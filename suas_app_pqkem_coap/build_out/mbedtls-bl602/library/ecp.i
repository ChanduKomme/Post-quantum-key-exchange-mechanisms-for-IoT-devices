# 0 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
# 1 "/home/chandu/sdk/bl602_iot_sdk/customer_app/suas_app_pqkem_coap/build_out/mbedtls-bl602//"
# 0 "<built-in>"
# 0 "<command-line>"
# 1 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
# 32 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
# 1 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/common.h" 1
# 14 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/common.h"
# 1 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/build_info.h" 1
# 113 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/build_info.h"
# 1 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/mbedtls_config.h" 1
# 114 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/build_info.h" 2
# 138 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/build_info.h"
# 1 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_config.h" 1
# 139 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/build_info.h" 2
# 176 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/build_info.h"
# 1 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/config_psa.h" 1
# 21 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/config_psa.h"
# 1 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_legacy.h" 1
# 22 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/config_psa.h" 2

# 1 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_adjust_config_synonyms.h" 1
# 24 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/config_psa.h" 2

# 1 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_adjust_config_dependencies.h" 1
# 26 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/config_psa.h" 2

# 1 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/config_adjust_psa_superset_legacy.h" 1
# 28 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/config_psa.h" 2







# 1 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_adjust_config_key_pair_types.h" 1
# 36 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/config_psa.h" 2




# 1 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/config_adjust_legacy_from_psa.h" 1
# 41 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/config_psa.h" 2
# 59 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/config_psa.h"
# 1 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_adjust_auto_enabled.h" 1
# 60 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/config_psa.h" 2
# 177 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/build_info.h" 2


# 1 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/config_adjust_legacy_crypto.h" 1
# 180 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/build_info.h" 2

# 1 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/config_adjust_x509.h" 1
# 182 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/build_info.h" 2

# 1 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/config_adjust_ssl.h" 1
# 184 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/build_info.h" 2
# 192 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/build_info.h"
# 1 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/check_config.h" 1
# 33 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/check_config.h"
# 1 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/lib/gcc/riscv32-unknown-elf/15.1.0/include/limits.h" 1 3 4
# 34 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/lib/gcc/riscv32-unknown-elf/15.1.0/include/limits.h" 3 4
# 1 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/lib/gcc/riscv32-unknown-elf/15.1.0/include/syslimits.h" 1 3 4






#pragma GCC diagnostic push
#pragma GCC diagnostic ignored "-Wpedantic"
# 1 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/lib/gcc/riscv32-unknown-elf/15.1.0/include/limits.h" 1 3 4
# 210 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/lib/gcc/riscv32-unknown-elf/15.1.0/include/limits.h" 3 4
# 1 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/limits.h" 1 3 4



# 1 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/newlib.h" 1 3 4
# 10 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/newlib.h" 3 4
# 1 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/_newlib_version.h" 1 3 4
# 11 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/newlib.h" 2 3 4
# 5 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/limits.h" 2 3 4
# 1 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/sys/cdefs.h" 1 3 4
# 45 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/sys/cdefs.h" 3 4
# 1 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/machine/_default_types.h" 1 3 4







# 1 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/sys/features.h" 1 3 4
# 9 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/machine/_default_types.h" 2 3 4
# 41 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/machine/_default_types.h" 3 4
typedef signed char __int8_t;

typedef unsigned char __uint8_t;
# 55 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/machine/_default_types.h" 3 4
typedef short int __int16_t;

typedef short unsigned int __uint16_t;
# 77 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/machine/_default_types.h" 3 4
typedef long int __int32_t;

typedef long unsigned int __uint32_t;
# 103 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/machine/_default_types.h" 3 4
typedef long long int __int64_t;

typedef long long unsigned int __uint64_t;
# 134 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/machine/_default_types.h" 3 4
typedef signed char __int_least8_t;

typedef unsigned char __uint_least8_t;
# 160 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/machine/_default_types.h" 3 4
typedef short int __int_least16_t;

typedef short unsigned int __uint_least16_t;
# 182 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/machine/_default_types.h" 3 4
typedef long int __int_least32_t;

typedef long unsigned int __uint_least32_t;
# 200 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/machine/_default_types.h" 3 4
typedef long long int __int_least64_t;

typedef long long unsigned int __uint_least64_t;
# 214 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/machine/_default_types.h" 3 4
typedef long long int __intmax_t;







typedef long long unsigned int __uintmax_t;







typedef int __intptr_t;

typedef unsigned int __uintptr_t;
# 46 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/sys/cdefs.h" 2 3 4

# 1 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/lib/gcc/riscv32-unknown-elf/15.1.0/include/stddef.h" 1 3 4
# 160 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/lib/gcc/riscv32-unknown-elf/15.1.0/include/stddef.h" 3 4
typedef int ptrdiff_t;
# 229 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/lib/gcc/riscv32-unknown-elf/15.1.0/include/stddef.h" 3 4
typedef unsigned int size_t;
# 344 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/lib/gcc/riscv32-unknown-elf/15.1.0/include/stddef.h" 3 4
typedef int wchar_t;
# 440 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/lib/gcc/riscv32-unknown-elf/15.1.0/include/stddef.h" 3 4
typedef struct {
  long long __max_align_ll __attribute__((__aligned__(__alignof__(long long))));
  long double __max_align_ld __attribute__((__aligned__(__alignof__(long double))));
# 451 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/lib/gcc/riscv32-unknown-elf/15.1.0/include/stddef.h" 3 4
} max_align_t;
# 465 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/lib/gcc/riscv32-unknown-elf/15.1.0/include/stddef.h" 3 4
  typedef __typeof__(nullptr) nullptr_t;
# 48 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/sys/cdefs.h" 2 3 4
# 6 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/limits.h" 2 3 4
# 1 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/sys/syslimits.h" 1 3 4
# 7 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/limits.h" 2 3 4
# 211 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/lib/gcc/riscv32-unknown-elf/15.1.0/include/limits.h" 2 3 4
# 10 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/lib/gcc/riscv32-unknown-elf/15.1.0/include/syslimits.h" 2 3 4
#pragma GCC diagnostic pop
# 35 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/lib/gcc/riscv32-unknown-elf/15.1.0/include/limits.h" 2 3 4
# 34 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/check_config.h" 2




# 1 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/lib/gcc/riscv32-unknown-elf/15.1.0/include/stdint.h" 1 3 4
# 14 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/lib/gcc/riscv32-unknown-elf/15.1.0/include/stdint.h" 3 4
# 1 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/lib/gcc/riscv32-unknown-elf/15.1.0/include/stdint-gcc.h" 1 3 4
# 34 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/lib/gcc/riscv32-unknown-elf/15.1.0/include/stdint-gcc.h" 3 4
typedef signed char int8_t;


typedef short int int16_t;


typedef long int int32_t;


typedef long long int int64_t;


typedef unsigned char uint8_t;


typedef short unsigned int uint16_t;


typedef long unsigned int uint32_t;


typedef long long unsigned int uint64_t;




typedef signed char int_least8_t;
typedef short int int_least16_t;
typedef long int int_least32_t;
typedef long long int int_least64_t;
typedef unsigned char uint_least8_t;
typedef short unsigned int uint_least16_t;
typedef long unsigned int uint_least32_t;
typedef long long unsigned int uint_least64_t;



typedef int int_fast8_t;
typedef int int_fast16_t;
typedef int int_fast32_t;
typedef long long int int_fast64_t;
typedef unsigned int uint_fast8_t;
typedef unsigned int uint_fast16_t;
typedef unsigned int uint_fast32_t;
typedef long long unsigned int uint_fast64_t;




typedef int intptr_t;


typedef unsigned int uintptr_t;




typedef long long int intmax_t;
typedef long long unsigned int uintmax_t;
# 15 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/lib/gcc/riscv32-unknown-elf/15.1.0/include/stdint.h" 2 3 4
# 39 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/check_config.h" 2
# 1146 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/check_config.h"

# 1146 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/check_config.h"
typedef int mbedtls_iso_c_forbids_empty_translation_units;
# 193 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/build_info.h" 2
# 15 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/common.h" 2
# 1 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/alignment.h" 1
# 15 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/alignment.h"
# 1 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/string.h" 1 3
# 10 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/string.h" 3
# 1 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/_ansi.h" 1 3
# 11 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/_ansi.h" 3
# 1 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/sys/config.h" 1 3



# 1 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/machine/ieeefp.h" 1 3
# 5 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/sys/config.h" 2 3
# 12 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/_ansi.h" 2 3
# 11 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/string.h" 2 3
# 1 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/sys/reent.h" 1 3
# 13 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/sys/reent.h" 3
# 1 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/_ansi.h" 1 3
# 14 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/sys/reent.h" 2 3
# 1 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/lib/gcc/riscv32-unknown-elf/15.1.0/include/stddef.h" 1 3 4
# 15 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/sys/reent.h" 2 3

# 1 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/sys/_types.h" 1 3
# 24 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/sys/_types.h" 3
# 1 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/lib/gcc/riscv32-unknown-elf/15.1.0/include/stddef.h" 1 3 4
# 374 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/lib/gcc/riscv32-unknown-elf/15.1.0/include/stddef.h" 3 4

# 374 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/lib/gcc/riscv32-unknown-elf/15.1.0/include/stddef.h" 3 4
typedef unsigned int wint_t;
# 25 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/sys/_types.h" 2 3


# 1 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/machine/_types.h" 1 3
# 28 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/sys/_types.h" 2 3


typedef long __blkcnt_t;



typedef long __blksize_t;



typedef __uint64_t __fsblkcnt_t;



typedef __uint32_t __fsfilcnt_t;



typedef long _off_t;





typedef int __pid_t;



typedef short __dev_t;



typedef unsigned short __uid_t;


typedef unsigned short __gid_t;



typedef __uint32_t __id_t;







typedef unsigned short __ino_t;
# 90 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/sys/_types.h" 3
typedef __uint32_t __mode_t;





__extension__ typedef long long _off64_t;





typedef _off_t __off_t;


typedef _off64_t __loff_t;


typedef long __key_t;







typedef long _fpos_t;
# 131 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/sys/_types.h" 3
typedef unsigned int __size_t;
# 147 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/sys/_types.h" 3
typedef signed int _ssize_t;
# 158 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/sys/_types.h" 3
typedef _ssize_t __ssize_t;



typedef struct
{
  int __count;
  union
  {
    wint_t __wch;
    unsigned char __wchb[4];
  } __value;
} _mbstate_t;




typedef void *_iconv_t;






typedef unsigned long __clock_t;






typedef __int_least64_t __time_t;





typedef unsigned long __clockid_t;


typedef long __daddr_t;



typedef unsigned long __timer_t;


typedef __uint8_t __sa_family_t;



typedef __uint32_t __socklen_t;


typedef int __nl_item;
typedef unsigned short __nlink_t;
typedef long __suseconds_t;
typedef unsigned long __useconds_t;







typedef __builtin_va_list __va_list;
# 17 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/sys/reent.h" 2 3






typedef unsigned long __ULong;
# 35 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/sys/reent.h" 3
# 1 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/sys/lock.h" 1 3
# 11 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/sys/lock.h" 3
typedef int _LOCK_T;
typedef int _LOCK_RECURSIVE_T;
# 36 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/sys/reent.h" 2 3
typedef _LOCK_RECURSIVE_T _flock_t;







struct _reent;

struct __locale_t;






struct _Bigint
{
  struct _Bigint *_next;
  int _k, _maxwds, _sign, _wds;
  __ULong _x[1];
};


struct __tm
{
  int __tm_sec;
  int __tm_min;
  int __tm_hour;
  int __tm_mday;
  int __tm_mon;
  int __tm_year;
  int __tm_wday;
  int __tm_yday;
  int __tm_isdst;
};







struct _on_exit_args {
 void * _fnargs[32];
 void * _dso_handle[32];

 __ULong _fntypes;


 __ULong _is_cxa;
};
# 99 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/sys/reent.h" 3
struct _atexit {
 struct _atexit *_next;
 int _ind;

 void (*_fns[32])(void);
        struct _on_exit_args _on_exit_args;
};
# 116 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/sys/reent.h" 3
struct __sbuf {
 unsigned char *_base;
 int _size;
};
# 153 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/sys/reent.h" 3
struct __sFILE {
  unsigned char *_p;
  int _r;
  int _w;
  short _flags;
  short _file;
  struct __sbuf _bf;
  int _lbfsize;






  void * _cookie;

  _ssize_t (*_read) (struct _reent *, void *,
        char *, int);
  _ssize_t (*_write) (struct _reent *, void *,
         const char *,
         int);
  _fpos_t (*_seek) (struct _reent *, void *, _fpos_t, int);
  int (*_close) (struct _reent *, void *);


  struct __sbuf _ub;
  unsigned char *_up;
  int _ur;


  unsigned char _ubuf[3];
  unsigned char _nbuf[1];


  struct __sbuf _lb;


  int _blksize;
  _off_t _offset;


  struct _reent *_data;



  _flock_t _lock;

  _mbstate_t _mbstate;
  int _flags2;
};
# 270 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/sys/reent.h" 3
typedef struct __sFILE __FILE;



extern __FILE __sf[3];

struct _glue
{
  struct _glue *_next;
  int _niobs;
  __FILE *_iobs;
};

extern struct _glue __sglue;
# 306 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/sys/reent.h" 3
struct _rand48 {
  unsigned short _seed[3];
  unsigned short _mult[3];
  unsigned short _add;




};
# 568 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/sys/reent.h" 3
struct _reent
{
  int _errno;




  __FILE *_stdin, *_stdout, *_stderr;

  int _inc;
  char _emergency[25];




  struct __locale_t *_locale;





  void (*__cleanup) (struct _reent *);


  struct _Bigint *_result;
  int _result_k;
  struct _Bigint *_p5s;
  struct _Bigint **_freelist;


  int _cvtlen;
  char *_cvtbuf;

  union
    {
      struct
        {



          char * _strtok_last;
          char _asctime_buf[26];
          struct __tm _localtime_buf;
          int _gamma_signgam;
          __extension__ unsigned long long _rand_next;
          struct _rand48 _r48;
          _mbstate_t _mblen_state;
          _mbstate_t _mbtowc_state;
          _mbstate_t _wctomb_state;
          char _l64a_buf[8];
          char _signal_buf[24];
          int _getdate_err;
          _mbstate_t _mbrlen_state;
          _mbstate_t _mbrtowc_state;
          _mbstate_t _mbsrtowcs_state;
          _mbstate_t _wcrtomb_state;
          _mbstate_t _wcsrtombs_state;
   int _h_errno;
# 634 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/sys/reent.h" 3
        } _reent;







    } _new;







  void (**_sig_func)(int);
};
# 782 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/sys/reent.h" 3
extern struct _reent *_impure_ptr ;





extern struct _reent _impure_data ;
# 900 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/sys/reent.h" 3
extern struct _atexit *__atexit;
extern struct _atexit __atexit0;

extern void (*__stdio_exit_handler) (void);

void _reclaim_reent (struct _reent *);

extern int _fwalk_sglue (struct _reent *, int (*)(struct _reent *, __FILE *),
    struct _glue *);
# 12 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/string.h" 2 3





# 1 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/lib/gcc/riscv32-unknown-elf/15.1.0/include/stddef.h" 1 3 4
# 18 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/string.h" 2 3


# 1 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/sys/_locale.h" 1 3
# 9 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/sys/_locale.h" 3
struct __locale_t;
typedef struct __locale_t *locale_t;
# 21 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/string.h" 2 3



# 1 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/strings.h" 1 3
# 44 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/strings.h" 3


int bcmp(const void *, const void *, size_t) __attribute__((__pure__));
void bcopy(const void *, void *, size_t);
void bzero(void *, size_t);


void explicit_bzero(void *, size_t);


int ffs(int) __attribute__((__const__));


int ffsl(long) __attribute__((__const__));
int ffsll(long long) __attribute__((__const__));
int fls(int) __attribute__((__const__));
int flsl(long) __attribute__((__const__));
int flsll(long long) __attribute__((__const__));


char *index(const char *, int) __attribute__((__pure__));
char *rindex(const char *, int) __attribute__((__pure__));

int strcasecmp(const char *, const char *) __attribute__((__pure__));
int strncasecmp(const char *, const char *, size_t) __attribute__((__pure__));


int strcasecmp_l (const char *, const char *, locale_t);
int strncasecmp_l (const char *, const char *, size_t, locale_t);


# 25 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/string.h" 2 3




void * memchr (const void *, int, size_t);
int memcmp (const void *, const void *, size_t);
void * memcpy (void *restrict, const void *restrict, size_t);
void * memmove (void *, const void *, size_t);
void * memset (void *, int, size_t);
char *strcat (char *restrict, const char *restrict);
char *strchr (const char *, int);
int strcmp (const char *, const char *);
int strcoll (const char *, const char *);
char *strcpy (char *restrict, const char *restrict);
size_t strcspn (const char *, const char *);
char *strerror (int);
size_t strlen (const char *);
char *strncat (char *restrict, const char *restrict, size_t);
int strncmp (const char *, const char *, size_t);
char *strncpy (char *restrict, const char *restrict, size_t);
char *strpbrk (const char *, const char *);
char *strrchr (const char *, int);
size_t strspn (const char *, const char *);
char *strstr (const char *, const char *);

char *strtok (char *restrict, const char *restrict);

size_t strxfrm (char *restrict, const char *restrict, size_t);


int strcoll_l (const char *, const char *, locale_t);
char *strerror_l (int, locale_t);
size_t strxfrm_l (char *restrict, const char *restrict, size_t, locale_t);


char *strtok_r (char *restrict, const char *restrict, char **restrict);


int timingsafe_bcmp (const void *, const void *, size_t);
int timingsafe_memcmp (const void *, const void *, size_t);


void * memccpy (void *restrict, const void *restrict, int, size_t);
# 76 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/string.h" 3
char *stpcpy (char *restrict, const char *restrict);
char *stpncpy (char *restrict, const char *restrict, size_t);






char *strdup (const char *) __attribute__((__malloc__)) __attribute__((__warn_unused_result__));

char *_strdup_r (struct _reent *, const char *);

char *strndup (const char *, size_t) __attribute__((__malloc__)) __attribute__((__warn_unused_result__));

char *_strndup_r (struct _reent *, const char *, size_t);
# 100 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/string.h" 3
int strerror_r (int, char *, size_t)

             __asm__ ("" "__xpg_strerror_r")

  ;







char * _strerror_r (struct _reent *, int, int, int *);


size_t strlcat (char *, const char *, size_t);
size_t strlcpy (char *, const char *, size_t);


size_t strnlen (const char *, size_t);


char *strsep (char **, const char *);


char *strnstr(const char *, const char *, size_t) __attribute__((__pure__));



char *strlwr (char *);
char *strupr (char *);



char *strsignal (int __signo);
# 175 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/string.h" 3
# 1 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/sys/string.h" 1 3
# 15 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/sys/string.h" 3
static __inline unsigned long __libc_detect_null(unsigned long w)
{
  unsigned long mask = 0x7f7f7f7f;
  if (sizeof (long) == 8)
    mask = ((mask << 16) << 16) | mask;
  return ~(((w & mask) + mask) | w | mask);
}
# 176 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/string.h" 2 3


# 16 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/alignment.h" 2
# 1 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/stdlib.h" 1 3
# 10 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/stdlib.h" 3
# 1 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/machine/ieeefp.h" 1 3
# 11 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/stdlib.h" 2 3





# 1 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/lib/gcc/riscv32-unknown-elf/15.1.0/include/stddef.h" 1 3 4
# 17 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/stdlib.h" 2 3



# 1 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/machine/stdlib.h" 1 3
# 21 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/stdlib.h" 2 3

# 1 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/alloca.h" 1 3
# 23 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/stdlib.h" 2 3
# 33 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/stdlib.h" 3


typedef struct
{
  int quot;
  int rem;
} div_t;

typedef struct
{
  long quot;
  long rem;
} ldiv_t;


typedef struct
{
  long long int quot;
  long long int rem;
} lldiv_t;




typedef int (*__compar_fn_t) (const void *, const void *);







int __locale_mb_cur_max (void);



void abort (void) __attribute__ ((__noreturn__));
int abs (int);

__uint32_t arc4random (void);
__uint32_t arc4random_uniform (__uint32_t);
void arc4random_buf (void *, size_t);

int atexit (void (*__func)(void));
double atof (const char *__nptr);

float atoff (const char *__nptr);

int atoi (const char *__nptr);
int _atoi_r (struct _reent *, const char *__nptr);
long atol (const char *__nptr);
long _atol_r (struct _reent *, const char *__nptr);
void * bsearch (const void *__key,
         const void *__base,
         size_t __nmemb,
         size_t __size,
         __compar_fn_t _compar);
void *calloc(size_t, size_t) __attribute__((__malloc__)) __attribute__((__warn_unused_result__))
      __attribute__((__alloc_size__(1, 2))) ;
div_t div (int __numer, int __denom);
void exit (int __status) __attribute__ ((__noreturn__));
void free (void *) ;
char * getenv (const char *__string);
char * _getenv_r (struct _reent *, const char *__string);



char * _findenv (const char *, int *);
char * _findenv_r (struct _reent *, const char *, int *);

extern char *suboptarg;
int getsubopt (char **, char * const *, char **);

long labs (long);
ldiv_t ldiv (long __numer, long __denom);
void *malloc(size_t) __attribute__((__malloc__)) __attribute__((__warn_unused_result__)) __attribute__((__alloc_size__(1))) ;
int mblen (const char *, size_t);
int _mblen_r (struct _reent *, const char *, size_t, _mbstate_t *);
int mbtowc (wchar_t *restrict, const char *restrict, size_t);
int _mbtowc_r (struct _reent *, wchar_t *restrict, const char *restrict, size_t, _mbstate_t *);
int wctomb (char *, wchar_t);
int _wctomb_r (struct _reent *, char *, wchar_t, _mbstate_t *);
size_t mbstowcs (wchar_t *restrict, const char *restrict, size_t);
size_t _mbstowcs_r (struct _reent *, wchar_t *restrict, const char *restrict, size_t, _mbstate_t *);
size_t wcstombs (char *restrict, const wchar_t *restrict, size_t);
size_t _wcstombs_r (struct _reent *, char *restrict, const wchar_t *restrict, size_t, _mbstate_t *);


char * mkdtemp (char *);






int mkstemp (char *);


int mkstemps (char *, int);


char * mktemp (char *) __attribute__ ((__deprecated__("the use of `mktemp' is dangerous; use `mkstemp' instead")));


char * _mkdtemp_r (struct _reent *, char *);
int _mkostemp_r (struct _reent *, char *, int);
int _mkostemps_r (struct _reent *, char *, int, int);
int _mkstemp_r (struct _reent *, char *);
int _mkstemps_r (struct _reent *, char *, int);
char * _mktemp_r (struct _reent *, char *) __attribute__ ((__deprecated__("the use of `mktemp' is dangerous; use `mkstemp' instead")));
void qsort (void *__base, size_t __nmemb, size_t __size, __compar_fn_t _compar);
int rand (void);
void *realloc(void *, size_t) __attribute__((__warn_unused_result__)) __attribute__((__alloc_size__(2))) ;

void *reallocarray(void *, size_t, size_t) __attribute__((__warn_unused_result__)) __attribute__((__alloc_size__(2, 3)));
void *reallocf(void *, size_t) __attribute__((__warn_unused_result__)) __attribute__((__alloc_size__(2)));


char * realpath (const char *restrict path, char *restrict resolved_path);


int rpmatch (const char *response);




void srand (unsigned __seed);
double strtod (const char *restrict __n, char **restrict __end_PTR);
double _strtod_r (struct _reent *,const char *restrict __n, char **restrict __end_PTR);

float strtof (const char *restrict __n, char **restrict __end_PTR);







long strtol (const char *restrict __n, char **restrict __end_PTR, int __base);
long _strtol_r (struct _reent *,const char *restrict __n, char **restrict __end_PTR, int __base);
unsigned long strtoul (const char *restrict __n, char **restrict __end_PTR, int __base);
unsigned long _strtoul_r (struct _reent *,const char *restrict __n, char **restrict __end_PTR, int __base);
# 191 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/stdlib.h" 3
int system (const char *__string);


long a64l (const char *__input);
char * l64a (long __input);
char * _l64a_r (struct _reent *,long __input);


int on_exit (void (*__func)(int, void *),void *__arg);


void _Exit (int __status) __attribute__ ((__noreturn__));


int putenv (char *__string);

int _putenv_r (struct _reent *, char *__string);
void * _reallocf_r (struct _reent *, void *, size_t);

int setenv (const char *__string, const char *__value, int __overwrite);

int _setenv_r (struct _reent *, const char *__string, const char *__value, int __overwrite);
# 224 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/stdlib.h" 3
char * __itoa (int, char *, int);
char * __utoa (unsigned, char *, int);

char * itoa (int, char *, int);
char * utoa (unsigned, char *, int);


int rand_r (unsigned *__seed);



double drand48 (void);
double _drand48_r (struct _reent *);
double erand48 (unsigned short [3]);
double _erand48_r (struct _reent *, unsigned short [3]);
long jrand48 (unsigned short [3]);
long _jrand48_r (struct _reent *, unsigned short [3]);
void lcong48 (unsigned short [7]);
void _lcong48_r (struct _reent *, unsigned short [7]);
long lrand48 (void);
long _lrand48_r (struct _reent *);
long mrand48 (void);
long _mrand48_r (struct _reent *);
long nrand48 (unsigned short [3]);
long _nrand48_r (struct _reent *, unsigned short [3]);
unsigned short *
       seed48 (unsigned short [3]);
unsigned short *
       _seed48_r (struct _reent *, unsigned short [3]);
void srand48 (long);
void _srand48_r (struct _reent *, long);


char * initstate (unsigned, char *, size_t);
long random (void);
char * setstate (char *);
void srandom (unsigned);


long long atoll (const char *__nptr);

long long _atoll_r (struct _reent *, const char *__nptr);

long long llabs (long long);
lldiv_t lldiv (long long __numer, long long __denom);
long long strtoll (const char *restrict __n, char **restrict __end_PTR, int __base);

long long _strtoll_r (struct _reent *, const char *restrict __n, char **restrict __end_PTR, int __base);

unsigned long long strtoull (const char *restrict __n, char **restrict __end_PTR, int __base);

unsigned long long _strtoull_r (struct _reent *, const char *restrict __n, char **restrict __end_PTR, int __base);



void cfree (void *);


int unsetenv (const char *__string);

int _unsetenv_r (struct _reent *, const char *__string);



int posix_memalign (void **, size_t, size_t) __attribute__((__nonnull__ (1)))
     __attribute__((__warn_unused_result__));


char * _dtoa_r (struct _reent *, double, int, int, int *, int*, char**);

void * _malloc_r (struct _reent *, size_t) ;
void * _calloc_r (struct _reent *, size_t, size_t) ;
void _free_r (struct _reent *, void *) ;
void * _realloc_r (struct _reent *, void *, size_t) ;
void _mstats_r (struct _reent *, char *);

int _system_r (struct _reent *, const char *);

void __eprintf (const char *, const char *, unsigned int, const char *);
# 312 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/stdlib.h" 3
void qsort_r (void *__base, size_t __nmemb, size_t __size, void *__thunk, int (*_compar)(void *, const void *, const void *))
             __asm__ ("" "__bsd_qsort_r");
# 322 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/stdlib.h" 3
extern long double _strtold_r (struct _reent *, const char *restrict, char **restrict);

extern long double strtold (const char *restrict, char **restrict);







void * aligned_alloc(size_t, size_t) __attribute__((__malloc__)) __attribute__((__alloc_align__(1)))
     __attribute__((__alloc_size__(2))) __attribute__((__warn_unused_result__));
int at_quick_exit(void (*)(void));
_Noreturn void
 quick_exit(int);



# 17 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/alignment.h" 2
# 86 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/alignment.h"

# 86 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/alignment.h"
typedef struct {
    uint16_t x;
} __attribute__((packed)) mbedtls_uint16_unaligned_t;
typedef struct {
    uint32_t x;
} __attribute__((packed)) mbedtls_uint32_unaligned_t;
typedef struct {
    uint64_t x;
} __attribute__((packed)) mbedtls_uint64_unaligned_t;
# 113 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/alignment.h"
__attribute__((always_inline))

static inline uint16_t mbedtls_get_unaligned_uint16(const void *p)
{
    uint16_t r;




    mbedtls_uint16_unaligned_t *p16 = (mbedtls_uint16_unaligned_t *) p;
    r = p16->x;



    return r;
}
# 140 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/alignment.h"
__attribute__((always_inline))

static inline void mbedtls_put_unaligned_uint16(void *p, uint16_t x)
{




    mbedtls_uint16_unaligned_t *p16 = (mbedtls_uint16_unaligned_t *) p;
    p16->x = x;



}
# 165 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/alignment.h"
__attribute__((always_inline))

static inline uint32_t mbedtls_get_unaligned_uint32(const void *p)
{
    uint32_t r;




    mbedtls_uint32_unaligned_t *p32 = (mbedtls_uint32_unaligned_t *) p;
    r = p32->x;



    return r;
}
# 192 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/alignment.h"
__attribute__((always_inline))

static inline void mbedtls_put_unaligned_uint32(void *p, uint32_t x)
{




    mbedtls_uint32_unaligned_t *p32 = (mbedtls_uint32_unaligned_t *) p;
    p32->x = x;



}
# 217 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/alignment.h"
__attribute__((always_inline))

static inline uint64_t mbedtls_get_unaligned_uint64(const void *p)
{
    uint64_t r;




    mbedtls_uint64_unaligned_t *p64 = (mbedtls_uint64_unaligned_t *) p;
    r = p64->x;



    return r;
}
# 244 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/alignment.h"
__attribute__((always_inline))

static inline void mbedtls_put_unaligned_uint64(void *p, uint64_t x)
{




    mbedtls_uint64_unaligned_t *p64 = (mbedtls_uint64_unaligned_t *) p;
    p64->x = x;



}
# 16 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/common.h" 2

# 1 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/assert.h" 1 3
# 39 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/assert.h" 3

# 39 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/assert.h" 3
void __assert (const char *, int, const char *)
     __attribute__ ((__noreturn__));
void __assert_func (const char *, int, const char *, const char *)
     __attribute__ ((__noreturn__));
# 18 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/common.h" 2
# 1 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/lib/gcc/riscv32-unknown-elf/15.1.0/include/stddef.h" 1 3 4
# 19 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/common.h" 2

# 1 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/lib/gcc/riscv32-unknown-elf/15.1.0/include/stddef.h" 1 3 4
# 21 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/common.h" 2
# 121 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/common.h"

# 121 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/common.h"
void mbedtls_zeroize_and_free(void *buf, size_t len);
# 138 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/common.h"
static inline unsigned char *mbedtls_buffer_offset(
    unsigned char *p, size_t n)
{
    return p == 
# 141 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/common.h" 3 4
               ((void *)0) 
# 141 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/common.h"
                    ? 
# 141 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/common.h" 3 4
                      ((void *)0) 
# 141 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/common.h"
                           : p + n;
}
# 155 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/common.h"
static inline const unsigned char *mbedtls_buffer_offset_const(
    const unsigned char *p, size_t n)
{
    return p == 
# 158 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/common.h" 3 4
               ((void *)0) 
# 158 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/common.h"
                    ? 
# 158 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/common.h" 3 4
                      ((void *)0) 
# 158 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/common.h"
                           : p + n;
}





__attribute__((always_inline))
# 186 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/common.h"
static inline void mbedtls_xor(unsigned char *r,
                               const unsigned char *a,
                               const unsigned char *b,
                               size_t n)
{
    size_t i = 0;
# 234 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/common.h"
    for (; i < n; i++) {
        r[i] = a[i] ^ b[i];
    }
}






__attribute__((always_inline))
# 268 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/common.h"
static inline void mbedtls_xor_no_simd(unsigned char *r,
                                       const unsigned char *a,
                                       const unsigned char *b,
                                       size_t n)
{
    size_t i = 0;
# 302 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/common.h"
    for (; i < n; i++) {
        r[i] = a[i] ^ b[i];
    }
}
# 33 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c" 2
# 65 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
# 1 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecp.h" 1
# 24 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecp.h"
# 1 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/private_access.h" 1
# 25 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecp.h" 2


# 1 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/platform_util.h" 1
# 16 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/platform_util.h"
# 1 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/lib/gcc/riscv32-unknown-elf/15.1.0/include/stddef.h" 1 3 4
# 17 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/platform_util.h" 2
# 159 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/platform_util.h"
void mbedtls_platform_zeroize(void *buf, size_t len);
# 209 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/platform_util.h"
typedef int mbedtls_f_rng_t(void *p_rng,
                            unsigned char *output, size_t output_size);
# 28 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecp.h" 2

# 1 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/bignum.h" 1
# 17 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/bignum.h"
# 1 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/lib/gcc/riscv32-unknown-elf/15.1.0/include/stddef.h" 1 3 4
# 18 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/bignum.h" 2
# 169 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/bignum.h"
typedef int32_t mbedtls_mpi_sint;
typedef uint32_t mbedtls_mpi_uint;
# 208 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/bignum.h"
typedef struct mbedtls_mpi {




    mbedtls_mpi_uint *p;
# 226 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/bignum.h"
    signed short s;


    unsigned short n;
# 239 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/bignum.h"
}
mbedtls_mpi;
# 250 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/bignum.h"
void mbedtls_mpi_init(mbedtls_mpi *X);
# 259 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/bignum.h"
void mbedtls_mpi_free(mbedtls_mpi *X);
# 274 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/bignum.h"
int mbedtls_mpi_grow(mbedtls_mpi *X, size_t nblimbs);
# 291 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/bignum.h"
int mbedtls_mpi_shrink(mbedtls_mpi *X, size_t nblimbs);
# 306 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/bignum.h"
int mbedtls_mpi_copy(mbedtls_mpi *X, const mbedtls_mpi *Y);







void mbedtls_mpi_swap(mbedtls_mpi *X, mbedtls_mpi *Y);
# 344 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/bignum.h"
int mbedtls_mpi_safe_cond_assign(mbedtls_mpi *X, const mbedtls_mpi *Y, unsigned char assign);
# 373 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/bignum.h"
int mbedtls_mpi_safe_cond_swap(mbedtls_mpi *X, mbedtls_mpi *Y, unsigned char swap);
# 385 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/bignum.h"
int mbedtls_mpi_lset(mbedtls_mpi *X, mbedtls_mpi_sint z);
# 397 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/bignum.h"
int mbedtls_mpi_get_bit(const mbedtls_mpi *X, size_t pos);
# 414 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/bignum.h"
int mbedtls_mpi_set_bit(mbedtls_mpi *X, size_t pos, unsigned char val);
# 428 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/bignum.h"
size_t mbedtls_mpi_lsb(const mbedtls_mpi *X);
# 442 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/bignum.h"
size_t mbedtls_mpi_bitlen(const mbedtls_mpi *X);
# 457 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/bignum.h"
size_t mbedtls_mpi_size(const mbedtls_mpi *X);
# 469 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/bignum.h"
int mbedtls_mpi_read_string(mbedtls_mpi *X, int radix, const char *s);
# 493 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/bignum.h"
int mbedtls_mpi_write_string(const mbedtls_mpi *X, int radix,
                             char *buf, size_t buflen, size_t *olen);
# 551 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/bignum.h"
int mbedtls_mpi_read_binary(mbedtls_mpi *X, const unsigned char *buf,
                            size_t buflen);
# 566 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/bignum.h"
int mbedtls_mpi_read_binary_le(mbedtls_mpi *X,
                               const unsigned char *buf, size_t buflen);
# 584 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/bignum.h"
int mbedtls_mpi_write_binary(const mbedtls_mpi *X, unsigned char *buf,
                             size_t buflen);
# 602 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/bignum.h"
int mbedtls_mpi_write_binary_le(const mbedtls_mpi *X,
                                unsigned char *buf, size_t buflen);
# 617 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/bignum.h"
int mbedtls_mpi_shift_l(mbedtls_mpi *X, size_t count);
# 629 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/bignum.h"
int mbedtls_mpi_shift_r(mbedtls_mpi *X, size_t count);
# 641 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/bignum.h"
int mbedtls_mpi_cmp_abs(const mbedtls_mpi *X, const mbedtls_mpi *Y);
# 653 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/bignum.h"
int mbedtls_mpi_cmp_mpi(const mbedtls_mpi *X, const mbedtls_mpi *Y);
# 670 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/bignum.h"
int mbedtls_mpi_lt_mpi_ct(const mbedtls_mpi *X, const mbedtls_mpi *Y,
                          unsigned *ret);
# 683 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/bignum.h"
int mbedtls_mpi_cmp_int(const mbedtls_mpi *X, mbedtls_mpi_sint z);
# 696 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/bignum.h"
int mbedtls_mpi_add_abs(mbedtls_mpi *X, const mbedtls_mpi *A,
                        const mbedtls_mpi *B);
# 711 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/bignum.h"
int mbedtls_mpi_sub_abs(mbedtls_mpi *X, const mbedtls_mpi *A,
                        const mbedtls_mpi *B);
# 725 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/bignum.h"
int mbedtls_mpi_add_mpi(mbedtls_mpi *X, const mbedtls_mpi *A,
                        const mbedtls_mpi *B);
# 739 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/bignum.h"
int mbedtls_mpi_sub_mpi(mbedtls_mpi *X, const mbedtls_mpi *A,
                        const mbedtls_mpi *B);
# 753 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/bignum.h"
int mbedtls_mpi_add_int(mbedtls_mpi *X, const mbedtls_mpi *A,
                        mbedtls_mpi_sint b);
# 768 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/bignum.h"
int mbedtls_mpi_sub_int(mbedtls_mpi *X, const mbedtls_mpi *A,
                        mbedtls_mpi_sint b);
# 783 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/bignum.h"
int mbedtls_mpi_mul_mpi(mbedtls_mpi *X, const mbedtls_mpi *A,
                        const mbedtls_mpi *B);
# 799 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/bignum.h"
int mbedtls_mpi_mul_int(mbedtls_mpi *X, const mbedtls_mpi *A,
                        mbedtls_mpi_uint b);
# 820 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/bignum.h"
int mbedtls_mpi_div_mpi(mbedtls_mpi *Q, mbedtls_mpi *R, const mbedtls_mpi *A,
                        const mbedtls_mpi *B);
# 841 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/bignum.h"
int mbedtls_mpi_div_int(mbedtls_mpi *Q, mbedtls_mpi *R, const mbedtls_mpi *A,
                        mbedtls_mpi_sint b);
# 861 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/bignum.h"
int mbedtls_mpi_mod_mpi(mbedtls_mpi *R, const mbedtls_mpi *A,
                        const mbedtls_mpi *B);
# 880 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/bignum.h"
int mbedtls_mpi_mod_int(mbedtls_mpi_uint *r, const mbedtls_mpi *A,
                        mbedtls_mpi_sint b);
# 910 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/bignum.h"
int mbedtls_mpi_exp_mod(mbedtls_mpi *X, const mbedtls_mpi *A,
                        const mbedtls_mpi *E, const mbedtls_mpi *N,
                        mbedtls_mpi *prec_RR);
# 931 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/bignum.h"
int mbedtls_mpi_fill_random(mbedtls_mpi *X, size_t size,
                            mbedtls_f_rng_t *f_rng,
                            void *p_rng);
# 967 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/bignum.h"
int mbedtls_mpi_random(mbedtls_mpi *X,
                       mbedtls_mpi_sint min,
                       const mbedtls_mpi *N,
                       mbedtls_f_rng_t *f_rng,
                       void *p_rng);
# 985 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/bignum.h"
int mbedtls_mpi_gcd(mbedtls_mpi *G, const mbedtls_mpi *A,
                    const mbedtls_mpi *B);
# 1006 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/bignum.h"
int mbedtls_mpi_inv_mod(mbedtls_mpi *X, const mbedtls_mpi *A,
                        const mbedtls_mpi *N);
# 1036 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/bignum.h"
int mbedtls_mpi_is_prime_ext(const mbedtls_mpi *X, int rounds,
                             mbedtls_f_rng_t *f_rng,
                             void *p_rng);






typedef enum {
    MBEDTLS_MPI_GEN_PRIME_FLAG_DH = 0x0001,
    MBEDTLS_MPI_GEN_PRIME_FLAG_LOW_ERR = 0x0002,
} mbedtls_mpi_gen_prime_flag_t;
# 1069 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/bignum.h"
int mbedtls_mpi_gen_prime(mbedtls_mpi *X, size_t nbits, int flags,
                          mbedtls_f_rng_t *f_rng,
                          void *p_rng);
# 1080 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/bignum.h"
int mbedtls_mpi_self_test(int verbose);
# 30 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecp.h" 2
# 102 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecp.h"
typedef enum {
    MBEDTLS_ECP_DP_NONE = 0,
    MBEDTLS_ECP_DP_SECP192R1,
    MBEDTLS_ECP_DP_SECP224R1,
    MBEDTLS_ECP_DP_SECP256R1,
    MBEDTLS_ECP_DP_SECP384R1,
    MBEDTLS_ECP_DP_SECP521R1,
    MBEDTLS_ECP_DP_BP256R1,
    MBEDTLS_ECP_DP_BP384R1,
    MBEDTLS_ECP_DP_BP512R1,
    MBEDTLS_ECP_DP_CURVE25519,
    MBEDTLS_ECP_DP_SECP192K1,
    MBEDTLS_ECP_DP_SECP224K1,
    MBEDTLS_ECP_DP_SECP256K1,
    MBEDTLS_ECP_DP_CURVE448,
} mbedtls_ecp_group_id;
# 127 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecp.h"
typedef enum {
    MBEDTLS_ECP_TYPE_NONE = 0,
    MBEDTLS_ECP_TYPE_SHORT_WEIERSTRASS,
    MBEDTLS_ECP_TYPE_MONTGOMERY,
} mbedtls_ecp_curve_type;
# 140 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecp.h"
typedef struct mbedtls_ecp_curve_info {
    mbedtls_ecp_group_id grp_id;
    uint16_t tls_id;
    uint16_t bit_size;
    const char *name;
} mbedtls_ecp_curve_info;
# 158 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecp.h"
typedef struct mbedtls_ecp_point {
    mbedtls_mpi X;
    mbedtls_mpi Y;
    mbedtls_mpi Z;
}
mbedtls_ecp_point;
# 233 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecp.h"
typedef struct mbedtls_ecp_group {
    mbedtls_ecp_group_id id;
    mbedtls_mpi P;
    mbedtls_mpi A;




    mbedtls_mpi B;

    mbedtls_ecp_point G;
    mbedtls_mpi N;
    size_t pbits;
    size_t nbits;




    unsigned int h;
    int(*modp)(mbedtls_mpi *);

    int(*t_pre)(mbedtls_ecp_point *, void *);
    int(*t_post)(mbedtls_ecp_point *, void *);
    void *t_data;
    mbedtls_ecp_point *T;
    size_t T_size;
}
mbedtls_ecp_group;
# 364 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecp.h"
typedef struct mbedtls_ecp_restart_mul mbedtls_ecp_restart_mul_ctx;






typedef struct mbedtls_ecp_restart_muladd mbedtls_ecp_restart_muladd_ctx;




typedef struct {
    unsigned ops_done;
    unsigned depth;
    mbedtls_ecp_restart_mul_ctx *rsm;
    mbedtls_ecp_restart_muladd_ctx *ma;
} mbedtls_ecp_restart_ctx;
# 402 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecp.h"
int mbedtls_ecp_check_budget(const mbedtls_ecp_group *grp,
                             mbedtls_ecp_restart_ctx *rs_ctx,
                             unsigned ops);
# 428 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecp.h"
typedef struct mbedtls_ecp_keypair {
    mbedtls_ecp_group grp;
    mbedtls_mpi d;
    mbedtls_ecp_point Q;
}
mbedtls_ecp_keypair;
# 521 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecp.h"
void mbedtls_ecp_set_max_ops(unsigned max_ops);







int mbedtls_ecp_restart_is_enabled(void);





mbedtls_ecp_curve_type mbedtls_ecp_get_type(const mbedtls_ecp_group *grp);
# 549 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecp.h"
const mbedtls_ecp_curve_info *mbedtls_ecp_curve_list(void);
# 565 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecp.h"
const mbedtls_ecp_group_id *mbedtls_ecp_grp_id_list(void);
# 576 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecp.h"
const mbedtls_ecp_curve_info *mbedtls_ecp_curve_info_from_grp_id(mbedtls_ecp_group_id grp_id);
# 587 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecp.h"
const mbedtls_ecp_curve_info *mbedtls_ecp_curve_info_from_tls_id(uint16_t tls_id);
# 598 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecp.h"
const mbedtls_ecp_curve_info *mbedtls_ecp_curve_info_from_name(const char *name);






void mbedtls_ecp_point_init(mbedtls_ecp_point *pt);
# 616 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecp.h"
void mbedtls_ecp_group_init(mbedtls_ecp_group *grp);






void mbedtls_ecp_keypair_init(mbedtls_ecp_keypair *key);






void mbedtls_ecp_point_free(mbedtls_ecp_point *pt);
# 639 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecp.h"
void mbedtls_ecp_group_free(mbedtls_ecp_group *grp);
# 648 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecp.h"
void mbedtls_ecp_keypair_free(mbedtls_ecp_keypair *key);
# 657 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecp.h"
void mbedtls_ecp_restart_init(mbedtls_ecp_restart_ctx *ctx);
# 666 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecp.h"
void mbedtls_ecp_restart_free(mbedtls_ecp_restart_ctx *ctx);
# 680 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecp.h"
int mbedtls_ecp_copy(mbedtls_ecp_point *P, const mbedtls_ecp_point *Q);
# 693 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecp.h"
int mbedtls_ecp_group_copy(mbedtls_ecp_group *dst,
                           const mbedtls_ecp_group *src);
# 705 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecp.h"
int mbedtls_ecp_set_zero(mbedtls_ecp_point *pt);
# 716 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecp.h"
int mbedtls_ecp_is_zero(mbedtls_ecp_point *pt);
# 730 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecp.h"
int mbedtls_ecp_point_cmp(const mbedtls_ecp_point *P,
                          const mbedtls_ecp_point *Q);
# 745 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecp.h"
int mbedtls_ecp_point_read_string(mbedtls_ecp_point *P, int radix,
                                  const char *x, const char *y);
# 773 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecp.h"
int mbedtls_ecp_point_write_binary(const mbedtls_ecp_group *grp,
                                   const mbedtls_ecp_point *P,
                                   int format, size_t *olen,
                                   unsigned char *buf, size_t buflen);
# 803 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecp.h"
int mbedtls_ecp_point_read_binary(const mbedtls_ecp_group *grp,
                                  mbedtls_ecp_point *P,
                                  const unsigned char *buf, size_t ilen);
# 825 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecp.h"
int mbedtls_ecp_tls_read_point(const mbedtls_ecp_group *grp,
                               mbedtls_ecp_point *pt,
                               const unsigned char **buf, size_t len);
# 851 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecp.h"
int mbedtls_ecp_tls_write_point(const mbedtls_ecp_group *grp,
                                const mbedtls_ecp_point *pt,
                                int format, size_t *olen,
                                unsigned char *buf, size_t blen);
# 873 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecp.h"
int mbedtls_ecp_group_load(mbedtls_ecp_group *grp, mbedtls_ecp_group_id id);
# 892 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecp.h"
int mbedtls_ecp_tls_read_group(mbedtls_ecp_group *grp,
                               const unsigned char **buf, size_t len);
# 913 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecp.h"
int mbedtls_ecp_tls_read_group_id(mbedtls_ecp_group_id *grp,
                                  const unsigned char **buf,
                                  size_t len);
# 934 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecp.h"
int mbedtls_ecp_tls_write_group(const mbedtls_ecp_group *grp,
                                size_t *olen,
                                unsigned char *buf, size_t blen);
# 967 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecp.h"
int mbedtls_ecp_mul(mbedtls_ecp_group *grp, mbedtls_ecp_point *R,
                    const mbedtls_mpi *m, const mbedtls_ecp_point *P,
                    mbedtls_f_rng_t *f_rng, void *p_rng);
# 1001 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecp.h"
int mbedtls_ecp_mul_restartable(mbedtls_ecp_group *grp, mbedtls_ecp_point *R,
                                const mbedtls_mpi *m, const mbedtls_ecp_point *P,
                                mbedtls_f_rng_t *f_rng, void *p_rng,
                                mbedtls_ecp_restart_ctx *rs_ctx);
# 1022 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecp.h"
static inline int mbedtls_ecp_group_a_is_minus_3(const mbedtls_ecp_group *grp)
{
    return grp->A.p == 
# 1024 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecp.h" 3 4
                                       ((void *)0)
# 1024 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecp.h"
                                           ;
}
# 1062 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecp.h"
int mbedtls_ecp_muladd(mbedtls_ecp_group *grp, mbedtls_ecp_point *R,
                       const mbedtls_mpi *m, const mbedtls_ecp_point *P,
                       const mbedtls_mpi *n, const mbedtls_ecp_point *Q);
# 1106 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecp.h"
int mbedtls_ecp_muladd_restartable(
    mbedtls_ecp_group *grp, mbedtls_ecp_point *R,
    const mbedtls_mpi *m, const mbedtls_ecp_point *P,
    const mbedtls_mpi *n, const mbedtls_ecp_point *Q,
    mbedtls_ecp_restart_ctx *rs_ctx);
# 1140 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecp.h"
int mbedtls_ecp_check_pubkey(const mbedtls_ecp_group *grp,
                             const mbedtls_ecp_point *pt);
# 1162 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecp.h"
int mbedtls_ecp_check_privkey(const mbedtls_ecp_group *grp,
                              const mbedtls_mpi *d);
# 1180 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecp.h"
int mbedtls_ecp_gen_privkey(const mbedtls_ecp_group *grp,
                            mbedtls_mpi *d,
                            mbedtls_f_rng_t *f_rng,
                            void *p_rng);
# 1212 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecp.h"
int mbedtls_ecp_gen_keypair_base(mbedtls_ecp_group *grp,
                                 const mbedtls_ecp_point *G,
                                 mbedtls_mpi *d, mbedtls_ecp_point *Q,
                                 mbedtls_f_rng_t *f_rng,
                                 void *p_rng);
# 1241 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecp.h"
int mbedtls_ecp_gen_keypair(mbedtls_ecp_group *grp, mbedtls_mpi *d,
                            mbedtls_ecp_point *Q,
                            mbedtls_f_rng_t *f_rng,
                            void *p_rng);
# 1259 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecp.h"
int mbedtls_ecp_gen_key(mbedtls_ecp_group_id grp_id, mbedtls_ecp_keypair *key,
                        mbedtls_f_rng_t *f_rng,
                        void *p_rng);
# 1291 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecp.h"
int mbedtls_ecp_set_public_key(mbedtls_ecp_group_id grp_id,
                               mbedtls_ecp_keypair *key,
                               const mbedtls_ecp_point *Q);
# 1328 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecp.h"
int mbedtls_ecp_read_key(mbedtls_ecp_group_id grp_id, mbedtls_ecp_keypair *key,
                         const unsigned char *buf, size_t buflen);
# 1399 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecp.h"
int mbedtls_ecp_write_key_ext(const mbedtls_ecp_keypair *key,
                              size_t *olen, unsigned char *buf, size_t buflen);
# 1428 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecp.h"
int mbedtls_ecp_write_public_key(const mbedtls_ecp_keypair *key,
                                 int format, size_t *olen,
                                 unsigned char *buf, size_t buflen);
# 1452 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecp.h"
int mbedtls_ecp_check_pub_priv(
    const mbedtls_ecp_keypair *pub, const mbedtls_ecp_keypair *prv,
    mbedtls_f_rng_t *f_rng, void *p_rng);
# 1469 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecp.h"
int mbedtls_ecp_keypair_calc_public(
    mbedtls_ecp_keypair *key,
    mbedtls_f_rng_t *f_rng, void *p_rng);
# 1482 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecp.h"
mbedtls_ecp_group_id mbedtls_ecp_keypair_get_group_id(
    const mbedtls_ecp_keypair *key);
# 1509 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecp.h"
int mbedtls_ecp_export(const mbedtls_ecp_keypair *key, mbedtls_ecp_group *grp,
                       mbedtls_mpi *d, mbedtls_ecp_point *Q);
# 1520 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecp.h"
int mbedtls_ecp_self_test(int verbose);
# 66 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c" 2
# 1 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/threading.h" 1
# 67 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c" 2

# 1 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/error.h" 1
# 15 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/error.h"
# 1 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/lib/gcc/riscv32-unknown-elf/15.1.0/include/stddef.h" 1 3 4
# 16 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/error.h" 2
# 142 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/error.h"
static inline int mbedtls_error_add(int high, int low,
                                    const char *file, int line)
{





    (void) file;
    (void) line;

    return high + low;
}
# 165 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/error.h"
void mbedtls_strerror(int errnum, char *buffer, size_t buflen);
# 180 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/error.h"
const char *mbedtls_high_level_strerr(int error_code);
# 195 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/error.h"
const char *mbedtls_low_level_strerr(int error_code);
# 69 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c" 2

# 1 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/bn_mul.h" 1
# 71 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c" 2
# 1 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/bignum_internal.h" 1
# 46 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/bignum_internal.h"
int mbedtls_mpi_exp_mod_unsafe(mbedtls_mpi *X, const mbedtls_mpi *A,
                               const mbedtls_mpi *E, const mbedtls_mpi *N,
                               mbedtls_mpi *prec_RR);
# 79 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/bignum_internal.h"
int mbedtls_mpi_gcd_modinv_odd(mbedtls_mpi *G,
                               mbedtls_mpi *I,
                               const mbedtls_mpi *A,
                               const mbedtls_mpi *N);
# 98 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/bignum_internal.h"
int mbedtls_mpi_inv_mod_odd(mbedtls_mpi *X,
                            const mbedtls_mpi *A,
                            const mbedtls_mpi *N);
# 118 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/bignum_internal.h"
int mbedtls_mpi_inv_mod_even_in_range(mbedtls_mpi *X,
                                      mbedtls_mpi const *A,
                                      mbedtls_mpi const *N);
# 72 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c" 2
# 1 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp_invasive.h" 1
# 19 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp_invasive.h"
# 1 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/bignum_mod.h" 1
# 83 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/bignum_mod.h"
typedef enum {

    MBEDTLS_MPI_MOD_REP_INVALID = 0,


    MBEDTLS_MPI_MOD_REP_MONTGOMERY = 2,





    MBEDTLS_MPI_MOD_REP_OPT_RED,
} mbedtls_mpi_mod_rep_selector;



typedef enum {
    MBEDTLS_MPI_MOD_EXT_REP_INVALID = 0,
    MBEDTLS_MPI_MOD_EXT_REP_LE = 8,
    MBEDTLS_MPI_MOD_EXT_REP_BE
} mbedtls_mpi_mod_ext_rep;

typedef struct {
    mbedtls_mpi_uint *p;
    size_t limbs;
} mbedtls_mpi_mod_residue;

typedef struct {
    mbedtls_mpi_uint const *rr;
    mbedtls_mpi_uint mm;
} mbedtls_mpi_mont_struct;

typedef int (*mbedtls_mpi_modp_fn)(mbedtls_mpi_uint *X, size_t X_limbs);

typedef struct {
    mbedtls_mpi_modp_fn modp;
} mbedtls_mpi_opt_red_struct;

typedef struct {
    const mbedtls_mpi_uint *p;
    size_t limbs;
    size_t bits;
    mbedtls_mpi_mod_rep_selector int_rep;
    union rep {

        mbedtls_mpi_mont_struct mont;

        mbedtls_mpi_opt_red_struct ored;
    } rep;
} mbedtls_mpi_mod_modulus;
# 162 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/bignum_mod.h"
int mbedtls_mpi_mod_residue_setup(mbedtls_mpi_mod_residue *r,
                                  const mbedtls_mpi_mod_modulus *N,
                                  mbedtls_mpi_uint *p,
                                  size_t p_limbs);
# 177 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/bignum_mod.h"
void mbedtls_mpi_mod_residue_release(mbedtls_mpi_mod_residue *r);





void mbedtls_mpi_mod_modulus_init(mbedtls_mpi_mod_modulus *N);
# 196 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/bignum_mod.h"
int mbedtls_mpi_mod_modulus_setup(mbedtls_mpi_mod_modulus *N,
                                  const mbedtls_mpi_uint *p,
                                  size_t p_limbs);
# 212 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/bignum_mod.h"
int mbedtls_mpi_mod_optred_modulus_setup(mbedtls_mpi_mod_modulus *N,
                                         const mbedtls_mpi_uint *p,
                                         size_t p_limbs,
                                         mbedtls_mpi_modp_fn modp);
# 227 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/bignum_mod.h"
void mbedtls_mpi_mod_modulus_free(mbedtls_mpi_mod_modulus *N);
# 258 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/bignum_mod.h"
int mbedtls_mpi_mod_mul(mbedtls_mpi_mod_residue *X,
                        const mbedtls_mpi_mod_residue *A,
                        const mbedtls_mpi_mod_residue *B,
                        const mbedtls_mpi_mod_modulus *N);
# 288 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/bignum_mod.h"
int mbedtls_mpi_mod_sub(mbedtls_mpi_mod_residue *X,
                        const mbedtls_mpi_mod_residue *A,
                        const mbedtls_mpi_mod_residue *B,
                        const mbedtls_mpi_mod_modulus *N);
# 318 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/bignum_mod.h"
int mbedtls_mpi_mod_inv(mbedtls_mpi_mod_residue *X,
                        const mbedtls_mpi_mod_residue *A,
                        const mbedtls_mpi_mod_modulus *N);
# 347 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/bignum_mod.h"
int mbedtls_mpi_mod_add(mbedtls_mpi_mod_residue *X,
                        const mbedtls_mpi_mod_residue *A,
                        const mbedtls_mpi_mod_residue *B,
                        const mbedtls_mpi_mod_modulus *N);
# 379 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/bignum_mod.h"
int mbedtls_mpi_mod_random(mbedtls_mpi_mod_residue *X,
                           mbedtls_mpi_uint min,
                           const mbedtls_mpi_mod_modulus *N,
                           int (*f_rng)(void *, unsigned char *, size_t),
                           void *p_rng);
# 408 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/bignum_mod.h"
int mbedtls_mpi_mod_read(mbedtls_mpi_mod_residue *r,
                         const mbedtls_mpi_mod_modulus *N,
                         const unsigned char *buf,
                         size_t buflen,
                         mbedtls_mpi_mod_ext_rep ext_rep);
# 446 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/bignum_mod.h"
int mbedtls_mpi_mod_write(const mbedtls_mpi_mod_residue *r,
                          const mbedtls_mpi_mod_modulus *N,
                          unsigned char *buf,
                          size_t buflen,
                          mbedtls_mpi_mod_ext_rep ext_rep);
# 20 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp_invasive.h" 2





typedef enum {
    MBEDTLS_ECP_MOD_NONE = 0,
    MBEDTLS_ECP_MOD_COORDINATE,
    MBEDTLS_ECP_MOD_SCALAR
} mbedtls_ecp_modulus_type;

typedef enum {
    MBEDTLS_ECP_VARIANT_NONE = 0,
    MBEDTLS_ECP_VARIANT_WITH_MPI_STRUCT,
    MBEDTLS_ECP_VARIANT_WITH_MPI_UINT
} mbedtls_ecp_variant;
# 73 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c" 2





# 1 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/platform.h" 1
# 58 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/platform.h"
# 1 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/stdio.h" 1 3
# 36 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/stdio.h" 3
# 1 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/lib/gcc/riscv32-unknown-elf/15.1.0/include/stddef.h" 1 3 4
# 37 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/stdio.h" 2 3



# 1 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/lib/gcc/riscv32-unknown-elf/15.1.0/include/stdarg.h" 1 3 4
# 40 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/lib/gcc/riscv32-unknown-elf/15.1.0/include/stdarg.h" 3 4

# 40 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/lib/gcc/riscv32-unknown-elf/15.1.0/include/stdarg.h" 3 4
typedef __builtin_va_list __gnuc_va_list;
# 41 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/stdio.h" 2 3





typedef __gnuc_va_list va_list;
# 63 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/stdio.h" 3



typedef __FILE FILE;



typedef _fpos_t fpos_t;





typedef __off_t off_t;




typedef _ssize_t ssize_t;



# 1 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/sys/stdio.h" 1 3
# 86 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/stdio.h" 2 3
# 187 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/stdio.h" 3
char * ctermid (char *);




FILE * tmpfile (void);
char * tmpnam (char *);

char * tempnam (const char *, const char *) __attribute__((__malloc__)) __attribute__((__warn_unused_result__));

int fclose (FILE *);
int fflush (FILE *);
FILE * freopen (const char *restrict, const char *restrict, FILE *restrict);
void setbuf (FILE *restrict, char *restrict);
int setvbuf (FILE *restrict, char *restrict, int, size_t);
int fprintf (FILE *restrict, const char *restrict, ...)
               __attribute__ ((__format__ (__printf__, 2, 3)));
int fscanf (FILE *restrict, const char *restrict, ...)
               __attribute__ ((__format__ (__scanf__, 2, 3)));
int printf (const char *restrict, ...)
               __attribute__ ((__format__ (__printf__, 1, 2)));
int scanf (const char *restrict, ...)
               __attribute__ ((__format__ (__scanf__, 1, 2)));
int sscanf (const char *restrict, const char *restrict, ...)
               __attribute__ ((__format__ (__scanf__, 2, 3)));
int vfprintf (FILE *restrict, const char *restrict, __gnuc_va_list)
               __attribute__ ((__format__ (__printf__, 2, 0)));
int vprintf (const char *, __gnuc_va_list)
               __attribute__ ((__format__ (__printf__, 1, 0)));
int vsprintf (char *restrict, const char *restrict, __gnuc_va_list)
               __attribute__ ((__format__ (__printf__, 2, 0)));
int fgetc (FILE *);
char * fgets (char *restrict, int, FILE *restrict);
int fputc (int, FILE *);
int fputs (const char *restrict, FILE *restrict);
int getc (FILE *);
int getchar (void);
char * gets (char *);
int putc (int, FILE *);
int putchar (int);
int puts (const char *);
int ungetc (int, FILE *);
size_t fread (void *restrict, size_t _size, size_t _n, FILE *restrict);
size_t fwrite (const void *restrict , size_t _size, size_t _n, FILE *);



int fgetpos (FILE *restrict, fpos_t *restrict);

int fseek (FILE *, long, int);



int fsetpos (FILE *, const fpos_t *);

long ftell ( FILE *);
void rewind (FILE *);
void clearerr (FILE *);
int feof (FILE *);
int ferror (FILE *);
void perror (const char *);

FILE * fopen (const char *restrict _name, const char *restrict _type);
int sprintf (char *restrict, const char *restrict, ...)
               __attribute__ ((__format__ (__printf__, 2, 3)));
int remove (const char *);
int rename (const char *, const char *);
# 263 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/stdio.h" 3
int fseeko (FILE *, off_t, int);
off_t ftello (FILE *);







int snprintf (char *restrict, size_t, const char *restrict, ...)
               __attribute__ ((__format__ (__printf__, 3, 4)));
int vsnprintf (char *restrict, size_t, const char *restrict, __gnuc_va_list)
               __attribute__ ((__format__ (__printf__, 3, 0)));
int vfscanf (FILE *restrict, const char *restrict, __gnuc_va_list)
               __attribute__ ((__format__ (__scanf__, 2, 0)));
int vscanf (const char *, __gnuc_va_list)
               __attribute__ ((__format__ (__scanf__, 1, 0)));
int vsscanf (const char *restrict, const char *restrict, __gnuc_va_list)
               __attribute__ ((__format__ (__scanf__, 2, 0)));
# 290 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/stdio.h" 3
int asiprintf (char **, const char *, ...)
               __attribute__ ((__format__ (__printf__, 2, 3)));
char * asniprintf (char *, size_t *, const char *, ...)
               __attribute__ ((__format__ (__printf__, 3, 4)));
char * asnprintf (char *restrict, size_t *restrict, const char *restrict, ...)
               __attribute__ ((__format__ (__printf__, 3, 4)));

int diprintf (int, const char *, ...)
               __attribute__ ((__format__ (__printf__, 2, 3)));

int fiprintf (FILE *, const char *, ...)
               __attribute__ ((__format__ (__printf__, 2, 3)));
int fiscanf (FILE *, const char *, ...)
               __attribute__ ((__format__ (__scanf__, 2, 3)));
int iprintf (const char *, ...)
               __attribute__ ((__format__ (__printf__, 1, 2)));
int iscanf (const char *, ...)
               __attribute__ ((__format__ (__scanf__, 1, 2)));
int siprintf (char *, const char *, ...)
               __attribute__ ((__format__ (__printf__, 2, 3)));
int siscanf (const char *, const char *, ...)
               __attribute__ ((__format__ (__scanf__, 2, 3)));
int sniprintf (char *, size_t, const char *, ...)
               __attribute__ ((__format__ (__printf__, 3, 4)));
int vasiprintf (char **, const char *, __gnuc_va_list)
               __attribute__ ((__format__ (__printf__, 2, 0)));
char * vasniprintf (char *, size_t *, const char *, __gnuc_va_list)
               __attribute__ ((__format__ (__printf__, 3, 0)));
char * vasnprintf (char *, size_t *, const char *, __gnuc_va_list)
               __attribute__ ((__format__ (__printf__, 3, 0)));
int vdiprintf (int, const char *, __gnuc_va_list)
               __attribute__ ((__format__ (__printf__, 2, 0)));
int vfiprintf (FILE *, const char *, __gnuc_va_list)
               __attribute__ ((__format__ (__printf__, 2, 0)));
int vfiscanf (FILE *, const char *, __gnuc_va_list)
               __attribute__ ((__format__ (__scanf__, 2, 0)));
int viprintf (const char *, __gnuc_va_list)
               __attribute__ ((__format__ (__printf__, 1, 0)));
int viscanf (const char *, __gnuc_va_list)
               __attribute__ ((__format__ (__scanf__, 1, 0)));
int vsiprintf (char *, const char *, __gnuc_va_list)
               __attribute__ ((__format__ (__printf__, 2, 0)));
int vsiscanf (const char *, const char *, __gnuc_va_list)
               __attribute__ ((__format__ (__scanf__, 2, 0)));
int vsniprintf (char *, size_t, const char *, __gnuc_va_list)
               __attribute__ ((__format__ (__printf__, 3, 0)));
# 345 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/stdio.h" 3
FILE * fdopen (int, const char *);

int fileno (FILE *);


int pclose (FILE *);
FILE * popen (const char *, const char *);



void setbuffer (FILE *, char *, int);
int setlinebuf (FILE *);



int getw (FILE *);
int putw (int, FILE *);


int getc_unlocked (FILE *);
int getchar_unlocked (void);
void flockfile (FILE *);
int ftrylockfile (FILE *);
void funlockfile (FILE *);
int putc_unlocked (int, FILE *);
int putchar_unlocked (int);
# 380 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/stdio.h" 3
int dprintf (int, const char *restrict, ...)
               __attribute__ ((__format__ (__printf__, 2, 3)));

FILE * fmemopen (void *restrict, size_t, const char *restrict);


FILE * open_memstream (char **, size_t *);
int vdprintf (int, const char *restrict, __gnuc_va_list)
               __attribute__ ((__format__ (__printf__, 2, 0)));



int renameat (int, const char *, int, const char *);
# 402 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/stdio.h" 3
int _asiprintf_r (struct _reent *, char **, const char *, ...)
               __attribute__ ((__format__ (__printf__, 3, 4)));
char * _asniprintf_r (struct _reent *, char *, size_t *, const char *, ...)
               __attribute__ ((__format__ (__printf__, 4, 5)));
char * _asnprintf_r (struct _reent *, char *restrict, size_t *restrict, const char *restrict, ...)
               __attribute__ ((__format__ (__printf__, 4, 5)));
int _asprintf_r (struct _reent *, char **restrict, const char *restrict, ...)
               __attribute__ ((__format__ (__printf__, 3, 4)));
int _diprintf_r (struct _reent *, int, const char *, ...)
               __attribute__ ((__format__ (__printf__, 3, 4)));
int _dprintf_r (struct _reent *, int, const char *restrict, ...)
               __attribute__ ((__format__ (__printf__, 3, 4)));
int _fclose_r (struct _reent *, FILE *);
int _fcloseall_r (struct _reent *);
FILE * _fdopen_r (struct _reent *, int, const char *);
int _fflush_r (struct _reent *, FILE *);
int _fgetc_r (struct _reent *, FILE *);
int _fgetc_unlocked_r (struct _reent *, FILE *);
char * _fgets_r (struct _reent *, char *restrict, int, FILE *restrict);
char * _fgets_unlocked_r (struct _reent *, char *restrict, int, FILE *restrict);




int _fgetpos_r (struct _reent *, FILE *, fpos_t *);
int _fsetpos_r (struct _reent *, FILE *, const fpos_t *);

int _fiprintf_r (struct _reent *, FILE *, const char *, ...)
               __attribute__ ((__format__ (__printf__, 3, 4)));
int _fiscanf_r (struct _reent *, FILE *, const char *, ...)
               __attribute__ ((__format__ (__scanf__, 3, 4)));
FILE * _fmemopen_r (struct _reent *, void *restrict, size_t, const char *restrict);
FILE * _fopen_r (struct _reent *, const char *restrict, const char *restrict);
FILE * _freopen_r (struct _reent *, const char *restrict, const char *restrict, FILE *restrict);
int _fprintf_r (struct _reent *, FILE *restrict, const char *restrict, ...)
               __attribute__ ((__format__ (__printf__, 3, 4)));
int _fpurge_r (struct _reent *, FILE *);
int _fputc_r (struct _reent *, int, FILE *);
int _fputc_unlocked_r (struct _reent *, int, FILE *);
int _fputs_r (struct _reent *, const char *restrict, FILE *restrict);
int _fputs_unlocked_r (struct _reent *, const char *restrict, FILE *restrict);
size_t _fread_r (struct _reent *, void *restrict, size_t _size, size_t _n, FILE *restrict);
size_t _fread_unlocked_r (struct _reent *, void *restrict, size_t _size, size_t _n, FILE *restrict);
int _fscanf_r (struct _reent *, FILE *restrict, const char *restrict, ...)
               __attribute__ ((__format__ (__scanf__, 3, 4)));
int _fseek_r (struct _reent *, FILE *, long, int);
int _fseeko_r (struct _reent *, FILE *, _off_t, int);
long _ftell_r (struct _reent *, FILE *);
_off_t _ftello_r (struct _reent *, FILE *);
void _rewind_r (struct _reent *, FILE *);
size_t _fwrite_r (struct _reent *, const void *restrict, size_t _size, size_t _n, FILE *restrict);
size_t _fwrite_unlocked_r (struct _reent *, const void *restrict, size_t _size, size_t _n, FILE *restrict);
int _getc_r (struct _reent *, FILE *);
int _getc_unlocked_r (struct _reent *, FILE *);
int _getchar_r (struct _reent *);
int _getchar_unlocked_r (struct _reent *);
char * _gets_r (struct _reent *, char *);
int _iprintf_r (struct _reent *, const char *, ...)
               __attribute__ ((__format__ (__printf__, 2, 3)));
int _iscanf_r (struct _reent *, const char *, ...)
               __attribute__ ((__format__ (__scanf__, 2, 3)));
FILE * _open_memstream_r (struct _reent *, char **, size_t *);
void _perror_r (struct _reent *, const char *);
int _printf_r (struct _reent *, const char *restrict, ...)
               __attribute__ ((__format__ (__printf__, 2, 3)));
int _putc_r (struct _reent *, int, FILE *);
int _putc_unlocked_r (struct _reent *, int, FILE *);
int _putchar_unlocked_r (struct _reent *, int);
int _putchar_r (struct _reent *, int);
int _puts_r (struct _reent *, const char *);
int _remove_r (struct _reent *, const char *);
int _rename_r (struct _reent *,
      const char *_old, const char *_new);
int _scanf_r (struct _reent *, const char *restrict, ...)
               __attribute__ ((__format__ (__scanf__, 2, 3)));
int _siprintf_r (struct _reent *, char *, const char *, ...)
               __attribute__ ((__format__ (__printf__, 3, 4)));
int _siscanf_r (struct _reent *, const char *, const char *, ...)
               __attribute__ ((__format__ (__scanf__, 3, 4)));
int _sniprintf_r (struct _reent *, char *, size_t, const char *, ...)
               __attribute__ ((__format__ (__printf__, 4, 5)));
int _snprintf_r (struct _reent *, char *restrict, size_t, const char *restrict, ...)
               __attribute__ ((__format__ (__printf__, 4, 5)));
int _sprintf_r (struct _reent *, char *restrict, const char *restrict, ...)
               __attribute__ ((__format__ (__printf__, 3, 4)));
int _sscanf_r (struct _reent *, const char *restrict, const char *restrict, ...)
               __attribute__ ((__format__ (__scanf__, 3, 4)));
char * _tempnam_r (struct _reent *, const char *, const char *);
FILE * _tmpfile_r (struct _reent *);
char * _tmpnam_r (struct _reent *, char *);
int _ungetc_r (struct _reent *, int, FILE *);
int _vasiprintf_r (struct _reent *, char **, const char *, __gnuc_va_list)
               __attribute__ ((__format__ (__printf__, 3, 0)));
char * _vasniprintf_r (struct _reent*, char *, size_t *, const char *, __gnuc_va_list)
               __attribute__ ((__format__ (__printf__, 4, 0)));
char * _vasnprintf_r (struct _reent*, char *, size_t *, const char *, __gnuc_va_list)
               __attribute__ ((__format__ (__printf__, 4, 0)));
int _vasprintf_r (struct _reent *, char **, const char *, __gnuc_va_list)
               __attribute__ ((__format__ (__printf__, 3, 0)));
int _vdiprintf_r (struct _reent *, int, const char *, __gnuc_va_list)
               __attribute__ ((__format__ (__printf__, 3, 0)));
int _vdprintf_r (struct _reent *, int, const char *restrict, __gnuc_va_list)
               __attribute__ ((__format__ (__printf__, 3, 0)));
int _vfiprintf_r (struct _reent *, FILE *, const char *, __gnuc_va_list)
               __attribute__ ((__format__ (__printf__, 3, 0)));
int _vfiscanf_r (struct _reent *, FILE *, const char *, __gnuc_va_list)
               __attribute__ ((__format__ (__scanf__, 3, 0)));
int _vfprintf_r (struct _reent *, FILE *restrict, const char *restrict, __gnuc_va_list)
               __attribute__ ((__format__ (__printf__, 3, 0)));
int _vfscanf_r (struct _reent *, FILE *restrict, const char *restrict, __gnuc_va_list)
               __attribute__ ((__format__ (__scanf__, 3, 0)));
int _viprintf_r (struct _reent *, const char *, __gnuc_va_list)
               __attribute__ ((__format__ (__printf__, 2, 0)));
int _viscanf_r (struct _reent *, const char *, __gnuc_va_list)
               __attribute__ ((__format__ (__scanf__, 2, 0)));
int _vprintf_r (struct _reent *, const char *restrict, __gnuc_va_list)
               __attribute__ ((__format__ (__printf__, 2, 0)));
int _vscanf_r (struct _reent *, const char *restrict, __gnuc_va_list)
               __attribute__ ((__format__ (__scanf__, 2, 0)));
int _vsiprintf_r (struct _reent *, char *, const char *, __gnuc_va_list)
               __attribute__ ((__format__ (__printf__, 3, 0)));
int _vsiscanf_r (struct _reent *, const char *, const char *, __gnuc_va_list)
               __attribute__ ((__format__ (__scanf__, 3, 0)));
int _vsniprintf_r (struct _reent *, char *, size_t, const char *, __gnuc_va_list)
               __attribute__ ((__format__ (__printf__, 4, 0)));
int _vsnprintf_r (struct _reent *, char *restrict, size_t, const char *restrict, __gnuc_va_list)
               __attribute__ ((__format__ (__printf__, 4, 0)));
int _vsprintf_r (struct _reent *, char *restrict, const char *restrict, __gnuc_va_list)
               __attribute__ ((__format__ (__printf__, 3, 0)));
int _vsscanf_r (struct _reent *, const char *restrict, const char *restrict, __gnuc_va_list)
               __attribute__ ((__format__ (__scanf__, 3, 0)));



int fpurge (FILE *);
ssize_t __getdelim (char **, size_t *, int, FILE *);
ssize_t __getline (char **, size_t *, FILE *);


void clearerr_unlocked (FILE *);
int feof_unlocked (FILE *);
int ferror_unlocked (FILE *);
int fileno_unlocked (FILE *);
int fflush_unlocked (FILE *);
int fgetc_unlocked (FILE *);
int fputc_unlocked (int, FILE *);
size_t fread_unlocked (void *restrict, size_t _size, size_t _n, FILE *restrict);
size_t fwrite_unlocked (const void *restrict , size_t _size, size_t _n, FILE *);
# 583 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/stdio.h" 3
int __srget_r (struct _reent *, FILE *);
int __swbuf_r (struct _reent *, int, FILE *);
# 607 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/stdio.h" 3
FILE *funopen (const void *__cookie,
  int (*__readfn)(void *__cookie, char *__buf,
    int __n),
  int (*__writefn)(void *__cookie, const char *__buf,
     int __n),
  fpos_t (*__seekfn)(void *__cookie, fpos_t __off, int __whence),
  int (*__closefn)(void *__cookie));
FILE *_funopen_r (struct _reent *, const void *__cookie,
  int (*__readfn)(void *__cookie, char *__buf,
    int __n),
  int (*__writefn)(void *__cookie, const char *__buf,
     int __n),
  fpos_t (*__seekfn)(void *__cookie, fpos_t __off, int __whence),
  int (*__closefn)(void *__cookie));
# 691 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/stdio.h" 3
static __inline__ int __sputc_r(struct _reent *_ptr, int _c, FILE *_p) {




 if (--_p->_w >= 0 || (_p->_w >= _p->_lbfsize && (char)_c != '\n'))
  return (*_p->_p++ = _c);
 else
  return (__swbuf_r(_ptr, _c, _p));
}
# 745 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/stdio.h" 3
static __inline int
_getchar_unlocked(void)
{
 struct _reent *_ptr;

 _ptr = _impure_ptr;
 return ((--(((_ptr)->_stdin))->_r < 0 ? __srget_r(_ptr, ((_ptr)->_stdin)) : (int)(*(((_ptr)->_stdin))->_p++)));
}

static __inline int
_putchar_unlocked(int _c)
{
 struct _reent *_ptr;

 _ptr = _impure_ptr;
 return (__sputc_r(_ptr, _c, ((_ptr)->_stdout)));
}
# 801 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/stdio.h" 3

# 59 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/platform.h" 2
# 440 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/platform.h"

# 440 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/platform.h"
typedef struct mbedtls_platform_context {
    char dummy;
}
mbedtls_platform_context;
# 464 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/platform.h"
int mbedtls_platform_setup(mbedtls_platform_context *ctx);
# 479 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/platform.h"
void mbedtls_platform_teardown(mbedtls_platform_context *ctx);
# 79 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c" 2

# 1 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp_internal_alt.h" 1
# 81 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c" 2







static unsigned long add_count, dbl_count;

static unsigned long mul_count;
# 104 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
static unsigned ecp_max_ops = 0;




void mbedtls_ecp_set_max_ops(unsigned max_ops)
{
    ecp_max_ops = max_ops;
}




int mbedtls_ecp_restart_is_enabled(void)
{
    return ecp_max_ops != 0;
}




struct mbedtls_ecp_restart_mul {
    mbedtls_ecp_point R;
    size_t i;
    mbedtls_ecp_point *T;
    unsigned char T_size;
    enum {
        ecp_rsm_init = 0,
        ecp_rsm_pre_dbl,
        ecp_rsm_pre_norm_dbl,
        ecp_rsm_pre_add,
        ecp_rsm_pre_norm_add,
        ecp_rsm_comb_core,
        ecp_rsm_final_norm,
    } state;
};




static void ecp_restart_rsm_init(mbedtls_ecp_restart_mul_ctx *ctx)
{
    mbedtls_ecp_point_init(&ctx->R);
    ctx->i = 0;
    ctx->T = 
# 148 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c" 3 4
            ((void *)0)
# 148 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
                ;
    ctx->T_size = 0;
    ctx->state = ecp_rsm_init;
}




static void ecp_restart_rsm_free(mbedtls_ecp_restart_mul_ctx *ctx)
{
    unsigned char i;

    if (ctx == 
# 160 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c" 3 4
              ((void *)0)
# 160 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
                  ) {
        return;
    }

    mbedtls_ecp_point_free(&ctx->R);

    if (ctx->T != 
# 166 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c" 3 4
                 ((void *)0)
# 166 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
                     ) {
        for (i = 0; i < ctx->T_size; i++) {
            mbedtls_ecp_point_free(ctx->T + i);
        }
        free(ctx->T);
    }

    ecp_restart_rsm_init(ctx);
}




struct mbedtls_ecp_restart_muladd {
    mbedtls_ecp_point mP;
    mbedtls_ecp_point R;
    enum {
        ecp_rsma_mul1 = 0,
        ecp_rsma_mul2,
        ecp_rsma_add,
        ecp_rsma_norm,
    } state;
};




static void ecp_restart_ma_init(mbedtls_ecp_restart_muladd_ctx *ctx)
{
    mbedtls_ecp_point_init(&ctx->mP);
    mbedtls_ecp_point_init(&ctx->R);
    ctx->state = ecp_rsma_mul1;
}




static void ecp_restart_ma_free(mbedtls_ecp_restart_muladd_ctx *ctx)
{
    if (ctx == 
# 205 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c" 3 4
              ((void *)0)
# 205 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
                  ) {
        return;
    }

    mbedtls_ecp_point_free(&ctx->mP);
    mbedtls_ecp_point_free(&ctx->R);

    ecp_restart_ma_init(ctx);
}




void mbedtls_ecp_restart_init(mbedtls_ecp_restart_ctx *ctx)
{
    ctx->ops_done = 0;
    ctx->depth = 0;
    ctx->rsm = 
# 222 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c" 3 4
              ((void *)0)
# 222 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
                  ;
    ctx->ma = 
# 223 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c" 3 4
             ((void *)0)
# 223 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
                 ;
}




void mbedtls_ecp_restart_free(mbedtls_ecp_restart_ctx *ctx)
{
    if (ctx == 
# 231 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c" 3 4
              ((void *)0)
# 231 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
                  ) {
        return;
    }

    ecp_restart_rsm_free(ctx->rsm);
    free(ctx->rsm);

    ecp_restart_ma_free(ctx->ma);
    free(ctx->ma);

    mbedtls_ecp_restart_init(ctx);
}




int mbedtls_ecp_check_budget(const mbedtls_ecp_group *grp,
                             mbedtls_ecp_restart_ctx *rs_ctx,
                             unsigned ops)
{
    if (rs_ctx != 
# 251 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c" 3 4
                 ((void *)0) 
# 251 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
                      && ecp_max_ops != 0) {


        if (grp->pbits >= 512) {
            ops *= 4;
        } else if (grp->pbits >= 384) {
            ops *= 2;
        }





        if ((rs_ctx->ops_done != 0) &&
            (rs_ctx->ops_done > ecp_max_ops ||
             ops > ecp_max_ops - rs_ctx->ops_done)) {
            return -0x4B00;
        }


        rs_ctx->ops_done += ops;
    }

    return 0;
}
# 318 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
static void mpi_init_many(mbedtls_mpi *arr, size_t size)
{
    while (size--) {
        mbedtls_mpi_init(arr++);
    }
}

static void mpi_free_many(mbedtls_mpi *arr, size_t size)
{
    while (size--) {
        mbedtls_mpi_free(arr++);
    }
}
# 345 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
static const mbedtls_ecp_curve_info ecp_supported_curves[] =
{

    { MBEDTLS_ECP_DP_SECP521R1, 25, 521, "secp521r1" },


    { MBEDTLS_ECP_DP_BP512R1, 28, 512, "brainpoolP512r1" },


    { MBEDTLS_ECP_DP_SECP384R1, 24, 384, "secp384r1" },


    { MBEDTLS_ECP_DP_BP384R1, 27, 384, "brainpoolP384r1" },


    { MBEDTLS_ECP_DP_SECP256R1, 23, 256, "secp256r1" },


    { MBEDTLS_ECP_DP_SECP256K1, 22, 256, "secp256k1" },


    { MBEDTLS_ECP_DP_BP256R1, 26, 256, "brainpoolP256r1" },


    { MBEDTLS_ECP_DP_SECP224R1, 21, 224, "secp224r1" },


    { MBEDTLS_ECP_DP_SECP224K1, 20, 224, "secp224k1" },


    { MBEDTLS_ECP_DP_SECP192R1, 19, 192, "secp192r1" },


    { MBEDTLS_ECP_DP_SECP192K1, 18, 192, "secp192k1" },


    { MBEDTLS_ECP_DP_CURVE25519, 29, 256, "x25519" },


    { MBEDTLS_ECP_DP_CURVE448, 30, 448, "x448" },

    { MBEDTLS_ECP_DP_NONE, 0, 0, 
# 386 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c" 3 4
                                                  ((void *)0) 
# 386 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
                                                                      },
};




static mbedtls_ecp_group_id ecp_supported_grp_id[sizeof(ecp_supported_curves) / sizeof(ecp_supported_curves[0])];




const mbedtls_ecp_curve_info *mbedtls_ecp_curve_list(void)
{
    return ecp_supported_curves;
}




const mbedtls_ecp_group_id *mbedtls_ecp_grp_id_list(void)
{
    static int init_done = 0;

    if (!init_done) {
        size_t i = 0;
        const mbedtls_ecp_curve_info *curve_info;

        for (curve_info = mbedtls_ecp_curve_list();
             curve_info->grp_id != MBEDTLS_ECP_DP_NONE;
             curve_info++) {
            ecp_supported_grp_id[i++] = curve_info->grp_id;
        }
        ecp_supported_grp_id[i] = MBEDTLS_ECP_DP_NONE;

        init_done = 1;
    }

    return ecp_supported_grp_id;
}




const mbedtls_ecp_curve_info *mbedtls_ecp_curve_info_from_grp_id(mbedtls_ecp_group_id grp_id)
{
    const mbedtls_ecp_curve_info *curve_info;

    for (curve_info = mbedtls_ecp_curve_list();
         curve_info->grp_id != MBEDTLS_ECP_DP_NONE;
         curve_info++) {
        if (curve_info->grp_id == grp_id) {
            return curve_info;
        }
    }

    return 
# 441 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c" 3 4
          ((void *)0)
# 441 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
              ;
}




const mbedtls_ecp_curve_info *mbedtls_ecp_curve_info_from_tls_id(uint16_t tls_id)
{
    const mbedtls_ecp_curve_info *curve_info;

    for (curve_info = mbedtls_ecp_curve_list();
         curve_info->grp_id != MBEDTLS_ECP_DP_NONE;
         curve_info++) {
        if (curve_info->tls_id == tls_id) {
            return curve_info;
        }
    }

    return 
# 459 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c" 3 4
          ((void *)0)
# 459 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
              ;
}




const mbedtls_ecp_curve_info *mbedtls_ecp_curve_info_from_name(const char *name)
{
    const mbedtls_ecp_curve_info *curve_info;

    if (name == 
# 469 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c" 3 4
               ((void *)0)
# 469 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
                   ) {
        return 
# 470 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c" 3 4
              ((void *)0)
# 470 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
                  ;
    }

    for (curve_info = mbedtls_ecp_curve_list();
         curve_info->grp_id != MBEDTLS_ECP_DP_NONE;
         curve_info++) {
        if (strcmp(curve_info->name, name) == 0) {
            return curve_info;
        }
    }

    return 
# 481 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c" 3 4
          ((void *)0)
# 481 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
              ;
}




mbedtls_ecp_curve_type mbedtls_ecp_get_type(const mbedtls_ecp_group *grp)
{
    if (grp->G.X.p == 
# 489 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c" 3 4
                     ((void *)0)
# 489 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
                         ) {
        return MBEDTLS_ECP_TYPE_NONE;
    }

    if (grp->G.Y.p == 
# 493 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c" 3 4
                     ((void *)0)
# 493 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
                         ) {
        return MBEDTLS_ECP_TYPE_MONTGOMERY;
    } else {
        return MBEDTLS_ECP_TYPE_SHORT_WEIERSTRASS;
    }
}




void mbedtls_ecp_point_init(mbedtls_ecp_point *pt)
{
    mbedtls_mpi_init(&pt->X);
    mbedtls_mpi_init(&pt->Y);
    mbedtls_mpi_init(&pt->Z);
}




void mbedtls_ecp_group_init(mbedtls_ecp_group *grp)
{
    grp->id = MBEDTLS_ECP_DP_NONE;
    mbedtls_mpi_init(&grp->P);
    mbedtls_mpi_init(&grp->A);
    mbedtls_mpi_init(&grp->B);
    mbedtls_ecp_point_init(&grp->G);
    mbedtls_mpi_init(&grp->N);
    grp->pbits = 0;
    grp->nbits = 0;
    grp->h = 0;
    grp->modp = 
# 524 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c" 3 4
               ((void *)0)
# 524 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
                   ;
    grp->t_pre = 
# 525 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c" 3 4
                ((void *)0)
# 525 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
                    ;
    grp->t_post = 
# 526 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c" 3 4
                 ((void *)0)
# 526 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
                     ;
    grp->t_data = 
# 527 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c" 3 4
                 ((void *)0)
# 527 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
                     ;
    grp->T = 
# 528 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c" 3 4
            ((void *)0)
# 528 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
                ;
    grp->T_size = 0;
}




void mbedtls_ecp_keypair_init(mbedtls_ecp_keypair *key)
{
    mbedtls_ecp_group_init(&key->grp);
    mbedtls_mpi_init(&key->d);
    mbedtls_ecp_point_init(&key->Q);
}




void mbedtls_ecp_point_free(mbedtls_ecp_point *pt)
{
    if (pt == 
# 547 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c" 3 4
             ((void *)0)
# 547 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
                 ) {
        return;
    }

    mbedtls_mpi_free(&(pt->X));
    mbedtls_mpi_free(&(pt->Y));
    mbedtls_mpi_free(&(pt->Z));
}




static int ecp_group_is_static_comb_table(const mbedtls_ecp_group *grp)
{

    return grp->T != 
# 562 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c" 3 4
                    ((void *)0) 
# 562 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
                         && grp->T_size == 0;




}




void mbedtls_ecp_group_free(mbedtls_ecp_group *grp)
{
    size_t i;

    if (grp == 
# 576 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c" 3 4
              ((void *)0)
# 576 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
                  ) {
        return;
    }

    if (grp->h != 1) {
        mbedtls_mpi_free(&grp->A);
        mbedtls_mpi_free(&grp->B);
        mbedtls_ecp_point_free(&grp->G);


        mbedtls_mpi_free(&grp->N);
        mbedtls_mpi_free(&grp->P);

    }

    if (!ecp_group_is_static_comb_table(grp) && grp->T != 
# 591 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c" 3 4
                                                         ((void *)0)
# 591 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
                                                             ) {
        for (i = 0; i < grp->T_size; i++) {
            mbedtls_ecp_point_free(&grp->T[i]);
        }
        free(grp->T);
    }

    mbedtls_platform_zeroize(grp, sizeof(mbedtls_ecp_group));
}




void mbedtls_ecp_keypair_free(mbedtls_ecp_keypair *key)
{
    if (key == 
# 606 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c" 3 4
              ((void *)0)
# 606 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
                  ) {
        return;
    }

    mbedtls_ecp_group_free(&key->grp);
    mbedtls_mpi_free(&key->d);
    mbedtls_ecp_point_free(&key->Q);
}




int mbedtls_ecp_copy(mbedtls_ecp_point *P, const mbedtls_ecp_point *Q)
{
    int ret = -0x006E;
    do { if ((ret = (mbedtls_mpi_copy(&P->X, &Q->X))) != 0) goto cleanup; } while (0);
    do { if ((ret = (mbedtls_mpi_copy(&P->Y, &Q->Y))) != 0) goto cleanup; } while (0);
    do { if ((ret = (mbedtls_mpi_copy(&P->Z, &Q->Z))) != 0) goto cleanup; } while (0);

cleanup:
    return ret;
}




int mbedtls_ecp_group_copy(mbedtls_ecp_group *dst, const mbedtls_ecp_group *src)
{
    return mbedtls_ecp_group_load(dst, src->id);
}




int mbedtls_ecp_set_zero(mbedtls_ecp_point *pt)
{
    int ret = -0x006E;
    do { if ((ret = (mbedtls_mpi_lset(&pt->X, 1))) != 0) goto cleanup; } while (0);
    do { if ((ret = (mbedtls_mpi_lset(&pt->Y, 1))) != 0) goto cleanup; } while (0);
    do { if ((ret = (mbedtls_mpi_lset(&pt->Z, 0))) != 0) goto cleanup; } while (0);

cleanup:
    return ret;
}




int mbedtls_ecp_is_zero(mbedtls_ecp_point *pt)
{
    return mbedtls_mpi_cmp_int(&pt->Z, 0) == 0;
}




int mbedtls_ecp_point_cmp(const mbedtls_ecp_point *P,
                          const mbedtls_ecp_point *Q)
{
    if (mbedtls_mpi_cmp_mpi(&P->X, &Q->X) == 0 &&
        mbedtls_mpi_cmp_mpi(&P->Y, &Q->Y) == 0 &&
        mbedtls_mpi_cmp_mpi(&P->Z, &Q->Z) == 0) {
        return 0;
    }

    return -0x4F80;
}




int mbedtls_ecp_point_read_string(mbedtls_ecp_point *P, int radix,
                                  const char *x, const char *y)
{
    int ret = -0x006E;
    do { if ((ret = (mbedtls_mpi_read_string(&P->X, radix, x))) != 0) goto cleanup; } while (0);
    do { if ((ret = (mbedtls_mpi_read_string(&P->Y, radix, y))) != 0) goto cleanup; } while (0);
    do { if ((ret = (mbedtls_mpi_lset(&P->Z, 1))) != 0) goto cleanup; } while (0);

cleanup:
    return ret;
}




int mbedtls_ecp_point_write_binary(const mbedtls_ecp_group *grp,
                                   const mbedtls_ecp_point *P,
                                   int format, size_t *olen,
                                   unsigned char *buf, size_t buflen)
{
    int ret = -0x4E80;
    size_t plen;
    if (format != 0 &&
        format != 1) {
        return -0x4F80;
    }

    plen = mbedtls_mpi_size(&grp->P);


    (void) format;
    if (mbedtls_ecp_get_type(grp) == MBEDTLS_ECP_TYPE_MONTGOMERY) {
        *olen = plen;
        if (buflen < *olen) {
            return -0x4F00;
        }

        do { if ((ret = (mbedtls_mpi_write_binary_le(&P->X, buf, plen))) != 0) goto cleanup; } while (0);
    }


    if (mbedtls_ecp_get_type(grp) == MBEDTLS_ECP_TYPE_SHORT_WEIERSTRASS) {



        if (mbedtls_mpi_cmp_int(&P->Z, 0) == 0) {
            if (buflen < 1) {
                return -0x4F00;
            }

            buf[0] = 0x00;
            *olen = 1;

            return 0;
        }

        if (format == 0) {
            *olen = 2 * plen + 1;

            if (buflen < *olen) {
                return -0x4F00;
            }

            buf[0] = 0x04;
            do { if ((ret = (mbedtls_mpi_write_binary(&P->X, buf + 1, plen))) != 0) goto cleanup; } while (0);
            do { if ((ret = (mbedtls_mpi_write_binary(&P->Y, buf + 1 + plen, plen))) != 0) goto cleanup; } while (0);
        } else if (format == 1) {
            *olen = plen + 1;

            if (buflen < *olen) {
                return -0x4F00;
            }

            buf[0] = 0x02 + mbedtls_mpi_get_bit(&P->Y, 0);
            do { if ((ret = (mbedtls_mpi_write_binary(&P->X, buf + 1, plen))) != 0) goto cleanup; } while (0);
        }
    }


cleanup:
    return ret;
}


static int mbedtls_ecp_sw_derive_y(const mbedtls_ecp_group *grp,
                                   const mbedtls_mpi *X,
                                   mbedtls_mpi *Y,
                                   int parity_bit);





int mbedtls_ecp_point_read_binary(const mbedtls_ecp_group *grp,
                                  mbedtls_ecp_point *pt,
                                  const unsigned char *buf, size_t ilen)
{
    int ret = -0x4E80;
    size_t plen;
    if (ilen < 1) {
        return -0x4F80;
    }

    plen = mbedtls_mpi_size(&grp->P);


    if (mbedtls_ecp_get_type(grp) == MBEDTLS_ECP_TYPE_MONTGOMERY) {
        if (plen != ilen) {
            return -0x4F80;
        }

        do { if ((ret = (mbedtls_mpi_read_binary_le(&pt->X, buf, plen))) != 0) goto cleanup; } while (0);
        mbedtls_mpi_free(&pt->Y);

        if (grp->id == MBEDTLS_ECP_DP_CURVE25519) {

            do { if ((ret = (mbedtls_mpi_set_bit(&pt->X, plen * 8 - 1, 0))) != 0) goto cleanup; } while (0);
        }

        do { if ((ret = (mbedtls_mpi_lset(&pt->Z, 1))) != 0) goto cleanup; } while (0);
    }


    if (mbedtls_ecp_get_type(grp) == MBEDTLS_ECP_TYPE_SHORT_WEIERSTRASS) {
        if (buf[0] == 0x00) {
            if (ilen == 1) {
                return mbedtls_ecp_set_zero(pt);
            } else {
                return -0x4F80;
            }
        }

        if (ilen < 1 + plen) {
            return -0x4F80;
        }

        do { if ((ret = (mbedtls_mpi_read_binary(&pt->X, buf + 1, plen))) != 0) goto cleanup; } while (0);
        do { if ((ret = (mbedtls_mpi_lset(&pt->Z, 1))) != 0) goto cleanup; } while (0);

        if (buf[0] == 0x04) {

            if (ilen != 1 + plen * 2) {
                return -0x4F80;
            }
            return mbedtls_mpi_read_binary(&pt->Y, buf + 1 + plen, plen);
        } else if (buf[0] == 0x02 || buf[0] == 0x03) {

            if (ilen != 1 + plen) {
                return -0x4F80;
            }
            return mbedtls_ecp_sw_derive_y(grp, &pt->X, &pt->Y,
                                           (buf[0] & 1));
        } else {
            return -0x4F80;
        }
    }


cleanup:
    return ret;
}







int mbedtls_ecp_tls_read_point(const mbedtls_ecp_group *grp,
                               mbedtls_ecp_point *pt,
                               const unsigned char **buf, size_t buf_len)
{
    unsigned char data_len;
    const unsigned char *buf_start;



    if (buf_len < 2) {
        return -0x4F80;
    }

    data_len = *(*buf)++;
    if (data_len < 1 || data_len > buf_len - 1) {
        return -0x4F80;
    }




    buf_start = *buf;
    *buf += data_len;

    return mbedtls_ecp_point_read_binary(grp, pt, buf_start, data_len);
}







int mbedtls_ecp_tls_write_point(const mbedtls_ecp_group *grp, const mbedtls_ecp_point *pt,
                                int format, size_t *olen,
                                unsigned char *buf, size_t blen)
{
    int ret = -0x006E;
    if (format != 0 &&
        format != 1) {
        return -0x4F80;
    }




    if (blen < 1) {
        return -0x4F80;
    }

    if ((ret = mbedtls_ecp_point_write_binary(grp, pt, format,
                                              olen, buf + 1, blen - 1)) != 0) {
        return ret;
    }




    buf[0] = (unsigned char) *olen;
    ++*olen;

    return 0;
}




int mbedtls_ecp_tls_read_group(mbedtls_ecp_group *grp,
                               const unsigned char **buf, size_t len)
{
    int ret = -0x006E;
    mbedtls_ecp_group_id grp_id;
    if ((ret = mbedtls_ecp_tls_read_group_id(&grp_id, buf, len)) != 0) {
        return ret;
    }

    return mbedtls_ecp_group_load(grp, grp_id);
}





int mbedtls_ecp_tls_read_group_id(mbedtls_ecp_group_id *grp,
                                  const unsigned char **buf, size_t len)
{
    uint16_t tls_id;
    const mbedtls_ecp_curve_info *curve_info;



    if (len < 3) {
        return -0x4F80;
    }




    if (*(*buf)++ != 3) {
        return -0x4F80;
    }




    tls_id = ((0) ? mbedtls_get_unaligned_uint16((*buf) + (0)) : __builtin_bswap16(mbedtls_get_unaligned_uint16((*buf) + (0))) );
    *buf += 2;

    if ((curve_info = mbedtls_ecp_curve_info_from_tls_id(tls_id)) == 
# 953 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c" 3 4
                                                                    ((void *)0)
# 953 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
                                                                        ) {
        return -0x4E80;
    }

    *grp = curve_info->grp_id;

    return 0;
}




int mbedtls_ecp_tls_write_group(const mbedtls_ecp_group *grp, size_t *olen,
                                unsigned char *buf, size_t blen)
{
    const mbedtls_ecp_curve_info *curve_info;
    if ((curve_info = mbedtls_ecp_curve_info_from_grp_id(grp->id)) == 
# 969 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c" 3 4
                                                                     ((void *)0)
# 969 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
                                                                         ) {
        return -0x4F80;
    }




    *olen = 3;
    if (blen < *olen) {
        return -0x4F00;
    }




    *buf++ = 3;




    { if (0) { mbedtls_put_unaligned_uint16((buf) + (0), (uint16_t) (curve_info->tls_id)); } else { mbedtls_put_unaligned_uint16((buf) + (0), __builtin_bswap16((uint16_t) (curve_info->tls_id))); } };

    return 0;
}







static int ecp_modp(mbedtls_mpi *N, const mbedtls_ecp_group *grp)
{
    int ret = -0x006E;

    if (grp->modp == 
# 1004 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c" 3 4
                    ((void *)0)
# 1004 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
                        ) {
        return mbedtls_mpi_mod_mpi(N, N, &grp->P);
    }


    if ((N->s < 0 && mbedtls_mpi_cmp_int(N, 0) != 0) ||
        mbedtls_mpi_bitlen(N) > 2 * grp->pbits) {
        return -0x4F80;
    }

    do { if ((ret = (grp->modp(N))) != 0) goto cleanup; } while (0);


    while (N->s < 0 && mbedtls_mpi_cmp_int(N, 0) != 0) {
        do { if ((ret = (mbedtls_mpi_add_mpi(N, N, &grp->P))) != 0) goto cleanup; } while (0);
    }

    while (mbedtls_mpi_cmp_mpi(N, &grp->P) >= 0) {

        do { if ((ret = (mbedtls_mpi_sub_abs(N, N, &grp->P))) != 0) goto cleanup; } while (0);
    }

cleanup:
    return ret;
}
# 1056 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
static inline int mbedtls_mpi_mul_mod(const mbedtls_ecp_group *grp,
                                      mbedtls_mpi *X,
                                      const mbedtls_mpi *A,
                                      const mbedtls_mpi *B)
{
    int ret = -0x006E;
    do { if ((ret = (mbedtls_mpi_mul_mpi(X, A, B))) != 0) goto cleanup; } while (0);
    do { do { if ((ret = (ecp_modp(&(*X), grp))) != 0) goto cleanup; } while (0); mul_count++; } while (0);
cleanup:
    return ret;
}
# 1078 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
__attribute__((unused))
static inline int mbedtls_mpi_sub_mod(const mbedtls_ecp_group *grp,
                                      mbedtls_mpi *X,
                                      const mbedtls_mpi *A,
                                      const mbedtls_mpi *B)
{
    int ret = -0x006E;
    do { if ((ret = (mbedtls_mpi_sub_mpi(X, A, B))) != 0) goto cleanup; } while (0);
    do { while ((X)->s < 0 && mbedtls_mpi_cmp_int((X), 0) != 0) do { if ((ret = (mbedtls_mpi_add_mpi((X), (X), &grp->P))) != 0) goto cleanup; } while (0); } while (0);
cleanup:
    return ret;
}
# 1100 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
static inline int mbedtls_mpi_add_mod(const mbedtls_ecp_group *grp,
                                      mbedtls_mpi *X,
                                      const mbedtls_mpi *A,
                                      const mbedtls_mpi *B)
{
    int ret = -0x006E;
    do { if ((ret = (mbedtls_mpi_add_mpi(X, A, B))) != 0) goto cleanup; } while (0);
    while (mbedtls_mpi_cmp_mpi((X), &grp->P) >= 0) do { if ((ret = (mbedtls_mpi_sub_abs((X), (X), &grp->P))) != 0) goto cleanup; } while (0);
cleanup:
    return ret;
}

__attribute__((unused))
static inline int mbedtls_mpi_mul_int_mod(const mbedtls_ecp_group *grp,
                                          mbedtls_mpi *X,
                                          const mbedtls_mpi *A,
                                          mbedtls_mpi_uint c)
{
    int ret = -0x006E;

    do { if ((ret = (mbedtls_mpi_mul_int(X, A, c))) != 0) goto cleanup; } while (0);
    while (mbedtls_mpi_cmp_mpi((X), &grp->P) >= 0) do { if ((ret = (mbedtls_mpi_sub_abs((X), (X), &grp->P))) != 0) goto cleanup; } while (0);
cleanup:
    return ret;
}

__attribute__((unused))
static inline int mbedtls_mpi_sub_int_mod(const mbedtls_ecp_group *grp,
                                          mbedtls_mpi *X,
                                          const mbedtls_mpi *A,
                                          mbedtls_mpi_uint c)
{
    int ret = -0x006E;

    do { if ((ret = (mbedtls_mpi_sub_int(X, A, c))) != 0) goto cleanup; } while (0);
    do { while ((X)->s < 0 && mbedtls_mpi_cmp_int((X), 0) != 0) do { if ((ret = (mbedtls_mpi_add_mpi((X), (X), &grp->P))) != 0) goto cleanup; } while (0); } while (0);
cleanup:
    return ret;
}




__attribute__((unused))
static inline int mbedtls_mpi_shift_l_mod(const mbedtls_ecp_group *grp,
                                          mbedtls_mpi *X,
                                          size_t count)
{
    int ret = -0x006E;
    do { if ((ret = (mbedtls_mpi_shift_l(X, count))) != 0) goto cleanup; } while (0);
    while (mbedtls_mpi_cmp_mpi((X), &grp->P) >= 0) do { if ((ret = (mbedtls_mpi_sub_abs((X), (X), &grp->P))) != 0) goto cleanup; } while (0);
cleanup:
    return ret;
}
# 1226 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
static int ecp_sw_rhs(const mbedtls_ecp_group *grp,
                      mbedtls_mpi *rhs,
                      const mbedtls_mpi *X)
{
    int ret;


    do { if ((ret = (mbedtls_mpi_mul_mod(grp, rhs, X, X))) != 0) goto cleanup; } while (0);


    if (mbedtls_ecp_group_a_is_minus_3(grp)) {
        do { if ((ret = (mbedtls_mpi_sub_int_mod(grp, rhs, rhs, 3))) != 0) goto cleanup; } while (0);
    } else {
        do { if ((ret = (mbedtls_mpi_add_mod(grp, rhs, rhs, &grp->A))) != 0) goto cleanup; } while (0);
    }

    do { if ((ret = (mbedtls_mpi_mul_mod(grp, rhs, rhs, X))) != 0) goto cleanup; } while (0);
    do { if ((ret = (mbedtls_mpi_add_mod(grp, rhs, rhs, &grp->B))) != 0) goto cleanup; } while (0);

cleanup:
    return ret;
}




static int mbedtls_ecp_sw_derive_y(const mbedtls_ecp_group *grp,
                                   const mbedtls_mpi *X,
                                   mbedtls_mpi *Y,
                                   int parity_bit)
{
# 1266 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
    if (mbedtls_mpi_get_bit(&grp->P, 0) != 1 ||
        mbedtls_mpi_get_bit(&grp->P, 1) != 1) {
        return -0x4E80;
    }

    int ret;
    mbedtls_mpi exp;
    mbedtls_mpi_init(&exp);


    do { if ((ret = (ecp_sw_rhs(grp, Y, X))) != 0) goto cleanup; } while (0);



    do { if ((ret = (mbedtls_mpi_add_int(&exp, &grp->P, 1))) != 0) goto cleanup; } while (0);
    do { if ((ret = (mbedtls_mpi_shift_r(&exp, 2))) != 0) goto cleanup; } while (0);

    do { if ((ret = (mbedtls_mpi_exp_mod(Y, Y , &exp, &grp->P, 
# 1283 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c" 3 4
   ((void *)0)
# 1283 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
   ))) != 0) goto cleanup; } while (0);






    if (mbedtls_mpi_get_bit(Y, 0) != parity_bit) {
        do { if ((ret = (mbedtls_mpi_sub_mpi(Y, &grp->P, Y))) != 0) goto cleanup; } while (0);
    }

cleanup:

    mbedtls_mpi_free(&exp);
    return ret;
}
# 1315 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
static int ecp_normalize_jac(const mbedtls_ecp_group *grp, mbedtls_ecp_point *pt)
{
    if (mbedtls_mpi_cmp_int(&pt->Z, 0) == 0) {
        return 0;
    }
# 1330 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
    int ret = -0x006E;
    mbedtls_mpi T;
    mbedtls_mpi_init(&T);

    do { if ((ret = (mbedtls_mpi_gcd_modinv_odd(
# 1334 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c" 3 4
   ((void *)0)
# 1334 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
   , (&T), (&pt->Z), &grp->P))) != 0) goto cleanup; } while (0);
    do { if ((ret = (mbedtls_mpi_mul_mod(grp, &pt->Y, &pt->Y, &T))) != 0) goto cleanup; } while (0);
    do { if ((ret = (mbedtls_mpi_mul_mod(grp, &T, &T, &T))) != 0) goto cleanup; } while (0);
    do { if ((ret = (mbedtls_mpi_mul_mod(grp, &pt->X, &pt->X, &T))) != 0) goto cleanup; } while (0);
    do { if ((ret = (mbedtls_mpi_mul_mod(grp, &pt->Y, &pt->Y, &T))) != 0) goto cleanup; } while (0);

    do { if ((ret = (mbedtls_mpi_lset(&pt->Z, 1))) != 0) goto cleanup; } while (0);

cleanup:

    mbedtls_mpi_free(&T);

    return ret;

}
# 1361 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
static int ecp_normalize_jac_many(const mbedtls_ecp_group *grp,
                                  mbedtls_ecp_point *T[], size_t T_size)
{
    if (T_size < 2) {
        return ecp_normalize_jac(grp, *T);
    }
# 1377 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
    int ret = -0x006E;
    size_t i;
    mbedtls_mpi *c, t;

    if ((c = calloc(T_size, sizeof(mbedtls_mpi))) == 
# 1381 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c" 3 4
                                                            ((void *)0)
# 1381 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
                                                                ) {
        return -0x4D80;
    }

    mbedtls_mpi_init(&t);

    mpi_init_many(c, T_size);



    do { if ((ret = (mbedtls_mpi_copy(&c[0], &T[0]->Z))) != 0) goto cleanup; } while (0);
    for (i = 1; i < T_size; i++) {
        do { if ((ret = (mbedtls_mpi_mul_mod(grp, &c[i], &c[i-1], &T[i]->Z))) != 0) goto cleanup; } while (0);
    }




    do { if ((ret = (mbedtls_mpi_gcd_modinv_odd(
# 1399 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c" 3 4
   ((void *)0)
# 1399 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
   , (&c[T_size-1]), (&c[T_size-1]), &grp->P))) != 0) goto cleanup; } while (0);

    for (i = T_size - 1;; i--) {
# 1414 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
        if (i > 0) {

            do { if ((ret = (mbedtls_mpi_mul_mod(grp, &t, &c[i], &c[i-1]))) != 0) goto cleanup; } while (0);
            do { if ((ret = (mbedtls_mpi_mul_mod(grp, &c[i-1], &c[i], &T[i]->Z))) != 0) goto cleanup; } while (0);
        } else {
            do { if ((ret = (mbedtls_mpi_copy(&t, &c[0]))) != 0) goto cleanup; } while (0);
        }


        do { if ((ret = (mbedtls_mpi_mul_mod(grp, &T[i]->Y, &T[i]->Y, &t))) != 0) goto cleanup; } while (0);
        do { if ((ret = (mbedtls_mpi_mul_mod(grp, &t, &t, &t))) != 0) goto cleanup; } while (0);
        do { if ((ret = (mbedtls_mpi_mul_mod(grp, &T[i]->X, &T[i]->X, &t))) != 0) goto cleanup; } while (0);
        do { if ((ret = (mbedtls_mpi_mul_mod(grp, &T[i]->Y, &T[i]->Y, &t))) != 0) goto cleanup; } while (0);







        do { if ((ret = (mbedtls_mpi_shrink(&T[i]->X, grp->P.n))) != 0) goto cleanup; } while (0);
        do { if ((ret = (mbedtls_mpi_shrink(&T[i]->Y, grp->P.n))) != 0) goto cleanup; } while (0);

        do { if ((ret = (mbedtls_mpi_lset(&T[i]->Z, 1))) != 0) goto cleanup; } while (0);

        if (i == 0) {
            break;
        }
    }

cleanup:

    mbedtls_mpi_free(&t);
    mpi_free_many(c, T_size);
    free(c);

    return ret;

}





static int ecp_safe_invert_jac(const mbedtls_ecp_group *grp,
                               mbedtls_ecp_point *Q,
                               unsigned char inv)
{
    int ret = -0x006E;
    mbedtls_mpi tmp;
    mbedtls_mpi_init(&tmp);

    do { unsigned char nonzero = mbedtls_mpi_cmp_int((&Q->Y), 0) != 0; do { if ((ret = (mbedtls_mpi_sub_mpi(&tmp, &grp->P, (&Q->Y)))) != 0) goto cleanup; } while (0); do { if ((ret = (mbedtls_mpi_safe_cond_assign((&Q->Y), &tmp, nonzero & inv))) != 0) goto cleanup; } while (0); } while (0);

cleanup:
    mbedtls_mpi_free(&tmp);
    return ret;
}
# 1487 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
static int ecp_double_jac(const mbedtls_ecp_group *grp, mbedtls_ecp_point *R,
                          const mbedtls_ecp_point *P,
                          mbedtls_mpi tmp[4])
{

    dbl_count++;
# 1504 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
    int ret = -0x006E;


    if (mbedtls_ecp_group_a_is_minus_3(grp)) {

        do { if ((ret = (mbedtls_mpi_mul_mod(grp, &tmp[1], &P->Z, &P->Z))) != 0) goto cleanup; } while (0);
        do { if ((ret = (mbedtls_mpi_add_mod(grp, &tmp[2], &P->X, &tmp[1]))) != 0) goto cleanup; } while (0);
        do { if ((ret = (mbedtls_mpi_sub_mod(grp, &tmp[3], &P->X, &tmp[1]))) != 0) goto cleanup; } while (0);
        do { if ((ret = (mbedtls_mpi_mul_mod(grp, &tmp[1], &tmp[2], &tmp[3]))) != 0) goto cleanup; } while (0);
        do { if ((ret = (mbedtls_mpi_mul_int_mod(grp, &tmp[0], &tmp[1], 3))) != 0) goto cleanup; } while (0);
    } else {

        do { if ((ret = (mbedtls_mpi_mul_mod(grp, &tmp[1], &P->X, &P->X))) != 0) goto cleanup; } while (0);
        do { if ((ret = (mbedtls_mpi_mul_int_mod(grp, &tmp[0], &tmp[1], 3))) != 0) goto cleanup; } while (0);


        if (mbedtls_mpi_cmp_int(&grp->A, 0) != 0) {

            do { if ((ret = (mbedtls_mpi_mul_mod(grp, &tmp[1], &P->Z, &P->Z))) != 0) goto cleanup; } while (0);
            do { if ((ret = (mbedtls_mpi_mul_mod(grp, &tmp[2], &tmp[1], &tmp[1]))) != 0) goto cleanup; } while (0);
            do { if ((ret = (mbedtls_mpi_mul_mod(grp, &tmp[1], &tmp[2], &grp->A))) != 0) goto cleanup; } while (0);
            do { if ((ret = (mbedtls_mpi_add_mod(grp, &tmp[0], &tmp[0], &tmp[1]))) != 0) goto cleanup; } while (0);
        }
    }


    do { if ((ret = (mbedtls_mpi_mul_mod(grp, &tmp[2], &P->Y, &P->Y))) != 0) goto cleanup; } while (0);
    do { if ((ret = (mbedtls_mpi_shift_l_mod(grp, &tmp[2], 1))) != 0) goto cleanup; } while (0);
    do { if ((ret = (mbedtls_mpi_mul_mod(grp, &tmp[1], &P->X, &tmp[2]))) != 0) goto cleanup; } while (0);
    do { if ((ret = (mbedtls_mpi_shift_l_mod(grp, &tmp[1], 1))) != 0) goto cleanup; } while (0);


    do { if ((ret = (mbedtls_mpi_mul_mod(grp, &tmp[3], &tmp[2], &tmp[2]))) != 0) goto cleanup; } while (0);
    do { if ((ret = (mbedtls_mpi_shift_l_mod(grp, &tmp[3], 1))) != 0) goto cleanup; } while (0);


    do { if ((ret = (mbedtls_mpi_mul_mod(grp, &tmp[2], &tmp[0], &tmp[0]))) != 0) goto cleanup; } while (0);
    do { if ((ret = (mbedtls_mpi_sub_mod(grp, &tmp[2], &tmp[2], &tmp[1]))) != 0) goto cleanup; } while (0);
    do { if ((ret = (mbedtls_mpi_sub_mod(grp, &tmp[2], &tmp[2], &tmp[1]))) != 0) goto cleanup; } while (0);


    do { if ((ret = (mbedtls_mpi_sub_mod(grp, &tmp[1], &tmp[1], &tmp[2]))) != 0) goto cleanup; } while (0);
    do { if ((ret = (mbedtls_mpi_mul_mod(grp, &tmp[1], &tmp[1], &tmp[0]))) != 0) goto cleanup; } while (0);
    do { if ((ret = (mbedtls_mpi_sub_mod(grp, &tmp[1], &tmp[1], &tmp[3]))) != 0) goto cleanup; } while (0);


    do { if ((ret = (mbedtls_mpi_mul_mod(grp, &tmp[3], &P->Y, &P->Z))) != 0) goto cleanup; } while (0);
    do { if ((ret = (mbedtls_mpi_shift_l_mod(grp, &tmp[3], 1))) != 0) goto cleanup; } while (0);


    do { if ((ret = (mbedtls_mpi_copy(&R->X, &tmp[2]))) != 0) goto cleanup; } while (0);
    do { if ((ret = (mbedtls_mpi_copy(&R->Y, &tmp[1]))) != 0) goto cleanup; } while (0);
    do { if ((ret = (mbedtls_mpi_copy(&R->Z, &tmp[3]))) != 0) goto cleanup; } while (0);

cleanup:

    return ret;

}
# 1584 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
static int ecp_add_mixed(const mbedtls_ecp_group *grp, mbedtls_ecp_point *R,
                         const mbedtls_ecp_point *P, const mbedtls_ecp_point *Q,
                         mbedtls_mpi tmp[4])
{

    add_count++;
# 1601 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
    int ret = -0x006E;




    mbedtls_mpi * const X = &R->X;
    mbedtls_mpi * const Y = &R->Y;
    mbedtls_mpi * const Z = &R->Z;

    if (!((&Q->Z)->p != 
# 1610 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c" 3 4
        ((void *)0)
# 1610 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
        )) {
        return -0x4F80;
    }




    if (mbedtls_mpi_cmp_int(&P->Z, 0) == 0) {
        return mbedtls_ecp_copy(R, Q);
    }

    if (mbedtls_mpi_cmp_int(&Q->Z, 0) == 0) {
        return mbedtls_ecp_copy(R, P);
    }




    if (mbedtls_mpi_cmp_int(&Q->Z, 1) != 0) {
        return -0x4F80;
    }

    do { if ((ret = (mbedtls_mpi_mul_mod(grp, &tmp[0], &P->Z, &P->Z))) != 0) goto cleanup; } while (0);
    do { if ((ret = (mbedtls_mpi_mul_mod(grp, &tmp[1], &tmp[0], &P->Z))) != 0) goto cleanup; } while (0);
    do { if ((ret = (mbedtls_mpi_mul_mod(grp, &tmp[0], &tmp[0], &Q->X))) != 0) goto cleanup; } while (0);
    do { if ((ret = (mbedtls_mpi_mul_mod(grp, &tmp[1], &tmp[1], &Q->Y))) != 0) goto cleanup; } while (0);
    do { if ((ret = (mbedtls_mpi_sub_mod(grp, &tmp[0], &tmp[0], &P->X))) != 0) goto cleanup; } while (0);
    do { if ((ret = (mbedtls_mpi_sub_mod(grp, &tmp[1], &tmp[1], &P->Y))) != 0) goto cleanup; } while (0);


    if (mbedtls_mpi_cmp_int(&tmp[0], 0) == 0) {
        if (mbedtls_mpi_cmp_int(&tmp[1], 0) == 0) {
            ret = ecp_double_jac(grp, R, P, tmp);
            goto cleanup;
        } else {
            ret = mbedtls_ecp_set_zero(R);
            goto cleanup;
        }
    }


    do { if ((ret = (mbedtls_mpi_mul_mod(grp, Z, &P->Z, &tmp[0]))) != 0) goto cleanup; } while (0);
    do { if ((ret = (mbedtls_mpi_mul_mod(grp, &tmp[2], &tmp[0], &tmp[0]))) != 0) goto cleanup; } while (0);
    do { if ((ret = (mbedtls_mpi_mul_mod(grp, &tmp[3], &tmp[2], &tmp[0]))) != 0) goto cleanup; } while (0);
    do { if ((ret = (mbedtls_mpi_mul_mod(grp, &tmp[2], &tmp[2], &P->X))) != 0) goto cleanup; } while (0);

    do { if ((ret = (mbedtls_mpi_copy(&tmp[0], &tmp[2]))) != 0) goto cleanup; } while (0);
    do { if ((ret = (mbedtls_mpi_shift_l_mod(grp, &tmp[0], 1))) != 0) goto cleanup; } while (0);


    do { if ((ret = (mbedtls_mpi_mul_mod(grp, X, &tmp[1], &tmp[1]))) != 0) goto cleanup; } while (0);
    do { if ((ret = (mbedtls_mpi_sub_mod(grp, X, X, &tmp[0]))) != 0) goto cleanup; } while (0);
    do { if ((ret = (mbedtls_mpi_sub_mod(grp, X, X, &tmp[3]))) != 0) goto cleanup; } while (0);
    do { if ((ret = (mbedtls_mpi_sub_mod(grp, &tmp[2], &tmp[2], X))) != 0) goto cleanup; } while (0);
    do { if ((ret = (mbedtls_mpi_mul_mod(grp, &tmp[2], &tmp[2], &tmp[1]))) != 0) goto cleanup; } while (0);
    do { if ((ret = (mbedtls_mpi_mul_mod(grp, &tmp[3], &tmp[3], &P->Y))) != 0) goto cleanup; } while (0);

    do { if ((ret = (mbedtls_mpi_sub_mod(grp, Y, &tmp[2], &tmp[3]))) != 0) goto cleanup; } while (0);

cleanup:

    return ret;

}
# 1682 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
static int ecp_randomize_jac(const mbedtls_ecp_group *grp, mbedtls_ecp_point *pt,
                             int (*f_rng)(void *, unsigned char *, size_t), void *p_rng)
{
# 1694 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
    int ret = -0x006E;
    mbedtls_mpi l;

    mbedtls_mpi_init(&l);


    do { if ((ret = (mbedtls_mpi_random((&l), 2, &grp->P, f_rng, p_rng))) != 0) goto cleanup; } while (0);


    do { if ((ret = (mbedtls_mpi_mul_mod(grp, &pt->Z, &pt->Z, &l))) != 0) goto cleanup; } while (0);


    do { if ((ret = (mbedtls_mpi_mul_mod(grp, &pt->Y, &pt->Y, &l))) != 0) goto cleanup; } while (0);


    do { if ((ret = (mbedtls_mpi_mul_mod(grp, &l, &l, &l))) != 0) goto cleanup; } while (0);
    do { if ((ret = (mbedtls_mpi_mul_mod(grp, &pt->X, &pt->X, &l))) != 0) goto cleanup; } while (0);


    do { if ((ret = (mbedtls_mpi_mul_mod(grp, &pt->Y, &pt->Y, &l))) != 0) goto cleanup; } while (0);

cleanup:
    mbedtls_mpi_free(&l);

    if (ret == -0x000E) {
        ret = -0x4D00;
    }
    return ret;

}
# 1785 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
static void ecp_comb_recode_core(unsigned char x[], size_t d,
                                 unsigned char w, const mbedtls_mpi *m)
{
    size_t i, j;
    unsigned char c, cc, adjust;

    memset(x, 0, d+1);


    for (i = 0; i < d; i++) {
        for (j = 0; j < w; j++) {
            x[i] |= mbedtls_mpi_get_bit(m, i + d * j) << j;
        }
    }


    c = 0;
    for (i = 1; i <= d; i++) {

        cc = x[i] & c;
        x[i] = x[i] ^ c;
        c = cc;


        adjust = 1 - (x[i] & 0x01);
        c |= x[i] & (x[i-1] * adjust);
        x[i] = x[i] ^ (x[i-1] * adjust);
        x[i-1] |= adjust << 7;
    }
}
# 1850 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
static int ecp_precompute_comb(const mbedtls_ecp_group *grp,
                               mbedtls_ecp_point T[], const mbedtls_ecp_point *P,
                               unsigned char w, size_t d,
                               mbedtls_ecp_restart_ctx *rs_ctx)
{
    int ret = -0x006E;
    unsigned char i;
    size_t j = 0;
    const unsigned char T_size = 1U << (w - 1);
    mbedtls_ecp_point *cur, *TT[(1 << (4 - 1)) - 1] = { 
# 1859 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c" 3 4
                                                     ((void *)0) 
# 1859 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
                                                          };

    mbedtls_mpi tmp[4];

    mpi_init_many(tmp, sizeof(tmp) / sizeof(mbedtls_mpi));


    if (rs_ctx != 
# 1866 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c" 3 4
                 ((void *)0) 
# 1866 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
                      && rs_ctx->rsm != 
# 1866 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c" 3 4
                                        ((void *)0)
# 1866 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
                                            ) {
        if (rs_ctx->rsm->state == ecp_rsm_pre_dbl) {
            goto dbl;
        }
        if (rs_ctx->rsm->state == ecp_rsm_pre_norm_dbl) {
            goto norm_dbl;
        }
        if (rs_ctx->rsm->state == ecp_rsm_pre_add) {
            goto add;
        }
        if (rs_ctx->rsm->state == ecp_rsm_pre_norm_add) {
            goto norm_add;
        }
    }





    if (rs_ctx != 
# 1885 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c" 3 4
                 ((void *)0) 
# 1885 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
                      && rs_ctx->rsm != 
# 1885 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c" 3 4
                                        ((void *)0)
# 1885 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
                                            ) {
        rs_ctx->rsm->state = ecp_rsm_pre_dbl;


        rs_ctx->rsm->i = 0;
    }

dbl:





    do { if ((ret = (mbedtls_ecp_copy(&T[0], P))) != 0) goto cleanup; } while (0);


    if (rs_ctx != 
# 1901 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c" 3 4
                 ((void *)0) 
# 1901 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
                      && rs_ctx->rsm != 
# 1901 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c" 3 4
                                        ((void *)0) 
# 1901 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
                                             && rs_ctx->rsm->i != 0) {
        j = rs_ctx->rsm->i;
    } else

    j = 0;

    for (; j < d * (w - 1); j++) {
        do { if ((ret = (mbedtls_ecp_check_budget(grp, rs_ctx, (unsigned) (8)))) != 0) goto cleanup; } while (0);;

        i = 1U << (j / d);
        cur = T + i;

        if (j % d == 0) {
            do { if ((ret = (mbedtls_ecp_copy(cur, T + (i >> 1)))) != 0) goto cleanup; } while (0);
        }

        do { if ((ret = (ecp_double_jac(grp, cur, cur, tmp))) != 0) goto cleanup; } while (0);
    }


    if (rs_ctx != 
# 1921 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c" 3 4
                 ((void *)0) 
# 1921 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
                      && rs_ctx->rsm != 
# 1921 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c" 3 4
                                        ((void *)0)
# 1921 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
                                            ) {
        rs_ctx->rsm->state = ecp_rsm_pre_norm_dbl;
    }

norm_dbl:
# 1934 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
    j = 0;
    for (i = 1; i < T_size; i <<= 1) {
        TT[j++] = T + i;
    }

    do { if ((ret = (mbedtls_ecp_check_budget(grp, rs_ctx, (unsigned) (120 + 6 * j - 2)))) != 0) goto cleanup; } while (0);;

    do { if ((ret = (ecp_normalize_jac_many(grp, TT, j))) != 0) goto cleanup; } while (0);


    if (rs_ctx != 
# 1944 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c" 3 4
                 ((void *)0) 
# 1944 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
                      && rs_ctx->rsm != 
# 1944 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c" 3 4
                                        ((void *)0)
# 1944 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
                                            ) {
        rs_ctx->rsm->state = ecp_rsm_pre_add;
    }

add:





    do { if ((ret = (mbedtls_ecp_check_budget(grp, rs_ctx, (unsigned) ((T_size - 1) * 11)))) != 0) goto cleanup; } while (0);;

    for (i = 1; i < T_size; i <<= 1) {
        j = i;
        while (j--) {
            do { if ((ret = (ecp_add_mixed(grp, &T[i + j], &T[j], &T[i], tmp))) != 0) goto cleanup; } while (0);
        }
    }


    if (rs_ctx != 
# 1964 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c" 3 4
                 ((void *)0) 
# 1964 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
                      && rs_ctx->rsm != 
# 1964 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c" 3 4
                                        ((void *)0)
# 1964 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
                                            ) {
        rs_ctx->rsm->state = ecp_rsm_pre_norm_add;
    }

norm_add:






    for (j = 0; j + 1 < T_size; j++) {
        TT[j] = T + j + 1;
    }

    do { if ((ret = (mbedtls_ecp_check_budget(grp, rs_ctx, (unsigned) (120 + 6 * j - 2)))) != 0) goto cleanup; } while (0);;

    do { if ((ret = (ecp_normalize_jac_many(grp, TT, j))) != 0) goto cleanup; } while (0);






    for (i = 0; i < T_size; i++) {
        mbedtls_mpi_free(&T[i].Z);
    }

cleanup:

    mpi_free_many(tmp, sizeof(tmp) / sizeof(mbedtls_mpi));


    if (rs_ctx != 
# 1997 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c" 3 4
                 ((void *)0) 
# 1997 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
                      && rs_ctx->rsm != 
# 1997 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c" 3 4
                                        ((void *)0) 
# 1997 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
                                             &&
        ret == -0x4B00) {
        if (rs_ctx->rsm->state == ecp_rsm_pre_dbl) {
            rs_ctx->rsm->i = j;
        }
    }


    return ret;
}






static int ecp_select_comb(const mbedtls_ecp_group *grp, mbedtls_ecp_point *R,
                           const mbedtls_ecp_point T[], unsigned char T_size,
                           unsigned char i)
{
    int ret = -0x006E;
    unsigned char ii, j;


    ii = (i & 0x7Fu) >> 1;


    for (j = 0; j < T_size; j++) {
        do { if ((ret = (mbedtls_mpi_safe_cond_assign((&R->X), (&T[j].X), (j == ii)))) != 0) goto cleanup; } while (0);
        do { if ((ret = (mbedtls_mpi_safe_cond_assign((&R->Y), (&T[j].Y), (j == ii)))) != 0) goto cleanup; } while (0);
    }


    do { if ((ret = (ecp_safe_invert_jac(grp, R, i >> 7))) != 0) goto cleanup; } while (0);

    do { if ((ret = (mbedtls_mpi_lset(&R->Z, 1))) != 0) goto cleanup; } while (0);

cleanup:
    return ret;
}







static int ecp_mul_comb_core(const mbedtls_ecp_group *grp, mbedtls_ecp_point *R,
                             const mbedtls_ecp_point T[], unsigned char T_size,
                             const unsigned char x[], size_t d,
                             int (*f_rng)(void *, unsigned char *, size_t),
                             void *p_rng,
                             mbedtls_ecp_restart_ctx *rs_ctx)
{
    int ret = -0x006E;
    mbedtls_ecp_point Txi;
    mbedtls_mpi tmp[4];
    size_t i;

    mbedtls_ecp_point_init(&Txi);
    mpi_init_many(tmp, sizeof(tmp) / sizeof(mbedtls_mpi));






    if (rs_ctx != 
# 2064 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c" 3 4
                 ((void *)0) 
# 2064 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
                      && rs_ctx->rsm != 
# 2064 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c" 3 4
                                        ((void *)0) 
# 2064 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
                                             &&
        rs_ctx->rsm->state != ecp_rsm_comb_core) {
        rs_ctx->rsm->i = 0;
        rs_ctx->rsm->state = ecp_rsm_comb_core;
    }


    if (rs_ctx != 
# 2071 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c" 3 4
                 ((void *)0) 
# 2071 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
                      && rs_ctx->rsm != 
# 2071 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c" 3 4
                                        ((void *)0) 
# 2071 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
                                             && rs_ctx->rsm->i != 0) {

        i = rs_ctx->rsm->i;
    } else

    {

        i = d;
        do { if ((ret = (ecp_select_comb(grp, R, T, T_size, x[i]))) != 0) goto cleanup; } while (0);
        if (f_rng != 0) {
            do { if ((ret = (ecp_randomize_jac(grp, R, f_rng, p_rng))) != 0) goto cleanup; } while (0);
        }
    }

    while (i != 0) {
        do { if ((ret = (mbedtls_ecp_check_budget(grp, rs_ctx, (unsigned) (8 + 11)))) != 0) goto cleanup; } while (0);;
        --i;

        do { if ((ret = (ecp_double_jac(grp, R, R, tmp))) != 0) goto cleanup; } while (0);
        do { if ((ret = (ecp_select_comb(grp, &Txi, T, T_size, x[i]))) != 0) goto cleanup; } while (0);
        do { if ((ret = (ecp_add_mixed(grp, R, R, &Txi, tmp))) != 0) goto cleanup; } while (0);
    }

cleanup:

    mbedtls_ecp_point_free(&Txi);
    mpi_free_many(tmp, sizeof(tmp) / sizeof(mbedtls_mpi));


    if (rs_ctx != 
# 2100 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c" 3 4
                 ((void *)0) 
# 2100 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
                      && rs_ctx->rsm != 
# 2100 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c" 3 4
                                        ((void *)0) 
# 2100 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
                                             &&
        ret == -0x4B00) {
        rs_ctx->rsm->i = i;

    }


    return ret;
}
# 2122 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
static int ecp_comb_recode_scalar(const mbedtls_ecp_group *grp,
                                  const mbedtls_mpi *m,
                                  unsigned char k[(521 + 1) / 2 + 1],
                                  size_t d,
                                  unsigned char w,
                                  unsigned char *parity_trick)
{
    int ret = -0x006E;
    mbedtls_mpi M, mm;

    mbedtls_mpi_init(&M);
    mbedtls_mpi_init(&mm);


    if (mbedtls_mpi_get_bit(&grp->N, 0) != 1) {
        return -0x4F80;
    }


    *parity_trick = (mbedtls_mpi_get_bit(m, 0) == 0);


    do { if ((ret = (mbedtls_mpi_copy(&M, m))) != 0) goto cleanup; } while (0);
    do { if ((ret = (mbedtls_mpi_sub_mpi(&mm, &grp->N, m))) != 0) goto cleanup; } while (0);
    do { if ((ret = (mbedtls_mpi_safe_cond_assign(&M, &mm, *parity_trick))) != 0) goto cleanup; } while (0);


    ecp_comb_recode_core(k, d, w, &M);

cleanup:
    mbedtls_mpi_free(&mm);
    mbedtls_mpi_free(&M);

    return ret;
}
# 2165 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
static int ecp_mul_comb_after_precomp(const mbedtls_ecp_group *grp,
                                      mbedtls_ecp_point *R,
                                      const mbedtls_mpi *m,
                                      const mbedtls_ecp_point *T,
                                      unsigned char T_size,
                                      unsigned char w,
                                      size_t d,
                                      int (*f_rng)(void *, unsigned char *, size_t),
                                      void *p_rng,
                                      mbedtls_ecp_restart_ctx *rs_ctx)
{
    int ret = -0x006E;
    unsigned char parity_trick;
    unsigned char k[(521 + 1) / 2 + 1];
    mbedtls_ecp_point *RR = R;


    if (rs_ctx != 
# 2182 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c" 3 4
                 ((void *)0) 
# 2182 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
                      && rs_ctx->rsm != 
# 2182 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c" 3 4
                                        ((void *)0)
# 2182 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
                                            ) {
        RR = &rs_ctx->rsm->R;

        if (rs_ctx->rsm->state == ecp_rsm_final_norm) {
            goto final_norm;
        }
    }


    do { if ((ret = (ecp_comb_recode_scalar(grp, m, k, d, w, &parity_trick))) != 0) goto cleanup; } while (0)
                                                          ;
    do { if ((ret = (ecp_mul_comb_core(grp, RR, T, T_size, k, d, f_rng, p_rng, rs_ctx))) != 0) goto cleanup; } while (0)
                                                            ;
    do { if ((ret = (ecp_safe_invert_jac(grp, RR, parity_trick))) != 0) goto cleanup; } while (0);


    if (rs_ctx != 
# 2198 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c" 3 4
                 ((void *)0) 
# 2198 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
                      && rs_ctx->rsm != 
# 2198 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c" 3 4
                                        ((void *)0)
# 2198 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
                                            ) {
        rs_ctx->rsm->state = ecp_rsm_final_norm;
    }

final_norm:
    do { if ((ret = (mbedtls_ecp_check_budget(grp, rs_ctx, (unsigned) (120)))) != 0) goto cleanup; } while (0);;

    do { if ((ret = (ecp_normalize_jac(grp, RR))) != 0) goto cleanup; } while (0);


    if (rs_ctx != 
# 2208 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c" 3 4
                 ((void *)0) 
# 2208 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
                      && rs_ctx->rsm != 
# 2208 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c" 3 4
                                        ((void *)0)
# 2208 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
                                            ) {
        do { if ((ret = (mbedtls_ecp_copy(R, RR))) != 0) goto cleanup; } while (0);
    }


cleanup:
    return ret;
}




static unsigned char ecp_pick_window_size(const mbedtls_ecp_group *grp,
                                          unsigned char p_eq_g)
{
    unsigned char w;






    w = grp->nbits >= 384 ? 5 : 4;






    if (p_eq_g) {
        w++;
    }
# 2251 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
    if ((!p_eq_g || !ecp_group_is_static_comb_table(grp)) && w > 4) {
        w = 4;
    }

    if (w >= grp->nbits) {
        w = 2;
    }

    return w;
}
# 2275 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
static int ecp_mul_comb(mbedtls_ecp_group *grp, mbedtls_ecp_point *R,
                        const mbedtls_mpi *m, const mbedtls_ecp_point *P,
                        int (*f_rng)(void *, unsigned char *, size_t),
                        void *p_rng,
                        mbedtls_ecp_restart_ctx *rs_ctx)
{
    int ret = -0x006E;
    unsigned char w, p_eq_g, i;
    size_t d;
    unsigned char T_size = 0, T_ok = 0;
    mbedtls_ecp_point *T = 
# 2285 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c" 3 4
                          ((void *)0)
# 2285 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
                              ;

    do { if (rs_ctx != 
# 2287 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c" 3 4
   ((void *)0) 
# 2287 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
   && rs_ctx->depth++ == 0) rs_ctx->ops_done = 0; if (mbedtls_ecp_restart_is_enabled() && rs_ctx != 
# 2287 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c" 3 4
   ((void *)0) 
# 2287 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
   && rs_ctx->rsm == 
# 2287 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c" 3 4
   ((void *)0)
# 2287 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
   ) { rs_ctx->rsm = calloc(1, sizeof(*rs_ctx->rsm)); if (rs_ctx->rsm == 
# 2287 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c" 3 4
   ((void *)0)
# 2287 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
   ) return -0x4D80; ecp_restart_rsm_init(rs_ctx->rsm); } } while (0);



    p_eq_g = (mbedtls_mpi_cmp_mpi(&P->Y, &grp->G.Y) == 0 &&
              mbedtls_mpi_cmp_mpi(&P->X, &grp->G.X) == 0);





    w = ecp_pick_window_size(grp, p_eq_g);
    T_size = 1U << (w - 1);
    d = (grp->nbits + w - 1) / w;


    if (p_eq_g && grp->T != 
# 2303 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c" 3 4
                           ((void *)0)
# 2303 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
                               ) {

        T = grp->T;
        T_ok = 1;
    } else


    if (rs_ctx != 
# 2310 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c" 3 4
                 ((void *)0) 
# 2310 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
                      && rs_ctx->rsm != 
# 2310 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c" 3 4
                                        ((void *)0) 
# 2310 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
                                             && rs_ctx->rsm->T != 
# 2310 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c" 3 4
                                                                  ((void *)0)
# 2310 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
                                                                      ) {

        T = rs_ctx->rsm->T;
        rs_ctx->rsm->T = 
# 2313 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c" 3 4
                        ((void *)0)
# 2313 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
                            ;
        rs_ctx->rsm->T_size = 0;


        T_ok = rs_ctx->rsm->state >= ecp_rsm_comb_core;
    } else


    {
        T = calloc(T_size, sizeof(mbedtls_ecp_point));
        if (T == 
# 2323 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c" 3 4
                ((void *)0)
# 2323 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
                    ) {
            ret = -0x4D80;
            goto cleanup;
        }

        for (i = 0; i < T_size; i++) {
            mbedtls_ecp_point_init(&T[i]);
        }

        T_ok = 0;
    }


    if (!T_ok) {
        do { if ((ret = (ecp_precompute_comb(grp, T, P, w, d, rs_ctx))) != 0) goto cleanup; } while (0);

        if (p_eq_g) {


            grp->T = T;
            grp->T_size = T_size;
        }
    }


    do { if ((ret = (ecp_mul_comb_after_precomp(grp, R, m, T, T_size, w, d, f_rng, p_rng, rs_ctx))) != 0) goto cleanup; } while (0)

                                                                     ;

cleanup:


    if (T == grp->T) {
        T = 
# 2356 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c" 3 4
           ((void *)0)
# 2356 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
               ;
    }



    if (rs_ctx != 
# 2361 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c" 3 4
                 ((void *)0) 
# 2361 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
                      && rs_ctx->rsm != 
# 2361 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c" 3 4
                                        ((void *)0) 
# 2361 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
                                             && ret == -0x4B00 && T != 
# 2361 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c" 3 4
                                                                                           ((void *)0)
# 2361 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
                                                                                               ) {

        rs_ctx->rsm->T_size = T_size;
        rs_ctx->rsm->T = T;
        T = 
# 2365 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c" 3 4
           ((void *)0)
# 2365 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
               ;
    }



    if (T != 
# 2370 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c" 3 4
            ((void *)0)
# 2370 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
                ) {
        for (i = 0; i < T_size; i++) {
            mbedtls_ecp_point_free(&T[i]);
        }
        free(T);
    }


    int should_free_R = (ret != 0);


    if (ret == -0x4B00) {
        should_free_R = 0;
    }

    if (should_free_R) {
        mbedtls_ecp_point_free(R);
    }

    do { if (rs_ctx != 
# 2389 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c" 3 4
   ((void *)0) 
# 2389 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
   && rs_ctx->rsm != 
# 2389 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c" 3 4
   ((void *)0) 
# 2389 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
   && ret != -0x4B00) { ecp_restart_rsm_free(rs_ctx->rsm); free(rs_ctx->rsm); rs_ctx->rsm = 
# 2389 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c" 3 4
   ((void *)0)
# 2389 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
   ; } if (rs_ctx != 
# 2389 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c" 3 4
   ((void *)0)
# 2389 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
   ) rs_ctx->depth--; } while (0);

    return ret;
}
# 2409 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
static int ecp_normalize_mxz(const mbedtls_ecp_group *grp, mbedtls_ecp_point *P)
{
# 2420 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
    int ret = -0x006E;
    do { if ((ret = (mbedtls_mpi_gcd_modinv_odd(
# 2421 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c" 3 4
   ((void *)0)
# 2421 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
   , (&P->Z), (&P->Z), &grp->P))) != 0) goto cleanup; } while (0);
    do { if ((ret = (mbedtls_mpi_mul_mod(grp, &P->X, &P->X, &P->Z))) != 0) goto cleanup; } while (0);
    do { if ((ret = (mbedtls_mpi_lset(&P->Z, 1))) != 0) goto cleanup; } while (0);

cleanup:
    return ret;

}
# 2438 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
static int ecp_randomize_mxz(const mbedtls_ecp_group *grp, mbedtls_ecp_point *P,
                             int (*f_rng)(void *, unsigned char *, size_t), void *p_rng)
{
# 2450 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
    int ret = -0x006E;
    mbedtls_mpi l;
    mbedtls_mpi_init(&l);


    do { if ((ret = (mbedtls_mpi_random((&l), 2, &grp->P, f_rng, p_rng))) != 0) goto cleanup; } while (0);

    do { if ((ret = (mbedtls_mpi_mul_mod(grp, &P->X, &P->X, &l))) != 0) goto cleanup; } while (0);
    do { if ((ret = (mbedtls_mpi_mul_mod(grp, &P->Z, &P->Z, &l))) != 0) goto cleanup; } while (0);

cleanup:
    mbedtls_mpi_free(&l);

    if (ret == -0x000E) {
        ret = -0x4D00;
    }
    return ret;

}
# 2485 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
static int ecp_double_add_mxz(const mbedtls_ecp_group *grp,
                              mbedtls_ecp_point *R, mbedtls_ecp_point *S,
                              const mbedtls_ecp_point *P, const mbedtls_ecp_point *Q,
                              const mbedtls_mpi *d,
                              mbedtls_mpi T[4])
{
# 2500 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
    int ret = -0x006E;

    do { if ((ret = (mbedtls_mpi_add_mod(grp, &T[0], &P->X, &P->Z))) != 0) goto cleanup; } while (0);
    do { if ((ret = (mbedtls_mpi_sub_mod(grp, &T[1], &P->X, &P->Z))) != 0) goto cleanup; } while (0);
    do { if ((ret = (mbedtls_mpi_add_mod(grp, &T[2], &Q->X, &Q->Z))) != 0) goto cleanup; } while (0);
    do { if ((ret = (mbedtls_mpi_sub_mod(grp, &T[3], &Q->X, &Q->Z))) != 0) goto cleanup; } while (0);
    do { if ((ret = (mbedtls_mpi_mul_mod(grp, &T[3], &T[3], &T[0]))) != 0) goto cleanup; } while (0);
    do { if ((ret = (mbedtls_mpi_mul_mod(grp, &T[2], &T[2], &T[1]))) != 0) goto cleanup; } while (0);
    do { if ((ret = (mbedtls_mpi_mul_mod(grp, &T[0], &T[0], &T[0]))) != 0) goto cleanup; } while (0);
    do { if ((ret = (mbedtls_mpi_mul_mod(grp, &T[1], &T[1], &T[1]))) != 0) goto cleanup; } while (0);
    do { if ((ret = (mbedtls_mpi_mul_mod(grp, &R->X, &T[0], &T[1]))) != 0) goto cleanup; } while (0);
    do { if ((ret = (mbedtls_mpi_sub_mod(grp, &T[0], &T[0], &T[1]))) != 0) goto cleanup; } while (0);
    do { if ((ret = (mbedtls_mpi_mul_mod(grp, &R->Z, &grp->A, &T[0]))) != 0) goto cleanup; } while (0);
    do { if ((ret = (mbedtls_mpi_add_mod(grp, &R->Z, &T[1], &R->Z))) != 0) goto cleanup; } while (0);
    do { if ((ret = (mbedtls_mpi_add_mod(grp, &S->X, &T[3], &T[2]))) != 0) goto cleanup; } while (0);
    do { if ((ret = (mbedtls_mpi_mul_mod(grp, &S->X, &S->X, &S->X))) != 0) goto cleanup; } while (0);
    do { if ((ret = (mbedtls_mpi_sub_mod(grp, &S->Z, &T[3], &T[2]))) != 0) goto cleanup; } while (0);
    do { if ((ret = (mbedtls_mpi_mul_mod(grp, &S->Z, &S->Z, &S->Z))) != 0) goto cleanup; } while (0);
    do { if ((ret = (mbedtls_mpi_mul_mod(grp, &S->Z, d, &S->Z))) != 0) goto cleanup; } while (0);
    do { if ((ret = (mbedtls_mpi_mul_mod(grp, &R->Z, &T[0], &R->Z))) != 0) goto cleanup; } while (0);

cleanup:

    return ret;

}





static int ecp_mul_mxz(mbedtls_ecp_group *grp, mbedtls_ecp_point *R,
                       const mbedtls_mpi *m, const mbedtls_ecp_point *P,
                       int (*f_rng)(void *, unsigned char *, size_t),
                       void *p_rng)
{
    int ret = -0x006E;
    size_t i;
    unsigned char b;
    mbedtls_ecp_point RP;
    mbedtls_mpi PX;
    mbedtls_mpi tmp[4];
    mbedtls_ecp_point_init(&RP); mbedtls_mpi_init(&PX);

    mpi_init_many(tmp, sizeof(tmp) / sizeof(mbedtls_mpi));

    if (f_rng == 
# 2546 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c" 3 4
                ((void *)0)
# 2546 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
                    ) {
        return -0x4F80;
    }


    do { if ((ret = (mbedtls_mpi_copy(&PX, &P->X))) != 0) goto cleanup; } while (0);
    do { if ((ret = (mbedtls_ecp_copy(&RP, P))) != 0) goto cleanup; } while (0);


    do { if ((ret = (mbedtls_mpi_lset(&R->X, 1))) != 0) goto cleanup; } while (0);
    do { if ((ret = (mbedtls_mpi_lset(&R->Z, 0))) != 0) goto cleanup; } while (0);
    mbedtls_mpi_free(&R->Y);


    while (mbedtls_mpi_cmp_mpi((&RP.X), &grp->P) >= 0) do { if ((ret = (mbedtls_mpi_sub_abs((&RP.X), (&RP.X), &grp->P))) != 0) goto cleanup; } while (0);


    do { if ((ret = (ecp_randomize_mxz(grp, &RP, f_rng, p_rng))) != 0) goto cleanup; } while (0);


    i = grp->nbits + 1;
    while (i-- > 0) {
        b = mbedtls_mpi_get_bit(m, i);







        do { if ((ret = (mbedtls_mpi_safe_cond_swap((&R->X), (&RP.X), (b)))) != 0) goto cleanup; } while (0);
        do { if ((ret = (mbedtls_mpi_safe_cond_swap((&R->Z), (&RP.Z), (b)))) != 0) goto cleanup; } while (0);
        do { if ((ret = (ecp_double_add_mxz(grp, R, &RP, R, &RP, &PX, tmp))) != 0) goto cleanup; } while (0);
        do { if ((ret = (mbedtls_mpi_safe_cond_swap((&R->X), (&RP.X), (b)))) != 0) goto cleanup; } while (0);
        do { if ((ret = (mbedtls_mpi_safe_cond_swap((&R->Z), (&RP.Z), (b)))) != 0) goto cleanup; } while (0);
    }

    do { if ((ret = (ecp_normalize_mxz(grp, R))) != 0) goto cleanup; } while (0);

cleanup:
    mbedtls_ecp_point_free(&RP); mbedtls_mpi_free(&PX);

    mpi_free_many(tmp, sizeof(tmp) / sizeof(mbedtls_mpi));
    return ret;
}
# 2600 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
static int ecp_mul_restartable_internal(mbedtls_ecp_group *grp, mbedtls_ecp_point *R,
                                        const mbedtls_mpi *m, const mbedtls_ecp_point *P,
                                        int (*f_rng)(void *, unsigned char *, size_t), void *p_rng,
                                        mbedtls_ecp_restart_ctx *rs_ctx)
{
    int ret = -0x4F80;






    if (rs_ctx != 
# 2612 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c" 3 4
                 ((void *)0) 
# 2612 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
                      && rs_ctx->depth++ == 0) {
        rs_ctx->ops_done = 0;
    }
# 2625 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
    int restarting = 0;

    restarting = (rs_ctx != 
# 2627 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c" 3 4
                           ((void *)0) 
# 2627 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
                                && rs_ctx->rsm != 
# 2627 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c" 3 4
                                                  ((void *)0)
# 2627 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
                                                      );


    if (!restarting) {

        do { if ((ret = (mbedtls_ecp_check_budget(grp, rs_ctx, (unsigned) (3)))) != 0) goto cleanup; } while (0);;


        do { if ((ret = (mbedtls_ecp_check_privkey(grp, m))) != 0) goto cleanup; } while (0);
        do { if ((ret = (mbedtls_ecp_check_pubkey(grp, P))) != 0) goto cleanup; } while (0);
    }

    ret = -0x4F80;

    if (mbedtls_ecp_get_type(grp) == MBEDTLS_ECP_TYPE_MONTGOMERY) {
        do { if ((ret = (ecp_mul_mxz(grp, R, m, P, f_rng, p_rng))) != 0) goto cleanup; } while (0);
    }


    if (mbedtls_ecp_get_type(grp) == MBEDTLS_ECP_TYPE_SHORT_WEIERSTRASS) {
        do { if ((ret = (ecp_mul_comb(grp, R, m, P, f_rng, p_rng, rs_ctx))) != 0) goto cleanup; } while (0);
    }


cleanup:
# 2660 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
    if (rs_ctx != 
# 2660 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c" 3 4
                 ((void *)0)
# 2660 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
                     ) {
        rs_ctx->depth--;
    }


    return ret;
}




int mbedtls_ecp_mul_restartable(mbedtls_ecp_group *grp, mbedtls_ecp_point *R,
                                const mbedtls_mpi *m, const mbedtls_ecp_point *P,
                                int (*f_rng)(void *, unsigned char *, size_t), void *p_rng,
                                mbedtls_ecp_restart_ctx *rs_ctx)
{
    if (f_rng == 
# 2676 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c" 3 4
                ((void *)0)
# 2676 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
                    ) {
        return -0x4F80;
    }

    return ecp_mul_restartable_internal(grp, R, m, P, f_rng, p_rng, rs_ctx);
}




int mbedtls_ecp_mul(mbedtls_ecp_group *grp, mbedtls_ecp_point *R,
                    const mbedtls_mpi *m, const mbedtls_ecp_point *P,
                    int (*f_rng)(void *, unsigned char *, size_t), void *p_rng)
{
    return mbedtls_ecp_mul_restartable(grp, R, m, P, f_rng, p_rng, 
# 2690 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c" 3 4
                                                                  ((void *)0)
# 2690 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
                                                                      );
}







static int ecp_check_pubkey_sw(const mbedtls_ecp_group *grp, const mbedtls_ecp_point *pt)
{
    int ret = -0x006E;
    mbedtls_mpi YY, RHS;


    if (mbedtls_mpi_cmp_int(&pt->X, 0) < 0 ||
        mbedtls_mpi_cmp_int(&pt->Y, 0) < 0 ||
        mbedtls_mpi_cmp_mpi(&pt->X, &grp->P) >= 0 ||
        mbedtls_mpi_cmp_mpi(&pt->Y, &grp->P) >= 0) {
        return -0x4C80;
    }

    mbedtls_mpi_init(&YY); mbedtls_mpi_init(&RHS);





    do { if ((ret = (mbedtls_mpi_mul_mod(grp, &YY, &pt->Y, &pt->Y))) != 0) goto cleanup; } while (0);
    do { if ((ret = (ecp_sw_rhs(grp, &RHS, &pt->X))) != 0) goto cleanup; } while (0);

    if (mbedtls_mpi_cmp_mpi(&YY, &RHS) != 0) {
        ret = -0x4C80;
    }

cleanup:

    mbedtls_mpi_free(&YY); mbedtls_mpi_free(&RHS);

    return ret;
}
# 2739 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
static int mbedtls_ecp_mul_shortcuts(mbedtls_ecp_group *grp,
                                     mbedtls_ecp_point *R,
                                     const mbedtls_mpi *m,
                                     const mbedtls_ecp_point *P,
                                     mbedtls_ecp_restart_ctx *rs_ctx)
{
    int ret = -0x006E;
    mbedtls_mpi tmp;
    mbedtls_mpi_init(&tmp);

    if (mbedtls_mpi_cmp_int(m, 0) == 0) {
        do { if ((ret = (mbedtls_ecp_check_pubkey(grp, P))) != 0) goto cleanup; } while (0);
        do { if ((ret = (mbedtls_ecp_set_zero(R))) != 0) goto cleanup; } while (0);
    } else if (mbedtls_mpi_cmp_int(m, 1) == 0) {
        do { if ((ret = (mbedtls_ecp_check_pubkey(grp, P))) != 0) goto cleanup; } while (0);
        do { if ((ret = (mbedtls_ecp_copy(R, P))) != 0) goto cleanup; } while (0);
    } else if (mbedtls_mpi_cmp_int(m, -1) == 0) {
        do { if ((ret = (mbedtls_ecp_check_pubkey(grp, P))) != 0) goto cleanup; } while (0);
        do { if ((ret = (mbedtls_ecp_copy(R, P))) != 0) goto cleanup; } while (0);
        do { unsigned char nonzero = mbedtls_mpi_cmp_int(((&R->Y)), 0) != 0; do { if ((ret = (mbedtls_mpi_sub_mpi(&tmp, &grp->P, ((&R->Y))))) != 0) goto cleanup; } while (0); do { if ((ret = (mbedtls_mpi_safe_cond_assign(((&R->Y)), &tmp, nonzero & 1))) != 0) goto cleanup; } while (0); } while (0);
    } else {
        do { if ((ret = (ecp_mul_restartable_internal(grp, R, m, P, 
# 2760 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c" 3 4
       ((void *)0)
# 2760 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
       , 
# 2760 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c" 3 4
       ((void *)0)
# 2760 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
       , rs_ctx))) != 0) goto cleanup; } while (0)
                                                                         ;
    }

cleanup:
    mbedtls_mpi_free(&tmp);

    return ret;
}





int mbedtls_ecp_muladd_restartable(
    mbedtls_ecp_group *grp, mbedtls_ecp_point *R,
    const mbedtls_mpi *m, const mbedtls_ecp_point *P,
    const mbedtls_mpi *n, const mbedtls_ecp_point *Q,
    mbedtls_ecp_restart_ctx *rs_ctx)
{
    int ret = -0x006E;
    mbedtls_ecp_point mP;
    mbedtls_ecp_point *pmP = &mP;
    mbedtls_ecp_point *pR = R;
    mbedtls_mpi tmp[4];



    if (mbedtls_ecp_get_type(grp) != MBEDTLS_ECP_TYPE_SHORT_WEIERSTRASS) {
        return -0x4E80;
    }

    mbedtls_ecp_point_init(&mP);
    mpi_init_many(tmp, sizeof(tmp) / sizeof(mbedtls_mpi));

    do { if (rs_ctx != 
# 2795 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c" 3 4
   ((void *)0) 
# 2795 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
   && rs_ctx->depth++ == 0) rs_ctx->ops_done = 0; if (mbedtls_ecp_restart_is_enabled() && rs_ctx != 
# 2795 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c" 3 4
   ((void *)0) 
# 2795 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
   && rs_ctx->ma == 
# 2795 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c" 3 4
   ((void *)0)
# 2795 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
   ) { rs_ctx->ma = calloc(1, sizeof(*rs_ctx->ma)); if (rs_ctx->ma == 
# 2795 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c" 3 4
   ((void *)0)
# 2795 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
   ) return -0x4D80; ecp_restart_ma_init(rs_ctx->ma); } } while (0);


    if (rs_ctx != 
# 2798 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c" 3 4
                 ((void *)0) 
# 2798 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
                      && rs_ctx->ma != 
# 2798 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c" 3 4
                                       ((void *)0)
# 2798 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
                                           ) {

        pmP = &rs_ctx->ma->mP;
        pR = &rs_ctx->ma->R;


        if (rs_ctx->ma->state == ecp_rsma_mul2) {
            goto mul2;
        }
        if (rs_ctx->ma->state == ecp_rsma_add) {
            goto add;
        }
        if (rs_ctx->ma->state == ecp_rsma_norm) {
            goto norm;
        }
    }


    do { if ((ret = (mbedtls_ecp_mul_shortcuts(grp, pmP, m, P, rs_ctx))) != 0) goto cleanup; } while (0);

    if (rs_ctx != 
# 2818 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c" 3 4
                 ((void *)0) 
# 2818 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
                      && rs_ctx->ma != 
# 2818 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c" 3 4
                                       ((void *)0)
# 2818 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
                                           ) {
        rs_ctx->ma->state = ecp_rsma_mul2;
    }

mul2:

    do { if ((ret = (mbedtls_ecp_mul_shortcuts(grp, pR, n, Q, rs_ctx))) != 0) goto cleanup; } while (0);
# 2833 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
    if (rs_ctx != 
# 2833 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c" 3 4
                 ((void *)0) 
# 2833 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
                      && rs_ctx->ma != 
# 2833 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c" 3 4
                                       ((void *)0)
# 2833 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
                                           ) {
        rs_ctx->ma->state = ecp_rsma_add;
    }

add:

    do { if ((ret = (mbedtls_ecp_check_budget(grp, rs_ctx, (unsigned) (11)))) != 0) goto cleanup; } while (0);;
    do { if ((ret = (ecp_add_mixed(grp, pR, pmP, pR, tmp))) != 0) goto cleanup; } while (0);

    if (rs_ctx != 
# 2842 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c" 3 4
                 ((void *)0) 
# 2842 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
                      && rs_ctx->ma != 
# 2842 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c" 3 4
                                       ((void *)0)
# 2842 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
                                           ) {
        rs_ctx->ma->state = ecp_rsma_norm;
    }

norm:

    do { if ((ret = (mbedtls_ecp_check_budget(grp, rs_ctx, (unsigned) (120)))) != 0) goto cleanup; } while (0);;
    do { if ((ret = (ecp_normalize_jac(grp, pR))) != 0) goto cleanup; } while (0);


    if (rs_ctx != 
# 2852 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c" 3 4
                 ((void *)0) 
# 2852 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
                      && rs_ctx->ma != 
# 2852 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c" 3 4
                                       ((void *)0)
# 2852 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
                                           ) {
        do { if ((ret = (mbedtls_ecp_copy(R, pR))) != 0) goto cleanup; } while (0);
    }


cleanup:

    mpi_free_many(tmp, sizeof(tmp) / sizeof(mbedtls_mpi));







    mbedtls_ecp_point_free(&mP);

    do { if (rs_ctx != 
# 2869 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c" 3 4
   ((void *)0) 
# 2869 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
   && rs_ctx->ma != 
# 2869 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c" 3 4
   ((void *)0) 
# 2869 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
   && ret != -0x4B00) { ecp_restart_ma_free(rs_ctx->ma); free(rs_ctx->ma); rs_ctx->ma = 
# 2869 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c" 3 4
   ((void *)0)
# 2869 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
   ; } if (rs_ctx != 
# 2869 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c" 3 4
   ((void *)0)
# 2869 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
   ) rs_ctx->depth--; } while (0);

    return ret;
}





int mbedtls_ecp_muladd(mbedtls_ecp_group *grp, mbedtls_ecp_point *R,
                       const mbedtls_mpi *m, const mbedtls_ecp_point *P,
                       const mbedtls_mpi *n, const mbedtls_ecp_point *Q)
{
    return mbedtls_ecp_muladd_restartable(grp, R, m, P, n, Q, 
# 2882 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c" 3 4
                                                             ((void *)0)
# 2882 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
                                                                 );
}
# 2897 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
static const mbedtls_mpi_uint x25519_bad_point_1[] = {
    ((mbedtls_mpi_uint) (0xe0) << 0) | ((mbedtls_mpi_uint) (0xeb) << 8) | ((mbedtls_mpi_uint) (0x7a) << 16) | ((mbedtls_mpi_uint) (0x7c) << 24), ((mbedtls_mpi_uint) (0x3b) << 0) | ((mbedtls_mpi_uint) (0x41) << 8) | ((mbedtls_mpi_uint) (0xb8) << 16) | ((mbedtls_mpi_uint) (0xae) << 24),
    ((mbedtls_mpi_uint) (0x16) << 0) | ((mbedtls_mpi_uint) (0x56) << 8) | ((mbedtls_mpi_uint) (0xe3) << 16) | ((mbedtls_mpi_uint) (0xfa) << 24), ((mbedtls_mpi_uint) (0xf1) << 0) | ((mbedtls_mpi_uint) (0x9f) << 8) | ((mbedtls_mpi_uint) (0xc4) << 16) | ((mbedtls_mpi_uint) (0x6a) << 24),
    ((mbedtls_mpi_uint) (0xda) << 0) | ((mbedtls_mpi_uint) (0x09) << 8) | ((mbedtls_mpi_uint) (0x8d) << 16) | ((mbedtls_mpi_uint) (0xeb) << 24), ((mbedtls_mpi_uint) (0x9c) << 0) | ((mbedtls_mpi_uint) (0x32) << 8) | ((mbedtls_mpi_uint) (0xb1) << 16) | ((mbedtls_mpi_uint) (0xfd) << 24),
    ((mbedtls_mpi_uint) (0x86) << 0) | ((mbedtls_mpi_uint) (0x62) << 8) | ((mbedtls_mpi_uint) (0x05) << 16) | ((mbedtls_mpi_uint) (0x16) << 24), ((mbedtls_mpi_uint) (0x5f) << 0) | ((mbedtls_mpi_uint) (0x49) << 8) | ((mbedtls_mpi_uint) (0xb8) << 16) | ((mbedtls_mpi_uint) (0x00) << 24),
};
static const mbedtls_mpi_uint x25519_bad_point_2[] = {
    ((mbedtls_mpi_uint) (0x5f) << 0) | ((mbedtls_mpi_uint) (0x9c) << 8) | ((mbedtls_mpi_uint) (0x95) << 16) | ((mbedtls_mpi_uint) (0xbc) << 24), ((mbedtls_mpi_uint) (0xa3) << 0) | ((mbedtls_mpi_uint) (0x50) << 8) | ((mbedtls_mpi_uint) (0x8c) << 16) | ((mbedtls_mpi_uint) (0x24) << 24),
    ((mbedtls_mpi_uint) (0xb1) << 0) | ((mbedtls_mpi_uint) (0xd0) << 8) | ((mbedtls_mpi_uint) (0xb1) << 16) | ((mbedtls_mpi_uint) (0x55) << 24), ((mbedtls_mpi_uint) (0x9c) << 0) | ((mbedtls_mpi_uint) (0x83) << 8) | ((mbedtls_mpi_uint) (0xef) << 16) | ((mbedtls_mpi_uint) (0x5b) << 24),
    ((mbedtls_mpi_uint) (0x04) << 0) | ((mbedtls_mpi_uint) (0x44) << 8) | ((mbedtls_mpi_uint) (0x5c) << 16) | ((mbedtls_mpi_uint) (0xc4) << 24), ((mbedtls_mpi_uint) (0x58) << 0) | ((mbedtls_mpi_uint) (0x1c) << 8) | ((mbedtls_mpi_uint) (0x8e) << 16) | ((mbedtls_mpi_uint) (0x86) << 24),
    ((mbedtls_mpi_uint) (0xd8) << 0) | ((mbedtls_mpi_uint) (0x22) << 8) | ((mbedtls_mpi_uint) (0x4e) << 16) | ((mbedtls_mpi_uint) (0xdd) << 24), ((mbedtls_mpi_uint) (0xd0) << 0) | ((mbedtls_mpi_uint) (0x9f) << 8) | ((mbedtls_mpi_uint) (0x11) << 16) | ((mbedtls_mpi_uint) (0x57) << 24),
};
static const mbedtls_mpi ecp_x25519_bad_point_1 = { .p = (mbedtls_mpi_uint *) (x25519_bad_point_1), .s = 1, .n = (sizeof(x25519_bad_point_1) / sizeof(mbedtls_mpi_uint)) }
                       ;
static const mbedtls_mpi ecp_x25519_bad_point_2 = { .p = (mbedtls_mpi_uint *) (x25519_bad_point_2), .s = 1, .n = (sizeof(x25519_bad_point_2) / sizeof(mbedtls_mpi_uint)) }
                       ;
# 2921 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
static int ecp_check_bad_points_mx(const mbedtls_mpi *X, const mbedtls_mpi *P,
                                   const mbedtls_ecp_group_id grp_id)
{
    int ret;
    mbedtls_mpi XmP;

    mbedtls_mpi_init(&XmP);



    do { if ((ret = (mbedtls_mpi_copy(&XmP, X))) != 0) goto cleanup; } while (0);
    while (mbedtls_mpi_cmp_mpi(&XmP, P) >= 0) {
        do { if ((ret = (mbedtls_mpi_sub_mpi(&XmP, &XmP, P))) != 0) goto cleanup; } while (0);
    }




    if (mbedtls_mpi_cmp_int(&XmP, 1) <= 0) {
        ret = -0x4C80;
        goto cleanup;
    }


    if (grp_id == MBEDTLS_ECP_DP_CURVE25519) {
        if (mbedtls_mpi_cmp_mpi(&XmP, &ecp_x25519_bad_point_1) == 0) {
            ret = -0x4C80;
            goto cleanup;
        }

        if (mbedtls_mpi_cmp_mpi(&XmP, &ecp_x25519_bad_point_2) == 0) {
            ret = -0x4C80;
            goto cleanup;
        }
    }





    do { if ((ret = (mbedtls_mpi_add_int(&XmP, &XmP, 1))) != 0) goto cleanup; } while (0);
    if (mbedtls_mpi_cmp_mpi(&XmP, P) == 0) {
        ret = -0x4C80;
        goto cleanup;
    }

    ret = 0;

cleanup:
    mbedtls_mpi_free(&XmP);

    return ret;
}




static int ecp_check_pubkey_mx(const mbedtls_ecp_group *grp, const mbedtls_ecp_point *pt)
{



    if (mbedtls_mpi_size(&pt->X) > (grp->nbits + 7) / 8) {
        return -0x4C80;
    }




    if (mbedtls_mpi_cmp_int(&pt->X, 0) < 0) {
        return -0x4C80;
    }

    return ecp_check_bad_points_mx(&pt->X, &grp->P, grp->id);
}





int mbedtls_ecp_check_pubkey(const mbedtls_ecp_group *grp,
                             const mbedtls_ecp_point *pt)
{

    if (mbedtls_mpi_cmp_int(&pt->Z, 1) != 0) {
        return -0x4C80;
    }


    if (mbedtls_ecp_get_type(grp) == MBEDTLS_ECP_TYPE_MONTGOMERY) {
        return ecp_check_pubkey_mx(grp, pt);
    }


    if (mbedtls_ecp_get_type(grp) == MBEDTLS_ECP_TYPE_SHORT_WEIERSTRASS) {
        return ecp_check_pubkey_sw(grp, pt);
    }

    return -0x4F80;
}




int mbedtls_ecp_check_privkey(const mbedtls_ecp_group *grp,
                              const mbedtls_mpi *d)
{

    if (mbedtls_ecp_get_type(grp) == MBEDTLS_ECP_TYPE_MONTGOMERY) {

        if (mbedtls_mpi_get_bit(d, 0) != 0 ||
            mbedtls_mpi_get_bit(d, 1) != 0 ||
            mbedtls_mpi_bitlen(d) != grp->nbits + 1) {
            return -0x4C80;
        }


        if (grp->nbits == 254 && mbedtls_mpi_get_bit(d, 2) != 0) {
            return -0x4C80;
        }

        return 0;
    }


    if (mbedtls_ecp_get_type(grp) == MBEDTLS_ECP_TYPE_SHORT_WEIERSTRASS) {

        if (mbedtls_mpi_cmp_int(d, 1) < 0 ||
            mbedtls_mpi_cmp_mpi(d, &grp->N) >= 0) {
            return -0x4C80;
        } else {
            return 0;
        }
    }


    return -0x4F80;
}


static
int mbedtls_ecp_gen_privkey_mx(size_t high_bit,
                               mbedtls_mpi *d,
                               int (*f_rng)(void *, unsigned char *, size_t),
                               void *p_rng)
{
    int ret = -0x4F80;
    size_t n_random_bytes = high_bit / 8 + 1;





    do { if ((ret = (mbedtls_mpi_fill_random(d, n_random_bytes, f_rng, p_rng))) != 0) goto cleanup; } while (0)
                                                          ;
    do { if ((ret = (mbedtls_mpi_shift_r(d, 8 * n_random_bytes - high_bit - 1))) != 0) goto cleanup; } while (0);

    do { if ((ret = (mbedtls_mpi_set_bit(d, high_bit, 1))) != 0) goto cleanup; } while (0);



    do { if ((ret = (mbedtls_mpi_set_bit(d, 0, 0))) != 0) goto cleanup; } while (0);
    do { if ((ret = (mbedtls_mpi_set_bit(d, 1, 0))) != 0) goto cleanup; } while (0);
    if (high_bit == 254) {
        do { if ((ret = (mbedtls_mpi_set_bit(d, 2, 0))) != 0) goto cleanup; } while (0);
    }

cleanup:
    return ret;
}



static int mbedtls_ecp_gen_privkey_sw(
    const mbedtls_mpi *N, mbedtls_mpi *d,
    int (*f_rng)(void *, unsigned char *, size_t), void *p_rng)
{
    int ret = mbedtls_mpi_random(d, 1, N, f_rng, p_rng);
    switch (ret) {
        case -0x000E:
            return -0x4D00;
        default:
            return ret;
    }
}





int mbedtls_ecp_gen_privkey(const mbedtls_ecp_group *grp,
                            mbedtls_mpi *d,
                            int (*f_rng)(void *, unsigned char *, size_t),
                            void *p_rng)
{

    if (mbedtls_ecp_get_type(grp) == MBEDTLS_ECP_TYPE_MONTGOMERY) {
        return mbedtls_ecp_gen_privkey_mx(grp->nbits, d, f_rng, p_rng);
    }



    if (mbedtls_ecp_get_type(grp) == MBEDTLS_ECP_TYPE_SHORT_WEIERSTRASS) {
        return mbedtls_ecp_gen_privkey_sw(&grp->N, d, f_rng, p_rng);
    }


    return -0x4F80;
}





int mbedtls_ecp_gen_keypair_base(mbedtls_ecp_group *grp,
                                 const mbedtls_ecp_point *G,
                                 mbedtls_mpi *d, mbedtls_ecp_point *Q,
                                 int (*f_rng)(void *, unsigned char *, size_t),
                                 void *p_rng)
{
    int ret = -0x006E;
    do { if ((ret = (mbedtls_ecp_gen_privkey(grp, d, f_rng, p_rng))) != 0) goto cleanup; } while (0);
    do { if ((ret = (mbedtls_ecp_mul(grp, Q, d, G, f_rng, p_rng))) != 0) goto cleanup; } while (0);

cleanup:
    return ret;
}




int mbedtls_ecp_gen_keypair(mbedtls_ecp_group *grp,
                            mbedtls_mpi *d, mbedtls_ecp_point *Q,
                            int (*f_rng)(void *, unsigned char *, size_t),
                            void *p_rng)
{
    return mbedtls_ecp_gen_keypair_base(grp, &grp->G, d, Q, f_rng, p_rng);
}




int mbedtls_ecp_gen_key(mbedtls_ecp_group_id grp_id, mbedtls_ecp_keypair *key,
                        int (*f_rng)(void *, unsigned char *, size_t), void *p_rng)
{
    int ret = -0x006E;
    if ((ret = mbedtls_ecp_group_load(&key->grp, grp_id)) != 0) {
        return ret;
    }

    return mbedtls_ecp_gen_keypair(&key->grp, &key->d, &key->Q, f_rng, p_rng);
}


int mbedtls_ecp_set_public_key(mbedtls_ecp_group_id grp_id,
                               mbedtls_ecp_keypair *key,
                               const mbedtls_ecp_point *Q)
{
    int ret = -0x006E;

    if (key->grp.id == MBEDTLS_ECP_DP_NONE) {

        if ((ret = mbedtls_ecp_group_load(&key->grp, grp_id)) != 0) {
            return ret;
        }
    } else if (key->grp.id != grp_id) {

        return -0x4F80;
    }
    return mbedtls_ecp_copy(&key->Q, Q);
}







int mbedtls_ecp_read_key(mbedtls_ecp_group_id grp_id, mbedtls_ecp_keypair *key,
                         const unsigned char *buf, size_t buflen)
{
    int ret = 0;

    if ((ret = mbedtls_ecp_group_load(&key->grp, grp_id)) != 0) {
        return ret;
    }

    ret = -0x4E80;


    if (mbedtls_ecp_get_type(&key->grp) == MBEDTLS_ECP_TYPE_MONTGOMERY) {



        if (grp_id == MBEDTLS_ECP_DP_CURVE25519) {
            if (buflen != 32) {
                return -0x4C80;
            }

            do { if ((ret = (mbedtls_mpi_read_binary_le(&key->d, buf, buflen))) != 0) goto cleanup; } while (0);


            do { if ((ret = (mbedtls_mpi_set_bit(&key->d, 0, 0))) != 0) goto cleanup; } while (0);
            do { if ((ret = (mbedtls_mpi_set_bit(&key->d, 1, 0))) != 0) goto cleanup; } while (0);
            do { if ((ret = (mbedtls_mpi_set_bit(&key->d, 2, 0))) != 0) goto cleanup; } while (0);


            do { if ((ret = (mbedtls_mpi_set_bit(&key->d, 32 * 8 - 1, 0))) != 0) goto cleanup; } while (0)


                 ;


            do { if ((ret = (mbedtls_mpi_set_bit(&key->d, 32 * 8 - 2, 1))) != 0) goto cleanup; } while (0)


                 ;
        } else if (grp_id == MBEDTLS_ECP_DP_CURVE448) {
            if (buflen != 56) {
                return -0x4C80;
            }

            do { if ((ret = (mbedtls_mpi_read_binary_le(&key->d, buf, buflen))) != 0) goto cleanup; } while (0);


            do { if ((ret = (mbedtls_mpi_set_bit(&key->d, 0, 0))) != 0) goto cleanup; } while (0);
            do { if ((ret = (mbedtls_mpi_set_bit(&key->d, 1, 0))) != 0) goto cleanup; } while (0);


            do { if ((ret = (mbedtls_mpi_set_bit(&key->d, 56 * 8 - 1, 1))) != 0) goto cleanup; } while (0)


                 ;
        }
    }


    if (mbedtls_ecp_get_type(&key->grp) == MBEDTLS_ECP_TYPE_SHORT_WEIERSTRASS) {
        do { if ((ret = (mbedtls_mpi_read_binary(&key->d, buf, buflen))) != 0) goto cleanup; } while (0);
    }


    if (ret == 0) {
        do { if ((ret = (mbedtls_ecp_check_privkey(&key->grp, &key->d))) != 0) goto cleanup; } while (0);
    }

cleanup:

    if (ret != 0) {
        mbedtls_mpi_free(&key->d);
    }

    return ret;
}
# 3312 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
int mbedtls_ecp_write_key_ext(const mbedtls_ecp_keypair *key,
                              size_t *olen, unsigned char *buf, size_t buflen)
{
    size_t len = (key->grp.nbits + 7) / 8;
    if (len > buflen) {

        *olen = 0;
        return -0x4F00;
    }
    *olen = len;


    if (key->d.n == 0) {
        return -0x4F80;
    }


    if (mbedtls_ecp_get_type(&key->grp) == MBEDTLS_ECP_TYPE_MONTGOMERY) {
        return mbedtls_mpi_write_binary_le(&key->d, buf, len);
    }



    if (mbedtls_ecp_get_type(&key->grp) == MBEDTLS_ECP_TYPE_SHORT_WEIERSTRASS) {
        return mbedtls_mpi_write_binary(&key->d, buf, len);
    }



    return -0x006E;
}




int mbedtls_ecp_write_public_key(const mbedtls_ecp_keypair *key,
                                 int format, size_t *olen,
                                 unsigned char *buf, size_t buflen)
{
    return mbedtls_ecp_point_write_binary(&key->grp, &key->Q,
                                          format, olen, buf, buflen);
}






int mbedtls_ecp_check_pub_priv(
    const mbedtls_ecp_keypair *pub, const mbedtls_ecp_keypair *prv,
    int (*f_rng)(void *, unsigned char *, size_t), void *p_rng)
{
    int ret = -0x006E;
    mbedtls_ecp_point Q;
    mbedtls_ecp_group grp;
    if (pub->grp.id == MBEDTLS_ECP_DP_NONE ||
        pub->grp.id != prv->grp.id ||
        mbedtls_mpi_cmp_mpi(&pub->Q.X, &prv->Q.X) ||
        mbedtls_mpi_cmp_mpi(&pub->Q.Y, &prv->Q.Y) ||
        mbedtls_mpi_cmp_mpi(&pub->Q.Z, &prv->Q.Z)) {
        return -0x4F80;
    }

    mbedtls_ecp_point_init(&Q);
    mbedtls_ecp_group_init(&grp);


    mbedtls_ecp_group_copy(&grp, &prv->grp);


    do { if ((ret = (mbedtls_ecp_mul(&grp, &Q, &prv->d, &prv->grp.G, f_rng, p_rng))) != 0) goto cleanup; } while (0);

    if (mbedtls_mpi_cmp_mpi(&Q.X, &prv->Q.X) ||
        mbedtls_mpi_cmp_mpi(&Q.Y, &prv->Q.Y) ||
        mbedtls_mpi_cmp_mpi(&Q.Z, &prv->Q.Z)) {
        ret = -0x4F80;
        goto cleanup;
    }

cleanup:
    mbedtls_ecp_point_free(&Q);
    mbedtls_ecp_group_free(&grp);

    return ret;
}

int mbedtls_ecp_keypair_calc_public(mbedtls_ecp_keypair *key,
                                    int (*f_rng)(void *, unsigned char *, size_t),
                                    void *p_rng)
{
    return mbedtls_ecp_mul(&key->grp, &key->Q, &key->d, &key->grp.G,
                           f_rng, p_rng);
}


mbedtls_ecp_group_id mbedtls_ecp_keypair_get_group_id(
    const mbedtls_ecp_keypair *key)
{
    return key->grp.id;
}




int mbedtls_ecp_export(const mbedtls_ecp_keypair *key, mbedtls_ecp_group *grp,
                       mbedtls_mpi *d, mbedtls_ecp_point *Q)
{
    int ret = -0x006E;

    if (grp != 
# 3421 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c" 3 4
              ((void *)0) 
# 3421 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
                   && (ret = mbedtls_ecp_group_copy(grp, &key->grp)) != 0) {
        return ret;
    }

    if (d != 
# 3425 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c" 3 4
            ((void *)0) 
# 3425 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
                 && (ret = mbedtls_mpi_copy(d, &key->d)) != 0) {
        return ret;
    }

    if (Q != 
# 3429 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c" 3 4
            ((void *)0) 
# 3429 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
                 && (ret = mbedtls_ecp_copy(Q, &key->Q)) != 0) {
        return ret;
    }

    return 0;
}
# 3446 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
static int self_test_rng(void *ctx, unsigned char *out, size_t len)
{
    static uint32_t state = 42;

    (void) ctx;

    for (size_t i = 0; i < len; i++) {
        state = state * 1664525u + 1013904223u;
        out[i] = (unsigned char) state;
    }

    return 0;
}




static int self_test_adjust_exponent(const mbedtls_ecp_group *grp,
                                     mbedtls_mpi *m)
{
    int ret = 0;
    switch (grp->id) {
# 3485 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
        default:

            (void) grp;
            (void) m;
            goto cleanup;
    }
cleanup:
    return ret;
}



static int self_test_point(int verbose,
                           mbedtls_ecp_group *grp,
                           mbedtls_ecp_point *R,
                           mbedtls_mpi *m,
                           const mbedtls_ecp_point *P,
                           const char *const *exponents,
                           size_t n_exponents)
{
    int ret = 0;
    size_t i = 0;
    unsigned long add_c_prev, dbl_c_prev, mul_c_prev;
    add_count = 0;
    dbl_count = 0;
    mul_count = 0;

    do { if ((ret = (mbedtls_mpi_read_string(m, 16, exponents[0]))) != 0) goto cleanup; } while (0);
    do { if ((ret = (self_test_adjust_exponent(grp, m))) != 0) goto cleanup; } while (0);
    do { if ((ret = (mbedtls_ecp_mul(grp, R, m, P, self_test_rng, 
# 3514 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c" 3 4
   ((void *)0)
# 3514 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
   ))) != 0) goto cleanup; } while (0);

    for (i = 1; i < n_exponents; i++) {
        add_c_prev = add_count;
        dbl_c_prev = dbl_count;
        mul_c_prev = mul_count;
        add_count = 0;
        dbl_count = 0;
        mul_count = 0;

        do { if ((ret = (mbedtls_mpi_read_string(m, 16, exponents[i]))) != 0) goto cleanup; } while (0);
        do { if ((ret = (self_test_adjust_exponent(grp, m))) != 0) goto cleanup; } while (0);
        do { if ((ret = (mbedtls_ecp_mul(grp, R, m, P, self_test_rng, 
# 3526 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c" 3 4
       ((void *)0)
# 3526 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
       ))) != 0) goto cleanup; } while (0);

        if (add_count != add_c_prev ||
            dbl_count != dbl_c_prev ||
            mul_count != mul_c_prev) {
            ret = 1;
            break;
        }
    }

cleanup:
    if (verbose != 0) {
        if (ret != 0) {
            printf("failed (%u)\n", (unsigned int) i);
        } else {
            printf("passed\n");
        }
    }
    return ret;
}





int mbedtls_ecp_self_test(int verbose)
{

    int ret = -0x006E;
    mbedtls_ecp_group grp;
    mbedtls_ecp_point R, P;
    mbedtls_mpi m;





    const char *sw_exponents[] =
    {
        "000000000000000000000000000000000000000000000001",
        "FFFFFFFFFFFFFFFFFFFFFFFE26F2FC170F69466A74DEFD8C",
        "5EA6F389A38B8BC81E767753B15AA5569E1782E30ABE7D25",
        "400000000000000000000000000000000000000000000000",
        "7FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF",
        "555555555555555555555555555555555555555555555555",
    };


    const char *m_exponents[] =
    {



        "4000000000000000000000000000000000000000000000000000000000000000",
        "5C3C3C3C3C3C3C3C3C3C3C3C3C3C3C3C3C3C3C3C3C3C3C3C3C3C3C3C3C3C3C30",
        "5715ECCE24583F7A7023C24164390586842E816D7280A49EF6DF4EAE6B280BF8",
        "41A2B017516F6D254E1F002BCCBADD54BE30F8CEC737A0E912B4963B6BA74460",
        "5555555555555555555555555555555555555555555555555555555555555550",
        "7FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF8",
    };


    mbedtls_ecp_group_init(&grp);
    mbedtls_ecp_point_init(&R);
    mbedtls_ecp_point_init(&P);
    mbedtls_mpi_init(&m);




    do { if ((ret = (mbedtls_ecp_group_load(&grp, MBEDTLS_ECP_DP_SECP192R1))) != 0) goto cleanup; } while (0);




    if (verbose != 0) {
        printf("  ECP SW test #1 (constant op_count, base point G): ");
    }

    do { if ((ret = (mbedtls_mpi_lset(&m, 2))) != 0) goto cleanup; } while (0);
    do { if ((ret = (mbedtls_ecp_mul(&grp, &P, &m, &grp.G, self_test_rng, 
# 3606 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c" 3 4
   ((void *)0)
# 3606 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/ecp.c"
   ))) != 0) goto cleanup; } while (0);
    ret = self_test_point(verbose,
                          &grp, &R, &m, &grp.G,
                          sw_exponents,
                          sizeof(sw_exponents) / sizeof(sw_exponents[0]));
    if (ret != 0) {
        goto cleanup;
    }

    if (verbose != 0) {
        printf("  ECP SW test #2 (constant op_count, other point): ");
    }

    ret = self_test_point(verbose,
                          &grp, &R, &m, &P,
                          sw_exponents,
                          sizeof(sw_exponents) / sizeof(sw_exponents[0]));
    if (ret != 0) {
        goto cleanup;
    }

    mbedtls_ecp_group_free(&grp);
    mbedtls_ecp_point_free(&R);



    if (verbose != 0) {
        printf("  ECP Montgomery test (constant op_count): ");
    }

    do { if ((ret = (mbedtls_ecp_group_load(&grp, MBEDTLS_ECP_DP_CURVE25519))) != 0) goto cleanup; } while (0);





    ret = self_test_point(verbose,
                          &grp, &R, &m, &grp.G,
                          m_exponents,
                          sizeof(m_exponents) / sizeof(m_exponents[0]));
    if (ret != 0) {
        goto cleanup;
    }


cleanup:

    if (ret < 0 && verbose != 0) {
        printf("Unexpected error, return code = %08X\n", (unsigned int) ret);
    }

    mbedtls_ecp_group_free(&grp);
    mbedtls_ecp_point_free(&R);
    mbedtls_ecp_point_free(&P);
    mbedtls_mpi_free(&m);

    if (verbose != 0) {
        printf("\n");
    }

    return ret;




}
