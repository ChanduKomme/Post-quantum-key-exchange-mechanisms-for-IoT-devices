# 0 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
# 1 "/home/chandu/sdk/bl602_iot_sdk/customer_app/suas_app_pqkem_gateway/build_out/mbedtls-bl602//"
# 0 "<built-in>"
# 0 "<command-line>"
# 1 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
# 9 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
# 1 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/common.h" 1
# 14 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/common.h"
# 1 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/build_info.h" 1
# 113 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/build_info.h"
# 1 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/mbedtls_config.h" 1
# 114 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/build_info.h" 2
# 138 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/build_info.h"
# 1 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_config.h" 1
# 139 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/build_info.h" 2
# 176 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/build_info.h"
# 1 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/config_psa.h" 1
# 21 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/config_psa.h"
# 1 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_legacy.h" 1
# 22 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/config_psa.h" 2

# 1 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_adjust_config_synonyms.h" 1
# 24 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/config_psa.h" 2

# 1 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_adjust_config_dependencies.h" 1
# 26 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/config_psa.h" 2

# 1 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/config_adjust_psa_superset_legacy.h" 1
# 28 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/config_psa.h" 2







# 1 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_adjust_config_key_pair_types.h" 1
# 36 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/config_psa.h" 2




# 1 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/config_adjust_legacy_from_psa.h" 1
# 41 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/config_psa.h" 2
# 59 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/config_psa.h"
# 1 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_adjust_auto_enabled.h" 1
# 60 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/config_psa.h" 2
# 177 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/build_info.h" 2


# 1 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/config_adjust_legacy_crypto.h" 1
# 180 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/build_info.h" 2

# 1 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/config_adjust_x509.h" 1
# 182 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/build_info.h" 2

# 1 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/config_adjust_ssl.h" 1
# 184 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/build_info.h" 2
# 192 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/build_info.h"
# 1 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/check_config.h" 1
# 33 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/check_config.h"
# 1 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/lib/gcc/riscv32-unknown-elf/15.1.0/include/limits.h" 1 3 4
# 34 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/lib/gcc/riscv32-unknown-elf/15.1.0/include/limits.h" 3 4
# 1 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/lib/gcc/riscv32-unknown-elf/15.1.0/include/syslimits.h" 1 3 4






#pragma GCC diagnostic push
#pragma GCC diagnostic ignored "-Wpedantic"
# 1 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/lib/gcc/riscv32-unknown-elf/15.1.0/include/limits.h" 1 3 4
# 210 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/lib/gcc/riscv32-unknown-elf/15.1.0/include/limits.h" 3 4
# 1 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/limits.h" 1 3 4



# 1 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/newlib.h" 1 3 4
# 10 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/newlib.h" 3 4
# 1 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/_newlib_version.h" 1 3 4
# 11 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/newlib.h" 2 3 4
# 5 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/limits.h" 2 3 4
# 1 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/sys/cdefs.h" 1 3 4
# 45 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/sys/cdefs.h" 3 4
# 1 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/machine/_default_types.h" 1 3 4







# 1 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/sys/features.h" 1 3 4
# 9 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/machine/_default_types.h" 2 3 4
# 41 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/machine/_default_types.h" 3 4
typedef signed char __int8_t;

typedef unsigned char __uint8_t;
# 55 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/machine/_default_types.h" 3 4
typedef short int __int16_t;

typedef short unsigned int __uint16_t;
# 77 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/machine/_default_types.h" 3 4
typedef long int __int32_t;

typedef long unsigned int __uint32_t;
# 103 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/machine/_default_types.h" 3 4
typedef long long int __int64_t;

typedef long long unsigned int __uint64_t;
# 134 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/machine/_default_types.h" 3 4
typedef signed char __int_least8_t;

typedef unsigned char __uint_least8_t;
# 160 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/machine/_default_types.h" 3 4
typedef short int __int_least16_t;

typedef short unsigned int __uint_least16_t;
# 182 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/machine/_default_types.h" 3 4
typedef long int __int_least32_t;

typedef long unsigned int __uint_least32_t;
# 200 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/machine/_default_types.h" 3 4
typedef long long int __int_least64_t;

typedef long long unsigned int __uint_least64_t;
# 214 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/machine/_default_types.h" 3 4
typedef long long int __intmax_t;







typedef long long unsigned int __uintmax_t;







typedef int __intptr_t;

typedef unsigned int __uintptr_t;
# 46 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/sys/cdefs.h" 2 3 4

# 1 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/lib/gcc/riscv32-unknown-elf/15.1.0/include/stddef.h" 1 3 4
# 160 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/lib/gcc/riscv32-unknown-elf/15.1.0/include/stddef.h" 3 4
typedef int ptrdiff_t;
# 229 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/lib/gcc/riscv32-unknown-elf/15.1.0/include/stddef.h" 3 4
typedef unsigned int size_t;
# 344 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/lib/gcc/riscv32-unknown-elf/15.1.0/include/stddef.h" 3 4
typedef int wchar_t;
# 440 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/lib/gcc/riscv32-unknown-elf/15.1.0/include/stddef.h" 3 4
typedef struct {
  long long __max_align_ll __attribute__((__aligned__(__alignof__(long long))));
  long double __max_align_ld __attribute__((__aligned__(__alignof__(long double))));
# 451 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/lib/gcc/riscv32-unknown-elf/15.1.0/include/stddef.h" 3 4
} max_align_t;
# 465 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/lib/gcc/riscv32-unknown-elf/15.1.0/include/stddef.h" 3 4
  typedef __typeof__(nullptr) nullptr_t;
# 48 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/sys/cdefs.h" 2 3 4
# 6 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/limits.h" 2 3 4
# 1 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/sys/syslimits.h" 1 3 4
# 7 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/limits.h" 2 3 4
# 211 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/lib/gcc/riscv32-unknown-elf/15.1.0/include/limits.h" 2 3 4
# 10 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/lib/gcc/riscv32-unknown-elf/15.1.0/include/syslimits.h" 2 3 4
#pragma GCC diagnostic pop
# 35 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/lib/gcc/riscv32-unknown-elf/15.1.0/include/limits.h" 2 3 4
# 34 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/check_config.h" 2




# 1 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/lib/gcc/riscv32-unknown-elf/15.1.0/include/stdint.h" 1 3 4
# 14 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/lib/gcc/riscv32-unknown-elf/15.1.0/include/stdint.h" 3 4
# 1 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/lib/gcc/riscv32-unknown-elf/15.1.0/include/stdint-gcc.h" 1 3 4
# 34 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/lib/gcc/riscv32-unknown-elf/15.1.0/include/stdint-gcc.h" 3 4
typedef signed char int8_t;


typedef short int int16_t;


typedef long int int32_t;


typedef long long int int64_t;


typedef unsigned char uint8_t;


typedef short unsigned int uint16_t;


typedef long unsigned int uint32_t;


typedef long long unsigned int uint64_t;




typedef signed char int_least8_t;
typedef short int int_least16_t;
typedef long int int_least32_t;
typedef long long int int_least64_t;
typedef unsigned char uint_least8_t;
typedef short unsigned int uint_least16_t;
typedef long unsigned int uint_least32_t;
typedef long long unsigned int uint_least64_t;



typedef int int_fast8_t;
typedef int int_fast16_t;
typedef int int_fast32_t;
typedef long long int int_fast64_t;
typedef unsigned int uint_fast8_t;
typedef unsigned int uint_fast16_t;
typedef unsigned int uint_fast32_t;
typedef long long unsigned int uint_fast64_t;




typedef int intptr_t;


typedef unsigned int uintptr_t;




typedef long long int intmax_t;
typedef long long unsigned int uintmax_t;
# 15 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/lib/gcc/riscv32-unknown-elf/15.1.0/include/stdint.h" 2 3 4
# 39 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/check_config.h" 2
# 1146 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/check_config.h"

# 1146 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/check_config.h"
typedef int mbedtls_iso_c_forbids_empty_translation_units;
# 193 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/build_info.h" 2
# 15 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/common.h" 2
# 1 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/alignment.h" 1
# 15 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/alignment.h"
# 1 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/string.h" 1 3
# 10 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/string.h" 3
# 1 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/_ansi.h" 1 3
# 11 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/_ansi.h" 3
# 1 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/sys/config.h" 1 3



# 1 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/machine/ieeefp.h" 1 3
# 5 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/sys/config.h" 2 3
# 12 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/_ansi.h" 2 3
# 11 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/string.h" 2 3
# 1 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/sys/reent.h" 1 3
# 13 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/sys/reent.h" 3
# 1 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/_ansi.h" 1 3
# 14 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/sys/reent.h" 2 3
# 1 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/lib/gcc/riscv32-unknown-elf/15.1.0/include/stddef.h" 1 3 4
# 15 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/sys/reent.h" 2 3

# 1 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/sys/_types.h" 1 3
# 24 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/sys/_types.h" 3
# 1 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/lib/gcc/riscv32-unknown-elf/15.1.0/include/stddef.h" 1 3 4
# 374 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/lib/gcc/riscv32-unknown-elf/15.1.0/include/stddef.h" 3 4

# 374 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/lib/gcc/riscv32-unknown-elf/15.1.0/include/stddef.h" 3 4
typedef unsigned int wint_t;
# 25 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/sys/_types.h" 2 3


# 1 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/machine/_types.h" 1 3
# 28 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/sys/_types.h" 2 3


typedef long __blkcnt_t;



typedef long __blksize_t;



typedef __uint64_t __fsblkcnt_t;



typedef __uint32_t __fsfilcnt_t;



typedef long _off_t;





typedef int __pid_t;



typedef short __dev_t;



typedef unsigned short __uid_t;


typedef unsigned short __gid_t;



typedef __uint32_t __id_t;







typedef unsigned short __ino_t;
# 90 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/sys/_types.h" 3
typedef __uint32_t __mode_t;





__extension__ typedef long long _off64_t;





typedef _off_t __off_t;


typedef _off64_t __loff_t;


typedef long __key_t;







typedef long _fpos_t;
# 131 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/sys/_types.h" 3
typedef unsigned int __size_t;
# 147 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/sys/_types.h" 3
typedef signed int _ssize_t;
# 158 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/sys/_types.h" 3
typedef _ssize_t __ssize_t;



typedef struct
{
  int __count;
  union
  {
    wint_t __wch;
    unsigned char __wchb[4];
  } __value;
} _mbstate_t;




typedef void *_iconv_t;






typedef unsigned long __clock_t;






typedef __int_least64_t __time_t;





typedef unsigned long __clockid_t;


typedef long __daddr_t;



typedef unsigned long __timer_t;


typedef __uint8_t __sa_family_t;



typedef __uint32_t __socklen_t;


typedef int __nl_item;
typedef unsigned short __nlink_t;
typedef long __suseconds_t;
typedef unsigned long __useconds_t;







typedef __builtin_va_list __va_list;
# 17 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/sys/reent.h" 2 3






typedef unsigned long __ULong;
# 35 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/sys/reent.h" 3
# 1 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/sys/lock.h" 1 3
# 11 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/sys/lock.h" 3
typedef int _LOCK_T;
typedef int _LOCK_RECURSIVE_T;
# 36 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/sys/reent.h" 2 3
typedef _LOCK_RECURSIVE_T _flock_t;







struct _reent;

struct __locale_t;






struct _Bigint
{
  struct _Bigint *_next;
  int _k, _maxwds, _sign, _wds;
  __ULong _x[1];
};


struct __tm
{
  int __tm_sec;
  int __tm_min;
  int __tm_hour;
  int __tm_mday;
  int __tm_mon;
  int __tm_year;
  int __tm_wday;
  int __tm_yday;
  int __tm_isdst;
};







struct _on_exit_args {
 void * _fnargs[32];
 void * _dso_handle[32];

 __ULong _fntypes;


 __ULong _is_cxa;
};
# 99 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/sys/reent.h" 3
struct _atexit {
 struct _atexit *_next;
 int _ind;

 void (*_fns[32])(void);
        struct _on_exit_args _on_exit_args;
};
# 116 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/sys/reent.h" 3
struct __sbuf {
 unsigned char *_base;
 int _size;
};
# 153 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/sys/reent.h" 3
struct __sFILE {
  unsigned char *_p;
  int _r;
  int _w;
  short _flags;
  short _file;
  struct __sbuf _bf;
  int _lbfsize;






  void * _cookie;

  _ssize_t (*_read) (struct _reent *, void *,
        char *, int);
  _ssize_t (*_write) (struct _reent *, void *,
         const char *,
         int);
  _fpos_t (*_seek) (struct _reent *, void *, _fpos_t, int);
  int (*_close) (struct _reent *, void *);


  struct __sbuf _ub;
  unsigned char *_up;
  int _ur;


  unsigned char _ubuf[3];
  unsigned char _nbuf[1];


  struct __sbuf _lb;


  int _blksize;
  _off_t _offset;


  struct _reent *_data;



  _flock_t _lock;

  _mbstate_t _mbstate;
  int _flags2;
};
# 270 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/sys/reent.h" 3
typedef struct __sFILE __FILE;



extern __FILE __sf[3];

struct _glue
{
  struct _glue *_next;
  int _niobs;
  __FILE *_iobs;
};

extern struct _glue __sglue;
# 306 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/sys/reent.h" 3
struct _rand48 {
  unsigned short _seed[3];
  unsigned short _mult[3];
  unsigned short _add;




};
# 568 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/sys/reent.h" 3
struct _reent
{
  int _errno;




  __FILE *_stdin, *_stdout, *_stderr;

  int _inc;
  char _emergency[25];




  struct __locale_t *_locale;





  void (*__cleanup) (struct _reent *);


  struct _Bigint *_result;
  int _result_k;
  struct _Bigint *_p5s;
  struct _Bigint **_freelist;


  int _cvtlen;
  char *_cvtbuf;

  union
    {
      struct
        {



          char * _strtok_last;
          char _asctime_buf[26];
          struct __tm _localtime_buf;
          int _gamma_signgam;
          __extension__ unsigned long long _rand_next;
          struct _rand48 _r48;
          _mbstate_t _mblen_state;
          _mbstate_t _mbtowc_state;
          _mbstate_t _wctomb_state;
          char _l64a_buf[8];
          char _signal_buf[24];
          int _getdate_err;
          _mbstate_t _mbrlen_state;
          _mbstate_t _mbrtowc_state;
          _mbstate_t _mbsrtowcs_state;
          _mbstate_t _wcrtomb_state;
          _mbstate_t _wcsrtombs_state;
   int _h_errno;
# 634 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/sys/reent.h" 3
        } _reent;







    } _new;







  void (**_sig_func)(int);
};
# 782 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/sys/reent.h" 3
extern struct _reent *_impure_ptr ;





extern struct _reent _impure_data ;
# 900 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/sys/reent.h" 3
extern struct _atexit *__atexit;
extern struct _atexit __atexit0;

extern void (*__stdio_exit_handler) (void);

void _reclaim_reent (struct _reent *);

extern int _fwalk_sglue (struct _reent *, int (*)(struct _reent *, __FILE *),
    struct _glue *);
# 12 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/string.h" 2 3





# 1 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/lib/gcc/riscv32-unknown-elf/15.1.0/include/stddef.h" 1 3 4
# 18 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/string.h" 2 3


# 1 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/sys/_locale.h" 1 3
# 9 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/sys/_locale.h" 3
struct __locale_t;
typedef struct __locale_t *locale_t;
# 21 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/string.h" 2 3



# 1 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/strings.h" 1 3
# 44 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/strings.h" 3


int bcmp(const void *, const void *, size_t) __attribute__((__pure__));
void bcopy(const void *, void *, size_t);
void bzero(void *, size_t);


void explicit_bzero(void *, size_t);


int ffs(int) __attribute__((__const__));


int ffsl(long) __attribute__((__const__));
int ffsll(long long) __attribute__((__const__));
int fls(int) __attribute__((__const__));
int flsl(long) __attribute__((__const__));
int flsll(long long) __attribute__((__const__));


char *index(const char *, int) __attribute__((__pure__));
char *rindex(const char *, int) __attribute__((__pure__));

int strcasecmp(const char *, const char *) __attribute__((__pure__));
int strncasecmp(const char *, const char *, size_t) __attribute__((__pure__));


int strcasecmp_l (const char *, const char *, locale_t);
int strncasecmp_l (const char *, const char *, size_t, locale_t);


# 25 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/string.h" 2 3




void * memchr (const void *, int, size_t);
int memcmp (const void *, const void *, size_t);
void * memcpy (void *restrict, const void *restrict, size_t);
void * memmove (void *, const void *, size_t);
void * memset (void *, int, size_t);
char *strcat (char *restrict, const char *restrict);
char *strchr (const char *, int);
int strcmp (const char *, const char *);
int strcoll (const char *, const char *);
char *strcpy (char *restrict, const char *restrict);
size_t strcspn (const char *, const char *);
char *strerror (int);
size_t strlen (const char *);
char *strncat (char *restrict, const char *restrict, size_t);
int strncmp (const char *, const char *, size_t);
char *strncpy (char *restrict, const char *restrict, size_t);
char *strpbrk (const char *, const char *);
char *strrchr (const char *, int);
size_t strspn (const char *, const char *);
char *strstr (const char *, const char *);

char *strtok (char *restrict, const char *restrict);

size_t strxfrm (char *restrict, const char *restrict, size_t);


int strcoll_l (const char *, const char *, locale_t);
char *strerror_l (int, locale_t);
size_t strxfrm_l (char *restrict, const char *restrict, size_t, locale_t);


char *strtok_r (char *restrict, const char *restrict, char **restrict);


int timingsafe_bcmp (const void *, const void *, size_t);
int timingsafe_memcmp (const void *, const void *, size_t);


void * memccpy (void *restrict, const void *restrict, int, size_t);
# 76 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/string.h" 3
char *stpcpy (char *restrict, const char *restrict);
char *stpncpy (char *restrict, const char *restrict, size_t);






char *strdup (const char *) __attribute__((__malloc__)) __attribute__((__warn_unused_result__));

char *_strdup_r (struct _reent *, const char *);

char *strndup (const char *, size_t) __attribute__((__malloc__)) __attribute__((__warn_unused_result__));

char *_strndup_r (struct _reent *, const char *, size_t);
# 100 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/string.h" 3
int strerror_r (int, char *, size_t)

             __asm__ ("" "__xpg_strerror_r")

  ;







char * _strerror_r (struct _reent *, int, int, int *);


size_t strlcat (char *, const char *, size_t);
size_t strlcpy (char *, const char *, size_t);


size_t strnlen (const char *, size_t);


char *strsep (char **, const char *);


char *strnstr(const char *, const char *, size_t) __attribute__((__pure__));



char *strlwr (char *);
char *strupr (char *);



char *strsignal (int __signo);
# 175 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/string.h" 3
# 1 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/sys/string.h" 1 3
# 15 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/sys/string.h" 3
static __inline unsigned long __libc_detect_null(unsigned long w)
{
  unsigned long mask = 0x7f7f7f7f;
  if (sizeof (long) == 8)
    mask = ((mask << 16) << 16) | mask;
  return ~(((w & mask) + mask) | w | mask);
}
# 176 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/string.h" 2 3


# 16 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/alignment.h" 2
# 1 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/stdlib.h" 1 3
# 10 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/stdlib.h" 3
# 1 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/machine/ieeefp.h" 1 3
# 11 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/stdlib.h" 2 3





# 1 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/lib/gcc/riscv32-unknown-elf/15.1.0/include/stddef.h" 1 3 4
# 17 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/stdlib.h" 2 3



# 1 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/machine/stdlib.h" 1 3
# 21 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/stdlib.h" 2 3

# 1 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/alloca.h" 1 3
# 23 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/stdlib.h" 2 3
# 33 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/stdlib.h" 3


typedef struct
{
  int quot;
  int rem;
} div_t;

typedef struct
{
  long quot;
  long rem;
} ldiv_t;


typedef struct
{
  long long int quot;
  long long int rem;
} lldiv_t;




typedef int (*__compar_fn_t) (const void *, const void *);







int __locale_mb_cur_max (void);



void abort (void) __attribute__ ((__noreturn__));
int abs (int);

__uint32_t arc4random (void);
__uint32_t arc4random_uniform (__uint32_t);
void arc4random_buf (void *, size_t);

int atexit (void (*__func)(void));
double atof (const char *__nptr);

float atoff (const char *__nptr);

int atoi (const char *__nptr);
int _atoi_r (struct _reent *, const char *__nptr);
long atol (const char *__nptr);
long _atol_r (struct _reent *, const char *__nptr);
void * bsearch (const void *__key,
         const void *__base,
         size_t __nmemb,
         size_t __size,
         __compar_fn_t _compar);
void *calloc(size_t, size_t) __attribute__((__malloc__)) __attribute__((__warn_unused_result__))
      __attribute__((__alloc_size__(1, 2))) ;
div_t div (int __numer, int __denom);
void exit (int __status) __attribute__ ((__noreturn__));
void free (void *) ;
char * getenv (const char *__string);
char * _getenv_r (struct _reent *, const char *__string);



char * _findenv (const char *, int *);
char * _findenv_r (struct _reent *, const char *, int *);

extern char *suboptarg;
int getsubopt (char **, char * const *, char **);

long labs (long);
ldiv_t ldiv (long __numer, long __denom);
void *malloc(size_t) __attribute__((__malloc__)) __attribute__((__warn_unused_result__)) __attribute__((__alloc_size__(1))) ;
int mblen (const char *, size_t);
int _mblen_r (struct _reent *, const char *, size_t, _mbstate_t *);
int mbtowc (wchar_t *restrict, const char *restrict, size_t);
int _mbtowc_r (struct _reent *, wchar_t *restrict, const char *restrict, size_t, _mbstate_t *);
int wctomb (char *, wchar_t);
int _wctomb_r (struct _reent *, char *, wchar_t, _mbstate_t *);
size_t mbstowcs (wchar_t *restrict, const char *restrict, size_t);
size_t _mbstowcs_r (struct _reent *, wchar_t *restrict, const char *restrict, size_t, _mbstate_t *);
size_t wcstombs (char *restrict, const wchar_t *restrict, size_t);
size_t _wcstombs_r (struct _reent *, char *restrict, const wchar_t *restrict, size_t, _mbstate_t *);


char * mkdtemp (char *);






int mkstemp (char *);


int mkstemps (char *, int);


char * mktemp (char *) __attribute__ ((__deprecated__("the use of `mktemp' is dangerous; use `mkstemp' instead")));


char * _mkdtemp_r (struct _reent *, char *);
int _mkostemp_r (struct _reent *, char *, int);
int _mkostemps_r (struct _reent *, char *, int, int);
int _mkstemp_r (struct _reent *, char *);
int _mkstemps_r (struct _reent *, char *, int);
char * _mktemp_r (struct _reent *, char *) __attribute__ ((__deprecated__("the use of `mktemp' is dangerous; use `mkstemp' instead")));
void qsort (void *__base, size_t __nmemb, size_t __size, __compar_fn_t _compar);
int rand (void);
void *realloc(void *, size_t) __attribute__((__warn_unused_result__)) __attribute__((__alloc_size__(2))) ;

void *reallocarray(void *, size_t, size_t) __attribute__((__warn_unused_result__)) __attribute__((__alloc_size__(2, 3)));
void *reallocf(void *, size_t) __attribute__((__warn_unused_result__)) __attribute__((__alloc_size__(2)));


char * realpath (const char *restrict path, char *restrict resolved_path);


int rpmatch (const char *response);




void srand (unsigned __seed);
double strtod (const char *restrict __n, char **restrict __end_PTR);
double _strtod_r (struct _reent *,const char *restrict __n, char **restrict __end_PTR);

float strtof (const char *restrict __n, char **restrict __end_PTR);







long strtol (const char *restrict __n, char **restrict __end_PTR, int __base);
long _strtol_r (struct _reent *,const char *restrict __n, char **restrict __end_PTR, int __base);
unsigned long strtoul (const char *restrict __n, char **restrict __end_PTR, int __base);
unsigned long _strtoul_r (struct _reent *,const char *restrict __n, char **restrict __end_PTR, int __base);
# 191 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/stdlib.h" 3
int system (const char *__string);


long a64l (const char *__input);
char * l64a (long __input);
char * _l64a_r (struct _reent *,long __input);


int on_exit (void (*__func)(int, void *),void *__arg);


void _Exit (int __status) __attribute__ ((__noreturn__));


int putenv (char *__string);

int _putenv_r (struct _reent *, char *__string);
void * _reallocf_r (struct _reent *, void *, size_t);

int setenv (const char *__string, const char *__value, int __overwrite);

int _setenv_r (struct _reent *, const char *__string, const char *__value, int __overwrite);
# 224 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/stdlib.h" 3
char * __itoa (int, char *, int);
char * __utoa (unsigned, char *, int);

char * itoa (int, char *, int);
char * utoa (unsigned, char *, int);


int rand_r (unsigned *__seed);



double drand48 (void);
double _drand48_r (struct _reent *);
double erand48 (unsigned short [3]);
double _erand48_r (struct _reent *, unsigned short [3]);
long jrand48 (unsigned short [3]);
long _jrand48_r (struct _reent *, unsigned short [3]);
void lcong48 (unsigned short [7]);
void _lcong48_r (struct _reent *, unsigned short [7]);
long lrand48 (void);
long _lrand48_r (struct _reent *);
long mrand48 (void);
long _mrand48_r (struct _reent *);
long nrand48 (unsigned short [3]);
long _nrand48_r (struct _reent *, unsigned short [3]);
unsigned short *
       seed48 (unsigned short [3]);
unsigned short *
       _seed48_r (struct _reent *, unsigned short [3]);
void srand48 (long);
void _srand48_r (struct _reent *, long);


char * initstate (unsigned, char *, size_t);
long random (void);
char * setstate (char *);
void srandom (unsigned);


long long atoll (const char *__nptr);

long long _atoll_r (struct _reent *, const char *__nptr);

long long llabs (long long);
lldiv_t lldiv (long long __numer, long long __denom);
long long strtoll (const char *restrict __n, char **restrict __end_PTR, int __base);

long long _strtoll_r (struct _reent *, const char *restrict __n, char **restrict __end_PTR, int __base);

unsigned long long strtoull (const char *restrict __n, char **restrict __end_PTR, int __base);

unsigned long long _strtoull_r (struct _reent *, const char *restrict __n, char **restrict __end_PTR, int __base);



void cfree (void *);


int unsetenv (const char *__string);

int _unsetenv_r (struct _reent *, const char *__string);



int posix_memalign (void **, size_t, size_t) __attribute__((__nonnull__ (1)))
     __attribute__((__warn_unused_result__));


char * _dtoa_r (struct _reent *, double, int, int, int *, int*, char**);

void * _malloc_r (struct _reent *, size_t) ;
void * _calloc_r (struct _reent *, size_t, size_t) ;
void _free_r (struct _reent *, void *) ;
void * _realloc_r (struct _reent *, void *, size_t) ;
void _mstats_r (struct _reent *, char *);

int _system_r (struct _reent *, const char *);

void __eprintf (const char *, const char *, unsigned int, const char *);
# 312 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/stdlib.h" 3
void qsort_r (void *__base, size_t __nmemb, size_t __size, void *__thunk, int (*_compar)(void *, const void *, const void *))
             __asm__ ("" "__bsd_qsort_r");
# 322 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/stdlib.h" 3
extern long double _strtold_r (struct _reent *, const char *restrict, char **restrict);

extern long double strtold (const char *restrict, char **restrict);







void * aligned_alloc(size_t, size_t) __attribute__((__malloc__)) __attribute__((__alloc_align__(1)))
     __attribute__((__alloc_size__(2))) __attribute__((__warn_unused_result__));
int at_quick_exit(void (*)(void));
_Noreturn void
 quick_exit(int);



# 17 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/alignment.h" 2
# 86 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/alignment.h"

# 86 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/alignment.h"
typedef struct {
    uint16_t x;
} __attribute__((packed)) mbedtls_uint16_unaligned_t;
typedef struct {
    uint32_t x;
} __attribute__((packed)) mbedtls_uint32_unaligned_t;
typedef struct {
    uint64_t x;
} __attribute__((packed)) mbedtls_uint64_unaligned_t;
# 113 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/alignment.h"
__attribute__((always_inline))

static inline uint16_t mbedtls_get_unaligned_uint16(const void *p)
{
    uint16_t r;




    mbedtls_uint16_unaligned_t *p16 = (mbedtls_uint16_unaligned_t *) p;
    r = p16->x;



    return r;
}
# 140 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/alignment.h"
__attribute__((always_inline))

static inline void mbedtls_put_unaligned_uint16(void *p, uint16_t x)
{




    mbedtls_uint16_unaligned_t *p16 = (mbedtls_uint16_unaligned_t *) p;
    p16->x = x;



}
# 165 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/alignment.h"
__attribute__((always_inline))

static inline uint32_t mbedtls_get_unaligned_uint32(const void *p)
{
    uint32_t r;




    mbedtls_uint32_unaligned_t *p32 = (mbedtls_uint32_unaligned_t *) p;
    r = p32->x;



    return r;
}
# 192 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/alignment.h"
__attribute__((always_inline))

static inline void mbedtls_put_unaligned_uint32(void *p, uint32_t x)
{




    mbedtls_uint32_unaligned_t *p32 = (mbedtls_uint32_unaligned_t *) p;
    p32->x = x;



}
# 217 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/alignment.h"
__attribute__((always_inline))

static inline uint64_t mbedtls_get_unaligned_uint64(const void *p)
{
    uint64_t r;




    mbedtls_uint64_unaligned_t *p64 = (mbedtls_uint64_unaligned_t *) p;
    r = p64->x;



    return r;
}
# 244 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/alignment.h"
__attribute__((always_inline))

static inline void mbedtls_put_unaligned_uint64(void *p, uint64_t x)
{




    mbedtls_uint64_unaligned_t *p64 = (mbedtls_uint64_unaligned_t *) p;
    p64->x = x;



}
# 16 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/common.h" 2

# 1 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/assert.h" 1 3
# 39 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/assert.h" 3

# 39 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/assert.h" 3
void __assert (const char *, int, const char *)
     __attribute__ ((__noreturn__));
void __assert_func (const char *, int, const char *, const char *)
     __attribute__ ((__noreturn__));
# 18 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/common.h" 2
# 1 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/lib/gcc/riscv32-unknown-elf/15.1.0/include/stddef.h" 1 3 4
# 19 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/common.h" 2

# 1 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/lib/gcc/riscv32-unknown-elf/15.1.0/include/stddef.h" 1 3 4
# 21 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/common.h" 2
# 121 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/common.h"

# 121 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/common.h"
void mbedtls_zeroize_and_free(void *buf, size_t len);
# 138 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/common.h"
static inline unsigned char *mbedtls_buffer_offset(
    unsigned char *p, size_t n)
{
    return p == 
# 141 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/common.h" 3 4
               ((void *)0) 
# 141 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/common.h"
                    ? 
# 141 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/common.h" 3 4
                      ((void *)0) 
# 141 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/common.h"
                           : p + n;
}
# 155 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/common.h"
static inline const unsigned char *mbedtls_buffer_offset_const(
    const unsigned char *p, size_t n)
{
    return p == 
# 158 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/common.h" 3 4
               ((void *)0) 
# 158 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/common.h"
                    ? 
# 158 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/common.h" 3 4
                      ((void *)0) 
# 158 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/common.h"
                           : p + n;
}





__attribute__((always_inline))
# 186 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/common.h"
static inline void mbedtls_xor(unsigned char *r,
                               const unsigned char *a,
                               const unsigned char *b,
                               size_t n)
{
    size_t i = 0;
# 234 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/common.h"
    for (; i < n; i++) {
        r[i] = a[i] ^ b[i];
    }
}






__attribute__((always_inline))
# 268 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/common.h"
static inline void mbedtls_xor_no_simd(unsigned char *r,
                                       const unsigned char *a,
                                       const unsigned char *b,
                                       size_t n)
{
    size_t i = 0;
# 302 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/common.h"
    for (; i < n; i++) {
        r[i] = a[i] ^ b[i];
    }
}
# 10 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 2
# 1 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_core_common.h" 1
# 29 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_core_common.h"
static inline unsigned char *psa_crypto_buffer_offset(
    unsigned char *p, size_t n)
{
    return p == 
# 32 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_core_common.h" 3 4
               ((void *)0) 
# 32 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_core_common.h"
                    ? 
# 32 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_core_common.h" 3 4
                      ((void *)0) 
# 32 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_core_common.h"
                           : p + n;
}
# 46 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_core_common.h"
static inline const unsigned char *psa_crypto_buffer_offset_const(
    const unsigned char *p, size_t n)
{
    return p == 
# 49 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_core_common.h" 3 4
               ((void *)0) 
# 49 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_core_common.h"
                    ? 
# 49 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_core_common.h" 3 4
                      ((void *)0) 
# 49 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_core_common.h"
                           : p + n;
}
# 11 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 2




# 1 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/check_crypto_config.h" 1
# 16 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 2


# 1 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto.h" 1
# 16 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto.h"
# 1 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_platform.h" 1
# 23 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_platform.h"
# 1 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/private_access.h" 1
# 24 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_platform.h" 2
# 32 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_platform.h"
# 1 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/build_info.h" 1
# 33 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_platform.h" 2
# 17 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto.h" 2


# 1 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/lib/gcc/riscv32-unknown-elf/15.1.0/include/stddef.h" 1 3 4
# 20 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto.h" 2
# 40 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto.h"
# 1 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_types.h" 1
# 59 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_types.h"
typedef int32_t psa_status_t;
# 78 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_types.h"
typedef uint16_t psa_key_type_t;
# 97 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_types.h"
typedef uint8_t psa_ecc_family_t;
# 116 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_types.h"
typedef uint8_t psa_dh_family_t;
# 134 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_types.h"
typedef uint32_t psa_algorithm_t;
# 183 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_types.h"
typedef uint32_t psa_key_lifetime_t;
# 219 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_types.h"
typedef uint8_t psa_key_persistence_t;
# 260 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_types.h"
typedef uint32_t psa_key_location_t;
# 275 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_types.h"
typedef uint32_t psa_key_id_t;
# 292 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_types.h"
typedef psa_key_id_t mbedtls_svc_key_id_t;
# 323 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_types.h"
typedef uint32_t psa_key_usage_t;
# 432 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_types.h"
typedef struct psa_key_attributes_s psa_key_attributes_t;
# 456 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_types.h"
typedef uint16_t psa_key_derivation_step_t;
# 480 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_types.h"
typedef struct psa_custom_key_parameters_s psa_custom_key_parameters_t;
# 504 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_types.h"
typedef struct psa_key_production_parameters_s psa_key_production_parameters_t;
# 41 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto.h" 2
# 60 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto.h"
# 1 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_values.h" 1
# 2447 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_values.h"
static inline mbedtls_svc_key_id_t mbedtls_svc_key_id_make(
    unsigned int unused, psa_key_id_t key_id)
{
    (void) unused;

    return key_id;
}
# 2462 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_values.h"
static inline int mbedtls_svc_key_id_equal(mbedtls_svc_key_id_t id1,
                                           mbedtls_svc_key_id_t id2)
{
    return id1 == id2;
}







static inline int mbedtls_svc_key_id_is_null(mbedtls_svc_key_id_t key)
{
    return key == 0;
}
# 61 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto.h" 2



# 1 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_sizes.h" 1
# 65 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto.h" 2






# 1 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_struct.h" 1
# 68 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_struct.h"
# 1 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_driver_contexts_primitives.h" 1
# 24 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_driver_contexts_primitives.h"
# 1 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_driver_common.h" 1
# 25 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_driver_common.h"
# 1 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/lib/gcc/riscv32-unknown-elf/15.1.0/include/stddef.h" 1 3 4
# 26 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_driver_common.h" 2
# 35 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_driver_common.h"
# 1 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_sizes.h" 1
# 36 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_driver_common.h" 2



typedef enum {
    PSA_CRYPTO_DRIVER_DECRYPT,
    PSA_CRYPTO_DRIVER_ENCRYPT
} psa_encrypt_or_decrypt_t;
# 25 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_driver_contexts_primitives.h" 2


# 1 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_builtin_primitives.h" 1
# 31 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_builtin_primitives.h"
# 1 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/md5.h" 1
# 20 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/md5.h"
# 1 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/lib/gcc/riscv32-unknown-elf/15.1.0/include/stddef.h" 1 3 4
# 21 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/md5.h" 2
# 39 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/md5.h"
typedef struct mbedtls_md5_context {
    uint32_t total[2];
    uint32_t state[4];
    unsigned char buffer[64];
}
mbedtls_md5_context;
# 60 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/md5.h"
void mbedtls_md5_init(mbedtls_md5_context *ctx);
# 72 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/md5.h"
void mbedtls_md5_free(mbedtls_md5_context *ctx);
# 85 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/md5.h"
void mbedtls_md5_clone(mbedtls_md5_context *dst,
                       const mbedtls_md5_context *src);
# 100 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/md5.h"
int mbedtls_md5_starts(mbedtls_md5_context *ctx);
# 116 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/md5.h"
int mbedtls_md5_update(mbedtls_md5_context *ctx,
                       const unsigned char *input,
                       size_t ilen);
# 133 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/md5.h"
int mbedtls_md5_finish(mbedtls_md5_context *ctx,
                       unsigned char output[16]);
# 149 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/md5.h"
int mbedtls_internal_md5_process(mbedtls_md5_context *ctx,
                                 const unsigned char data[64]);
# 166 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/md5.h"
int mbedtls_md5(const unsigned char *input,
                size_t ilen,
                unsigned char output[16]);
# 182 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/md5.h"
int mbedtls_md5_self_test(int verbose);
# 32 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_builtin_primitives.h" 2
# 1 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ripemd160.h" 1
# 16 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ripemd160.h"
# 1 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/lib/gcc/riscv32-unknown-elf/15.1.0/include/stddef.h" 1 3 4
# 17 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ripemd160.h" 2
# 30 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ripemd160.h"
typedef struct mbedtls_ripemd160_context {
    uint32_t total[2];
    uint32_t state[5];
    unsigned char buffer[64];
}
mbedtls_ripemd160_context;
# 46 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ripemd160.h"
void mbedtls_ripemd160_init(mbedtls_ripemd160_context *ctx);






void mbedtls_ripemd160_free(mbedtls_ripemd160_context *ctx);







void mbedtls_ripemd160_clone(mbedtls_ripemd160_context *dst,
                             const mbedtls_ripemd160_context *src);
# 71 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ripemd160.h"
int mbedtls_ripemd160_starts(mbedtls_ripemd160_context *ctx);
# 82 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ripemd160.h"
int mbedtls_ripemd160_update(mbedtls_ripemd160_context *ctx,
                             const unsigned char *input,
                             size_t ilen);
# 94 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ripemd160.h"
int mbedtls_ripemd160_finish(mbedtls_ripemd160_context *ctx,
                             unsigned char output[20]);
# 105 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ripemd160.h"
int mbedtls_internal_ripemd160_process(mbedtls_ripemd160_context *ctx,
                                       const unsigned char data[64]);
# 117 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ripemd160.h"
int mbedtls_ripemd160(const unsigned char *input,
                      size_t ilen,
                      unsigned char output[20]);
# 128 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ripemd160.h"
int mbedtls_ripemd160_self_test(int verbose);
# 33 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_builtin_primitives.h" 2
# 1 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/sha1.h" 1
# 23 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/sha1.h"
# 1 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/lib/gcc/riscv32-unknown-elf/15.1.0/include/stddef.h" 1 3 4
# 24 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/sha1.h" 2
# 45 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/sha1.h"
typedef struct mbedtls_sha1_context {
    uint32_t total[2];
    uint32_t state[5];
    unsigned char buffer[64];
}
mbedtls_sha1_context;
# 67 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/sha1.h"
void mbedtls_sha1_init(mbedtls_sha1_context *ctx);
# 82 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/sha1.h"
void mbedtls_sha1_free(mbedtls_sha1_context *ctx);
# 95 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/sha1.h"
void mbedtls_sha1_clone(mbedtls_sha1_context *dst,
                        const mbedtls_sha1_context *src);
# 111 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/sha1.h"
int mbedtls_sha1_starts(mbedtls_sha1_context *ctx);
# 130 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/sha1.h"
int mbedtls_sha1_update(mbedtls_sha1_context *ctx,
                        const unsigned char *input,
                        size_t ilen);
# 150 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/sha1.h"
int mbedtls_sha1_finish(mbedtls_sha1_context *ctx,
                        unsigned char output[20]);
# 168 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/sha1.h"
int mbedtls_internal_sha1_process(mbedtls_sha1_context *ctx,
                                  const unsigned char data[64]);
# 194 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/sha1.h"
int mbedtls_sha1(const unsigned char *input,
                 size_t ilen,
                 unsigned char output[20]);
# 211 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/sha1.h"
int mbedtls_sha1_self_test(int verbose);
# 34 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_builtin_primitives.h" 2
# 1 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/sha256.h" 1
# 19 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/sha256.h"
# 1 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/lib/gcc/riscv32-unknown-elf/15.1.0/include/stddef.h" 1 3 4
# 20 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/sha256.h" 2
# 40 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/sha256.h"
typedef struct mbedtls_sha256_context {
    unsigned char buffer[64];
    uint32_t total[2];
    uint32_t state[8];

    int is224;


}
mbedtls_sha256_context;
# 60 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/sha256.h"
void mbedtls_sha256_init(mbedtls_sha256_context *ctx);
# 69 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/sha256.h"
void mbedtls_sha256_free(mbedtls_sha256_context *ctx);







void mbedtls_sha256_clone(mbedtls_sha256_context *dst,
                          const mbedtls_sha256_context *src);
# 95 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/sha256.h"
int mbedtls_sha256_starts(mbedtls_sha256_context *ctx, int is224);
# 110 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/sha256.h"
int mbedtls_sha256_update(mbedtls_sha256_context *ctx,
                          const unsigned char *input,
                          size_t ilen);
# 127 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/sha256.h"
int mbedtls_sha256_finish(mbedtls_sha256_context *ctx,
                          unsigned char *output);
# 142 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/sha256.h"
int mbedtls_internal_sha256_process(mbedtls_sha256_context *ctx,
                                    const unsigned char data[64]);
# 167 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/sha256.h"
int mbedtls_sha256(const unsigned char *input,
                   size_t ilen,
                   unsigned char *output,
                   int is224);
# 181 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/sha256.h"
int mbedtls_sha224_self_test(int verbose);
# 191 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/sha256.h"
int mbedtls_sha256_self_test(int verbose);
# 35 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_builtin_primitives.h" 2
# 1 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/sha512.h" 1
# 18 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/sha512.h"
# 1 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/lib/gcc/riscv32-unknown-elf/15.1.0/include/stddef.h" 1 3 4
# 19 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/sha512.h" 2
# 39 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/sha512.h"
typedef struct mbedtls_sha512_context {
    uint64_t total[2];
    uint64_t state[8];
    unsigned char buffer[128];

    int is384;


}
mbedtls_sha512_context;
# 60 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/sha512.h"
void mbedtls_sha512_init(mbedtls_sha512_context *ctx);
# 70 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/sha512.h"
void mbedtls_sha512_free(mbedtls_sha512_context *ctx);







void mbedtls_sha512_clone(mbedtls_sha512_context *dst,
                          const mbedtls_sha512_context *src);
# 96 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/sha512.h"
int mbedtls_sha512_starts(mbedtls_sha512_context *ctx, int is384);
# 111 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/sha512.h"
int mbedtls_sha512_update(mbedtls_sha512_context *ctx,
                          const unsigned char *input,
                          size_t ilen);
# 128 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/sha512.h"
int mbedtls_sha512_finish(mbedtls_sha512_context *ctx,
                          unsigned char *output);
# 143 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/sha512.h"
int mbedtls_internal_sha512_process(mbedtls_sha512_context *ctx,
                                    const unsigned char data[128]);
# 175 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/sha512.h"
int mbedtls_sha512(const unsigned char *input,
                   size_t ilen,
                   unsigned char *output,
                   int is384);
# 189 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/sha512.h"
int mbedtls_sha384_self_test(int verbose);
# 199 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/sha512.h"
int mbedtls_sha512_self_test(int verbose);
# 36 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_builtin_primitives.h" 2
# 1 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/sha3.h" 1
# 21 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/sha3.h"
# 1 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/lib/gcc/riscv32-unknown-elf/15.1.0/include/stddef.h" 1 3 4
# 22 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/sha3.h" 2
# 37 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/sha3.h"
typedef enum {
    MBEDTLS_SHA3_NONE = 0,
    MBEDTLS_SHA3_224,
    MBEDTLS_SHA3_256,
    MBEDTLS_SHA3_384,
    MBEDTLS_SHA3_512,
} mbedtls_sha3_id;






typedef struct {
    uint64_t state[25];
    uint32_t index;
    uint16_t olen;
    uint16_t max_block_size;
}
mbedtls_sha3_context;






void mbedtls_sha3_init(mbedtls_sha3_context *ctx);
# 72 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/sha3.h"
void mbedtls_sha3_free(mbedtls_sha3_context *ctx);







void mbedtls_sha3_clone(mbedtls_sha3_context *dst,
                        const mbedtls_sha3_context *src);
# 93 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/sha3.h"
int mbedtls_sha3_starts(mbedtls_sha3_context *ctx, mbedtls_sha3_id id);
# 108 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/sha3.h"
int mbedtls_sha3_update(mbedtls_sha3_context *ctx,
                        const uint8_t *input,
                        size_t ilen);
# 127 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/sha3.h"
int mbedtls_sha3_finish(mbedtls_sha3_context *ctx,
                        uint8_t *output, size_t olen);
# 153 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/sha3.h"
int mbedtls_sha3(mbedtls_sha3_id id, const uint8_t *input,
                 size_t ilen,
                 uint8_t *output,
                 size_t olen);
# 165 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/sha3.h"
int mbedtls_sha3_self_test(int verbose);
# 37 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_builtin_primitives.h" 2
# 52 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_builtin_primitives.h"
typedef struct {
    psa_algorithm_t alg;
    union {
        unsigned dummy;

        mbedtls_md5_context md5;


        mbedtls_ripemd160_context ripemd160;


        mbedtls_sha1_context sha1;



        mbedtls_sha256_context sha256;



        mbedtls_sha512_context sha512;





        mbedtls_sha3_context sha3;

    } ctx;
} mbedtls_psa_hash_operation_t;







# 1 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/cipher.h" 1
# 21 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/cipher.h"
# 1 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/lib/gcc/riscv32-unknown-elf/15.1.0/include/stddef.h" 1 3 4
# 22 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/cipher.h" 2
# 1 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/platform_util.h" 1
# 16 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/platform_util.h"
# 1 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/lib/gcc/riscv32-unknown-elf/15.1.0/include/stddef.h" 1 3 4
# 17 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/platform_util.h" 2
# 159 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/platform_util.h"
void mbedtls_platform_zeroize(void *buf, size_t len);
# 209 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/platform_util.h"
typedef int mbedtls_f_rng_t(void *p_rng,
                            unsigned char *output, size_t output_size);
# 23 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/cipher.h" 2
# 66 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/cipher.h"
typedef enum {
    MBEDTLS_CIPHER_ID_NONE = 0,
    MBEDTLS_CIPHER_ID_NULL,
    MBEDTLS_CIPHER_ID_AES,
    MBEDTLS_CIPHER_ID_DES,
    MBEDTLS_CIPHER_ID_3DES,
    MBEDTLS_CIPHER_ID_CAMELLIA,
    MBEDTLS_CIPHER_ID_ARIA,
    MBEDTLS_CIPHER_ID_CHACHA20,
} mbedtls_cipher_id_t;
# 84 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/cipher.h"
typedef enum {
    MBEDTLS_CIPHER_NONE = 0,
    MBEDTLS_CIPHER_NULL,
    MBEDTLS_CIPHER_AES_128_ECB,
    MBEDTLS_CIPHER_AES_192_ECB,
    MBEDTLS_CIPHER_AES_256_ECB,
    MBEDTLS_CIPHER_AES_128_CBC,
    MBEDTLS_CIPHER_AES_192_CBC,
    MBEDTLS_CIPHER_AES_256_CBC,
    MBEDTLS_CIPHER_AES_128_CFB128,
    MBEDTLS_CIPHER_AES_192_CFB128,
    MBEDTLS_CIPHER_AES_256_CFB128,
    MBEDTLS_CIPHER_AES_128_CTR,
    MBEDTLS_CIPHER_AES_192_CTR,
    MBEDTLS_CIPHER_AES_256_CTR,
    MBEDTLS_CIPHER_AES_128_GCM,
    MBEDTLS_CIPHER_AES_192_GCM,
    MBEDTLS_CIPHER_AES_256_GCM,
    MBEDTLS_CIPHER_CAMELLIA_128_ECB,
    MBEDTLS_CIPHER_CAMELLIA_192_ECB,
    MBEDTLS_CIPHER_CAMELLIA_256_ECB,
    MBEDTLS_CIPHER_CAMELLIA_128_CBC,
    MBEDTLS_CIPHER_CAMELLIA_192_CBC,
    MBEDTLS_CIPHER_CAMELLIA_256_CBC,
    MBEDTLS_CIPHER_CAMELLIA_128_CFB128,
    MBEDTLS_CIPHER_CAMELLIA_192_CFB128,
    MBEDTLS_CIPHER_CAMELLIA_256_CFB128,
    MBEDTLS_CIPHER_CAMELLIA_128_CTR,
    MBEDTLS_CIPHER_CAMELLIA_192_CTR,
    MBEDTLS_CIPHER_CAMELLIA_256_CTR,
    MBEDTLS_CIPHER_CAMELLIA_128_GCM,
    MBEDTLS_CIPHER_CAMELLIA_192_GCM,
    MBEDTLS_CIPHER_CAMELLIA_256_GCM,
    MBEDTLS_CIPHER_DES_ECB,
    MBEDTLS_CIPHER_DES_CBC,
    MBEDTLS_CIPHER_DES_EDE_ECB,
    MBEDTLS_CIPHER_DES_EDE_CBC,
    MBEDTLS_CIPHER_DES_EDE3_ECB,
    MBEDTLS_CIPHER_DES_EDE3_CBC,
    MBEDTLS_CIPHER_AES_128_CCM,
    MBEDTLS_CIPHER_AES_192_CCM,
    MBEDTLS_CIPHER_AES_256_CCM,
    MBEDTLS_CIPHER_AES_128_CCM_STAR_NO_TAG,
    MBEDTLS_CIPHER_AES_192_CCM_STAR_NO_TAG,
    MBEDTLS_CIPHER_AES_256_CCM_STAR_NO_TAG,
    MBEDTLS_CIPHER_CAMELLIA_128_CCM,
    MBEDTLS_CIPHER_CAMELLIA_192_CCM,
    MBEDTLS_CIPHER_CAMELLIA_256_CCM,
    MBEDTLS_CIPHER_CAMELLIA_128_CCM_STAR_NO_TAG,
    MBEDTLS_CIPHER_CAMELLIA_192_CCM_STAR_NO_TAG,
    MBEDTLS_CIPHER_CAMELLIA_256_CCM_STAR_NO_TAG,
    MBEDTLS_CIPHER_ARIA_128_ECB,
    MBEDTLS_CIPHER_ARIA_192_ECB,
    MBEDTLS_CIPHER_ARIA_256_ECB,
    MBEDTLS_CIPHER_ARIA_128_CBC,
    MBEDTLS_CIPHER_ARIA_192_CBC,
    MBEDTLS_CIPHER_ARIA_256_CBC,
    MBEDTLS_CIPHER_ARIA_128_CFB128,
    MBEDTLS_CIPHER_ARIA_192_CFB128,
    MBEDTLS_CIPHER_ARIA_256_CFB128,
    MBEDTLS_CIPHER_ARIA_128_CTR,
    MBEDTLS_CIPHER_ARIA_192_CTR,
    MBEDTLS_CIPHER_ARIA_256_CTR,
    MBEDTLS_CIPHER_ARIA_128_GCM,
    MBEDTLS_CIPHER_ARIA_192_GCM,
    MBEDTLS_CIPHER_ARIA_256_GCM,
    MBEDTLS_CIPHER_ARIA_128_CCM,
    MBEDTLS_CIPHER_ARIA_192_CCM,
    MBEDTLS_CIPHER_ARIA_256_CCM,
    MBEDTLS_CIPHER_ARIA_128_CCM_STAR_NO_TAG,
    MBEDTLS_CIPHER_ARIA_192_CCM_STAR_NO_TAG,
    MBEDTLS_CIPHER_ARIA_256_CCM_STAR_NO_TAG,
    MBEDTLS_CIPHER_AES_128_OFB,
    MBEDTLS_CIPHER_AES_192_OFB,
    MBEDTLS_CIPHER_AES_256_OFB,
    MBEDTLS_CIPHER_AES_128_XTS,
    MBEDTLS_CIPHER_AES_256_XTS,
    MBEDTLS_CIPHER_CHACHA20,
    MBEDTLS_CIPHER_CHACHA20_POLY1305,
    MBEDTLS_CIPHER_AES_128_KW,
    MBEDTLS_CIPHER_AES_192_KW,
    MBEDTLS_CIPHER_AES_256_KW,
    MBEDTLS_CIPHER_AES_128_KWP,
    MBEDTLS_CIPHER_AES_192_KWP,
    MBEDTLS_CIPHER_AES_256_KWP,
} mbedtls_cipher_type_t;


typedef enum {
    MBEDTLS_MODE_NONE = 0,
    MBEDTLS_MODE_ECB,
    MBEDTLS_MODE_CBC,
    MBEDTLS_MODE_CFB,
    MBEDTLS_MODE_OFB,
    MBEDTLS_MODE_CTR,
    MBEDTLS_MODE_GCM,
    MBEDTLS_MODE_STREAM,
    MBEDTLS_MODE_CCM,
    MBEDTLS_MODE_CCM_STAR_NO_TAG,
    MBEDTLS_MODE_XTS,
    MBEDTLS_MODE_CHACHAPOLY,
    MBEDTLS_MODE_KW,
    MBEDTLS_MODE_KWP,
} mbedtls_cipher_mode_t;


typedef enum {
    MBEDTLS_PADDING_PKCS7 = 0,
    MBEDTLS_PADDING_ONE_AND_ZEROS,
    MBEDTLS_PADDING_ZEROS_AND_LEN,
    MBEDTLS_PADDING_ZEROS,
    MBEDTLS_PADDING_NONE,
} mbedtls_cipher_padding_t;


typedef enum {
    MBEDTLS_OPERATION_NONE = -1,
    MBEDTLS_DECRYPT = 0,
    MBEDTLS_ENCRYPT,
} mbedtls_operation_t;

enum {

    MBEDTLS_KEY_LENGTH_NONE = 0,

    MBEDTLS_KEY_LENGTH_DES = 64,

    MBEDTLS_KEY_LENGTH_DES_EDE = 128,

    MBEDTLS_KEY_LENGTH_DES_EDE3 = 192,
};
# 244 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/cipher.h"
typedef struct mbedtls_cipher_base_t mbedtls_cipher_base_t;




typedef struct mbedtls_cmac_context_t mbedtls_cmac_context_t;
# 266 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/cipher.h"
typedef struct mbedtls_cipher_info_t {

    const char *name;


    unsigned int block_size : 5;





    unsigned int iv_size : 3;





    unsigned int key_bitlen : 4;




    unsigned int mode : 4;







    unsigned int type : 8;





    unsigned int flags : 2;


    unsigned int base_idx : 5;

} mbedtls_cipher_info_t;
# 316 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/cipher.h"
typedef struct mbedtls_cipher_context_t {

    const mbedtls_cipher_info_t *cipher_info;


    int key_bitlen;




    mbedtls_operation_t operation;





    void(*add_padding)(unsigned char *output, size_t olen,
                                        size_t data_len);




    int(*get_padding)(unsigned char *input, size_t ilen,
                                       size_t *data_len,
                                       size_t *invalid_padding);



    unsigned char unprocessed_data[16];


    size_t unprocessed_len;



    unsigned char iv[16];


    size_t iv_size;


    void *cipher_ctx;



    mbedtls_cmac_context_t *cmac_ctx;
# 375 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/cipher.h"
} mbedtls_cipher_context_t;
# 390 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/cipher.h"
const int *mbedtls_cipher_list(void);
# 403 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/cipher.h"
const mbedtls_cipher_info_t *mbedtls_cipher_info_from_string(const char *cipher_name);
# 415 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/cipher.h"
const mbedtls_cipher_info_t *mbedtls_cipher_info_from_type(const mbedtls_cipher_type_t cipher_type);
# 431 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/cipher.h"
const mbedtls_cipher_info_t *mbedtls_cipher_info_from_values(const mbedtls_cipher_id_t cipher_id,
                                                             int key_bitlen,
                                                             const mbedtls_cipher_mode_t mode);
# 444 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/cipher.h"
static inline mbedtls_cipher_type_t mbedtls_cipher_info_get_type(
    const mbedtls_cipher_info_t *info)
{
    if (info == 
# 447 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/cipher.h" 3 4
               ((void *)0)
# 447 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/cipher.h"
                   ) {
        return MBEDTLS_CIPHER_NONE;
    } else {
        return (mbedtls_cipher_type_t) info->type;
    }
}
# 463 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/cipher.h"
static inline mbedtls_cipher_mode_t mbedtls_cipher_info_get_mode(
    const mbedtls_cipher_info_t *info)
{
    if (info == 
# 466 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/cipher.h" 3 4
               ((void *)0)
# 466 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/cipher.h"
                   ) {
        return MBEDTLS_MODE_NONE;
    } else {
        return (mbedtls_cipher_mode_t) info->mode;
    }
}
# 484 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/cipher.h"
static inline size_t mbedtls_cipher_info_get_key_bitlen(
    const mbedtls_cipher_info_t *info)
{
    if (info == 
# 487 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/cipher.h" 3 4
               ((void *)0)
# 487 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/cipher.h"
                   ) {
        return 0;
    } else {
        return ((size_t) info->key_bitlen) << 6;
    }
}
# 505 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/cipher.h"
static inline const char *mbedtls_cipher_info_get_name(
    const mbedtls_cipher_info_t *info)
{
    if (info == 
# 508 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/cipher.h" 3 4
               ((void *)0)
# 508 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/cipher.h"
                   ) {
        return 
# 509 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/cipher.h" 3 4
              ((void *)0)
# 509 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/cipher.h"
                  ;
    } else {
        return info->name;
    }
}
# 525 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/cipher.h"
static inline size_t mbedtls_cipher_info_get_iv_size(
    const mbedtls_cipher_info_t *info)
{
    if (info == 
# 528 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/cipher.h" 3 4
               ((void *)0)
# 528 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/cipher.h"
                   ) {
        return 0;
    }

    return ((size_t) info->iv_size) << 2;
}
# 545 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/cipher.h"
static inline size_t mbedtls_cipher_info_get_block_size(
    const mbedtls_cipher_info_t *info)
{
    if (info == 
# 548 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/cipher.h" 3 4
               ((void *)0)
# 548 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/cipher.h"
                   ) {
        return 0;
    }

    return (size_t) (info->block_size);
}
# 564 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/cipher.h"
static inline int mbedtls_cipher_info_has_variable_key_bitlen(
    const mbedtls_cipher_info_t *info)
{
    if (info == 
# 567 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/cipher.h" 3 4
               ((void *)0)
# 567 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/cipher.h"
                   ) {
        return 0;
    }

    return info->flags & 0x02;
}
# 583 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/cipher.h"
static inline int mbedtls_cipher_info_has_variable_iv_size(
    const mbedtls_cipher_info_t *info)
{
    if (info == 
# 586 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/cipher.h" 3 4
               ((void *)0)
# 586 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/cipher.h"
                   ) {
        return 0;
    }

    return info->flags & 0x01;
}






void mbedtls_cipher_init(mbedtls_cipher_context_t *ctx);
# 609 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/cipher.h"
void mbedtls_cipher_free(mbedtls_cipher_context_t *ctx);
# 638 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/cipher.h"
int mbedtls_cipher_setup(mbedtls_cipher_context_t *ctx,
                         const mbedtls_cipher_info_t *cipher_info);
# 685 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/cipher.h"
static inline unsigned int mbedtls_cipher_get_block_size(
    const mbedtls_cipher_context_t *ctx)
{
    if (ctx->cipher_info == 
# 688 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/cipher.h" 3 4
                                            ((void *)0)
# 688 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/cipher.h"
                                                ) {
        return 0;
    }

    return (unsigned int) ctx->cipher_info->block_size;
}
# 704 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/cipher.h"
static inline mbedtls_cipher_mode_t mbedtls_cipher_get_cipher_mode(
    const mbedtls_cipher_context_t *ctx)
{
    if (ctx->cipher_info == 
# 707 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/cipher.h" 3 4
                                            ((void *)0)
# 707 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/cipher.h"
                                                ) {
        return MBEDTLS_MODE_NONE;
    }

    return (mbedtls_cipher_mode_t) ctx->cipher_info->mode;
}
# 724 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/cipher.h"
static inline int mbedtls_cipher_get_iv_size(
    const mbedtls_cipher_context_t *ctx)
{
    if (ctx->cipher_info == 
# 727 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/cipher.h" 3 4
                                            ((void *)0)
# 727 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/cipher.h"
                                                ) {
        return 0;
    }

    if (ctx->iv_size != 0) {
        return (int) ctx->iv_size;
    }

    return (int) (((int) ctx->cipher_info->iv_size) <<
                  2);
}
# 747 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/cipher.h"
static inline mbedtls_cipher_type_t mbedtls_cipher_get_type(
    const mbedtls_cipher_context_t *ctx)
{
    if (ctx->cipher_info == 
# 750 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/cipher.h" 3 4
                                            ((void *)0)
# 750 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/cipher.h"
                                                ) {
        return MBEDTLS_CIPHER_NONE;
    }

    return (mbedtls_cipher_type_t) ctx->cipher_info->type;
}
# 766 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/cipher.h"
static inline const char *mbedtls_cipher_get_name(
    const mbedtls_cipher_context_t *ctx)
{
    if (ctx->cipher_info == 
# 769 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/cipher.h" 3 4
                                            ((void *)0)
# 769 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/cipher.h"
                                                ) {
        return 0;
    }

    return ctx->cipher_info->name;
}
# 785 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/cipher.h"
static inline int mbedtls_cipher_get_key_bitlen(
    const mbedtls_cipher_context_t *ctx)
{
    if (ctx->cipher_info == 
# 788 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/cipher.h" 3 4
                                            ((void *)0)
# 788 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/cipher.h"
                                                ) {
        return MBEDTLS_KEY_LENGTH_NONE;
    }

    return (int) ctx->cipher_info->key_bitlen <<
           6;
}
# 804 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/cipher.h"
static inline mbedtls_operation_t mbedtls_cipher_get_operation(
    const mbedtls_cipher_context_t *ctx)
{
    if (ctx->cipher_info == 
# 807 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/cipher.h" 3 4
                                            ((void *)0)
# 807 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/cipher.h"
                                                ) {
        return MBEDTLS_OPERATION_NONE;
    }

    return ctx->operation;
}
# 830 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/cipher.h"
int mbedtls_cipher_setkey(mbedtls_cipher_context_t *ctx,
                          const unsigned char *key,
                          int key_bitlen,
                          const mbedtls_operation_t operation);
# 851 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/cipher.h"
int mbedtls_cipher_set_padding_mode(mbedtls_cipher_context_t *ctx,
                                    mbedtls_cipher_padding_t mode);
# 879 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/cipher.h"
int mbedtls_cipher_set_iv(mbedtls_cipher_context_t *ctx,
                          const unsigned char *iv,
                          size_t iv_len);
# 916 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/cipher.h"
int mbedtls_cipher_reset(mbedtls_cipher_context_t *ctx);
# 931 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/cipher.h"
int mbedtls_cipher_update_ad(mbedtls_cipher_context_t *ctx,
                             const unsigned char *ad, size_t ad_len);
# 965 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/cipher.h"
int mbedtls_cipher_update(mbedtls_cipher_context_t *ctx,
                          const unsigned char *input,
                          size_t ilen, unsigned char *output,
                          size_t *olen);
# 1011 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/cipher.h"
int mbedtls_cipher_finish(mbedtls_cipher_context_t *ctx,
                          unsigned char *output, size_t *olen);
# 1057 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/cipher.h"
int mbedtls_cipher_finish_padded(mbedtls_cipher_context_t *ctx,
                                 unsigned char *output, size_t *olen,
                                 size_t *invalid_padding);
# 1079 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/cipher.h"
int mbedtls_cipher_write_tag(mbedtls_cipher_context_t *ctx,
                             unsigned char *tag, size_t tag_len);
# 1096 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/cipher.h"
int mbedtls_cipher_check_tag(mbedtls_cipher_context_t *ctx,
                             const unsigned char *tag, size_t tag_len);
# 1133 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/cipher.h"
int mbedtls_cipher_crypt(mbedtls_cipher_context_t *ctx,
                         const unsigned char *iv, size_t iv_len,
                         const unsigned char *input, size_t ilen,
                         unsigned char *output, size_t *olen);
# 1183 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/cipher.h"
int mbedtls_cipher_auth_encrypt_ext(mbedtls_cipher_context_t *ctx,
                                    const unsigned char *iv, size_t iv_len,
                                    const unsigned char *ad, size_t ad_len,
                                    const unsigned char *input, size_t ilen,
                                    unsigned char *output, size_t output_len,
                                    size_t *olen, size_t tag_len);
# 1239 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/cipher.h"
int mbedtls_cipher_auth_decrypt_ext(mbedtls_cipher_context_t *ctx,
                                    const unsigned char *iv, size_t iv_len,
                                    const unsigned char *ad, size_t ad_len,
                                    const unsigned char *input, size_t ilen,
                                    unsigned char *output, size_t output_len,
                                    size_t *olen, size_t tag_len);
# 89 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_builtin_primitives.h" 2
# 101 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_builtin_primitives.h"
typedef struct {

    psa_algorithm_t alg;
    uint8_t iv_length;
    uint8_t block_length;
    union {
        unsigned int dummy;
        mbedtls_cipher_context_t cipher;
    } ctx;
} mbedtls_psa_cipher_operation_t;
# 28 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_driver_contexts_primitives.h" 2
# 87 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_driver_contexts_primitives.h"
typedef union {
    unsigned dummy;
    mbedtls_psa_hash_operation_t mbedtls_ctx;



} psa_driver_hash_context_t;

typedef union {
    unsigned dummy;
    mbedtls_psa_cipher_operation_t mbedtls_ctx;




} psa_driver_cipher_context_t;
# 69 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_struct.h" 2

struct psa_hash_operation_s {
# 80 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_struct.h"
    unsigned int id;
    psa_driver_hash_context_t ctx;

};





static inline struct psa_hash_operation_s psa_hash_operation_init(void)
{
    const struct psa_hash_operation_s v = { 0, { 0 } };
    return v;
}

struct psa_cipher_operation_s {
# 105 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_struct.h"
    unsigned int id;

    unsigned int iv_required : 1;
    unsigned int iv_set : 1;

    uint8_t default_iv_length;

    psa_driver_cipher_context_t ctx;

};






static inline struct psa_cipher_operation_s psa_cipher_operation_init(void)
{
    const struct psa_cipher_operation_s v = { 0, 0, 0, 0, { 0 } };
    return v;
}



# 1 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_driver_contexts_composites.h" 1
# 28 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_driver_contexts_composites.h"
# 1 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_builtin_composites.h" 1
# 27 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_builtin_composites.h"
# 1 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/cmac.h" 1
# 59 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/cmac.h"
struct mbedtls_cmac_context_t {

    unsigned char state[16];



    unsigned char unprocessed_block[16];


    size_t unprocessed_len;
};
# 105 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/cmac.h"
int mbedtls_cipher_cmac_starts(mbedtls_cipher_context_t *ctx,
                               const unsigned char *key, size_t keybits);
# 130 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/cmac.h"
int mbedtls_cipher_cmac_update(mbedtls_cipher_context_t *ctx,
                               const unsigned char *input, size_t ilen);
# 149 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/cmac.h"
int mbedtls_cipher_cmac_finish(mbedtls_cipher_context_t *ctx,
                               unsigned char *output);
# 168 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/cmac.h"
int mbedtls_cipher_cmac_reset(mbedtls_cipher_context_t *ctx);
# 197 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/cmac.h"
int mbedtls_cipher_cmac(const mbedtls_cipher_info_t *cipher_info,
                        const unsigned char *key, size_t keylen,
                        const unsigned char *input, size_t ilen,
                        unsigned char *output);
# 220 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/cmac.h"
int mbedtls_aes_cmac_prf_128(const unsigned char *key, size_t key_len,
                             const unsigned char *input, size_t in_len,
                             unsigned char output[16]);
# 239 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/cmac.h"
int mbedtls_cmac_self_test(int verbose);
# 28 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_builtin_composites.h" 2

# 1 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/gcm.h" 1
# 58 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/gcm.h"
typedef struct mbedtls_gcm_context {



    mbedtls_cipher_context_t cipher_ctx;

    uint64_t H[256][2];
    uint64_t len;
    uint64_t add_len;
    unsigned char base_ectr[16];
    unsigned char y[16];
    unsigned char buf[16];
    unsigned char mode;


    unsigned char acceleration;
}
mbedtls_gcm_context;
# 92 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/gcm.h"
void mbedtls_gcm_init(mbedtls_gcm_context *ctx);
# 110 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/gcm.h"
int mbedtls_gcm_setkey(mbedtls_gcm_context *ctx,
                       mbedtls_cipher_id_t cipher,
                       const unsigned char *key,
                       unsigned int keybits);
# 165 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/gcm.h"
int mbedtls_gcm_crypt_and_tag(mbedtls_gcm_context *ctx,
                              int mode,
                              size_t length,
                              const unsigned char *iv,
                              size_t iv_len,
                              const unsigned char *add,
                              size_t add_len,
                              const unsigned char *input,
                              unsigned char *output,
                              size_t tag_len,
                              unsigned char *tag);
# 212 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/gcm.h"
int mbedtls_gcm_auth_decrypt(mbedtls_gcm_context *ctx,
                             size_t length,
                             const unsigned char *iv,
                             size_t iv_len,
                             const unsigned char *add,
                             size_t add_len,
                             const unsigned char *tag,
                             size_t tag_len,
                             const unsigned char *input,
                             unsigned char *output);
# 236 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/gcm.h"
int mbedtls_gcm_starts(mbedtls_gcm_context *ctx,
                       int mode,
                       const unsigned char *iv,
                       size_t iv_len);
# 261 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/gcm.h"
int mbedtls_gcm_update_ad(mbedtls_gcm_context *ctx,
                          const unsigned char *add,
                          size_t add_len);
# 318 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/gcm.h"
int mbedtls_gcm_update(mbedtls_gcm_context *ctx,
                       const unsigned char *input, size_t input_length,
                       unsigned char *output, size_t output_size,
                       size_t *output_length);
# 356 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/gcm.h"
int mbedtls_gcm_finish(mbedtls_gcm_context *ctx,
                       unsigned char *output, size_t output_size,
                       size_t *output_length,
                       unsigned char *tag, size_t tag_len);
# 368 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/gcm.h"
void mbedtls_gcm_free(mbedtls_gcm_context *ctx);
# 378 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/gcm.h"
int mbedtls_gcm_self_test(int verbose);
# 30 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_builtin_composites.h" 2


# 1 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ccm.h" 1
# 69 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ccm.h"
typedef struct mbedtls_ccm_context {
    unsigned char y[16];
    unsigned char ctr[16];
    size_t plaintext_len;
    size_t add_len;
    size_t tag_len;
    size_t processed;





    unsigned int q;
    unsigned int mode;







    mbedtls_cipher_context_t cipher_ctx;

    int state;

}
mbedtls_ccm_context;
# 108 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ccm.h"
void mbedtls_ccm_init(mbedtls_ccm_context *ctx);
# 123 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ccm.h"
int mbedtls_ccm_setkey(mbedtls_ccm_context *ctx,
                       mbedtls_cipher_id_t cipher,
                       const unsigned char *key,
                       unsigned int keybits);
# 135 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ccm.h"
void mbedtls_ccm_free(mbedtls_ccm_context *ctx);
# 173 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ccm.h"
int mbedtls_ccm_encrypt_and_tag(mbedtls_ccm_context *ctx, size_t length,
                                const unsigned char *iv, size_t iv_len,
                                const unsigned char *ad, size_t ad_len,
                                const unsigned char *input, unsigned char *output,
                                unsigned char *tag, size_t tag_len);
# 222 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ccm.h"
int mbedtls_ccm_star_encrypt_and_tag(mbedtls_ccm_context *ctx, size_t length,
                                     const unsigned char *iv, size_t iv_len,
                                     const unsigned char *ad, size_t ad_len,
                                     const unsigned char *input, unsigned char *output,
                                     unsigned char *tag, size_t tag_len);
# 259 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ccm.h"
int mbedtls_ccm_auth_decrypt(mbedtls_ccm_context *ctx, size_t length,
                             const unsigned char *iv, size_t iv_len,
                             const unsigned char *ad, size_t ad_len,
                             const unsigned char *input, unsigned char *output,
                             const unsigned char *tag, size_t tag_len);
# 305 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ccm.h"
int mbedtls_ccm_star_auth_decrypt(mbedtls_ccm_context *ctx, size_t length,
                                  const unsigned char *iv, size_t iv_len,
                                  const unsigned char *ad, size_t ad_len,
                                  const unsigned char *input, unsigned char *output,
                                  const unsigned char *tag, size_t tag_len);
# 339 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ccm.h"
int mbedtls_ccm_starts(mbedtls_ccm_context *ctx,
                       int mode,
                       const unsigned char *iv,
                       size_t iv_len);
# 371 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ccm.h"
int mbedtls_ccm_set_lengths(mbedtls_ccm_context *ctx,
                            size_t total_ad_len,
                            size_t plaintext_len,
                            size_t tag_len);
# 406 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ccm.h"
int mbedtls_ccm_update_ad(mbedtls_ccm_context *ctx,
                          const unsigned char *ad,
                          size_t ad_len);
# 473 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ccm.h"
int mbedtls_ccm_update(mbedtls_ccm_context *ctx,
                       const unsigned char *input, size_t input_len,
                       unsigned char *output, size_t output_size,
                       size_t *output_len);
# 509 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ccm.h"
int mbedtls_ccm_finish(mbedtls_ccm_context *ctx,
                       unsigned char *tag, size_t tag_len);
# 519 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ccm.h"
int mbedtls_ccm_self_test(int verbose);
# 33 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_builtin_composites.h" 2

# 1 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/chachapoly.h" 1
# 27 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/chachapoly.h"
# 1 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/poly1305.h" 1
# 27 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/poly1305.h"
# 1 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/lib/gcc/riscv32-unknown-elf/15.1.0/include/stddef.h" 1 3 4
# 28 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/poly1305.h" 2
# 38 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/poly1305.h"
typedef struct mbedtls_poly1305_context {
    uint32_t r[4];
    uint32_t s[4];
    uint32_t acc[5];
    uint8_t queue[16];
    size_t queue_len;
}
mbedtls_poly1305_context;
# 66 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/poly1305.h"
void mbedtls_poly1305_init(mbedtls_poly1305_context *ctx);
# 76 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/poly1305.h"
void mbedtls_poly1305_free(mbedtls_poly1305_context *ctx);
# 91 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/poly1305.h"
int mbedtls_poly1305_starts(mbedtls_poly1305_context *ctx,
                            const unsigned char key[32]);
# 112 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/poly1305.h"
int mbedtls_poly1305_update(mbedtls_poly1305_context *ctx,
                            const unsigned char *input,
                            size_t ilen);
# 128 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/poly1305.h"
int mbedtls_poly1305_finish(mbedtls_poly1305_context *ctx,
                            unsigned char mac[16]);
# 149 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/poly1305.h"
int mbedtls_poly1305_mac(const unsigned char key[32],
                         const unsigned char *input,
                         size_t ilen,
                         unsigned char mac[16]);
# 161 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/poly1305.h"
int mbedtls_poly1305_self_test(int verbose);
# 28 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/chachapoly.h" 2
# 38 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/chachapoly.h"
typedef enum {
    MBEDTLS_CHACHAPOLY_ENCRYPT,
    MBEDTLS_CHACHAPOLY_DECRYPT
}
mbedtls_chachapoly_mode_t;



# 1 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/chacha20.h" 1
# 27 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/chacha20.h"
# 1 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/lib/gcc/riscv32-unknown-elf/15.1.0/include/stddef.h" 1 3 4
# 28 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/chacha20.h" 2
# 38 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/chacha20.h"
typedef struct mbedtls_chacha20_context {
    uint32_t state[16];
    uint8_t keystream8[64];
    size_t keystream_bytes_used;
}
mbedtls_chacha20_context;
# 64 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/chacha20.h"
void mbedtls_chacha20_init(mbedtls_chacha20_context *ctx);
# 75 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/chacha20.h"
void mbedtls_chacha20_free(mbedtls_chacha20_context *ctx);
# 93 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/chacha20.h"
int mbedtls_chacha20_setkey(mbedtls_chacha20_context *ctx,
                            const unsigned char key[32]);
# 115 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/chacha20.h"
int mbedtls_chacha20_starts(mbedtls_chacha20_context *ctx,
                            const unsigned char nonce[12],
                            uint32_t counter);
# 148 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/chacha20.h"
int mbedtls_chacha20_update(mbedtls_chacha20_context *ctx,
                            size_t size,
                            const unsigned char *input,
                            unsigned char *output);
# 181 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/chacha20.h"
int mbedtls_chacha20_crypt(const unsigned char key[32],
                           const unsigned char nonce[12],
                           uint32_t counter,
                           size_t size,
                           const unsigned char *input,
                           unsigned char *output);
# 195 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/chacha20.h"
int mbedtls_chacha20_self_test(int verbose);
# 47 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/chachapoly.h" 2

typedef struct mbedtls_chachapoly_context {
    mbedtls_chacha20_context chacha20_ctx;
    mbedtls_poly1305_context poly1305_ctx;
    uint64_t aad_len;
    uint64_t ciphertext_len;
    int state;
    mbedtls_chachapoly_mode_t mode;
}
mbedtls_chachapoly_context;
# 104 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/chachapoly.h"
void mbedtls_chachapoly_init(mbedtls_chachapoly_context *ctx);
# 113 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/chachapoly.h"
void mbedtls_chachapoly_free(mbedtls_chachapoly_context *ctx);
# 126 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/chachapoly.h"
int mbedtls_chachapoly_setkey(mbedtls_chachapoly_context *ctx,
                              const unsigned char key[32]);
# 154 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/chachapoly.h"
int mbedtls_chachapoly_starts(mbedtls_chachapoly_context *ctx,
                              const unsigned char nonce[12],
                              mbedtls_chachapoly_mode_t mode);
# 197 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/chachapoly.h"
int mbedtls_chachapoly_update_aad(mbedtls_chachapoly_context *ctx,
                                  const unsigned char *aad,
                                  size_t aad_len);
# 232 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/chachapoly.h"
int mbedtls_chachapoly_update(mbedtls_chachapoly_context *ctx,
                              size_t len,
                              const unsigned char *input,
                              unsigned char *output);
# 253 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/chachapoly.h"
int mbedtls_chachapoly_finish(mbedtls_chachapoly_context *ctx,
                              unsigned char mac[16]);
# 285 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/chachapoly.h"
int mbedtls_chachapoly_encrypt_and_tag(mbedtls_chachapoly_context *ctx,
                                       size_t length,
                                       const unsigned char nonce[12],
                                       const unsigned char *aad,
                                       size_t aad_len,
                                       const unsigned char *input,
                                       unsigned char *output,
                                       unsigned char tag[16]);
# 319 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/chachapoly.h"
int mbedtls_chachapoly_auth_decrypt(mbedtls_chachapoly_context *ctx,
                                    size_t length,
                                    const unsigned char nonce[12],
                                    const unsigned char *aad,
                                    size_t aad_len,
                                    const unsigned char tag[16],
                                    const unsigned char *input,
                                    unsigned char *output);
# 335 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/chachapoly.h"
int mbedtls_chachapoly_self_test(int verbose);
# 35 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_builtin_composites.h" 2
# 45 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_builtin_composites.h"
typedef struct {

    psa_algorithm_t alg;

    struct psa_hash_operation_s hash_ctx;

    uint8_t opad[144u];
} mbedtls_psa_hmac_operation_t;




typedef struct {
    psa_algorithm_t alg;
    union {
        unsigned dummy;

        mbedtls_psa_hmac_operation_t hmac;


        mbedtls_cipher_context_t cmac;

    } ctx;
} mbedtls_psa_mac_operation_t;
# 79 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_builtin_composites.h"
typedef struct {
    psa_algorithm_t alg;
    psa_key_type_t key_type;

    unsigned int is_encrypt : 1;

    uint8_t tag_length;

    union {
        unsigned dummy;

        mbedtls_ccm_context ccm;


        mbedtls_gcm_context gcm;





    } ctx;

} mbedtls_psa_aead_operation_t;



# 1 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecdsa.h" 1
# 24 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecdsa.h"
# 1 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecp.h" 1
# 29 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecp.h"
# 1 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/bignum.h" 1
# 17 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/bignum.h"
# 1 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/lib/gcc/riscv32-unknown-elf/15.1.0/include/stddef.h" 1 3 4
# 18 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/bignum.h" 2
# 169 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/bignum.h"
typedef int32_t mbedtls_mpi_sint;
typedef uint32_t mbedtls_mpi_uint;
# 208 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/bignum.h"
typedef struct mbedtls_mpi {




    mbedtls_mpi_uint *p;
# 226 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/bignum.h"
    signed short s;


    unsigned short n;
# 239 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/bignum.h"
}
mbedtls_mpi;
# 250 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/bignum.h"
void mbedtls_mpi_init(mbedtls_mpi *X);
# 259 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/bignum.h"
void mbedtls_mpi_free(mbedtls_mpi *X);
# 274 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/bignum.h"
int mbedtls_mpi_grow(mbedtls_mpi *X, size_t nblimbs);
# 291 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/bignum.h"
int mbedtls_mpi_shrink(mbedtls_mpi *X, size_t nblimbs);
# 306 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/bignum.h"
int mbedtls_mpi_copy(mbedtls_mpi *X, const mbedtls_mpi *Y);







void mbedtls_mpi_swap(mbedtls_mpi *X, mbedtls_mpi *Y);
# 344 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/bignum.h"
int mbedtls_mpi_safe_cond_assign(mbedtls_mpi *X, const mbedtls_mpi *Y, unsigned char assign);
# 373 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/bignum.h"
int mbedtls_mpi_safe_cond_swap(mbedtls_mpi *X, mbedtls_mpi *Y, unsigned char swap);
# 385 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/bignum.h"
int mbedtls_mpi_lset(mbedtls_mpi *X, mbedtls_mpi_sint z);
# 397 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/bignum.h"
int mbedtls_mpi_get_bit(const mbedtls_mpi *X, size_t pos);
# 414 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/bignum.h"
int mbedtls_mpi_set_bit(mbedtls_mpi *X, size_t pos, unsigned char val);
# 428 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/bignum.h"
size_t mbedtls_mpi_lsb(const mbedtls_mpi *X);
# 442 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/bignum.h"
size_t mbedtls_mpi_bitlen(const mbedtls_mpi *X);
# 457 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/bignum.h"
size_t mbedtls_mpi_size(const mbedtls_mpi *X);
# 469 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/bignum.h"
int mbedtls_mpi_read_string(mbedtls_mpi *X, int radix, const char *s);
# 493 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/bignum.h"
int mbedtls_mpi_write_string(const mbedtls_mpi *X, int radix,
                             char *buf, size_t buflen, size_t *olen);
# 551 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/bignum.h"
int mbedtls_mpi_read_binary(mbedtls_mpi *X, const unsigned char *buf,
                            size_t buflen);
# 566 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/bignum.h"
int mbedtls_mpi_read_binary_le(mbedtls_mpi *X,
                               const unsigned char *buf, size_t buflen);
# 584 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/bignum.h"
int mbedtls_mpi_write_binary(const mbedtls_mpi *X, unsigned char *buf,
                             size_t buflen);
# 602 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/bignum.h"
int mbedtls_mpi_write_binary_le(const mbedtls_mpi *X,
                                unsigned char *buf, size_t buflen);
# 617 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/bignum.h"
int mbedtls_mpi_shift_l(mbedtls_mpi *X, size_t count);
# 629 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/bignum.h"
int mbedtls_mpi_shift_r(mbedtls_mpi *X, size_t count);
# 641 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/bignum.h"
int mbedtls_mpi_cmp_abs(const mbedtls_mpi *X, const mbedtls_mpi *Y);
# 653 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/bignum.h"
int mbedtls_mpi_cmp_mpi(const mbedtls_mpi *X, const mbedtls_mpi *Y);
# 670 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/bignum.h"
int mbedtls_mpi_lt_mpi_ct(const mbedtls_mpi *X, const mbedtls_mpi *Y,
                          unsigned *ret);
# 683 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/bignum.h"
int mbedtls_mpi_cmp_int(const mbedtls_mpi *X, mbedtls_mpi_sint z);
# 696 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/bignum.h"
int mbedtls_mpi_add_abs(mbedtls_mpi *X, const mbedtls_mpi *A,
                        const mbedtls_mpi *B);
# 711 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/bignum.h"
int mbedtls_mpi_sub_abs(mbedtls_mpi *X, const mbedtls_mpi *A,
                        const mbedtls_mpi *B);
# 725 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/bignum.h"
int mbedtls_mpi_add_mpi(mbedtls_mpi *X, const mbedtls_mpi *A,
                        const mbedtls_mpi *B);
# 739 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/bignum.h"
int mbedtls_mpi_sub_mpi(mbedtls_mpi *X, const mbedtls_mpi *A,
                        const mbedtls_mpi *B);
# 753 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/bignum.h"
int mbedtls_mpi_add_int(mbedtls_mpi *X, const mbedtls_mpi *A,
                        mbedtls_mpi_sint b);
# 768 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/bignum.h"
int mbedtls_mpi_sub_int(mbedtls_mpi *X, const mbedtls_mpi *A,
                        mbedtls_mpi_sint b);
# 783 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/bignum.h"
int mbedtls_mpi_mul_mpi(mbedtls_mpi *X, const mbedtls_mpi *A,
                        const mbedtls_mpi *B);
# 799 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/bignum.h"
int mbedtls_mpi_mul_int(mbedtls_mpi *X, const mbedtls_mpi *A,
                        mbedtls_mpi_uint b);
# 820 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/bignum.h"
int mbedtls_mpi_div_mpi(mbedtls_mpi *Q, mbedtls_mpi *R, const mbedtls_mpi *A,
                        const mbedtls_mpi *B);
# 841 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/bignum.h"
int mbedtls_mpi_div_int(mbedtls_mpi *Q, mbedtls_mpi *R, const mbedtls_mpi *A,
                        mbedtls_mpi_sint b);
# 861 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/bignum.h"
int mbedtls_mpi_mod_mpi(mbedtls_mpi *R, const mbedtls_mpi *A,
                        const mbedtls_mpi *B);
# 880 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/bignum.h"
int mbedtls_mpi_mod_int(mbedtls_mpi_uint *r, const mbedtls_mpi *A,
                        mbedtls_mpi_sint b);
# 910 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/bignum.h"
int mbedtls_mpi_exp_mod(mbedtls_mpi *X, const mbedtls_mpi *A,
                        const mbedtls_mpi *E, const mbedtls_mpi *N,
                        mbedtls_mpi *prec_RR);
# 931 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/bignum.h"
int mbedtls_mpi_fill_random(mbedtls_mpi *X, size_t size,
                            mbedtls_f_rng_t *f_rng,
                            void *p_rng);
# 967 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/bignum.h"
int mbedtls_mpi_random(mbedtls_mpi *X,
                       mbedtls_mpi_sint min,
                       const mbedtls_mpi *N,
                       mbedtls_f_rng_t *f_rng,
                       void *p_rng);
# 985 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/bignum.h"
int mbedtls_mpi_gcd(mbedtls_mpi *G, const mbedtls_mpi *A,
                    const mbedtls_mpi *B);
# 1006 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/bignum.h"
int mbedtls_mpi_inv_mod(mbedtls_mpi *X, const mbedtls_mpi *A,
                        const mbedtls_mpi *N);
# 1036 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/bignum.h"
int mbedtls_mpi_is_prime_ext(const mbedtls_mpi *X, int rounds,
                             mbedtls_f_rng_t *f_rng,
                             void *p_rng);






typedef enum {
    MBEDTLS_MPI_GEN_PRIME_FLAG_DH = 0x0001,
    MBEDTLS_MPI_GEN_PRIME_FLAG_LOW_ERR = 0x0002,
} mbedtls_mpi_gen_prime_flag_t;
# 1069 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/bignum.h"
int mbedtls_mpi_gen_prime(mbedtls_mpi *X, size_t nbits, int flags,
                          mbedtls_f_rng_t *f_rng,
                          void *p_rng);
# 1080 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/bignum.h"
int mbedtls_mpi_self_test(int verbose);
# 30 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecp.h" 2
# 102 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecp.h"
typedef enum {
    MBEDTLS_ECP_DP_NONE = 0,
    MBEDTLS_ECP_DP_SECP192R1,
    MBEDTLS_ECP_DP_SECP224R1,
    MBEDTLS_ECP_DP_SECP256R1,
    MBEDTLS_ECP_DP_SECP384R1,
    MBEDTLS_ECP_DP_SECP521R1,
    MBEDTLS_ECP_DP_BP256R1,
    MBEDTLS_ECP_DP_BP384R1,
    MBEDTLS_ECP_DP_BP512R1,
    MBEDTLS_ECP_DP_CURVE25519,
    MBEDTLS_ECP_DP_SECP192K1,
    MBEDTLS_ECP_DP_SECP224K1,
    MBEDTLS_ECP_DP_SECP256K1,
    MBEDTLS_ECP_DP_CURVE448,
} mbedtls_ecp_group_id;
# 127 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecp.h"
typedef enum {
    MBEDTLS_ECP_TYPE_NONE = 0,
    MBEDTLS_ECP_TYPE_SHORT_WEIERSTRASS,
    MBEDTLS_ECP_TYPE_MONTGOMERY,
} mbedtls_ecp_curve_type;
# 140 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecp.h"
typedef struct mbedtls_ecp_curve_info {
    mbedtls_ecp_group_id grp_id;
    uint16_t tls_id;
    uint16_t bit_size;
    const char *name;
} mbedtls_ecp_curve_info;
# 158 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecp.h"
typedef struct mbedtls_ecp_point {
    mbedtls_mpi X;
    mbedtls_mpi Y;
    mbedtls_mpi Z;
}
mbedtls_ecp_point;
# 233 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecp.h"
typedef struct mbedtls_ecp_group {
    mbedtls_ecp_group_id id;
    mbedtls_mpi P;
    mbedtls_mpi A;




    mbedtls_mpi B;

    mbedtls_ecp_point G;
    mbedtls_mpi N;
    size_t pbits;
    size_t nbits;




    unsigned int h;
    int(*modp)(mbedtls_mpi *);

    int(*t_pre)(mbedtls_ecp_point *, void *);
    int(*t_post)(mbedtls_ecp_point *, void *);
    void *t_data;
    mbedtls_ecp_point *T;
    size_t T_size;
}
mbedtls_ecp_group;
# 364 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecp.h"
typedef struct mbedtls_ecp_restart_mul mbedtls_ecp_restart_mul_ctx;






typedef struct mbedtls_ecp_restart_muladd mbedtls_ecp_restart_muladd_ctx;




typedef struct {
    unsigned ops_done;
    unsigned depth;
    mbedtls_ecp_restart_mul_ctx *rsm;
    mbedtls_ecp_restart_muladd_ctx *ma;
} mbedtls_ecp_restart_ctx;
# 402 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecp.h"
int mbedtls_ecp_check_budget(const mbedtls_ecp_group *grp,
                             mbedtls_ecp_restart_ctx *rs_ctx,
                             unsigned ops);
# 428 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecp.h"
typedef struct mbedtls_ecp_keypair {
    mbedtls_ecp_group grp;
    mbedtls_mpi d;
    mbedtls_ecp_point Q;
}
mbedtls_ecp_keypair;
# 521 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecp.h"
void mbedtls_ecp_set_max_ops(unsigned max_ops);







int mbedtls_ecp_restart_is_enabled(void);





mbedtls_ecp_curve_type mbedtls_ecp_get_type(const mbedtls_ecp_group *grp);
# 549 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecp.h"
const mbedtls_ecp_curve_info *mbedtls_ecp_curve_list(void);
# 565 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecp.h"
const mbedtls_ecp_group_id *mbedtls_ecp_grp_id_list(void);
# 576 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecp.h"
const mbedtls_ecp_curve_info *mbedtls_ecp_curve_info_from_grp_id(mbedtls_ecp_group_id grp_id);
# 587 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecp.h"
const mbedtls_ecp_curve_info *mbedtls_ecp_curve_info_from_tls_id(uint16_t tls_id);
# 598 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecp.h"
const mbedtls_ecp_curve_info *mbedtls_ecp_curve_info_from_name(const char *name);






void mbedtls_ecp_point_init(mbedtls_ecp_point *pt);
# 616 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecp.h"
void mbedtls_ecp_group_init(mbedtls_ecp_group *grp);






void mbedtls_ecp_keypair_init(mbedtls_ecp_keypair *key);






void mbedtls_ecp_point_free(mbedtls_ecp_point *pt);
# 639 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecp.h"
void mbedtls_ecp_group_free(mbedtls_ecp_group *grp);
# 648 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecp.h"
void mbedtls_ecp_keypair_free(mbedtls_ecp_keypair *key);
# 657 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecp.h"
void mbedtls_ecp_restart_init(mbedtls_ecp_restart_ctx *ctx);
# 666 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecp.h"
void mbedtls_ecp_restart_free(mbedtls_ecp_restart_ctx *ctx);
# 680 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecp.h"
int mbedtls_ecp_copy(mbedtls_ecp_point *P, const mbedtls_ecp_point *Q);
# 693 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecp.h"
int mbedtls_ecp_group_copy(mbedtls_ecp_group *dst,
                           const mbedtls_ecp_group *src);
# 705 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecp.h"
int mbedtls_ecp_set_zero(mbedtls_ecp_point *pt);
# 716 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecp.h"
int mbedtls_ecp_is_zero(mbedtls_ecp_point *pt);
# 730 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecp.h"
int mbedtls_ecp_point_cmp(const mbedtls_ecp_point *P,
                          const mbedtls_ecp_point *Q);
# 745 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecp.h"
int mbedtls_ecp_point_read_string(mbedtls_ecp_point *P, int radix,
                                  const char *x, const char *y);
# 773 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecp.h"
int mbedtls_ecp_point_write_binary(const mbedtls_ecp_group *grp,
                                   const mbedtls_ecp_point *P,
                                   int format, size_t *olen,
                                   unsigned char *buf, size_t buflen);
# 803 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecp.h"
int mbedtls_ecp_point_read_binary(const mbedtls_ecp_group *grp,
                                  mbedtls_ecp_point *P,
                                  const unsigned char *buf, size_t ilen);
# 825 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecp.h"
int mbedtls_ecp_tls_read_point(const mbedtls_ecp_group *grp,
                               mbedtls_ecp_point *pt,
                               const unsigned char **buf, size_t len);
# 851 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecp.h"
int mbedtls_ecp_tls_write_point(const mbedtls_ecp_group *grp,
                                const mbedtls_ecp_point *pt,
                                int format, size_t *olen,
                                unsigned char *buf, size_t blen);
# 873 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecp.h"
int mbedtls_ecp_group_load(mbedtls_ecp_group *grp, mbedtls_ecp_group_id id);
# 892 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecp.h"
int mbedtls_ecp_tls_read_group(mbedtls_ecp_group *grp,
                               const unsigned char **buf, size_t len);
# 913 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecp.h"
int mbedtls_ecp_tls_read_group_id(mbedtls_ecp_group_id *grp,
                                  const unsigned char **buf,
                                  size_t len);
# 934 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecp.h"
int mbedtls_ecp_tls_write_group(const mbedtls_ecp_group *grp,
                                size_t *olen,
                                unsigned char *buf, size_t blen);
# 967 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecp.h"
int mbedtls_ecp_mul(mbedtls_ecp_group *grp, mbedtls_ecp_point *R,
                    const mbedtls_mpi *m, const mbedtls_ecp_point *P,
                    mbedtls_f_rng_t *f_rng, void *p_rng);
# 1001 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecp.h"
int mbedtls_ecp_mul_restartable(mbedtls_ecp_group *grp, mbedtls_ecp_point *R,
                                const mbedtls_mpi *m, const mbedtls_ecp_point *P,
                                mbedtls_f_rng_t *f_rng, void *p_rng,
                                mbedtls_ecp_restart_ctx *rs_ctx);
# 1022 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecp.h"
static inline int mbedtls_ecp_group_a_is_minus_3(const mbedtls_ecp_group *grp)
{
    return grp->A.p == 
# 1024 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecp.h" 3 4
                                       ((void *)0)
# 1024 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecp.h"
                                           ;
}
# 1062 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecp.h"
int mbedtls_ecp_muladd(mbedtls_ecp_group *grp, mbedtls_ecp_point *R,
                       const mbedtls_mpi *m, const mbedtls_ecp_point *P,
                       const mbedtls_mpi *n, const mbedtls_ecp_point *Q);
# 1106 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecp.h"
int mbedtls_ecp_muladd_restartable(
    mbedtls_ecp_group *grp, mbedtls_ecp_point *R,
    const mbedtls_mpi *m, const mbedtls_ecp_point *P,
    const mbedtls_mpi *n, const mbedtls_ecp_point *Q,
    mbedtls_ecp_restart_ctx *rs_ctx);
# 1140 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecp.h"
int mbedtls_ecp_check_pubkey(const mbedtls_ecp_group *grp,
                             const mbedtls_ecp_point *pt);
# 1162 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecp.h"
int mbedtls_ecp_check_privkey(const mbedtls_ecp_group *grp,
                              const mbedtls_mpi *d);
# 1180 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecp.h"
int mbedtls_ecp_gen_privkey(const mbedtls_ecp_group *grp,
                            mbedtls_mpi *d,
                            mbedtls_f_rng_t *f_rng,
                            void *p_rng);
# 1212 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecp.h"
int mbedtls_ecp_gen_keypair_base(mbedtls_ecp_group *grp,
                                 const mbedtls_ecp_point *G,
                                 mbedtls_mpi *d, mbedtls_ecp_point *Q,
                                 mbedtls_f_rng_t *f_rng,
                                 void *p_rng);
# 1241 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecp.h"
int mbedtls_ecp_gen_keypair(mbedtls_ecp_group *grp, mbedtls_mpi *d,
                            mbedtls_ecp_point *Q,
                            mbedtls_f_rng_t *f_rng,
                            void *p_rng);
# 1259 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecp.h"
int mbedtls_ecp_gen_key(mbedtls_ecp_group_id grp_id, mbedtls_ecp_keypair *key,
                        mbedtls_f_rng_t *f_rng,
                        void *p_rng);
# 1291 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecp.h"
int mbedtls_ecp_set_public_key(mbedtls_ecp_group_id grp_id,
                               mbedtls_ecp_keypair *key,
                               const mbedtls_ecp_point *Q);
# 1328 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecp.h"
int mbedtls_ecp_read_key(mbedtls_ecp_group_id grp_id, mbedtls_ecp_keypair *key,
                         const unsigned char *buf, size_t buflen);
# 1399 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecp.h"
int mbedtls_ecp_write_key_ext(const mbedtls_ecp_keypair *key,
                              size_t *olen, unsigned char *buf, size_t buflen);
# 1428 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecp.h"
int mbedtls_ecp_write_public_key(const mbedtls_ecp_keypair *key,
                                 int format, size_t *olen,
                                 unsigned char *buf, size_t buflen);
# 1452 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecp.h"
int mbedtls_ecp_check_pub_priv(
    const mbedtls_ecp_keypair *pub, const mbedtls_ecp_keypair *prv,
    mbedtls_f_rng_t *f_rng, void *p_rng);
# 1469 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecp.h"
int mbedtls_ecp_keypair_calc_public(
    mbedtls_ecp_keypair *key,
    mbedtls_f_rng_t *f_rng, void *p_rng);
# 1482 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecp.h"
mbedtls_ecp_group_id mbedtls_ecp_keypair_get_group_id(
    const mbedtls_ecp_keypair *key);
# 1509 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecp.h"
int mbedtls_ecp_export(const mbedtls_ecp_keypair *key, mbedtls_ecp_group *grp,
                       mbedtls_mpi *d, mbedtls_ecp_point *Q);
# 1520 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecp.h"
int mbedtls_ecp_self_test(int verbose);
# 25 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecdsa.h" 2
# 1 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/md.h" 1
# 18 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/md.h"
# 1 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/lib/gcc/riscv32-unknown-elf/15.1.0/include/stddef.h" 1 3 4
# 19 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/md.h" 2
# 47 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/md.h"
typedef enum {
    MBEDTLS_MD_NONE=0,
    MBEDTLS_MD_MD5=0x03,
    MBEDTLS_MD_RIPEMD160=0x04,
    MBEDTLS_MD_SHA1=0x05,
    MBEDTLS_MD_SHA224=0x08,
    MBEDTLS_MD_SHA256=0x09,
    MBEDTLS_MD_SHA384=0x0a,
    MBEDTLS_MD_SHA512=0x0b,
    MBEDTLS_MD_SHA3_224=0x10,
    MBEDTLS_MD_SHA3_256=0x11,
    MBEDTLS_MD_SHA3_384=0x12,
    MBEDTLS_MD_SHA3_512=0x13,
} mbedtls_md_type_t;
# 107 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/md.h"
typedef struct mbedtls_md_info_t mbedtls_md_info_t;






typedef enum {
    MBEDTLS_MD_ENGINE_LEGACY = 0,
    MBEDTLS_MD_ENGINE_PSA,
} mbedtls_md_engine_t;




typedef struct mbedtls_md_context_t {

    const mbedtls_md_info_t *md_info;







    void *md_ctx;



    void *hmac_ctx;

} mbedtls_md_context_t;
# 149 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/md.h"
const mbedtls_md_info_t *mbedtls_md_info_from_type(mbedtls_md_type_t md_type);
# 159 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/md.h"
void mbedtls_md_init(mbedtls_md_context_t *ctx);
# 174 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/md.h"
void mbedtls_md_free(mbedtls_md_context_t *ctx);
# 196 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/md.h"

int mbedtls_md_setup(mbedtls_md_context_t *ctx, const mbedtls_md_info_t *md_info, int hmac);
# 222 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/md.h"

int mbedtls_md_clone(mbedtls_md_context_t *dst,
                     const mbedtls_md_context_t *src);
# 235 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/md.h"
unsigned char mbedtls_md_get_size(const mbedtls_md_info_t *md_info);
# 246 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/md.h"
static inline unsigned char mbedtls_md_get_size_from_type(mbedtls_md_type_t md_type)
{
    return mbedtls_md_get_size(mbedtls_md_info_from_type(md_type));
}
# 260 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/md.h"
mbedtls_md_type_t mbedtls_md_get_type(const mbedtls_md_info_t *md_info);
# 275 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/md.h"

int mbedtls_md_starts(mbedtls_md_context_t *ctx);
# 294 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/md.h"

int mbedtls_md_update(mbedtls_md_context_t *ctx, const unsigned char *input, size_t ilen);
# 315 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/md.h"

int mbedtls_md_finish(mbedtls_md_context_t *ctx, unsigned char *output);
# 336 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/md.h"

int mbedtls_md(const mbedtls_md_info_t *md_info, const unsigned char *input, size_t ilen,
               unsigned char *output);
# 351 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/md.h"
const int *mbedtls_md_list(void);
# 362 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/md.h"
const mbedtls_md_info_t *mbedtls_md_info_from_string(const char *md_name);
# 373 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/md.h"
const char *mbedtls_md_get_name(const mbedtls_md_info_t *md_info);
# 385 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/md.h"
const mbedtls_md_info_t *mbedtls_md_info_from_ctx(
    const mbedtls_md_context_t *ctx);
# 429 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/md.h"

int mbedtls_md_hmac_starts(mbedtls_md_context_t *ctx, const unsigned char *key,
                           size_t keylen);
# 452 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/md.h"

int mbedtls_md_hmac_update(mbedtls_md_context_t *ctx, const unsigned char *input,
                           size_t ilen);
# 474 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/md.h"

int mbedtls_md_hmac_finish(mbedtls_md_context_t *ctx, unsigned char *output);
# 492 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/md.h"

int mbedtls_md_hmac_reset(mbedtls_md_context_t *ctx);
# 517 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/md.h"

int mbedtls_md_hmac(const mbedtls_md_info_t *md_info, const unsigned char *key, size_t keylen,
                    const unsigned char *input, size_t ilen,
                    unsigned char *output);
# 26 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecdsa.h" 2
# 68 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecdsa.h"
typedef mbedtls_ecp_keypair mbedtls_ecdsa_context;
# 77 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecdsa.h"
typedef struct mbedtls_ecdsa_restart_ver mbedtls_ecdsa_restart_ver_ctx;






typedef struct mbedtls_ecdsa_restart_sig mbedtls_ecdsa_restart_sig_ctx;







typedef struct mbedtls_ecdsa_restart_det mbedtls_ecdsa_restart_det_ctx;





typedef struct {
    mbedtls_ecp_restart_ctx ecp;

    mbedtls_ecdsa_restart_ver_ctx *ver;
    mbedtls_ecdsa_restart_sig_ctx *sig;

    mbedtls_ecdsa_restart_det_ctx *det;

} mbedtls_ecdsa_restart_ctx;
# 123 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecdsa.h"
int mbedtls_ecdsa_can_do(mbedtls_ecp_group_id gid);
# 162 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecdsa.h"
int mbedtls_ecdsa_sign(mbedtls_ecp_group *grp, mbedtls_mpi *r, mbedtls_mpi *s,
                       const mbedtls_mpi *d, const unsigned char *buf, size_t blen,
                       mbedtls_f_rng_t *f_rng, void *p_rng);
# 207 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecdsa.h"
int mbedtls_ecdsa_sign_det_ext(mbedtls_ecp_group *grp, mbedtls_mpi *r,
                               mbedtls_mpi *s, const mbedtls_mpi *d,
                               const unsigned char *buf, size_t blen,
                               mbedtls_md_type_t md_alg,
                               mbedtls_f_rng_t *f_rng_blind,
                               void *p_rng_blind);
# 271 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecdsa.h"
int mbedtls_ecdsa_sign_restartable(
    mbedtls_ecp_group *grp,
    mbedtls_mpi *r, mbedtls_mpi *s,
    const mbedtls_mpi *d,
    const unsigned char *buf, size_t blen,
    mbedtls_f_rng_t *f_rng,
    void *p_rng,
    mbedtls_f_rng_t *f_rng_blind,
    void *p_rng_blind,
    mbedtls_ecdsa_restart_ctx *rs_ctx);
# 334 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecdsa.h"
int mbedtls_ecdsa_sign_det_restartable(
    mbedtls_ecp_group *grp,
    mbedtls_mpi *r, mbedtls_mpi *s,
    const mbedtls_mpi *d, const unsigned char *buf, size_t blen,
    mbedtls_md_type_t md_alg,
    mbedtls_f_rng_t *f_rng_blind,
    void *p_rng_blind,
    mbedtls_ecdsa_restart_ctx *rs_ctx);
# 375 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecdsa.h"
int mbedtls_ecdsa_verify(mbedtls_ecp_group *grp,
                         const unsigned char *buf, size_t blen,
                         const mbedtls_ecp_point *Q, const mbedtls_mpi *r,
                         const mbedtls_mpi *s);
# 416 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecdsa.h"
int mbedtls_ecdsa_verify_restartable(mbedtls_ecp_group *grp,
                                     const unsigned char *buf, size_t blen,
                                     const mbedtls_ecp_point *Q,
                                     const mbedtls_mpi *r,
                                     const mbedtls_mpi *s,
                                     mbedtls_ecdsa_restart_ctx *rs_ctx);
# 474 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecdsa.h"
int mbedtls_ecdsa_write_signature(mbedtls_ecdsa_context *ctx,
                                  mbedtls_md_type_t md_alg,
                                  const unsigned char *hash, size_t hlen,
                                  unsigned char *sig, size_t sig_size, size_t *slen,
                                  mbedtls_f_rng_t *f_rng,
                                  void *p_rng);
# 522 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecdsa.h"
int mbedtls_ecdsa_write_signature_restartable(mbedtls_ecdsa_context *ctx,
                                              mbedtls_md_type_t md_alg,
                                              const unsigned char *hash, size_t hlen,
                                              unsigned char *sig, size_t sig_size, size_t *slen,
                                              mbedtls_f_rng_t *f_rng,
                                              void *p_rng,
                                              mbedtls_ecdsa_restart_ctx *rs_ctx);
# 557 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecdsa.h"
int mbedtls_ecdsa_read_signature(mbedtls_ecdsa_context *ctx,
                                 const unsigned char *hash, size_t hlen,
                                 const unsigned char *sig, size_t slen);
# 592 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecdsa.h"
int mbedtls_ecdsa_read_signature_restartable(mbedtls_ecdsa_context *ctx,
                                             const unsigned char *hash, size_t hlen,
                                             const unsigned char *sig, size_t slen,
                                             mbedtls_ecdsa_restart_ctx *rs_ctx);
# 613 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecdsa.h"
int mbedtls_ecdsa_genkey(mbedtls_ecdsa_context *ctx, mbedtls_ecp_group_id gid,
                         mbedtls_f_rng_t *f_rng, void *p_rng);
# 631 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecdsa.h"
int mbedtls_ecdsa_from_keypair(mbedtls_ecdsa_context *ctx,
                               const mbedtls_ecp_keypair *key);







void mbedtls_ecdsa_init(mbedtls_ecdsa_context *ctx);
# 649 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecdsa.h"
void mbedtls_ecdsa_free(mbedtls_ecdsa_context *ctx);
# 658 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecdsa.h"
void mbedtls_ecdsa_restart_init(mbedtls_ecdsa_restart_ctx *ctx);
# 667 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecdsa.h"
void mbedtls_ecdsa_restart_free(mbedtls_ecdsa_restart_ctx *ctx);
# 106 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_builtin_composites.h" 2


typedef struct {



    mbedtls_ecdsa_context *ctx;
    mbedtls_ecdsa_restart_ctx restart_ctx;

    uint32_t num_ops;

    size_t coordinate_bytes;
    psa_algorithm_t alg;
    mbedtls_md_type_t md_alg;
    uint8_t hash[(((521u) + 7u) / 8u)];
    size_t hash_length;
# 130 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_builtin_composites.h"
} mbedtls_psa_sign_hash_interruptible_operation_t;
# 142 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_builtin_composites.h"
typedef struct {




    mbedtls_ecdsa_context *ctx;
    mbedtls_ecdsa_restart_ctx restart_ctx;

    uint32_t num_ops;

    uint8_t hash[(((521u) + 7u) / 8u)];
    size_t hash_length;

    mbedtls_mpi r;
    mbedtls_mpi s;
# 166 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_builtin_composites.h"
} mbedtls_psa_verify_hash_interruptible_operation_t;
# 180 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_builtin_composites.h"
# 1 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecjpake.h" 1
# 42 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecjpake.h"
typedef enum {
    MBEDTLS_ECJPAKE_CLIENT = 0,
    MBEDTLS_ECJPAKE_SERVER,
    MBEDTLS_ECJPAKE_NONE,
} mbedtls_ecjpake_role;
# 60 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecjpake.h"
typedef struct mbedtls_ecjpake_context {
    mbedtls_md_type_t md_type;
    mbedtls_ecp_group grp;
    mbedtls_ecjpake_role role;
    int point_format;

    mbedtls_ecp_point Xm1;
    mbedtls_ecp_point Xm2;
    mbedtls_ecp_point Xp1;
    mbedtls_ecp_point Xp2;
    mbedtls_ecp_point Xp;

    mbedtls_mpi xm1;
    mbedtls_mpi xm2;

    mbedtls_mpi s;
} mbedtls_ecjpake_context;
# 88 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecjpake.h"
void mbedtls_ecjpake_init(mbedtls_ecjpake_context *ctx);
# 111 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecjpake.h"
int mbedtls_ecjpake_setup(mbedtls_ecjpake_context *ctx,
                          mbedtls_ecjpake_role role,
                          mbedtls_md_type_t hash,
                          mbedtls_ecp_group_id curve,
                          const unsigned char *secret,
                          size_t len);
# 130 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecjpake.h"
int mbedtls_ecjpake_set_point_format(mbedtls_ecjpake_context *ctx,
                                     int point_format);
# 142 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecjpake.h"
int mbedtls_ecjpake_check(const mbedtls_ecjpake_context *ctx);
# 163 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecjpake.h"
int mbedtls_ecjpake_write_round_one(mbedtls_ecjpake_context *ctx,
                                    unsigned char *buf, size_t len, size_t *olen,
                                    mbedtls_f_rng_t *f_rng,
                                    void *p_rng);
# 182 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecjpake.h"
int mbedtls_ecjpake_read_round_one(mbedtls_ecjpake_context *ctx,
                                   const unsigned char *buf,
                                   size_t len);
# 204 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecjpake.h"
int mbedtls_ecjpake_write_round_two(mbedtls_ecjpake_context *ctx,
                                    unsigned char *buf, size_t len, size_t *olen,
                                    mbedtls_f_rng_t *f_rng,
                                    void *p_rng);
# 222 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecjpake.h"
int mbedtls_ecjpake_read_round_two(mbedtls_ecjpake_context *ctx,
                                   const unsigned char *buf,
                                   size_t len);
# 244 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecjpake.h"
int mbedtls_ecjpake_derive_secret(mbedtls_ecjpake_context *ctx,
                                  unsigned char *buf, size_t len, size_t *olen,
                                  mbedtls_f_rng_t *f_rng,
                                  void *p_rng);
# 267 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecjpake.h"
int mbedtls_ecjpake_write_shared_key(mbedtls_ecjpake_context *ctx,
                                     unsigned char *buf, size_t len, size_t *olen,
                                     mbedtls_f_rng_t *f_rng,
                                     void *p_rng);
# 280 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecjpake.h"
void mbedtls_ecjpake_free(mbedtls_ecjpake_context *ctx);
# 289 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecjpake.h"
int mbedtls_ecjpake_self_test(int verbose);
# 181 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_builtin_composites.h" 2
# 191 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_builtin_composites.h"
typedef struct {
    psa_algorithm_t alg;

    uint8_t *password;
    size_t password_len;

    mbedtls_ecjpake_role role;
    uint8_t buffer[((3 + 1 + 65 + 1 + 65 + 1 + 32) * 2)];
    size_t buffer_length;
    size_t buffer_offset;


    union {
        unsigned int dummy;

        mbedtls_ecjpake_context jpake;

    } ctx;

} mbedtls_psa_pake_operation_t;
# 29 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_driver_contexts_composites.h" 2
# 114 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_driver_contexts_composites.h"
typedef union {
    unsigned dummy;
    mbedtls_psa_mac_operation_t mbedtls_ctx;




} psa_driver_mac_context_t;

typedef union {
    unsigned dummy;
    mbedtls_psa_aead_operation_t mbedtls_ctx;



} psa_driver_aead_context_t;

typedef union {
    unsigned dummy;
    mbedtls_psa_sign_hash_interruptible_operation_t mbedtls_ctx;
} psa_driver_sign_hash_interruptible_context_t;

typedef union {
    unsigned dummy;
    mbedtls_psa_verify_hash_interruptible_operation_t mbedtls_ctx;
} psa_driver_verify_hash_interruptible_context_t;

typedef union {
    unsigned dummy;
    mbedtls_psa_pake_operation_t mbedtls_ctx;




} psa_driver_pake_context_t;
# 130 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_struct.h" 2

struct psa_mac_operation_s {
# 141 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_struct.h"
    unsigned int id;
    uint8_t mac_size;
    unsigned int is_sign : 1;
    psa_driver_mac_context_t ctx;

};






static inline struct psa_mac_operation_s psa_mac_operation_init(void)
{
    const struct psa_mac_operation_s v = { 0, 0, 0, { 0 } };
    return v;
}

struct psa_aead_operation_s {
# 169 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_struct.h"
    unsigned int id;

    psa_algorithm_t alg;
    psa_key_type_t key_type;

    size_t ad_remaining;
    size_t body_remaining;

    unsigned int nonce_set : 1;
    unsigned int lengths_set : 1;
    unsigned int ad_started : 1;
    unsigned int body_started : 1;
    unsigned int is_encrypt : 1;

    psa_driver_aead_context_t ctx;

};






static inline struct psa_aead_operation_s psa_aead_operation_init(void)
{
    const struct psa_aead_operation_s v = { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, { 0 } };
    return v;
}



# 1 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_driver_contexts_key_derivation.h" 1
# 27 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_driver_contexts_key_derivation.h"
# 1 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_builtin_key_derivation.h" 1
# 30 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_builtin_key_derivation.h"
typedef struct {
    uint8_t *info;
    size_t info_length;



    uint8_t offset_in_block;
    uint8_t block_number;
    unsigned int state : 2;
    unsigned int info_set : 1;
    uint8_t output_block[64u];
    uint8_t prk[64u];
    struct psa_mac_operation_s hmac;
} psa_hkdf_key_derivation_t;




typedef struct {
    uint8_t data[32u];
} psa_tls12_ecjpake_to_pms_t;




typedef enum {
    PSA_TLS12_PRF_STATE_INIT,
    PSA_TLS12_PRF_STATE_SEED_SET,
    PSA_TLS12_PRF_STATE_OTHER_KEY_SET,
    PSA_TLS12_PRF_STATE_KEY_SET,
    PSA_TLS12_PRF_STATE_LABEL_SET,
    PSA_TLS12_PRF_STATE_OUTPUT
} psa_tls12_prf_key_derivation_state_t;

typedef struct psa_tls12_prf_key_derivation_s {






    uint8_t left_in_block;


    uint8_t block_number;

    psa_tls12_prf_key_derivation_state_t state;

    uint8_t *secret;
    size_t secret_length;
    uint8_t *seed;
    size_t seed_length;
    uint8_t *label;
    size_t label_length;

    uint8_t *other_secret;
    size_t other_secret_length;


    uint8_t Ai[64u];


    uint8_t output_block[64u];
} psa_tls12_prf_key_derivation_t;



typedef enum {
    PSA_PBKDF2_STATE_INIT,
    PSA_PBKDF2_STATE_INPUT_COST_SET,
    PSA_PBKDF2_STATE_SALT_SET,
    PSA_PBKDF2_STATE_PASSWORD_SET,
    PSA_PBKDF2_STATE_OUTPUT
} psa_pbkdf2_key_derivation_state_t;

typedef struct {
    psa_pbkdf2_key_derivation_state_t state;
    uint64_t input_cost;
    uint8_t *salt;
    size_t salt_length;
    uint8_t password[144u];
    size_t password_length;
    uint8_t output_block[64u];
    uint8_t bytes_used;
    uint32_t block_number;
} psa_pbkdf2_key_derivation_t;
# 28 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_driver_contexts_key_derivation.h" 2




typedef union {
    unsigned dummy;



    psa_hkdf_key_derivation_t hkdf;



    psa_tls12_prf_key_derivation_t tls12_prf;


    psa_tls12_ecjpake_to_pms_t tls12_ecjpake_to_pms;


    psa_pbkdf2_key_derivation_t pbkdf2;

} psa_driver_key_derivation_context_t;
# 201 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_struct.h" 2

struct psa_key_derivation_s {



    psa_algorithm_t alg;
    unsigned int can_output_key : 1;
    size_t capacity;
    psa_driver_key_derivation_context_t ctx;

};







static inline struct psa_key_derivation_s psa_key_derivation_operation_init(
    void)
{
    const struct psa_key_derivation_s v = { 0, 0, 0, { 0 } };
    return v;
}

struct psa_custom_key_parameters_s {

    uint32_t flags;
};
# 252 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_struct.h"
struct psa_key_production_parameters_s {
    uint32_t flags;
    uint8_t data[];
};
# 268 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_struct.h"
struct psa_key_policy_s {
    psa_key_usage_t usage;
    psa_algorithm_t alg;
    psa_algorithm_t alg2;
};
typedef struct psa_key_policy_s psa_key_policy_t;


static inline struct psa_key_policy_s psa_key_policy_init(void)
{
    const struct psa_key_policy_s v = { 0, 0, 0 };
    return v;
}



typedef uint16_t psa_key_bits_t;
# 295 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_struct.h"
struct psa_key_attributes_s {




    psa_key_type_t type;
    psa_key_bits_t bits;
    psa_key_lifetime_t lifetime;
    psa_key_policy_t policy;
# 315 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_struct.h"
    mbedtls_svc_key_id_t id;
};
# 329 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_struct.h"
static inline struct psa_key_attributes_s psa_key_attributes_init(void)
{
    const struct psa_key_attributes_s v = { ((psa_key_type_t) 0x0000), 0, ((psa_key_lifetime_t) 0x00000000), { 0, 0, 0 }, ((psa_key_id_t) 0) };
    return v;
}

static inline void psa_set_key_id(psa_key_attributes_t *attributes,
                                  mbedtls_svc_key_id_t key)
{
    psa_key_lifetime_t lifetime = attributes->lifetime;

    attributes->id = key;

    if ((((psa_key_persistence_t) ((lifetime) & 0x000000ff)) == ((psa_key_persistence_t) 0x00))) {
        attributes->lifetime =
            ((((psa_key_location_t) ((lifetime) >> 8))) << 8 | (((psa_key_lifetime_t) 0x00000001)))

                                                        ;
    }
}

static inline mbedtls_svc_key_id_t psa_get_key_id(
    const psa_key_attributes_t *attributes)
{
    return attributes->id;
}
# 364 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_struct.h"
static inline void psa_set_key_lifetime(psa_key_attributes_t *attributes,
                                        psa_key_lifetime_t lifetime)
{
    attributes->lifetime = lifetime;
    if ((((psa_key_persistence_t) ((lifetime) & 0x000000ff)) == ((psa_key_persistence_t) 0x00))) {



        attributes->id = 0;

    }
}

static inline psa_key_lifetime_t psa_get_key_lifetime(
    const psa_key_attributes_t *attributes)
{
    return attributes->lifetime;
}

static inline void psa_extend_key_usage_flags(psa_key_usage_t *usage_flags)
{
    if (*usage_flags & ((psa_key_usage_t) 0x00001000)) {
        *usage_flags |= ((psa_key_usage_t) 0x00000400);
    }

    if (*usage_flags & ((psa_key_usage_t) 0x00002000)) {
        *usage_flags |= ((psa_key_usage_t) 0x00000800);
    }
}

static inline void psa_set_key_usage_flags(psa_key_attributes_t *attributes,
                                           psa_key_usage_t usage_flags)
{
    psa_extend_key_usage_flags(&usage_flags);
    attributes->policy.usage = usage_flags;
}

static inline psa_key_usage_t psa_get_key_usage_flags(
    const psa_key_attributes_t *attributes)
{
    return attributes->policy.usage;
}

static inline void psa_set_key_algorithm(psa_key_attributes_t *attributes,
                                         psa_algorithm_t alg)
{
    attributes->policy.alg = alg;
}

static inline psa_algorithm_t psa_get_key_algorithm(
    const psa_key_attributes_t *attributes)
{
    return attributes->policy.alg;
}

static inline void psa_set_key_type(psa_key_attributes_t *attributes,
                                    psa_key_type_t type)
{
    attributes->type = type;
}

static inline psa_key_type_t psa_get_key_type(
    const psa_key_attributes_t *attributes)
{
    return attributes->type;
}

static inline void psa_set_key_bits(psa_key_attributes_t *attributes,
                                    size_t bits)
{
    if (bits > 0xfff8) {
        attributes->bits = ((psa_key_bits_t) -1);
    } else {
        attributes->bits = (psa_key_bits_t) bits;
    }
}

static inline size_t psa_get_key_bits(
    const psa_key_attributes_t *attributes)
{
    return attributes->bits;
}




struct psa_sign_hash_interruptible_operation_s {
# 460 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_struct.h"
    unsigned int id;

    psa_driver_sign_hash_interruptible_context_t ctx;

    unsigned int error_occurred : 1;

    uint32_t num_ops;

};







static inline struct psa_sign_hash_interruptible_operation_s
psa_sign_hash_interruptible_operation_init(void)
{
    const struct psa_sign_hash_interruptible_operation_s v =
        { 0, { 0 }, 0, 0 };

    return v;
}




struct psa_verify_hash_interruptible_operation_s {
# 498 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_struct.h"
    unsigned int id;

    psa_driver_verify_hash_interruptible_context_t ctx;

    unsigned int error_occurred : 1;

    uint32_t num_ops;

};







static inline struct psa_verify_hash_interruptible_operation_s
psa_verify_hash_interruptible_operation_init(void)
{
    const struct psa_verify_hash_interruptible_operation_s v =
        { 0, { 0 }, 0, 0 };

    return v;
}
# 72 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto.h" 2
# 106 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto.h"
psa_status_t psa_crypto_init(void);
# 122 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto.h"
static psa_key_attributes_t psa_key_attributes_init(void);
# 148 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto.h"
static void psa_set_key_id(psa_key_attributes_t *attributes,
                           mbedtls_svc_key_id_t key);
# 196 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto.h"
static void psa_set_key_lifetime(psa_key_attributes_t *attributes,
                                 psa_key_lifetime_t lifetime);
# 211 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto.h"
static mbedtls_svc_key_id_t psa_get_key_id(
    const psa_key_attributes_t *attributes);
# 224 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto.h"
static psa_key_lifetime_t psa_get_key_lifetime(
    const psa_key_attributes_t *attributes);
# 243 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto.h"
static void psa_set_key_usage_flags(psa_key_attributes_t *attributes,
                                    psa_key_usage_t usage_flags);
# 256 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto.h"
static psa_key_usage_t psa_get_key_usage_flags(
    const psa_key_attributes_t *attributes);
# 289 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto.h"
static void psa_set_key_algorithm(psa_key_attributes_t *attributes,
                                  psa_algorithm_t alg);
# 303 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto.h"
static psa_algorithm_t psa_get_key_algorithm(
    const psa_key_attributes_t *attributes);
# 320 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto.h"
static void psa_set_key_type(psa_key_attributes_t *attributes,
                             psa_key_type_t type);
# 338 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto.h"
static void psa_set_key_bits(psa_key_attributes_t *attributes,
                             size_t bits);
# 351 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto.h"
static psa_key_type_t psa_get_key_type(const psa_key_attributes_t *attributes);
# 363 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto.h"
static size_t psa_get_key_bits(const psa_key_attributes_t *attributes);
# 393 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto.h"
psa_status_t psa_get_key_attributes(mbedtls_svc_key_id_t key,
                                    psa_key_attributes_t *attributes);
# 408 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto.h"
void psa_reset_key_attributes(psa_key_attributes_t *attributes);
# 437 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto.h"
psa_status_t psa_purge_key(mbedtls_svc_key_id_t key);
# 527 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto.h"
psa_status_t psa_copy_key(mbedtls_svc_key_id_t source_key,
                          const psa_key_attributes_t *attributes,
                          mbedtls_svc_key_id_t *target_key);
# 582 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto.h"
psa_status_t psa_destroy_key(mbedtls_svc_key_id_t key);
# 661 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto.h"
psa_status_t psa_import_key(const psa_key_attributes_t *attributes,
                            const uint8_t *data,
                            size_t data_length,
                            mbedtls_svc_key_id_t *key);
# 756 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto.h"
psa_status_t psa_export_key(mbedtls_svc_key_id_t key,
                            uint8_t *data,
                            size_t data_size,
                            size_t *data_length);
# 831 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto.h"
psa_status_t psa_export_public_key(mbedtls_svc_key_id_t key,
                                   uint8_t *data,
                                   size_t data_size,
                                   size_t *data_length);
# 875 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto.h"
psa_status_t psa_hash_compute(psa_algorithm_t alg,
                              const uint8_t *input,
                              size_t input_length,
                              uint8_t *hash,
                              size_t hash_size,
                              size_t *hash_length);
# 910 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto.h"
psa_status_t psa_hash_compare(psa_algorithm_t alg,
                              const uint8_t *input,
                              size_t input_length,
                              const uint8_t *hash,
                              size_t hash_length);
# 944 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto.h"
typedef struct psa_hash_operation_s psa_hash_operation_t;
# 954 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto.h"
static psa_hash_operation_t psa_hash_operation_init(void);
# 1004 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto.h"
psa_status_t psa_hash_setup(psa_hash_operation_t *operation,
                            psa_algorithm_t alg);
# 1030 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto.h"
psa_status_t psa_hash_update(psa_hash_operation_t *operation,
                             const uint8_t *input,
                             size_t input_length);
# 1076 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto.h"
psa_status_t psa_hash_finish(psa_hash_operation_t *operation,
                             uint8_t *hash,
                             size_t hash_size,
                             size_t *hash_length);
# 1117 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto.h"
psa_status_t psa_hash_verify(psa_hash_operation_t *operation,
                             const uint8_t *hash,
                             size_t hash_length);
# 1146 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto.h"
psa_status_t psa_hash_abort(psa_hash_operation_t *operation);
# 1175 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto.h"
psa_status_t psa_hash_clone(const psa_hash_operation_t *source_operation,
                            psa_hash_operation_t *target_operation);
# 1226 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto.h"
psa_status_t psa_mac_compute(mbedtls_svc_key_id_t key,
                             psa_algorithm_t alg,
                             const uint8_t *input,
                             size_t input_length,
                             uint8_t *mac,
                             size_t mac_size,
                             size_t *mac_length);
# 1267 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto.h"
psa_status_t psa_mac_verify(mbedtls_svc_key_id_t key,
                            psa_algorithm_t alg,
                            const uint8_t *input,
                            size_t input_length,
                            const uint8_t *mac,
                            size_t mac_length);
# 1303 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto.h"
typedef struct psa_mac_operation_s psa_mac_operation_t;
# 1313 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto.h"
static psa_mac_operation_t psa_mac_operation_init(void);
# 1373 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto.h"
psa_status_t psa_mac_sign_setup(psa_mac_operation_t *operation,
                                mbedtls_svc_key_id_t key,
                                psa_algorithm_t alg);
# 1435 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto.h"
psa_status_t psa_mac_verify_setup(psa_mac_operation_t *operation,
                                  mbedtls_svc_key_id_t key,
                                  psa_algorithm_t alg);
# 1465 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto.h"
psa_status_t psa_mac_update(psa_mac_operation_t *operation,
                            const uint8_t *input,
                            size_t input_length);
# 1514 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto.h"
psa_status_t psa_mac_sign_finish(psa_mac_operation_t *operation,
                                 uint8_t *mac,
                                 size_t mac_size,
                                 size_t *mac_length);
# 1557 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto.h"
psa_status_t psa_mac_verify_finish(psa_mac_operation_t *operation,
                                   const uint8_t *mac,
                                   size_t mac_length);
# 1586 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto.h"
psa_status_t psa_mac_abort(psa_mac_operation_t *operation);
# 1633 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto.h"
psa_status_t psa_cipher_encrypt(mbedtls_svc_key_id_t key,
                                psa_algorithm_t alg,
                                const uint8_t *input,
                                size_t input_length,
                                uint8_t *output,
                                size_t output_size,
                                size_t *output_length);
# 1680 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto.h"
psa_status_t psa_cipher_decrypt(mbedtls_svc_key_id_t key,
                                psa_algorithm_t alg,
                                const uint8_t *input,
                                size_t input_length,
                                uint8_t *output,
                                size_t output_size,
                                size_t *output_length);
# 1716 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto.h"
typedef struct psa_cipher_operation_s psa_cipher_operation_t;
# 1726 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto.h"
static psa_cipher_operation_t psa_cipher_operation_init(void);
# 1787 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto.h"
psa_status_t psa_cipher_encrypt_setup(psa_cipher_operation_t *operation,
                                      mbedtls_svc_key_id_t key,
                                      psa_algorithm_t alg);
# 1850 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto.h"
psa_status_t psa_cipher_decrypt_setup(psa_cipher_operation_t *operation,
                                      mbedtls_svc_key_id_t key,
                                      psa_algorithm_t alg);
# 1888 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto.h"
psa_status_t psa_cipher_generate_iv(psa_cipher_operation_t *operation,
                                    uint8_t *iv,
                                    size_t iv_size,
                                    size_t *iv_length);
# 1929 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto.h"
psa_status_t psa_cipher_set_iv(psa_cipher_operation_t *operation,
                               const uint8_t *iv,
                               size_t iv_length);
# 1970 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto.h"
psa_status_t psa_cipher_update(psa_cipher_operation_t *operation,
                               const uint8_t *input,
                               size_t input_length,
                               uint8_t *output,
                               size_t output_size,
                               size_t *output_length);
# 2022 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto.h"
psa_status_t psa_cipher_finish(psa_cipher_operation_t *operation,
                               uint8_t *output,
                               size_t output_size,
                               size_t *output_length);
# 2052 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto.h"
psa_status_t psa_cipher_abort(psa_cipher_operation_t *operation);
# 2121 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto.h"
psa_status_t psa_aead_encrypt(mbedtls_svc_key_id_t key,
                              psa_algorithm_t alg,
                              const uint8_t *nonce,
                              size_t nonce_length,
                              const uint8_t *additional_data,
                              size_t additional_data_length,
                              const uint8_t *plaintext,
                              size_t plaintext_length,
                              uint8_t *ciphertext,
                              size_t ciphertext_size,
                              size_t *ciphertext_length);
# 2194 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto.h"
psa_status_t psa_aead_decrypt(mbedtls_svc_key_id_t key,
                              psa_algorithm_t alg,
                              const uint8_t *nonce,
                              size_t nonce_length,
                              const uint8_t *additional_data,
                              size_t additional_data_length,
                              const uint8_t *ciphertext,
                              size_t ciphertext_length,
                              uint8_t *plaintext,
                              size_t plaintext_size,
                              size_t *plaintext_length);
# 2234 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto.h"
typedef struct psa_aead_operation_s psa_aead_operation_t;
# 2244 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto.h"
static psa_aead_operation_t psa_aead_operation_init(void);
# 2312 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto.h"
psa_status_t psa_aead_encrypt_setup(psa_aead_operation_t *operation,
                                    mbedtls_svc_key_id_t key,
                                    psa_algorithm_t alg);
# 2378 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto.h"
psa_status_t psa_aead_decrypt_setup(psa_aead_operation_t *operation,
                                    mbedtls_svc_key_id_t key,
                                    psa_algorithm_t alg);
# 2417 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto.h"
psa_status_t psa_aead_generate_nonce(psa_aead_operation_t *operation,
                                     uint8_t *nonce,
                                     size_t nonce_size,
                                     size_t *nonce_length);
# 2457 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto.h"
psa_status_t psa_aead_set_nonce(psa_aead_operation_t *operation,
                                const uint8_t *nonce,
                                size_t nonce_length);
# 2502 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto.h"
psa_status_t psa_aead_set_lengths(psa_aead_operation_t *operation,
                                  size_t ad_length,
                                  size_t plaintext_length);
# 2550 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto.h"
psa_status_t psa_aead_update_ad(psa_aead_operation_t *operation,
                                const uint8_t *input,
                                size_t input_length);
# 2634 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto.h"
psa_status_t psa_aead_update(psa_aead_operation_t *operation,
                             const uint8_t *input,
                             size_t input_length,
                             uint8_t *output,
                             size_t output_size,
                             size_t *output_length);
# 2720 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto.h"
psa_status_t psa_aead_finish(psa_aead_operation_t *operation,
                             uint8_t *ciphertext,
                             size_t ciphertext_size,
                             size_t *ciphertext_length,
                             uint8_t *tag,
                             size_t tag_size,
                             size_t *tag_length);
# 2803 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto.h"
psa_status_t psa_aead_verify(psa_aead_operation_t *operation,
                             uint8_t *plaintext,
                             size_t plaintext_size,
                             size_t *plaintext_length,
                             const uint8_t *tag,
                             size_t tag_length);
# 2835 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto.h"
psa_status_t psa_aead_abort(psa_aead_operation_t *operation);
# 2901 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto.h"
psa_status_t psa_sign_message(mbedtls_svc_key_id_t key,
                              psa_algorithm_t alg,
                              const uint8_t *input,
                              size_t input_length,
                              uint8_t *signature,
                              size_t signature_size,
                              size_t *signature_length);
# 2953 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto.h"
psa_status_t psa_verify_message(mbedtls_svc_key_id_t key,
                                psa_algorithm_t alg,
                                const uint8_t *input,
                                size_t input_length,
                                const uint8_t *signature,
                                size_t signature_length);
# 3006 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto.h"
psa_status_t psa_sign_hash(mbedtls_svc_key_id_t key,
                           psa_algorithm_t alg,
                           const uint8_t *hash,
                           size_t hash_length,
                           uint8_t *signature,
                           size_t signature_size,
                           size_t *signature_length);
# 3057 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto.h"
psa_status_t psa_verify_hash(mbedtls_svc_key_id_t key,
                             psa_algorithm_t alg,
                             const uint8_t *hash,
                             size_t hash_length,
                             const uint8_t *signature,
                             size_t signature_length);
# 3115 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto.h"
psa_status_t psa_asymmetric_encrypt(mbedtls_svc_key_id_t key,
                                    psa_algorithm_t alg,
                                    const uint8_t *input,
                                    size_t input_length,
                                    const uint8_t *salt,
                                    size_t salt_length,
                                    uint8_t *output,
                                    size_t output_size,
                                    size_t *output_length);
# 3176 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto.h"
psa_status_t psa_asymmetric_decrypt(mbedtls_svc_key_id_t key,
                                    psa_algorithm_t alg,
                                    const uint8_t *input,
                                    size_t input_length,
                                    const uint8_t *salt,
                                    size_t salt_length,
                                    uint8_t *output,
                                    size_t output_size,
                                    size_t *output_length);
# 3221 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto.h"
typedef struct psa_key_derivation_s psa_key_derivation_operation_t;
# 3231 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto.h"
static psa_key_derivation_operation_t psa_key_derivation_operation_init(void);
# 3292 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto.h"
psa_status_t psa_key_derivation_setup(
    psa_key_derivation_operation_t *operation,
    psa_algorithm_t alg);
# 3315 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto.h"
psa_status_t psa_key_derivation_get_capacity(
    const psa_key_derivation_operation_t *operation,
    size_t *capacity);
# 3343 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto.h"
psa_status_t psa_key_derivation_set_capacity(
    psa_key_derivation_operation_t *operation,
    size_t capacity);
# 3396 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto.h"
psa_status_t psa_key_derivation_input_bytes(
    psa_key_derivation_operation_t *operation,
    psa_key_derivation_step_t step,
    const uint8_t *data,
    size_t data_length);
# 3439 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto.h"
psa_status_t psa_key_derivation_input_integer(
    psa_key_derivation_operation_t *operation,
    psa_key_derivation_step_t step,
    uint64_t value);
# 3507 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto.h"
psa_status_t psa_key_derivation_input_key(
    psa_key_derivation_operation_t *operation,
    psa_key_derivation_step_t step,
    mbedtls_svc_key_id_t key);
# 3575 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto.h"
psa_status_t psa_key_derivation_key_agreement(
    psa_key_derivation_operation_t *operation,
    psa_key_derivation_step_t step,
    mbedtls_svc_key_id_t private_key,
    const uint8_t *peer_key,
    size_t peer_key_length);
# 3622 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto.h"
psa_status_t psa_key_derivation_output_bytes(
    psa_key_derivation_operation_t *operation,
    uint8_t *output,
    size_t output_length);
# 3777 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto.h"
psa_status_t psa_key_derivation_output_key(
    const psa_key_attributes_t *attributes,
    psa_key_derivation_operation_t *operation,
    mbedtls_svc_key_id_t *key);
# 3849 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto.h"
psa_status_t psa_key_derivation_output_key_custom(
    const psa_key_attributes_t *attributes,
    psa_key_derivation_operation_t *operation,
    const psa_custom_key_parameters_t *custom,
    const uint8_t *custom_data,
    size_t custom_data_length,
    mbedtls_svc_key_id_t *key);
# 3931 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto.h"
psa_status_t psa_key_derivation_output_key_ext(
    const psa_key_attributes_t *attributes,
    psa_key_derivation_operation_t *operation,
    const psa_key_production_parameters_t *params,
    size_t params_data_length,
    mbedtls_svc_key_id_t *key);
# 3992 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto.h"
psa_status_t psa_key_derivation_verify_bytes(
    psa_key_derivation_operation_t *operation,
    const uint8_t *expected,
    size_t expected_length);
# 4057 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto.h"
psa_status_t psa_key_derivation_verify_key(
    psa_key_derivation_operation_t *operation,
    psa_key_id_t expected);
# 4084 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto.h"
psa_status_t psa_key_derivation_abort(
    psa_key_derivation_operation_t *operation);
# 4137 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto.h"
psa_status_t psa_raw_key_agreement(psa_algorithm_t alg,
                                   mbedtls_svc_key_id_t private_key,
                                   const uint8_t *peer_key,
                                   size_t peer_key_length,
                                   uint8_t *output,
                                   size_t output_size,
                                   size_t *output_length);
# 4175 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto.h"
psa_status_t psa_generate_random(uint8_t *output,
                                 size_t output_size);
# 4226 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto.h"
psa_status_t psa_generate_key(const psa_key_attributes_t *attributes,
                              mbedtls_svc_key_id_t *key);
# 4279 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto.h"
psa_status_t psa_generate_key_custom(const psa_key_attributes_t *attributes,
                                     const psa_custom_key_parameters_t *custom,
                                     const uint8_t *custom_data,
                                     size_t custom_data_length,
                                     mbedtls_svc_key_id_t *key);
# 4336 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto.h"
psa_status_t psa_generate_key_ext(const psa_key_attributes_t *attributes,
                                  const psa_key_production_parameters_t *params,
                                  size_t params_data_length,
                                  mbedtls_svc_key_id_t *key);
# 4379 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto.h"
typedef struct psa_sign_hash_interruptible_operation_s psa_sign_hash_interruptible_operation_t;
# 4412 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto.h"
typedef struct psa_verify_hash_interruptible_operation_s psa_verify_hash_interruptible_operation_t;
# 4486 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto.h"
void psa_interruptible_set_max_ops(uint32_t max_ops);
# 4505 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto.h"
uint32_t psa_interruptible_get_max_ops(void);
# 4533 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto.h"
uint32_t psa_sign_hash_get_num_ops(
    const psa_sign_hash_interruptible_operation_t *operation);
# 4560 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto.h"
uint32_t psa_verify_hash_get_num_ops(
    const psa_verify_hash_interruptible_operation_t *operation);
# 4634 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto.h"
psa_status_t psa_sign_hash_start(
    psa_sign_hash_interruptible_operation_t *operation,
    mbedtls_svc_key_id_t key, psa_algorithm_t alg,
    const uint8_t *hash, size_t hash_length);
# 4727 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto.h"
psa_status_t psa_sign_hash_complete(
    psa_sign_hash_interruptible_operation_t *operation,
    uint8_t *signature, size_t signature_size,
    size_t *signature_length);
# 4769 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto.h"
psa_status_t psa_sign_hash_abort(
    psa_sign_hash_interruptible_operation_t *operation);
# 4846 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto.h"
psa_status_t psa_verify_hash_start(
    psa_verify_hash_interruptible_operation_t *operation,
    mbedtls_svc_key_id_t key, psa_algorithm_t alg,
    const uint8_t *hash, size_t hash_length,
    const uint8_t *signature, size_t signature_length);
# 4923 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto.h"
psa_status_t psa_verify_hash_complete(
    psa_verify_hash_interruptible_operation_t *operation);
# 4963 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto.h"
psa_status_t psa_verify_hash_abort(
    psa_verify_hash_interruptible_operation_t *operation);
# 4975 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto.h"
# 1 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_extra.h" 1
# 21 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_extra.h"
# 1 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_compat.h" 1
# 31 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_compat.h"
typedef mbedtls_svc_key_id_t psa_key_handle_t;
# 41 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_compat.h"
static inline int psa_key_handle_is_null(psa_key_handle_t handle)
{
    return mbedtls_svc_key_id_is_null(handle);
}
# 106 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_compat.h"
psa_status_t psa_open_key(mbedtls_svc_key_id_t key,
                          psa_key_handle_t *handle);
# 147 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_compat.h"
psa_status_t psa_close_key(psa_key_handle_t handle);
# 22 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_extra.h" 2
# 68 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_extra.h"
static inline void psa_set_key_enrollment_algorithm(
    psa_key_attributes_t *attributes,
    psa_algorithm_t alg2)
{
    attributes->policy.alg2 = alg2;
}







static inline psa_algorithm_t psa_get_key_enrollment_algorithm(
    const psa_key_attributes_t *attributes)
{
    return attributes->policy.alg2;
}
# 223 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_extra.h"
void mbedtls_psa_crypto_free(void);







typedef struct mbedtls_psa_stats_s {

    size_t volatile_slots;


    size_t persistent_slots;


    size_t external_slots;


    size_t half_filled_slots;

    size_t cache_slots;

    size_t empty_slots;

    size_t locked_slots;

    psa_key_id_t max_open_internal_key_id;

    psa_key_id_t max_open_external_key_id;
} mbedtls_psa_stats_t;
# 262 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_extra.h"
void mbedtls_psa_get_stats(mbedtls_psa_stats_t *stats);
# 333 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_extra.h"
psa_status_t mbedtls_psa_inject_entropy(const uint8_t *seed,
                                        size_t seed_size);
# 516 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_extra.h"
typedef uint64_t psa_drv_slot_number_t;
# 612 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_extra.h"
int psa_can_do_hash(psa_algorithm_t hash_alg);
# 627 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_extra.h"
int psa_can_do_cipher(psa_key_type_t key_type, psa_algorithm_t cipher_alg);
# 797 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_extra.h"
typedef uint8_t psa_pake_role_t;







typedef uint8_t psa_pake_step_t;
# 815 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_extra.h"
typedef uint8_t psa_pake_primitive_type_t;






typedef uint8_t psa_pake_family_t;





typedef uint32_t psa_pake_primitive_t;
# 1084 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_extra.h"
struct psa_pake_cipher_suite_s {
    psa_algorithm_t algorithm;
    psa_pake_primitive_type_t type;
    psa_pake_family_t family;
    uint16_t bits;
    psa_algorithm_t hash;
};

struct psa_crypto_driver_pake_inputs_s {
    uint8_t *password;
    size_t password_len;
    uint8_t *user;
    size_t user_len;
    uint8_t *peer;
    size_t peer_len;
    psa_key_attributes_t attributes;
    struct psa_pake_cipher_suite_s cipher_suite;
};

typedef enum psa_crypto_driver_pake_step {
    PSA_JPAKE_STEP_INVALID = 0,
    PSA_JPAKE_X1_STEP_KEY_SHARE = 1,
    PSA_JPAKE_X1_STEP_ZK_PUBLIC = 2,
    PSA_JPAKE_X1_STEP_ZK_PROOF = 3,
    PSA_JPAKE_X2_STEP_KEY_SHARE = 4,
    PSA_JPAKE_X2_STEP_ZK_PUBLIC = 5,
    PSA_JPAKE_X2_STEP_ZK_PROOF = 6,
    PSA_JPAKE_X2S_STEP_KEY_SHARE = 7,
    PSA_JPAKE_X2S_STEP_ZK_PUBLIC = 8,
    PSA_JPAKE_X2S_STEP_ZK_PROOF = 9,
    PSA_JPAKE_X4S_STEP_KEY_SHARE = 10,
    PSA_JPAKE_X4S_STEP_ZK_PUBLIC = 11,
    PSA_JPAKE_X4S_STEP_ZK_PROOF = 12
} psa_crypto_driver_pake_step_t;

typedef enum psa_jpake_round {
    PSA_JPAKE_FIRST = 0,
    PSA_JPAKE_SECOND = 1,
    PSA_JPAKE_FINISHED = 2
} psa_jpake_round_t;

typedef enum psa_jpake_io_mode {
    PSA_JPAKE_INPUT = 0,
    PSA_JPAKE_OUTPUT = 1
} psa_jpake_io_mode_t;

struct psa_jpake_computation_stage_s {

    psa_jpake_round_t round;

    psa_jpake_io_mode_t io_mode;

    uint8_t inputs;

    uint8_t outputs;

    psa_pake_step_t step;
};






struct psa_pake_operation_s {
# 1158 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_extra.h"
    unsigned int id;

    psa_algorithm_t alg;

    psa_pake_primitive_t primitive;


    uint8_t stage;

    union {
        uint8_t dummy;

        struct psa_jpake_computation_stage_s jpake;

    } computation_stage;
    union {
        psa_driver_pake_context_t ctx;
        struct psa_crypto_driver_pake_inputs_s inputs;
    } data;

};
# 1190 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_extra.h"
typedef struct psa_pake_cipher_suite_s psa_pake_cipher_suite_t;



static psa_pake_cipher_suite_t psa_pake_cipher_suite_init(void);







static psa_algorithm_t psa_pake_cs_get_algorithm(
    const psa_pake_cipher_suite_t *cipher_suite);
# 1219 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_extra.h"
static void psa_pake_cs_set_algorithm(psa_pake_cipher_suite_t *cipher_suite,
                                      psa_algorithm_t algorithm);







static psa_pake_primitive_t psa_pake_cs_get_primitive(
    const psa_pake_cipher_suite_t *cipher_suite);
# 1244 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_extra.h"
static void psa_pake_cs_set_primitive(psa_pake_cipher_suite_t *cipher_suite,
                                      psa_pake_primitive_t primitive);







static psa_pake_family_t psa_pake_cs_get_family(
    const psa_pake_cipher_suite_t *cipher_suite);







static uint16_t psa_pake_cs_get_bits(
    const psa_pake_cipher_suite_t *cipher_suite);
# 1273 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_extra.h"
static psa_algorithm_t psa_pake_cs_get_hash(
    const psa_pake_cipher_suite_t *cipher_suite);
# 1292 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_extra.h"
static void psa_pake_cs_set_hash(psa_pake_cipher_suite_t *cipher_suite,
                                 psa_algorithm_t hash);
# 1323 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_extra.h"
typedef struct psa_pake_operation_s psa_pake_operation_t;


typedef struct psa_crypto_driver_pake_inputs_s psa_crypto_driver_pake_inputs_t;


typedef struct psa_jpake_computation_stage_s psa_jpake_computation_stage_t;



static psa_pake_operation_t psa_pake_operation_init(void);
# 1345 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_extra.h"
psa_status_t psa_crypto_driver_pake_get_password_len(
    const psa_crypto_driver_pake_inputs_t *inputs,
    size_t *password_len);
# 1361 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_extra.h"
psa_status_t psa_crypto_driver_pake_get_password(
    const psa_crypto_driver_pake_inputs_t *inputs,
    uint8_t *buffer, size_t buffer_size, size_t *buffer_length);
# 1375 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_extra.h"
psa_status_t psa_crypto_driver_pake_get_user_len(
    const psa_crypto_driver_pake_inputs_t *inputs,
    size_t *user_len);
# 1389 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_extra.h"
psa_status_t psa_crypto_driver_pake_get_peer_len(
    const psa_crypto_driver_pake_inputs_t *inputs,
    size_t *peer_len);
# 1407 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_extra.h"
psa_status_t psa_crypto_driver_pake_get_user(
    const psa_crypto_driver_pake_inputs_t *inputs,
    uint8_t *user_id, size_t user_id_size, size_t *user_id_len);
# 1425 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_extra.h"
psa_status_t psa_crypto_driver_pake_get_peer(
    const psa_crypto_driver_pake_inputs_t *inputs,
    uint8_t *peer_id, size_t peer_id_size, size_t *peer_id_length);
# 1439 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_extra.h"
psa_status_t psa_crypto_driver_pake_get_cipher_suite(
    const psa_crypto_driver_pake_inputs_t *inputs,
    psa_pake_cipher_suite_t *cipher_suite);
# 1513 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_extra.h"
psa_status_t psa_pake_setup(psa_pake_operation_t *operation,
                            const psa_pake_cipher_suite_t *cipher_suite);
# 1561 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_extra.h"
psa_status_t psa_pake_set_password_key(psa_pake_operation_t *operation,
                                       mbedtls_svc_key_id_t password);
# 1605 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_extra.h"
psa_status_t psa_pake_set_user(psa_pake_operation_t *operation,
                               const uint8_t *user_id,
                               size_t user_id_len);
# 1651 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_extra.h"
psa_status_t psa_pake_set_peer(psa_pake_operation_t *operation,
                               const uint8_t *peer_id,
                               size_t peer_id_len);
# 1693 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_extra.h"
psa_status_t psa_pake_set_role(psa_pake_operation_t *operation,
                               psa_pake_role_t role);
# 1751 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_extra.h"
psa_status_t psa_pake_output(psa_pake_operation_t *operation,
                             psa_pake_step_t step,
                             uint8_t *output,
                             size_t output_size,
                             size_t *output_length);
# 1806 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_extra.h"
psa_status_t psa_pake_input(psa_pake_operation_t *operation,
                            psa_pake_step_t step,
                            const uint8_t *input,
                            size_t input_length);
# 1869 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_extra.h"
psa_status_t psa_pake_get_implicit_key(psa_pake_operation_t *operation,
                                       psa_key_derivation_operation_t *output);
# 1896 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_extra.h"
psa_status_t psa_pake_abort(psa_pake_operation_t *operation);



static inline psa_algorithm_t psa_pake_cs_get_algorithm(
    const psa_pake_cipher_suite_t *cipher_suite)
{
    return cipher_suite->algorithm;
}

static inline void psa_pake_cs_set_algorithm(
    psa_pake_cipher_suite_t *cipher_suite,
    psa_algorithm_t algorithm)
{
    if (!(((algorithm) & ((psa_algorithm_t) 0x7f000000)) == ((psa_algorithm_t) 0x0a000000))) {
        cipher_suite->algorithm = 0;
    } else {
        cipher_suite->algorithm = algorithm;
    }
}

static inline psa_pake_primitive_t psa_pake_cs_get_primitive(
    const psa_pake_cipher_suite_t *cipher_suite)
{
    return ((cipher_suite->bits & 0xFFFF) != cipher_suite->bits) ? 0 : ((psa_pake_primitive_t) (((cipher_suite->type) << 24 | (cipher_suite->family) << 16) | (cipher_suite->bits)))
                                                 ;
}

static inline void psa_pake_cs_set_primitive(
    psa_pake_cipher_suite_t *cipher_suite,
    psa_pake_primitive_t primitive)
{
    cipher_suite->type = (psa_pake_primitive_type_t) (primitive >> 24);
    cipher_suite->family = (psa_pake_family_t) (0xFF & (primitive >> 16));
    cipher_suite->bits = (uint16_t) (0xFFFF & primitive);
}

static inline psa_pake_family_t psa_pake_cs_get_family(
    const psa_pake_cipher_suite_t *cipher_suite)
{
    return cipher_suite->family;
}

static inline uint16_t psa_pake_cs_get_bits(
    const psa_pake_cipher_suite_t *cipher_suite)
{
    return cipher_suite->bits;
}

static inline psa_algorithm_t psa_pake_cs_get_hash(
    const psa_pake_cipher_suite_t *cipher_suite)
{
    return cipher_suite->hash;
}

static inline void psa_pake_cs_set_hash(psa_pake_cipher_suite_t *cipher_suite,
                                        psa_algorithm_t hash)
{
    if (!(((hash) & ((psa_algorithm_t) 0x7f000000)) == ((psa_algorithm_t) 0x02000000))) {
        cipher_suite->hash = 0;
    } else {
        cipher_suite->hash = hash;
    }
}

static inline struct psa_pake_cipher_suite_s psa_pake_cipher_suite_init(void)
{
    const struct psa_pake_cipher_suite_s v = { ((psa_algorithm_t)0), 0, 0, 0, ((psa_algorithm_t)0) };
    return v;
}

static inline struct psa_pake_operation_s psa_pake_operation_init(void)
{
    const struct psa_pake_operation_s v = { 0, ((psa_algorithm_t)0), 0, 0, { 0 }, { { 0 } } };
    return v;
}
# 4976 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto.h" 2
# 19 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 2
# 1 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_values.h" 1
# 20 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 2

# 1 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_cipher.h" 1
# 32 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_cipher.h"
psa_status_t mbedtls_cipher_values_from_psa(psa_algorithm_t alg, psa_key_type_t key_type,
                                            size_t *key_bits, mbedtls_cipher_mode_t *mode,
                                            mbedtls_cipher_id_t *cipher_id);
# 49 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_cipher.h"
const mbedtls_cipher_info_t *mbedtls_cipher_info_from_psa(
    psa_algorithm_t alg, psa_key_type_t key_type, size_t key_bits,
    mbedtls_cipher_id_t *cipher_id);
# 78 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_cipher.h"
psa_status_t mbedtls_psa_cipher_encrypt_setup(
    mbedtls_psa_cipher_operation_t *operation,
    const psa_key_attributes_t *attributes,
    const uint8_t *key_buffer, size_t key_buffer_size,
    psa_algorithm_t alg);
# 108 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_cipher.h"
psa_status_t mbedtls_psa_cipher_decrypt_setup(
    mbedtls_psa_cipher_operation_t *operation,
    const psa_key_attributes_t *attributes,
    const uint8_t *key_buffer, size_t key_buffer_size,
    psa_algorithm_t alg);
# 136 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_cipher.h"
psa_status_t mbedtls_psa_cipher_set_iv(
    mbedtls_psa_cipher_operation_t *operation,
    const uint8_t *iv, size_t iv_length);
# 161 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_cipher.h"
psa_status_t mbedtls_psa_cipher_update(
    mbedtls_psa_cipher_operation_t *operation,
    const uint8_t *input, size_t input_length,
    uint8_t *output, size_t output_size, size_t *output_length);
# 192 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_cipher.h"
psa_status_t mbedtls_psa_cipher_finish(
    mbedtls_psa_cipher_operation_t *operation,
    uint8_t *output, size_t output_size, size_t *output_length);
# 211 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_cipher.h"
psa_status_t mbedtls_psa_cipher_abort(mbedtls_psa_cipher_operation_t *operation);
# 255 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_cipher.h"
psa_status_t mbedtls_psa_cipher_encrypt(const psa_key_attributes_t *attributes,
                                        const uint8_t *key_buffer,
                                        size_t key_buffer_size,
                                        psa_algorithm_t alg,
                                        const uint8_t *iv,
                                        size_t iv_length,
                                        const uint8_t *input,
                                        size_t input_length,
                                        uint8_t *output,
                                        size_t output_size,
                                        size_t *output_length);
# 306 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_cipher.h"
psa_status_t mbedtls_psa_cipher_decrypt(const psa_key_attributes_t *attributes,
                                        const uint8_t *key_buffer,
                                        size_t key_buffer_size,
                                        psa_algorithm_t alg,
                                        const uint8_t *input,
                                        size_t input_length,
                                        uint8_t *output,
                                        size_t output_size,
                                        size_t *output_length);
# 22 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 2
# 1 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_core.h" 1
# 22 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_core.h"
# 1 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_se_driver.h" 1
# 26 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_se_driver.h"
# 1 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_driver_common.h" 1
# 27 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_se_driver.h" 2
# 44 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_se_driver.h"
typedef struct {
# 89 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_se_driver.h"
    const void *const persistent_data;






    const size_t persistent_data_size;






    uintptr_t transient_data;
} psa_drv_se_context_t;
# 124 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_se_driver.h"
typedef psa_status_t (*psa_drv_se_init_t)(psa_drv_se_context_t *drv_context,
                                          void *persistent_data,
                                          psa_key_location_t location);
# 137 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_se_driver.h"
typedef uint64_t psa_key_slot_number_t;
# 173 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_se_driver.h"
typedef psa_status_t (*psa_drv_se_mac_setup_t)(psa_drv_se_context_t *drv_context,
                                               void *op_context,
                                               psa_key_slot_number_t key_slot,
                                               psa_algorithm_t algorithm);
# 188 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_se_driver.h"
typedef psa_status_t (*psa_drv_se_mac_update_t)(void *op_context,
                                                const uint8_t *p_input,
                                                size_t input_length);
# 208 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_se_driver.h"
typedef psa_status_t (*psa_drv_se_mac_finish_t)(void *op_context,
                                                uint8_t *p_mac,
                                                size_t mac_size,
                                                size_t *p_mac_length);
# 229 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_se_driver.h"
typedef psa_status_t (*psa_drv_se_mac_finish_verify_t)(void *op_context,
                                                       const uint8_t *p_mac,
                                                       size_t mac_length);







typedef psa_status_t (*psa_drv_se_mac_abort_t)(void *op_context);
# 259 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_se_driver.h"
typedef psa_status_t (*psa_drv_se_mac_generate_t)(psa_drv_se_context_t *drv_context,
                                                  const uint8_t *p_input,
                                                  size_t input_length,
                                                  psa_key_slot_number_t key_slot,
                                                  psa_algorithm_t alg,
                                                  uint8_t *p_mac,
                                                  size_t mac_size,
                                                  size_t *p_mac_length);
# 288 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_se_driver.h"
typedef psa_status_t (*psa_drv_se_mac_verify_t)(psa_drv_se_context_t *drv_context,
                                                const uint8_t *p_input,
                                                size_t input_length,
                                                psa_key_slot_number_t key_slot,
                                                psa_algorithm_t alg,
                                                const uint8_t *p_mac,
                                                size_t mac_length);
# 311 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_se_driver.h"
typedef struct {



    size_t context_size;


    psa_drv_se_mac_setup_t p_setup;


    psa_drv_se_mac_update_t p_update;


    psa_drv_se_mac_finish_t p_finish;


    psa_drv_se_mac_finish_verify_t p_finish_verify;


    psa_drv_se_mac_abort_t p_abort;


    psa_drv_se_mac_generate_t p_mac;


    psa_drv_se_mac_verify_t p_mac_verify;
} psa_drv_se_mac_t;
# 379 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_se_driver.h"
typedef psa_status_t (*psa_drv_se_cipher_setup_t)(psa_drv_se_context_t *drv_context,
                                                  void *op_context,
                                                  psa_key_slot_number_t key_slot,
                                                  psa_algorithm_t algorithm,
                                                  psa_encrypt_or_decrypt_t direction);
# 400 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_se_driver.h"
typedef psa_status_t (*psa_drv_se_cipher_set_iv_t)(void *op_context,
                                                   const uint8_t *p_iv,
                                                   size_t iv_length);
# 422 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_se_driver.h"
typedef psa_status_t (*psa_drv_se_cipher_update_t)(void *op_context,
                                                   const uint8_t *p_input,
                                                   size_t input_size,
                                                   uint8_t *p_output,
                                                   size_t output_size,
                                                   size_t *p_output_length);
# 443 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_se_driver.h"
typedef psa_status_t (*psa_drv_se_cipher_finish_t)(void *op_context,
                                                   uint8_t *p_output,
                                                   size_t output_size,
                                                   size_t *p_output_length);







typedef psa_status_t (*psa_drv_se_cipher_abort_t)(void *op_context);
# 479 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_se_driver.h"
typedef psa_status_t (*psa_drv_se_cipher_ecb_t)(psa_drv_se_context_t *drv_context,
                                                psa_key_slot_number_t key_slot,
                                                psa_algorithm_t algorithm,
                                                psa_encrypt_or_decrypt_t direction,
                                                const uint8_t *p_input,
                                                size_t input_size,
                                                uint8_t *p_output,
                                                size_t output_size);
# 498 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_se_driver.h"
typedef struct {



    size_t context_size;

    psa_drv_se_cipher_setup_t p_setup;

    psa_drv_se_cipher_set_iv_t p_set_iv;

    psa_drv_se_cipher_update_t p_update;

    psa_drv_se_cipher_finish_t p_finish;

    psa_drv_se_cipher_abort_t p_abort;




    psa_drv_se_cipher_ecb_t p_ecb;
} psa_drv_se_cipher_t;
# 547 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_se_driver.h"
typedef psa_status_t (*psa_drv_se_asymmetric_sign_t)(psa_drv_se_context_t *drv_context,
                                                     psa_key_slot_number_t key_slot,
                                                     psa_algorithm_t alg,
                                                     const uint8_t *p_hash,
                                                     size_t hash_length,
                                                     uint8_t *p_signature,
                                                     size_t signature_size,
                                                     size_t *p_signature_length);
# 573 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_se_driver.h"
typedef psa_status_t (*psa_drv_se_asymmetric_verify_t)(psa_drv_se_context_t *drv_context,
                                                       psa_key_slot_number_t key_slot,
                                                       psa_algorithm_t alg,
                                                       const uint8_t *p_hash,
                                                       size_t hash_length,
                                                       const uint8_t *p_signature,
                                                       size_t signature_length);
# 611 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_se_driver.h"
typedef psa_status_t (*psa_drv_se_asymmetric_encrypt_t)(psa_drv_se_context_t *drv_context,
                                                        psa_key_slot_number_t key_slot,
                                                        psa_algorithm_t alg,
                                                        const uint8_t *p_input,
                                                        size_t input_length,
                                                        const uint8_t *p_salt,
                                                        size_t salt_length,
                                                        uint8_t *p_output,
                                                        size_t output_size,
                                                        size_t *p_output_length);
# 651 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_se_driver.h"
typedef psa_status_t (*psa_drv_se_asymmetric_decrypt_t)(psa_drv_se_context_t *drv_context,
                                                        psa_key_slot_number_t key_slot,
                                                        psa_algorithm_t alg,
                                                        const uint8_t *p_input,
                                                        size_t input_length,
                                                        const uint8_t *p_salt,
                                                        size_t salt_length,
                                                        uint8_t *p_output,
                                                        size_t output_size,
                                                        size_t *p_output_length);
# 671 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_se_driver.h"
typedef struct {

    psa_drv_se_asymmetric_sign_t p_sign;

    psa_drv_se_asymmetric_verify_t p_verify;

    psa_drv_se_asymmetric_encrypt_t p_encrypt;

    psa_drv_se_asymmetric_decrypt_t p_decrypt;
} psa_drv_se_asymmetric_t;
# 724 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_se_driver.h"
typedef psa_status_t (*psa_drv_se_aead_encrypt_t)(psa_drv_se_context_t *drv_context,
                                                  psa_key_slot_number_t key_slot,
                                                  psa_algorithm_t algorithm,
                                                  const uint8_t *p_nonce,
                                                  size_t nonce_length,
                                                  const uint8_t *p_additional_data,
                                                  size_t additional_data_length,
                                                  const uint8_t *p_plaintext,
                                                  size_t plaintext_length,
                                                  uint8_t *p_ciphertext,
                                                  size_t ciphertext_size,
                                                  size_t *p_ciphertext_length);
# 766 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_se_driver.h"
typedef psa_status_t (*psa_drv_se_aead_decrypt_t)(psa_drv_se_context_t *drv_context,
                                                  psa_key_slot_number_t key_slot,
                                                  psa_algorithm_t algorithm,
                                                  const uint8_t *p_nonce,
                                                  size_t nonce_length,
                                                  const uint8_t *p_additional_data,
                                                  size_t additional_data_length,
                                                  const uint8_t *p_ciphertext,
                                                  size_t ciphertext_length,
                                                  uint8_t *p_plaintext,
                                                  size_t plaintext_size,
                                                  size_t *p_plaintext_length);
# 788 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_se_driver.h"
typedef struct {

    psa_drv_se_aead_encrypt_t p_encrypt;

    psa_drv_se_aead_decrypt_t p_decrypt;
} psa_drv_se_aead_t;
# 806 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_se_driver.h"
typedef enum {
    PSA_KEY_CREATION_IMPORT,
    PSA_KEY_CREATION_GENERATE,
    PSA_KEY_CREATION_DERIVE,
    PSA_KEY_CREATION_COPY,
# 830 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_se_driver.h"
    PSA_KEY_CREATION_REGISTER,

} psa_key_creation_method_t;
# 898 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_se_driver.h"
typedef psa_status_t (*psa_drv_se_allocate_key_t)(
    psa_drv_se_context_t *drv_context,
    void *persistent_data,
    const psa_key_attributes_t *attributes,
    psa_key_creation_method_t method,
    psa_key_slot_number_t *key_slot);
# 944 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_se_driver.h"
typedef psa_status_t (*psa_drv_se_validate_slot_number_t)(
    psa_drv_se_context_t *drv_context,
    void *persistent_data,
    const psa_key_attributes_t *attributes,
    psa_key_creation_method_t method,
    psa_key_slot_number_t key_slot);
# 980 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_se_driver.h"
typedef psa_status_t (*psa_drv_se_import_key_t)(
    psa_drv_se_context_t *drv_context,
    psa_key_slot_number_t key_slot,
    const psa_key_attributes_t *attributes,
    const uint8_t *data,
    size_t data_length,
    size_t *bits);
# 1006 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_se_driver.h"
typedef psa_status_t (*psa_drv_se_destroy_key_t)(
    psa_drv_se_context_t *drv_context,
    void *persistent_data,
    psa_key_slot_number_t key_slot);
# 1042 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_se_driver.h"
typedef psa_status_t (*psa_drv_se_export_key_t)(psa_drv_se_context_t *drv_context,
                                                psa_key_slot_number_t key,
                                                uint8_t *p_data,
                                                size_t data_size,
                                                size_t *p_data_length);
# 1094 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_se_driver.h"
typedef psa_status_t (*psa_drv_se_generate_key_t)(
    psa_drv_se_context_t *drv_context,
    psa_key_slot_number_t key_slot,
    const psa_key_attributes_t *attributes,
    uint8_t *pubkey, size_t pubkey_size, size_t *pubkey_length);
# 1109 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_se_driver.h"
typedef struct {

    psa_drv_se_allocate_key_t p_allocate;

    psa_drv_se_validate_slot_number_t p_validate_slot_number;

    psa_drv_se_import_key_t p_import;

    psa_drv_se_generate_key_t p_generate;

    psa_drv_se_destroy_key_t p_destroy;

    psa_drv_se_export_key_t p_export;

    psa_drv_se_export_key_t p_export_public;
} psa_drv_se_key_management_t;
# 1189 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_se_driver.h"
typedef psa_status_t (*psa_drv_se_key_derivation_setup_t)(psa_drv_se_context_t *drv_context,
                                                          void *op_context,
                                                          psa_algorithm_t kdf_alg,
                                                          psa_key_slot_number_t source_key);
# 1209 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_se_driver.h"
typedef psa_status_t (*psa_drv_se_key_derivation_collateral_t)(void *op_context,
                                                               uint32_t collateral_id,
                                                               const uint8_t *p_collateral,
                                                               size_t collateral_size);
# 1224 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_se_driver.h"
typedef psa_status_t (*psa_drv_se_key_derivation_derive_t)(void *op_context,
                                                           psa_key_slot_number_t dest_key);
# 1238 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_se_driver.h"
typedef psa_status_t (*psa_drv_se_key_derivation_export_t)(void *op_context,
                                                           uint8_t *p_output,
                                                           size_t output_size,
                                                           size_t *p_output_length);
# 1252 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_se_driver.h"
typedef struct {

    size_t context_size;

    psa_drv_se_key_derivation_setup_t p_setup;

    psa_drv_se_key_derivation_collateral_t p_collateral;

    psa_drv_se_key_derivation_derive_t p_derive;


    psa_drv_se_key_derivation_export_t p_export;
} psa_drv_se_key_derivation_t;
# 1278 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_se_driver.h"
typedef struct {





    uint32_t hal_version;
# 1294 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_se_driver.h"
    size_t persistent_data_size;
# 1306 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_se_driver.h"
    psa_drv_se_init_t p_init;

    const psa_drv_se_key_management_t *key_management;
    const psa_drv_se_mac_t *mac;
    const psa_drv_se_cipher_t *cipher;
    const psa_drv_se_aead_t *aead;
    const psa_drv_se_asymmetric_t *asymmetric;
    const psa_drv_se_key_derivation_t *derivation;
} psa_drv_se_t;
# 1373 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/psa/crypto_se_driver.h"
psa_status_t psa_register_se_driver(
    psa_key_location_t location,
    const psa_drv_se_t *methods);
# 23 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_core.h" 2




typedef enum {
    PSA_SLOT_EMPTY = 0,
    PSA_SLOT_FILLING,
    PSA_SLOT_FULL,
    PSA_SLOT_PENDING_DELETION,
} psa_key_slot_state_t;




typedef struct {


    psa_key_attributes_t attr;
# 61 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_core.h"
    psa_key_slot_state_t state;
# 79 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_core.h"
    union {
        struct {
# 96 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_core.h"
            int32_t next_free_relative_to_next;
        } free;

        struct {
# 127 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_core.h"
            size_t registered_readers;
        } occupied;
    } var;



    struct key_data {



        uint8_t *data;

        size_t bytes;
    } key;
} psa_key_slot_t;
# 194 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_core.h"
static inline int psa_key_slot_has_readers(const psa_key_slot_t *slot)
{
    return slot->var.occupied.registered_readers > 0;
}
# 231 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_core.h"
psa_status_t psa_wipe_key_slot(psa_key_slot_t *slot);
# 245 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_core.h"
psa_status_t psa_allocate_buffer_to_slot(psa_key_slot_t *slot,
                                         size_t buffer_length);


psa_status_t psa_remove_key_data_from_memory(psa_key_slot_t *slot);
# 268 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_core.h"
psa_status_t psa_copy_key_material_into_slot(psa_key_slot_t *slot,
                                             const uint8_t *data,
                                             size_t data_length);
# 281 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_core.h"
psa_status_t mbedtls_to_psa_error(int ret);
# 309 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_core.h"
psa_status_t psa_import_key_into_slot(
    const psa_key_attributes_t *attributes,
    const uint8_t *data, size_t data_length,
    uint8_t *key_buffer, size_t key_buffer_size,
    size_t *key_buffer_length, size_t *bits);
# 337 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_core.h"
psa_status_t psa_export_key_internal(
    const psa_key_attributes_t *attributes,
    const uint8_t *key_buffer, size_t key_buffer_size,
    uint8_t *data, size_t data_size, size_t *data_length);
# 365 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_core.h"
psa_status_t psa_export_public_key_internal(
    const psa_key_attributes_t *attributes,
    const uint8_t *key_buffer, size_t key_buffer_size,
    uint8_t *data, size_t data_size, size_t *data_length);
# 379 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_core.h"
int psa_custom_key_parameters_are_default(
    const psa_custom_key_parameters_t *custom,
    size_t custom_data_length);
# 406 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_core.h"
psa_status_t psa_generate_key_internal(const psa_key_attributes_t *attributes,
                                       const psa_custom_key_parameters_t *custom,
                                       const uint8_t *custom_data,
                                       size_t custom_data_length,
                                       uint8_t *key_buffer,
                                       size_t key_buffer_size,
                                       size_t *key_buffer_length);
# 451 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_core.h"
psa_status_t psa_sign_message_builtin(
    const psa_key_attributes_t *attributes,
    const uint8_t *key_buffer, size_t key_buffer_size,
    psa_algorithm_t alg, const uint8_t *input, size_t input_length,
    uint8_t *signature, size_t signature_size, size_t *signature_length);
# 488 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_core.h"
psa_status_t psa_verify_message_builtin(
    const psa_key_attributes_t *attributes,
    const uint8_t *key_buffer, size_t key_buffer_size,
    psa_algorithm_t alg, const uint8_t *input, size_t input_length,
    const uint8_t *signature, size_t signature_length);
# 527 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_core.h"
psa_status_t psa_sign_hash_builtin(
    const psa_key_attributes_t *attributes,
    const uint8_t *key_buffer, size_t key_buffer_size,
    psa_algorithm_t alg, const uint8_t *hash, size_t hash_length,
    uint8_t *signature, size_t signature_size, size_t *signature_length);
# 562 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_core.h"
psa_status_t psa_verify_hash_builtin(
    const psa_key_attributes_t *attributes,
    const uint8_t *key_buffer, size_t key_buffer_size,
    psa_algorithm_t alg, const uint8_t *hash, size_t hash_length,
    const uint8_t *signature, size_t signature_length);
# 585 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_core.h"
psa_status_t psa_validate_unstructured_key_bit_size(psa_key_type_t type,
                                                    size_t bits);
# 634 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_core.h"
psa_status_t psa_key_agreement_raw_builtin(
    const psa_key_attributes_t *attributes,
    const uint8_t *key_buffer,
    size_t key_buffer_size,
    psa_algorithm_t alg,
    const uint8_t *peer_key,
    size_t peer_key_length,
    uint8_t *shared_secret,
    size_t shared_secret_size,
    size_t *shared_secret_length);
# 660 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_core.h"
void mbedtls_psa_interruptible_set_max_ops(uint32_t max_ops);
# 674 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_core.h"
uint32_t mbedtls_psa_interruptible_get_max_ops(void);
# 694 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_core.h"
uint32_t mbedtls_psa_sign_hash_get_num_ops(
    const mbedtls_psa_sign_hash_interruptible_operation_t *operation);
# 715 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_core.h"
uint32_t mbedtls_psa_verify_hash_get_num_ops(
    const mbedtls_psa_verify_hash_interruptible_operation_t *operation);
# 750 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_core.h"
psa_status_t mbedtls_psa_sign_hash_start(
    mbedtls_psa_sign_hash_interruptible_operation_t *operation,
    const psa_key_attributes_t *attributes, const uint8_t *key_buffer,
    size_t key_buffer_size, psa_algorithm_t alg,
    const uint8_t *hash, size_t hash_length);
# 797 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_core.h"
psa_status_t mbedtls_psa_sign_hash_complete(
    mbedtls_psa_sign_hash_interruptible_operation_t *operation,
    uint8_t *signature, size_t signature_size,
    size_t *signature_length);
# 817 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_core.h"
psa_status_t mbedtls_psa_sign_hash_abort(
    mbedtls_psa_sign_hash_interruptible_operation_t *operation);
# 855 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_core.h"
psa_status_t mbedtls_psa_verify_hash_start(
    mbedtls_psa_verify_hash_interruptible_operation_t *operation,
    const psa_key_attributes_t *attributes,
    const uint8_t *key_buffer, size_t key_buffer_size,
    psa_algorithm_t alg,
    const uint8_t *hash, size_t hash_length,
    const uint8_t *signature, size_t signature_length);
# 892 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_core.h"
psa_status_t mbedtls_psa_verify_hash_complete(
    mbedtls_psa_verify_hash_interruptible_operation_t *operation);
# 910 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_core.h"
psa_status_t mbedtls_psa_verify_hash_abort(
    mbedtls_psa_verify_hash_interruptible_operation_t *operation);

typedef struct psa_crypto_local_input_s {
    uint8_t *buffer;
    size_t length;
} psa_crypto_local_input_t;
# 931 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_core.h"
psa_status_t psa_crypto_local_input_alloc(const uint8_t *input, size_t input_len,
                                          psa_crypto_local_input_t *local_input);







void psa_crypto_local_input_free(psa_crypto_local_input_t *local_input);

typedef struct psa_crypto_local_output_s {
    uint8_t *original;
    uint8_t *buffer;
    size_t length;
} psa_crypto_local_output_t;
# 967 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_core.h"
psa_status_t psa_crypto_local_output_alloc(uint8_t *output, size_t output_len,
                                           psa_crypto_local_output_t *local_output);
# 981 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_core.h"
psa_status_t psa_crypto_local_output_free(psa_crypto_local_output_t *local_output);
# 23 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 2
# 1 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_invasive.h" 1
# 31 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_invasive.h"
# 1 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/entropy.h" 1
# 16 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/entropy.h"
# 1 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/lib/gcc/riscv32-unknown-elf/15.1.0/include/stddef.h" 1 3 4
# 17 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/entropy.h" 2

# 1 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/md.h" 1
# 19 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/entropy.h" 2
# 88 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/entropy.h"
typedef int (*mbedtls_entropy_f_source_ptr)(void *data, unsigned char *output, size_t len,
                                            size_t *olen);




typedef struct mbedtls_entropy_source_state {
    mbedtls_entropy_f_source_ptr f_source;
    void *p_source;
    size_t size;
    size_t threshold;
    int strong;
}
mbedtls_entropy_source_state;




typedef struct mbedtls_entropy_context {
    mbedtls_md_context_t accumulator;
    int accumulator_started;


    int source_count;
    mbedtls_entropy_source_state source[20];






}
mbedtls_entropy_context;
# 135 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/entropy.h"
void mbedtls_entropy_init(mbedtls_entropy_context *ctx);






void mbedtls_entropy_free(mbedtls_entropy_context *ctx);
# 161 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/entropy.h"
int mbedtls_entropy_add_source(mbedtls_entropy_context *ctx,
                               mbedtls_entropy_f_source_ptr f_source, void *p_source,
                               size_t threshold, int strong);
# 173 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/entropy.h"
int mbedtls_entropy_gather(mbedtls_entropy_context *ctx);
# 186 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/entropy.h"
int mbedtls_entropy_func(void *data, unsigned char *output, size_t len);
# 198 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/entropy.h"
int mbedtls_entropy_update_manual(mbedtls_entropy_context *ctx,
                                  const unsigned char *data, size_t len);
# 250 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/entropy.h"
int mbedtls_entropy_self_test(int verbose);
# 266 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/entropy.h"
int mbedtls_entropy_source_self_test(int verbose);
# 32 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_invasive.h" 2
# 66 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_invasive.h"
psa_status_t mbedtls_psa_crypto_configure_entropy_sources(
    void (* entropy_init)(mbedtls_entropy_context *ctx),
    void (* entropy_free)(mbedtls_entropy_context *ctx));
# 24 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 2
# 1 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_driver_wrappers.h" 1
# 13 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_driver_wrappers.h"
# 1 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_aead.h" 1
# 67 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_aead.h"
psa_status_t mbedtls_psa_aead_encrypt(
    const psa_key_attributes_t *attributes,
    const uint8_t *key_buffer, size_t key_buffer_size,
    psa_algorithm_t alg,
    const uint8_t *nonce, size_t nonce_length,
    const uint8_t *additional_data, size_t additional_data_length,
    const uint8_t *plaintext, size_t plaintext_length,
    uint8_t *ciphertext, size_t ciphertext_size, size_t *ciphertext_length);
# 130 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_aead.h"
psa_status_t mbedtls_psa_aead_decrypt(
    const psa_key_attributes_t *attributes,
    const uint8_t *key_buffer, size_t key_buffer_size,
    psa_algorithm_t alg,
    const uint8_t *nonce, size_t nonce_length,
    const uint8_t *additional_data, size_t additional_data_length,
    const uint8_t *ciphertext, size_t ciphertext_length,
    uint8_t *plaintext, size_t plaintext_size, size_t *plaintext_length);
# 175 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_aead.h"
psa_status_t mbedtls_psa_aead_encrypt_setup(
    mbedtls_psa_aead_operation_t *operation,
    const psa_key_attributes_t *attributes,
    const uint8_t *key_buffer,
    size_t key_buffer_size,
    psa_algorithm_t alg);
# 218 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_aead.h"
psa_status_t mbedtls_psa_aead_decrypt_setup(
    mbedtls_psa_aead_operation_t *operation,
    const psa_key_attributes_t *attributes,
    const uint8_t *key_buffer,
    size_t key_buffer_size,
    psa_algorithm_t alg);
# 253 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_aead.h"
psa_status_t mbedtls_psa_aead_set_nonce(
    mbedtls_psa_aead_operation_t *operation,
    const uint8_t *nonce,
    size_t nonce_length);
# 294 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_aead.h"
psa_status_t mbedtls_psa_aead_set_lengths(
    mbedtls_psa_aead_operation_t *operation,
    size_t ad_length,
    size_t plaintext_length);
# 331 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_aead.h"
psa_status_t mbedtls_psa_aead_update_ad(
    mbedtls_psa_aead_operation_t *operation,
    const uint8_t *input,
    size_t input_length);
# 391 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_aead.h"
psa_status_t mbedtls_psa_aead_update(
    mbedtls_psa_aead_operation_t *operation,
    const uint8_t *input,
    size_t input_length,
    uint8_t *output,
    size_t output_size,
    size_t *output_length);
# 463 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_aead.h"
psa_status_t mbedtls_psa_aead_finish(
    mbedtls_psa_aead_operation_t *operation,
    uint8_t *ciphertext,
    size_t ciphertext_size,
    size_t *ciphertext_length,
    uint8_t *tag,
    size_t tag_size,
    size_t *tag_length);
# 496 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_aead.h"
psa_status_t mbedtls_psa_aead_abort(
    mbedtls_psa_aead_operation_t *operation);
# 14 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_driver_wrappers.h" 2


# 1 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_driver_wrappers_no_static.h" 1
# 15 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_driver_wrappers_no_static.h"
psa_status_t psa_driver_wrapper_export_public_key(
    const psa_key_attributes_t *attributes,
    const uint8_t *key_buffer, size_t key_buffer_size,
    uint8_t *data, size_t data_size, size_t *data_length);

psa_status_t psa_driver_wrapper_get_key_buffer_size(
    const psa_key_attributes_t *attributes,
    size_t *key_buffer_size);

psa_status_t psa_driver_wrapper_get_builtin_key(
    psa_drv_slot_number_t slot_number,
    psa_key_attributes_t *attributes,
    uint8_t *key_buffer, size_t key_buffer_size, size_t *key_buffer_length);
# 17 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_driver_wrappers.h" 2
# 1 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_hash.h" 1
# 40 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_hash.h"
psa_status_t mbedtls_psa_hash_compute(
    psa_algorithm_t alg,
    const uint8_t *input,
    size_t input_length,
    uint8_t *hash,
    size_t hash_size,
    size_t *hash_length);
# 80 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_hash.h"
psa_status_t mbedtls_psa_hash_setup(
    mbedtls_psa_hash_operation_t *operation,
    psa_algorithm_t alg);
# 112 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_hash.h"
psa_status_t mbedtls_psa_hash_clone(
    const mbedtls_psa_hash_operation_t *source_operation,
    mbedtls_psa_hash_operation_t *target_operation);
# 139 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_hash.h"
psa_status_t mbedtls_psa_hash_update(
    mbedtls_psa_hash_operation_t *operation,
    const uint8_t *input,
    size_t input_length);
# 178 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_hash.h"
psa_status_t mbedtls_psa_hash_finish(
    mbedtls_psa_hash_operation_t *operation,
    uint8_t *hash,
    size_t hash_size,
    size_t *hash_length);
# 208 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_hash.h"
psa_status_t mbedtls_psa_hash_abort(
    mbedtls_psa_hash_operation_t *operation);
# 18 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_driver_wrappers.h" 2
# 1 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_mac.h" 1
# 46 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_mac.h"
psa_status_t mbedtls_psa_mac_compute(
    const psa_key_attributes_t *attributes,
    const uint8_t *key_buffer,
    size_t key_buffer_size,
    psa_algorithm_t alg,
    const uint8_t *input,
    size_t input_length,
    uint8_t *mac,
    size_t mac_size,
    size_t *mac_length);
# 85 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_mac.h"
psa_status_t mbedtls_psa_mac_sign_setup(
    mbedtls_psa_mac_operation_t *operation,
    const psa_key_attributes_t *attributes,
    const uint8_t *key_buffer,
    size_t key_buffer_size,
    psa_algorithm_t alg);
# 120 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_mac.h"
psa_status_t mbedtls_psa_mac_verify_setup(
    mbedtls_psa_mac_operation_t *operation,
    const psa_key_attributes_t *attributes,
    const uint8_t *key_buffer,
    size_t key_buffer_size,
    psa_algorithm_t alg);
# 152 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_mac.h"
psa_status_t mbedtls_psa_mac_update(
    mbedtls_psa_mac_operation_t *operation,
    const uint8_t *input,
    size_t input_length);
# 194 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_mac.h"
psa_status_t mbedtls_psa_mac_sign_finish(
    mbedtls_psa_mac_operation_t *operation,
    uint8_t *mac,
    size_t mac_size,
    size_t *mac_length);
# 235 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_mac.h"
psa_status_t mbedtls_psa_mac_verify_finish(
    mbedtls_psa_mac_operation_t *operation,
    const uint8_t *mac,
    size_t mac_length);
# 261 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_mac.h"
psa_status_t mbedtls_psa_mac_abort(
    mbedtls_psa_mac_operation_t *operation);
# 19 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_driver_wrappers.h" 2
# 1 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_pake.h" 1
# 37 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_pake.h"
psa_status_t mbedtls_psa_pake_setup(mbedtls_psa_pake_operation_t *operation,
                                    const psa_crypto_driver_pake_inputs_t *inputs);
# 74 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_pake.h"
psa_status_t mbedtls_psa_pake_output(mbedtls_psa_pake_operation_t *operation,
                                     psa_crypto_driver_pake_step_t step,
                                     uint8_t *output,
                                     size_t output_size,
                                     size_t *output_length);
# 112 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_pake.h"
psa_status_t mbedtls_psa_pake_input(mbedtls_psa_pake_operation_t *operation,
                                    psa_crypto_driver_pake_step_t step,
                                    const uint8_t *input,
                                    size_t input_length);
# 139 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_pake.h"
psa_status_t mbedtls_psa_pake_get_implicit_key(
    mbedtls_psa_pake_operation_t *operation,
    uint8_t *output, size_t output_size,
    size_t *output_length);
# 157 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_pake.h"
psa_status_t mbedtls_psa_pake_abort(mbedtls_psa_pake_operation_t *operation);
# 20 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_driver_wrappers.h" 2
# 1 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_rsa.h" 1
# 13 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_rsa.h"
# 1 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/rsa.h" 1
# 85 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/rsa.h"
typedef struct mbedtls_rsa_context {
    int ver;



    size_t len;

    mbedtls_mpi N;
    mbedtls_mpi E;

    mbedtls_mpi D;
    mbedtls_mpi P;
    mbedtls_mpi Q;

    mbedtls_mpi DP;
    mbedtls_mpi DQ;
    mbedtls_mpi QP;

    mbedtls_mpi RN;

    mbedtls_mpi RP;
    mbedtls_mpi RQ;

    mbedtls_mpi Vi;
    mbedtls_mpi Vf;

    int padding;


    int hash_id;







}
mbedtls_rsa_context;
# 139 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/rsa.h"
void mbedtls_rsa_init(mbedtls_rsa_context *ctx);
# 175 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/rsa.h"
int mbedtls_rsa_set_padding(mbedtls_rsa_context *ctx, int padding,
                            mbedtls_md_type_t hash_id);
# 187 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/rsa.h"
int mbedtls_rsa_get_padding_mode(const mbedtls_rsa_context *ctx);
# 198 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/rsa.h"
int mbedtls_rsa_get_md_alg(const mbedtls_rsa_context *ctx);
# 229 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/rsa.h"
int mbedtls_rsa_import(mbedtls_rsa_context *ctx,
                       const mbedtls_mpi *N,
                       const mbedtls_mpi *P, const mbedtls_mpi *Q,
                       const mbedtls_mpi *D, const mbedtls_mpi *E);
# 268 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/rsa.h"
int mbedtls_rsa_import_raw(mbedtls_rsa_context *ctx,
                           unsigned char const *N, size_t N_len,
                           unsigned char const *P, size_t P_len,
                           unsigned char const *Q, size_t Q_len,
                           unsigned char const *D, size_t D_len,
                           unsigned char const *E, size_t E_len);
# 307 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/rsa.h"
int mbedtls_rsa_complete(mbedtls_rsa_context *ctx);
# 349 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/rsa.h"
int mbedtls_rsa_export(const mbedtls_rsa_context *ctx,
                       mbedtls_mpi *N, mbedtls_mpi *P, mbedtls_mpi *Q,
                       mbedtls_mpi *D, mbedtls_mpi *E);
# 400 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/rsa.h"
int mbedtls_rsa_export_raw(const mbedtls_rsa_context *ctx,
                           unsigned char *N, size_t N_len,
                           unsigned char *P, size_t P_len,
                           unsigned char *Q, size_t Q_len,
                           unsigned char *D, size_t D_len,
                           unsigned char *E, size_t E_len);
# 426 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/rsa.h"
int mbedtls_rsa_export_crt(const mbedtls_rsa_context *ctx,
                           mbedtls_mpi *DP, mbedtls_mpi *DQ, mbedtls_mpi *QP);
# 437 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/rsa.h"
size_t mbedtls_rsa_get_bitlen(const mbedtls_rsa_context *ctx);
# 447 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/rsa.h"
size_t mbedtls_rsa_get_len(const mbedtls_rsa_context *ctx);
# 467 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/rsa.h"
int mbedtls_rsa_gen_key(mbedtls_rsa_context *ctx,
                        mbedtls_f_rng_t *f_rng,
                        void *p_rng,
                        unsigned int nbits, int exponent);
# 486 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/rsa.h"
int mbedtls_rsa_check_pubkey(const mbedtls_rsa_context *ctx);
# 524 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/rsa.h"
int mbedtls_rsa_check_privkey(const mbedtls_rsa_context *ctx);
# 537 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/rsa.h"
int mbedtls_rsa_check_pub_priv(const mbedtls_rsa_context *pub,
                               const mbedtls_rsa_context *prv);
# 559 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/rsa.h"
int mbedtls_rsa_public(mbedtls_rsa_context *ctx,
                       const unsigned char *input,
                       unsigned char *output);
# 592 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/rsa.h"
int mbedtls_rsa_private(mbedtls_rsa_context *ctx,
                        mbedtls_f_rng_t *f_rng,
                        void *p_rng,
                        const unsigned char *input,
                        unsigned char *output);
# 621 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/rsa.h"
int mbedtls_rsa_pkcs1_encrypt(mbedtls_rsa_context *ctx,
                              mbedtls_f_rng_t *f_rng,
                              void *p_rng,
                              size_t ilen,
                              const unsigned char *input,
                              unsigned char *output);
# 648 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/rsa.h"
int mbedtls_rsa_rsaes_pkcs1_v15_encrypt(mbedtls_rsa_context *ctx,
                                        mbedtls_f_rng_t *f_rng,
                                        void *p_rng,
                                        size_t ilen,
                                        const unsigned char *input,
                                        unsigned char *output);
# 682 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/rsa.h"
int mbedtls_rsa_rsaes_oaep_encrypt(mbedtls_rsa_context *ctx,
                                   mbedtls_f_rng_t *f_rng,
                                   void *p_rng,
                                   const unsigned char *label, size_t label_len,
                                   size_t ilen,
                                   const unsigned char *input,
                                   unsigned char *output);
# 725 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/rsa.h"
int mbedtls_rsa_pkcs1_decrypt(mbedtls_rsa_context *ctx,
                              mbedtls_f_rng_t *f_rng,
                              void *p_rng,
                              size_t *olen,
                              const unsigned char *input,
                              unsigned char *output,
                              size_t output_max_len);
# 767 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/rsa.h"
int mbedtls_rsa_rsaes_pkcs1_v15_decrypt(mbedtls_rsa_context *ctx,
                                        mbedtls_f_rng_t *f_rng,
                                        void *p_rng,
                                        size_t *olen,
                                        const unsigned char *input,
                                        unsigned char *output,
                                        size_t output_max_len);
# 808 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/rsa.h"
int mbedtls_rsa_rsaes_oaep_decrypt(mbedtls_rsa_context *ctx,
                                   mbedtls_f_rng_t *f_rng,
                                   void *p_rng,
                                   const unsigned char *label, size_t label_len,
                                   size_t *olen,
                                   const unsigned char *input,
                                   unsigned char *output,
                                   size_t output_max_len);
# 851 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/rsa.h"
int mbedtls_rsa_pkcs1_sign(mbedtls_rsa_context *ctx,
                           mbedtls_f_rng_t *f_rng,
                           void *p_rng,
                           mbedtls_md_type_t md_alg,
                           unsigned int hashlen,
                           const unsigned char *hash,
                           unsigned char *sig);
# 883 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/rsa.h"
int mbedtls_rsa_rsassa_pkcs1_v15_sign(mbedtls_rsa_context *ctx,
                                      mbedtls_f_rng_t *f_rng,
                                      void *p_rng,
                                      mbedtls_md_type_t md_alg,
                                      unsigned int hashlen,
                                      const unsigned char *hash,
                                      unsigned char *sig);
# 935 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/rsa.h"
int mbedtls_rsa_rsassa_pss_sign_ext(mbedtls_rsa_context *ctx,
                                    mbedtls_f_rng_t *f_rng,
                                    void *p_rng,
                                    mbedtls_md_type_t md_alg,
                                    unsigned int hashlen,
                                    const unsigned char *hash,
                                    int saltlen,
                                    unsigned char *sig);
# 985 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/rsa.h"
int mbedtls_rsa_rsassa_pss_sign(mbedtls_rsa_context *ctx,
                                mbedtls_f_rng_t *f_rng,
                                void *p_rng,
                                mbedtls_md_type_t md_alg,
                                unsigned int hashlen,
                                const unsigned char *hash,
                                unsigned char *sig);
# 1020 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/rsa.h"
int mbedtls_rsa_pkcs1_verify(mbedtls_rsa_context *ctx,
                             mbedtls_md_type_t md_alg,
                             unsigned int hashlen,
                             const unsigned char *hash,
                             const unsigned char *sig);
# 1045 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/rsa.h"
int mbedtls_rsa_rsassa_pkcs1_v15_verify(mbedtls_rsa_context *ctx,
                                        mbedtls_md_type_t md_alg,
                                        unsigned int hashlen,
                                        const unsigned char *hash,
                                        const unsigned char *sig);
# 1080 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/rsa.h"
int mbedtls_rsa_rsassa_pss_verify(mbedtls_rsa_context *ctx,
                                  mbedtls_md_type_t md_alg,
                                  unsigned int hashlen,
                                  const unsigned char *hash,
                                  const unsigned char *sig);
# 1120 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/rsa.h"
int mbedtls_rsa_rsassa_pss_verify_ext(mbedtls_rsa_context *ctx,
                                      mbedtls_md_type_t md_alg,
                                      unsigned int hashlen,
                                      const unsigned char *hash,
                                      mbedtls_md_type_t mgf1_hash_id,
                                      int expected_salt_len,
                                      const unsigned char *sig);
# 1137 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/rsa.h"
int mbedtls_rsa_copy(mbedtls_rsa_context *dst, const mbedtls_rsa_context *src);
# 1146 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/rsa.h"
void mbedtls_rsa_free(mbedtls_rsa_context *ctx);
# 1156 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/rsa.h"
int mbedtls_rsa_self_test(int verbose);
# 14 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_rsa.h" 2
# 25 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_rsa.h"
psa_status_t mbedtls_psa_rsa_load_representation(psa_key_type_t type,
                                                 const uint8_t *data,
                                                 size_t data_length,
                                                 mbedtls_rsa_context **p_rsa);
# 56 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_rsa.h"
psa_status_t mbedtls_psa_rsa_import_key(
    const psa_key_attributes_t *attributes,
    const uint8_t *data, size_t data_length,
    uint8_t *key_buffer, size_t key_buffer_size,
    size_t *key_buffer_length, size_t *bits);
# 70 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_rsa.h"
psa_status_t mbedtls_psa_rsa_export_key(psa_key_type_t type,
                                        mbedtls_rsa_context *rsa,
                                        uint8_t *data,
                                        size_t data_size,
                                        size_t *data_length);
# 100 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_rsa.h"
psa_status_t mbedtls_psa_rsa_export_public_key(
    const psa_key_attributes_t *attributes,
    const uint8_t *key_buffer, size_t key_buffer_size,
    uint8_t *data, size_t data_size, size_t *data_length);
# 127 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_rsa.h"
psa_status_t mbedtls_psa_rsa_generate_key(
    const psa_key_attributes_t *attributes,
    const uint8_t *custom_data, size_t custom_data_length,
    uint8_t *key_buffer, size_t key_buffer_size, size_t *key_buffer_length);
# 165 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_rsa.h"
psa_status_t mbedtls_psa_rsa_sign_hash(
    const psa_key_attributes_t *attributes,
    const uint8_t *key_buffer, size_t key_buffer_size,
    psa_algorithm_t alg, const uint8_t *hash, size_t hash_length,
    uint8_t *signature, size_t signature_size, size_t *signature_length);
# 201 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_rsa.h"
psa_status_t mbedtls_psa_rsa_verify_hash(
    const psa_key_attributes_t *attributes,
    const uint8_t *key_buffer, size_t key_buffer_size,
    psa_algorithm_t alg, const uint8_t *hash, size_t hash_length,
    const uint8_t *signature, size_t signature_length);
# 251 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_rsa.h"
psa_status_t mbedtls_psa_asymmetric_encrypt(const psa_key_attributes_t *attributes,
                                            const uint8_t *key_buffer,
                                            size_t key_buffer_size,
                                            psa_algorithm_t alg,
                                            const uint8_t *input,
                                            size_t input_length,
                                            const uint8_t *salt,
                                            size_t salt_length,
                                            uint8_t *output,
                                            size_t output_size,
                                            size_t *output_length);
# 309 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_rsa.h"
psa_status_t mbedtls_psa_asymmetric_decrypt(const psa_key_attributes_t *attributes,
                                            const uint8_t *key_buffer,
                                            size_t key_buffer_size,
                                            psa_algorithm_t alg,
                                            const uint8_t *input,
                                            size_t input_length,
                                            const uint8_t *salt,
                                            size_t salt_length,
                                            uint8_t *output,
                                            size_t output_size,
                                            size_t *output_length);
# 21 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_driver_wrappers.h" 2

# 1 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/platform.h" 1
# 58 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/platform.h"
# 1 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/stdio.h" 1 3
# 36 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/stdio.h" 3
# 1 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/lib/gcc/riscv32-unknown-elf/15.1.0/include/stddef.h" 1 3 4
# 37 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/stdio.h" 2 3



# 1 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/lib/gcc/riscv32-unknown-elf/15.1.0/include/stdarg.h" 1 3 4
# 40 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/lib/gcc/riscv32-unknown-elf/15.1.0/include/stdarg.h" 3 4

# 40 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/lib/gcc/riscv32-unknown-elf/15.1.0/include/stdarg.h" 3 4
typedef __builtin_va_list __gnuc_va_list;
# 41 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/stdio.h" 2 3





typedef __gnuc_va_list va_list;
# 63 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/stdio.h" 3



typedef __FILE FILE;



typedef _fpos_t fpos_t;





typedef __off_t off_t;




typedef _ssize_t ssize_t;



# 1 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/sys/stdio.h" 1 3
# 86 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/stdio.h" 2 3
# 187 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/stdio.h" 3
char * ctermid (char *);




FILE * tmpfile (void);
char * tmpnam (char *);

char * tempnam (const char *, const char *) __attribute__((__malloc__)) __attribute__((__warn_unused_result__));

int fclose (FILE *);
int fflush (FILE *);
FILE * freopen (const char *restrict, const char *restrict, FILE *restrict);
void setbuf (FILE *restrict, char *restrict);
int setvbuf (FILE *restrict, char *restrict, int, size_t);
int fprintf (FILE *restrict, const char *restrict, ...)
               __attribute__ ((__format__ (__printf__, 2, 3)));
int fscanf (FILE *restrict, const char *restrict, ...)
               __attribute__ ((__format__ (__scanf__, 2, 3)));
int printf (const char *restrict, ...)
               __attribute__ ((__format__ (__printf__, 1, 2)));
int scanf (const char *restrict, ...)
               __attribute__ ((__format__ (__scanf__, 1, 2)));
int sscanf (const char *restrict, const char *restrict, ...)
               __attribute__ ((__format__ (__scanf__, 2, 3)));
int vfprintf (FILE *restrict, const char *restrict, __gnuc_va_list)
               __attribute__ ((__format__ (__printf__, 2, 0)));
int vprintf (const char *, __gnuc_va_list)
               __attribute__ ((__format__ (__printf__, 1, 0)));
int vsprintf (char *restrict, const char *restrict, __gnuc_va_list)
               __attribute__ ((__format__ (__printf__, 2, 0)));
int fgetc (FILE *);
char * fgets (char *restrict, int, FILE *restrict);
int fputc (int, FILE *);
int fputs (const char *restrict, FILE *restrict);
int getc (FILE *);
int getchar (void);
char * gets (char *);
int putc (int, FILE *);
int putchar (int);
int puts (const char *);
int ungetc (int, FILE *);
size_t fread (void *restrict, size_t _size, size_t _n, FILE *restrict);
size_t fwrite (const void *restrict , size_t _size, size_t _n, FILE *);



int fgetpos (FILE *restrict, fpos_t *restrict);

int fseek (FILE *, long, int);



int fsetpos (FILE *, const fpos_t *);

long ftell ( FILE *);
void rewind (FILE *);
void clearerr (FILE *);
int feof (FILE *);
int ferror (FILE *);
void perror (const char *);

FILE * fopen (const char *restrict _name, const char *restrict _type);
int sprintf (char *restrict, const char *restrict, ...)
               __attribute__ ((__format__ (__printf__, 2, 3)));
int remove (const char *);
int rename (const char *, const char *);
# 263 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/stdio.h" 3
int fseeko (FILE *, off_t, int);
off_t ftello (FILE *);







int snprintf (char *restrict, size_t, const char *restrict, ...)
               __attribute__ ((__format__ (__printf__, 3, 4)));
int vsnprintf (char *restrict, size_t, const char *restrict, __gnuc_va_list)
               __attribute__ ((__format__ (__printf__, 3, 0)));
int vfscanf (FILE *restrict, const char *restrict, __gnuc_va_list)
               __attribute__ ((__format__ (__scanf__, 2, 0)));
int vscanf (const char *, __gnuc_va_list)
               __attribute__ ((__format__ (__scanf__, 1, 0)));
int vsscanf (const char *restrict, const char *restrict, __gnuc_va_list)
               __attribute__ ((__format__ (__scanf__, 2, 0)));
# 290 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/stdio.h" 3
int asiprintf (char **, const char *, ...)
               __attribute__ ((__format__ (__printf__, 2, 3)));
char * asniprintf (char *, size_t *, const char *, ...)
               __attribute__ ((__format__ (__printf__, 3, 4)));
char * asnprintf (char *restrict, size_t *restrict, const char *restrict, ...)
               __attribute__ ((__format__ (__printf__, 3, 4)));

int diprintf (int, const char *, ...)
               __attribute__ ((__format__ (__printf__, 2, 3)));

int fiprintf (FILE *, const char *, ...)
               __attribute__ ((__format__ (__printf__, 2, 3)));
int fiscanf (FILE *, const char *, ...)
               __attribute__ ((__format__ (__scanf__, 2, 3)));
int iprintf (const char *, ...)
               __attribute__ ((__format__ (__printf__, 1, 2)));
int iscanf (const char *, ...)
               __attribute__ ((__format__ (__scanf__, 1, 2)));
int siprintf (char *, const char *, ...)
               __attribute__ ((__format__ (__printf__, 2, 3)));
int siscanf (const char *, const char *, ...)
               __attribute__ ((__format__ (__scanf__, 2, 3)));
int sniprintf (char *, size_t, const char *, ...)
               __attribute__ ((__format__ (__printf__, 3, 4)));
int vasiprintf (char **, const char *, __gnuc_va_list)
               __attribute__ ((__format__ (__printf__, 2, 0)));
char * vasniprintf (char *, size_t *, const char *, __gnuc_va_list)
               __attribute__ ((__format__ (__printf__, 3, 0)));
char * vasnprintf (char *, size_t *, const char *, __gnuc_va_list)
               __attribute__ ((__format__ (__printf__, 3, 0)));
int vdiprintf (int, const char *, __gnuc_va_list)
               __attribute__ ((__format__ (__printf__, 2, 0)));
int vfiprintf (FILE *, const char *, __gnuc_va_list)
               __attribute__ ((__format__ (__printf__, 2, 0)));
int vfiscanf (FILE *, const char *, __gnuc_va_list)
               __attribute__ ((__format__ (__scanf__, 2, 0)));
int viprintf (const char *, __gnuc_va_list)
               __attribute__ ((__format__ (__printf__, 1, 0)));
int viscanf (const char *, __gnuc_va_list)
               __attribute__ ((__format__ (__scanf__, 1, 0)));
int vsiprintf (char *, const char *, __gnuc_va_list)
               __attribute__ ((__format__ (__printf__, 2, 0)));
int vsiscanf (const char *, const char *, __gnuc_va_list)
               __attribute__ ((__format__ (__scanf__, 2, 0)));
int vsniprintf (char *, size_t, const char *, __gnuc_va_list)
               __attribute__ ((__format__ (__printf__, 3, 0)));
# 345 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/stdio.h" 3
FILE * fdopen (int, const char *);

int fileno (FILE *);


int pclose (FILE *);
FILE * popen (const char *, const char *);



void setbuffer (FILE *, char *, int);
int setlinebuf (FILE *);



int getw (FILE *);
int putw (int, FILE *);


int getc_unlocked (FILE *);
int getchar_unlocked (void);
void flockfile (FILE *);
int ftrylockfile (FILE *);
void funlockfile (FILE *);
int putc_unlocked (int, FILE *);
int putchar_unlocked (int);
# 380 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/stdio.h" 3
int dprintf (int, const char *restrict, ...)
               __attribute__ ((__format__ (__printf__, 2, 3)));

FILE * fmemopen (void *restrict, size_t, const char *restrict);


FILE * open_memstream (char **, size_t *);
int vdprintf (int, const char *restrict, __gnuc_va_list)
               __attribute__ ((__format__ (__printf__, 2, 0)));



int renameat (int, const char *, int, const char *);
# 402 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/stdio.h" 3
int _asiprintf_r (struct _reent *, char **, const char *, ...)
               __attribute__ ((__format__ (__printf__, 3, 4)));
char * _asniprintf_r (struct _reent *, char *, size_t *, const char *, ...)
               __attribute__ ((__format__ (__printf__, 4, 5)));
char * _asnprintf_r (struct _reent *, char *restrict, size_t *restrict, const char *restrict, ...)
               __attribute__ ((__format__ (__printf__, 4, 5)));
int _asprintf_r (struct _reent *, char **restrict, const char *restrict, ...)
               __attribute__ ((__format__ (__printf__, 3, 4)));
int _diprintf_r (struct _reent *, int, const char *, ...)
               __attribute__ ((__format__ (__printf__, 3, 4)));
int _dprintf_r (struct _reent *, int, const char *restrict, ...)
               __attribute__ ((__format__ (__printf__, 3, 4)));
int _fclose_r (struct _reent *, FILE *);
int _fcloseall_r (struct _reent *);
FILE * _fdopen_r (struct _reent *, int, const char *);
int _fflush_r (struct _reent *, FILE *);
int _fgetc_r (struct _reent *, FILE *);
int _fgetc_unlocked_r (struct _reent *, FILE *);
char * _fgets_r (struct _reent *, char *restrict, int, FILE *restrict);
char * _fgets_unlocked_r (struct _reent *, char *restrict, int, FILE *restrict);




int _fgetpos_r (struct _reent *, FILE *, fpos_t *);
int _fsetpos_r (struct _reent *, FILE *, const fpos_t *);

int _fiprintf_r (struct _reent *, FILE *, const char *, ...)
               __attribute__ ((__format__ (__printf__, 3, 4)));
int _fiscanf_r (struct _reent *, FILE *, const char *, ...)
               __attribute__ ((__format__ (__scanf__, 3, 4)));
FILE * _fmemopen_r (struct _reent *, void *restrict, size_t, const char *restrict);
FILE * _fopen_r (struct _reent *, const char *restrict, const char *restrict);
FILE * _freopen_r (struct _reent *, const char *restrict, const char *restrict, FILE *restrict);
int _fprintf_r (struct _reent *, FILE *restrict, const char *restrict, ...)
               __attribute__ ((__format__ (__printf__, 3, 4)));
int _fpurge_r (struct _reent *, FILE *);
int _fputc_r (struct _reent *, int, FILE *);
int _fputc_unlocked_r (struct _reent *, int, FILE *);
int _fputs_r (struct _reent *, const char *restrict, FILE *restrict);
int _fputs_unlocked_r (struct _reent *, const char *restrict, FILE *restrict);
size_t _fread_r (struct _reent *, void *restrict, size_t _size, size_t _n, FILE *restrict);
size_t _fread_unlocked_r (struct _reent *, void *restrict, size_t _size, size_t _n, FILE *restrict);
int _fscanf_r (struct _reent *, FILE *restrict, const char *restrict, ...)
               __attribute__ ((__format__ (__scanf__, 3, 4)));
int _fseek_r (struct _reent *, FILE *, long, int);
int _fseeko_r (struct _reent *, FILE *, _off_t, int);
long _ftell_r (struct _reent *, FILE *);
_off_t _ftello_r (struct _reent *, FILE *);
void _rewind_r (struct _reent *, FILE *);
size_t _fwrite_r (struct _reent *, const void *restrict, size_t _size, size_t _n, FILE *restrict);
size_t _fwrite_unlocked_r (struct _reent *, const void *restrict, size_t _size, size_t _n, FILE *restrict);
int _getc_r (struct _reent *, FILE *);
int _getc_unlocked_r (struct _reent *, FILE *);
int _getchar_r (struct _reent *);
int _getchar_unlocked_r (struct _reent *);
char * _gets_r (struct _reent *, char *);
int _iprintf_r (struct _reent *, const char *, ...)
               __attribute__ ((__format__ (__printf__, 2, 3)));
int _iscanf_r (struct _reent *, const char *, ...)
               __attribute__ ((__format__ (__scanf__, 2, 3)));
FILE * _open_memstream_r (struct _reent *, char **, size_t *);
void _perror_r (struct _reent *, const char *);
int _printf_r (struct _reent *, const char *restrict, ...)
               __attribute__ ((__format__ (__printf__, 2, 3)));
int _putc_r (struct _reent *, int, FILE *);
int _putc_unlocked_r (struct _reent *, int, FILE *);
int _putchar_unlocked_r (struct _reent *, int);
int _putchar_r (struct _reent *, int);
int _puts_r (struct _reent *, const char *);
int _remove_r (struct _reent *, const char *);
int _rename_r (struct _reent *,
      const char *_old, const char *_new);
int _scanf_r (struct _reent *, const char *restrict, ...)
               __attribute__ ((__format__ (__scanf__, 2, 3)));
int _siprintf_r (struct _reent *, char *, const char *, ...)
               __attribute__ ((__format__ (__printf__, 3, 4)));
int _siscanf_r (struct _reent *, const char *, const char *, ...)
               __attribute__ ((__format__ (__scanf__, 3, 4)));
int _sniprintf_r (struct _reent *, char *, size_t, const char *, ...)
               __attribute__ ((__format__ (__printf__, 4, 5)));
int _snprintf_r (struct _reent *, char *restrict, size_t, const char *restrict, ...)
               __attribute__ ((__format__ (__printf__, 4, 5)));
int _sprintf_r (struct _reent *, char *restrict, const char *restrict, ...)
               __attribute__ ((__format__ (__printf__, 3, 4)));
int _sscanf_r (struct _reent *, const char *restrict, const char *restrict, ...)
               __attribute__ ((__format__ (__scanf__, 3, 4)));
char * _tempnam_r (struct _reent *, const char *, const char *);
FILE * _tmpfile_r (struct _reent *);
char * _tmpnam_r (struct _reent *, char *);
int _ungetc_r (struct _reent *, int, FILE *);
int _vasiprintf_r (struct _reent *, char **, const char *, __gnuc_va_list)
               __attribute__ ((__format__ (__printf__, 3, 0)));
char * _vasniprintf_r (struct _reent*, char *, size_t *, const char *, __gnuc_va_list)
               __attribute__ ((__format__ (__printf__, 4, 0)));
char * _vasnprintf_r (struct _reent*, char *, size_t *, const char *, __gnuc_va_list)
               __attribute__ ((__format__ (__printf__, 4, 0)));
int _vasprintf_r (struct _reent *, char **, const char *, __gnuc_va_list)
               __attribute__ ((__format__ (__printf__, 3, 0)));
int _vdiprintf_r (struct _reent *, int, const char *, __gnuc_va_list)
               __attribute__ ((__format__ (__printf__, 3, 0)));
int _vdprintf_r (struct _reent *, int, const char *restrict, __gnuc_va_list)
               __attribute__ ((__format__ (__printf__, 3, 0)));
int _vfiprintf_r (struct _reent *, FILE *, const char *, __gnuc_va_list)
               __attribute__ ((__format__ (__printf__, 3, 0)));
int _vfiscanf_r (struct _reent *, FILE *, const char *, __gnuc_va_list)
               __attribute__ ((__format__ (__scanf__, 3, 0)));
int _vfprintf_r (struct _reent *, FILE *restrict, const char *restrict, __gnuc_va_list)
               __attribute__ ((__format__ (__printf__, 3, 0)));
int _vfscanf_r (struct _reent *, FILE *restrict, const char *restrict, __gnuc_va_list)
               __attribute__ ((__format__ (__scanf__, 3, 0)));
int _viprintf_r (struct _reent *, const char *, __gnuc_va_list)
               __attribute__ ((__format__ (__printf__, 2, 0)));
int _viscanf_r (struct _reent *, const char *, __gnuc_va_list)
               __attribute__ ((__format__ (__scanf__, 2, 0)));
int _vprintf_r (struct _reent *, const char *restrict, __gnuc_va_list)
               __attribute__ ((__format__ (__printf__, 2, 0)));
int _vscanf_r (struct _reent *, const char *restrict, __gnuc_va_list)
               __attribute__ ((__format__ (__scanf__, 2, 0)));
int _vsiprintf_r (struct _reent *, char *, const char *, __gnuc_va_list)
               __attribute__ ((__format__ (__printf__, 3, 0)));
int _vsiscanf_r (struct _reent *, const char *, const char *, __gnuc_va_list)
               __attribute__ ((__format__ (__scanf__, 3, 0)));
int _vsniprintf_r (struct _reent *, char *, size_t, const char *, __gnuc_va_list)
               __attribute__ ((__format__ (__printf__, 4, 0)));
int _vsnprintf_r (struct _reent *, char *restrict, size_t, const char *restrict, __gnuc_va_list)
               __attribute__ ((__format__ (__printf__, 4, 0)));
int _vsprintf_r (struct _reent *, char *restrict, const char *restrict, __gnuc_va_list)
               __attribute__ ((__format__ (__printf__, 3, 0)));
int _vsscanf_r (struct _reent *, const char *restrict, const char *restrict, __gnuc_va_list)
               __attribute__ ((__format__ (__scanf__, 3, 0)));



int fpurge (FILE *);
ssize_t __getdelim (char **, size_t *, int, FILE *);
ssize_t __getline (char **, size_t *, FILE *);


void clearerr_unlocked (FILE *);
int feof_unlocked (FILE *);
int ferror_unlocked (FILE *);
int fileno_unlocked (FILE *);
int fflush_unlocked (FILE *);
int fgetc_unlocked (FILE *);
int fputc_unlocked (int, FILE *);
size_t fread_unlocked (void *restrict, size_t _size, size_t _n, FILE *restrict);
size_t fwrite_unlocked (const void *restrict , size_t _size, size_t _n, FILE *);
# 583 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/stdio.h" 3
int __srget_r (struct _reent *, FILE *);
int __swbuf_r (struct _reent *, int, FILE *);
# 607 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/stdio.h" 3
FILE *funopen (const void *__cookie,
  int (*__readfn)(void *__cookie, char *__buf,
    int __n),
  int (*__writefn)(void *__cookie, const char *__buf,
     int __n),
  fpos_t (*__seekfn)(void *__cookie, fpos_t __off, int __whence),
  int (*__closefn)(void *__cookie));
FILE *_funopen_r (struct _reent *, const void *__cookie,
  int (*__readfn)(void *__cookie, char *__buf,
    int __n),
  int (*__writefn)(void *__cookie, const char *__buf,
     int __n),
  fpos_t (*__seekfn)(void *__cookie, fpos_t __off, int __whence),
  int (*__closefn)(void *__cookie));
# 691 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/stdio.h" 3
static __inline__ int __sputc_r(struct _reent *_ptr, int _c, FILE *_p) {




 if (--_p->_w >= 0 || (_p->_w >= _p->_lbfsize && (char)_c != '\n'))
  return (*_p->_p++ = _c);
 else
  return (__swbuf_r(_ptr, _c, _p));
}
# 745 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/stdio.h" 3
static __inline int
_getchar_unlocked(void)
{
 struct _reent *_ptr;

 _ptr = _impure_ptr;
 return ((--(((_ptr)->_stdin))->_r < 0 ? __srget_r(_ptr, ((_ptr)->_stdin)) : (int)(*(((_ptr)->_stdin))->_p++)));
}

static __inline int
_putchar_unlocked(int _c)
{
 struct _reent *_ptr;

 _ptr = _impure_ptr;
 return (__sputc_r(_ptr, _c, ((_ptr)->_stdout)));
}
# 801 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/riscv32-unknown-elf/include/stdio.h" 3

# 59 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/platform.h" 2
# 440 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/platform.h"

# 440 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/platform.h"
typedef struct mbedtls_platform_context {
    char dummy;
}
mbedtls_platform_context;
# 464 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/platform.h"
int mbedtls_platform_setup(mbedtls_platform_context *ctx);
# 479 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/platform.h"
void mbedtls_platform_teardown(mbedtls_platform_context *ctx);
# 23 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_driver_wrappers.h" 2
# 1 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/constant_time.h" 1
# 12 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/constant_time.h"
# 1 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/lib/gcc/riscv32-unknown-elf/15.1.0/include/stddef.h" 1 3 4
# 13 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/constant_time.h" 2
# 32 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/constant_time.h"
int mbedtls_ct_memcmp(const void *a,
                      const void *b,
                      size_t n);
# 24 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_driver_wrappers.h" 2
# 72 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_driver_wrappers.h"
static inline psa_status_t psa_driver_wrapper_init( void )
{
    psa_status_t status = ((psa_status_t)-151);
# 92 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_driver_wrappers.h"
    (void) status;
    return( ((psa_status_t)0) );
}

static inline void psa_driver_wrapper_free( void )
{
# 108 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_driver_wrappers.h"
}


static inline psa_status_t psa_driver_wrapper_sign_message(
    const psa_key_attributes_t *attributes,
    const uint8_t *key_buffer,
    size_t key_buffer_size,
    psa_algorithm_t alg,
    const uint8_t *input,
    size_t input_length,
    uint8_t *signature,
    size_t signature_size,
    size_t *signature_length )
{
    psa_status_t status = ((psa_status_t)-151);
    psa_key_location_t location =
        ((psa_key_location_t) ((psa_get_key_lifetime(attributes)) >> 8));

    switch( location )
    {
        case ((psa_key_location_t) 0x000000):
# 148 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_driver_wrappers.h"
            break;
# 169 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_driver_wrappers.h"
        default:

            (void)status;
            break;
    }

    return( psa_sign_message_builtin( attributes,
                                      key_buffer,
                                      key_buffer_size,
                                      alg,
                                      input,
                                      input_length,
                                      signature,
                                      signature_size,
                                      signature_length ) );
}

static inline psa_status_t psa_driver_wrapper_verify_message(
    const psa_key_attributes_t *attributes,
    const uint8_t *key_buffer,
    size_t key_buffer_size,
    psa_algorithm_t alg,
    const uint8_t *input,
    size_t input_length,
    const uint8_t *signature,
    size_t signature_length )
{
    psa_status_t status = ((psa_status_t)-151);
    psa_key_location_t location =
        ((psa_key_location_t) ((psa_get_key_lifetime(attributes)) >> 8));

    switch( location )
    {
        case ((psa_key_location_t) 0x000000):
# 221 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_driver_wrappers.h"
            break;
# 241 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_driver_wrappers.h"
        default:

            (void)status;
            break;
    }

    return( psa_verify_message_builtin( attributes,
                                        key_buffer,
                                        key_buffer_size,
                                        alg,
                                        input,
                                        input_length,
                                        signature,
                                        signature_length ) );
}

static inline psa_status_t psa_driver_wrapper_sign_hash(
    const psa_key_attributes_t *attributes,
    const uint8_t *key_buffer, size_t key_buffer_size,
    psa_algorithm_t alg, const uint8_t *hash, size_t hash_length,
    uint8_t *signature, size_t signature_size, size_t *signature_length )
{
# 283 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_driver_wrappers.h"
    psa_status_t status = ((psa_status_t)-151);
    psa_key_location_t location =
        ((psa_key_location_t) ((psa_get_key_lifetime(attributes)) >> 8));

    switch( location )
    {
        case ((psa_key_location_t) 0x000000):
# 328 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_driver_wrappers.h"
            return( psa_sign_hash_builtin( attributes,
                                           key_buffer,
                                           key_buffer_size,
                                           alg,
                                           hash,
                                           hash_length,
                                           signature,
                                           signature_size,
                                           signature_length ) );
# 353 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_driver_wrappers.h"
        default:

            (void)status;
            return( ((psa_status_t)-135) );
    }
}

static inline psa_status_t psa_driver_wrapper_verify_hash(
    const psa_key_attributes_t *attributes,
    const uint8_t *key_buffer, size_t key_buffer_size,
    psa_algorithm_t alg, const uint8_t *hash, size_t hash_length,
    const uint8_t *signature, size_t signature_length )
{
# 386 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_driver_wrappers.h"
    psa_status_t status = ((psa_status_t)-151);
    psa_key_location_t location =
        ((psa_key_location_t) ((psa_get_key_lifetime(attributes)) >> 8));

    switch( location )
    {
        case ((psa_key_location_t) 0x000000):
# 430 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_driver_wrappers.h"
            return( psa_verify_hash_builtin( attributes,
                                             key_buffer,
                                             key_buffer_size,
                                             alg,
                                             hash,
                                             hash_length,
                                             signature,
                                             signature_length ) );
# 453 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_driver_wrappers.h"
        default:

            (void)status;
            return( ((psa_status_t)-135) );
    }
}

static inline uint32_t psa_driver_wrapper_sign_hash_get_num_ops(
    psa_sign_hash_interruptible_operation_t *operation )
{
    switch( operation->id )
    {

        case 0:
            return 0;

        case (1):
            return(mbedtls_psa_sign_hash_get_num_ops(&operation->ctx.mbedtls_ctx));







    }


    return 0;
}

static inline uint32_t psa_driver_wrapper_verify_hash_get_num_ops(
    psa_verify_hash_interruptible_operation_t *operation )
{
    switch( operation->id )
    {

        case 0:
            return 0;

        case (1):
            return (mbedtls_psa_verify_hash_get_num_ops(&operation->ctx.mbedtls_ctx));
# 503 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_driver_wrappers.h"
    }


    return 0;
}

static inline psa_status_t psa_driver_wrapper_sign_hash_start(
    psa_sign_hash_interruptible_operation_t *operation,
    const psa_key_attributes_t *attributes, const uint8_t *key_buffer,
    size_t key_buffer_size, psa_algorithm_t alg,
    const uint8_t *hash, size_t hash_length )
{
    psa_status_t status = ((psa_status_t)-151);
    psa_key_location_t location = ((psa_key_location_t) ((psa_get_key_lifetime(attributes)) >> 8))
                                                                                      ;

    switch( location )
    {
        case ((psa_key_location_t) 0x000000):
# 536 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_driver_wrappers.h"
            operation->id = (1);
            status = mbedtls_psa_sign_hash_start( &operation->ctx.mbedtls_ctx,
                                                  attributes,
                                                  key_buffer, key_buffer_size,
                                                  alg, hash, hash_length );
            break;



        default:

            status = ((psa_status_t)-135);
            break;
    }

    return( status );
}

static inline psa_status_t psa_driver_wrapper_sign_hash_complete(
    psa_sign_hash_interruptible_operation_t *operation,
    uint8_t *signature, size_t signature_size,
    size_t *signature_length )
{
    switch( operation->id )
    {
        case (1):
            return( mbedtls_psa_sign_hash_complete( &operation->ctx.mbedtls_ctx,
                                                    signature, signature_size,
                                                    signature_length ) );







    }

    ( void ) signature;
    ( void ) signature_size;
    ( void ) signature_length;

    return( ((psa_status_t)-135) );
}

static inline psa_status_t psa_driver_wrapper_sign_hash_abort(
    psa_sign_hash_interruptible_operation_t *operation )
{
    switch( operation->id )
    {
        case (1):
            return( mbedtls_psa_sign_hash_abort( &operation->ctx.mbedtls_ctx ) );







    }

    return( ((psa_status_t)-135) );
}

static inline psa_status_t psa_driver_wrapper_verify_hash_start(
    psa_verify_hash_interruptible_operation_t *operation,
    const psa_key_attributes_t *attributes, const uint8_t *key_buffer,
    size_t key_buffer_size, psa_algorithm_t alg,
    const uint8_t *hash, size_t hash_length,
    const uint8_t *signature, size_t signature_length )
{
    psa_status_t status = ((psa_status_t)-151);
    psa_key_location_t location = ((psa_key_location_t) ((psa_get_key_lifetime(attributes)) >> 8))
                                                                                      ;

    switch( location )
    {
        case ((psa_key_location_t) 0x000000):
# 628 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_driver_wrappers.h"
            operation->id = (1);
            status = mbedtls_psa_verify_hash_start( &operation->ctx.mbedtls_ctx,
                                                    attributes,
                                                    key_buffer, key_buffer_size,
                                                    alg, hash, hash_length,
                                                    signature, signature_length );
            break;



        default:

            status = ((psa_status_t)-135);
            break;
    }

    return( status );
}

static inline psa_status_t psa_driver_wrapper_verify_hash_complete(
    psa_verify_hash_interruptible_operation_t *operation )
{
    switch( operation->id )
    {
        case (1):
            return( mbedtls_psa_verify_hash_complete(
                                                     &operation->ctx.mbedtls_ctx
                                                     ) );







    }

    return( ((psa_status_t)-135) );
}

static inline psa_status_t psa_driver_wrapper_verify_hash_abort(
    psa_verify_hash_interruptible_operation_t *operation )
{
    switch( operation->id )
    {
        case (1):
            return( mbedtls_psa_verify_hash_abort( &operation->ctx.mbedtls_ctx
                                                 ) );







    }

    return( ((psa_status_t)-135) );
}
# 700 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_driver_wrappers.h"
static inline psa_status_t psa_driver_wrapper_get_key_buffer_size_from_key_data(
    const psa_key_attributes_t *attributes,
    const uint8_t *data,
    size_t data_length,
    size_t *key_buffer_size )
{
    psa_key_location_t location =
        ((psa_key_location_t) ((psa_get_key_lifetime(attributes)) >> 8));
    psa_key_type_t key_type = psa_get_key_type(attributes);

    *key_buffer_size = 0;
    switch( location )
    {
# 721 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_driver_wrappers.h"
        default:
            (void)key_type;
            (void)data;
            (void)data_length;
            return( ((psa_status_t)-135) );
    }
}

static inline psa_status_t psa_driver_wrapper_generate_key(
    const psa_key_attributes_t *attributes,
    const psa_custom_key_parameters_t *custom,
    const uint8_t *custom_data, size_t custom_data_length,
    uint8_t *key_buffer, size_t key_buffer_size, size_t *key_buffer_length )
{
    psa_status_t status = ((psa_status_t)-151);
    psa_key_location_t location =
        ((psa_key_location_t) ((psa_get_key_lifetime(attributes)) >> 8));


    int is_default_production =
        psa_custom_key_parameters_are_default(custom, custom_data_length);
    if( location != ((psa_key_location_t) 0x000000) && !is_default_production )
    {


        return ((psa_status_t)-134);
    }
# 774 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_driver_wrappers.h"
    switch( location )
    {
        case ((psa_key_location_t) 0x000000):
# 811 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_driver_wrappers.h"
            status = psa_generate_key_internal(
                attributes, custom, custom_data, custom_data_length,
                key_buffer, key_buffer_size, key_buffer_length );
            break;
# 826 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_driver_wrappers.h"
        default:

            status = ((psa_status_t)-135);
            break;
    }

    return( status );
}

static inline psa_status_t psa_driver_wrapper_import_key(
    const psa_key_attributes_t *attributes,
    const uint8_t *data,
    size_t data_length,
    uint8_t *key_buffer,
    size_t key_buffer_size,
    size_t *key_buffer_length,
    size_t *bits )
{

    psa_status_t status = ((psa_status_t)-151);
    psa_key_location_t location = ((psa_key_location_t) ((psa_get_key_lifetime( attributes )) >> 8))
                                                                          ;
# 878 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_driver_wrappers.h"
    switch( location )
    {
        case ((psa_key_location_t) 0x000000):
# 919 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_driver_wrappers.h"
            return( psa_import_key_into_slot( attributes,
                                              data, data_length,
                                              key_buffer, key_buffer_size,
                                              key_buffer_length, bits ) );
# 941 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_driver_wrappers.h"
        default:
            (void)status;
            return( ((psa_status_t)-135) );
    }

}

static inline psa_status_t psa_driver_wrapper_export_key(
    const psa_key_attributes_t *attributes,
    const uint8_t *key_buffer, size_t key_buffer_size,
    uint8_t *data, size_t data_size, size_t *data_length )

{

    psa_status_t status = ((psa_status_t)-135);
    psa_key_location_t location = ((psa_key_location_t) ((psa_get_key_lifetime( attributes )) >> 8))
                                                                          ;
# 979 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_driver_wrappers.h"
    switch( location )
    {
        case ((psa_key_location_t) 0x000000):
            return( psa_export_key_internal( attributes,
                                             key_buffer,
                                             key_buffer_size,
                                             data,
                                             data_size,
                                             data_length ) );
# 1006 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_driver_wrappers.h"
        default:

            return( status );
    }

}

static inline psa_status_t psa_driver_wrapper_copy_key(
    psa_key_attributes_t *attributes,
    const uint8_t *source_key, size_t source_key_length,
    uint8_t *target_key_buffer, size_t target_key_buffer_size,
    size_t *target_key_buffer_length )
{

    psa_status_t status = ((psa_status_t)-151);
    psa_key_location_t location =
        ((psa_key_location_t) ((psa_get_key_lifetime(attributes)) >> 8));
# 1035 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_driver_wrappers.h"
    switch( location )
    {
# 1053 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_driver_wrappers.h"
        default:
            (void)source_key;
            (void)source_key_length;
            (void)target_key_buffer;
            (void)target_key_buffer_size;
            (void)target_key_buffer_length;
            status = ((psa_status_t)-135);
    }
    return( status );

}




static inline psa_status_t psa_driver_wrapper_cipher_encrypt(
    const psa_key_attributes_t *attributes,
    const uint8_t *key_buffer,
    size_t key_buffer_size,
    psa_algorithm_t alg,
    const uint8_t *iv,
    size_t iv_length,
    const uint8_t *input,
    size_t input_length,
    uint8_t *output,
    size_t output_size,
    size_t *output_length )
{
    psa_status_t status = ((psa_status_t)-151);
    psa_key_location_t location =
        ((psa_key_location_t) ((psa_get_key_lifetime(attributes)) >> 8));

    switch( location )
    {
        case ((psa_key_location_t) 0x000000):
# 1110 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_driver_wrappers.h"
            return( mbedtls_psa_cipher_encrypt( attributes,
                                                key_buffer,
                                                key_buffer_size,
                                                alg,
                                                iv,
                                                iv_length,
                                                input,
                                                input_length,
                                                output,
                                                output_size,
                                                output_length ) );
# 1143 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_driver_wrappers.h"
        default:

            (void)status;
            (void)key_buffer;
            (void)key_buffer_size;
            (void)alg;
            (void)iv;
            (void)iv_length;
            (void)input;
            (void)input_length;
            (void)output;
            (void)output_size;
            (void)output_length;
            return( ((psa_status_t)-135) );
    }
}

static inline psa_status_t psa_driver_wrapper_cipher_decrypt(
    const psa_key_attributes_t *attributes,
    const uint8_t *key_buffer,
    size_t key_buffer_size,
    psa_algorithm_t alg,
    const uint8_t *input,
    size_t input_length,
    uint8_t *output,
    size_t output_size,
    size_t *output_length )
{
    psa_status_t status = ((psa_status_t)-151);
    psa_key_location_t location =
        ((psa_key_location_t) ((psa_get_key_lifetime(attributes)) >> 8));

    switch( location )
    {
        case ((psa_key_location_t) 0x000000):
# 1198 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_driver_wrappers.h"
            return( mbedtls_psa_cipher_decrypt( attributes,
                                                key_buffer,
                                                key_buffer_size,
                                                alg,
                                                input,
                                                input_length,
                                                output,
                                                output_size,
                                                output_length ) );
# 1227 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_driver_wrappers.h"
        default:

            (void)status;
            (void)key_buffer;
            (void)key_buffer_size;
            (void)alg;
            (void)input;
            (void)input_length;
            (void)output;
            (void)output_size;
            (void)output_length;
            return( ((psa_status_t)-135) );
    }
}

static inline psa_status_t psa_driver_wrapper_cipher_encrypt_setup(
    psa_cipher_operation_t *operation,
    const psa_key_attributes_t *attributes,
    const uint8_t *key_buffer, size_t key_buffer_size,
    psa_algorithm_t alg )
{
    psa_status_t status = ((psa_status_t)-151);
    psa_key_location_t location =
        ((psa_key_location_t) ((psa_get_key_lifetime(attributes)) >> 8));

    switch( location )
    {
        case ((psa_key_location_t) 0x000000):
# 1275 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_driver_wrappers.h"
            status = mbedtls_psa_cipher_encrypt_setup( &operation->ctx.mbedtls_ctx,
                                                       attributes,
                                                       key_buffer,
                                                       key_buffer_size,
                                                       alg );
            if( status == ((psa_status_t)0) )
                operation->id = (1);

            if( status != ((psa_status_t)-134) )
                return( status );

            return( ((psa_status_t)-134) );
# 1304 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_driver_wrappers.h"
        default:

            (void)status;
            (void)operation;
            (void)key_buffer;
            (void)key_buffer_size;
            (void)alg;
            return( ((psa_status_t)-135) );
    }
}

static inline psa_status_t psa_driver_wrapper_cipher_decrypt_setup(
    psa_cipher_operation_t *operation,
    const psa_key_attributes_t *attributes,
    const uint8_t *key_buffer, size_t key_buffer_size,
    psa_algorithm_t alg )
{
    psa_status_t status = ((psa_status_t)-135);
    psa_key_location_t location =
        ((psa_key_location_t) ((psa_get_key_lifetime(attributes)) >> 8));

    switch( location )
    {
        case ((psa_key_location_t) 0x000000):
# 1348 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_driver_wrappers.h"
            status = mbedtls_psa_cipher_decrypt_setup( &operation->ctx.mbedtls_ctx,
                                                       attributes,
                                                       key_buffer,
                                                       key_buffer_size,
                                                       alg );
            if( status == ((psa_status_t)0) )
                operation->id = (1);

            return( status );
# 1377 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_driver_wrappers.h"
        default:

            (void)status;
            (void)operation;
            (void)key_buffer;
            (void)key_buffer_size;
            (void)alg;
            return( ((psa_status_t)-135) );
    }
}

static inline psa_status_t psa_driver_wrapper_cipher_set_iv(
    psa_cipher_operation_t *operation,
    const uint8_t *iv,
    size_t iv_length )
{
    switch( operation->id )
    {

        case (1):
            return( mbedtls_psa_cipher_set_iv( &operation->ctx.mbedtls_ctx,
                                               iv,
                                               iv_length ) );
# 1415 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_driver_wrappers.h"
    }

    (void)iv;
    (void)iv_length;

    return( ((psa_status_t)-135) );
}

static inline psa_status_t psa_driver_wrapper_cipher_update(
    psa_cipher_operation_t *operation,
    const uint8_t *input,
    size_t input_length,
    uint8_t *output,
    size_t output_size,
    size_t *output_length )
{
    switch( operation->id )
    {

        case (1):
            return( mbedtls_psa_cipher_update( &operation->ctx.mbedtls_ctx,
                                               input,
                                               input_length,
                                               output,
                                               output_size,
                                               output_length ) );
# 1458 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_driver_wrappers.h"
    }

    (void)input;
    (void)input_length;
    (void)output;
    (void)output_size;
    (void)output_length;

    return( ((psa_status_t)-135) );
}

static inline psa_status_t psa_driver_wrapper_cipher_finish(
    psa_cipher_operation_t *operation,
    uint8_t *output,
    size_t output_size,
    size_t *output_length )
{
    switch( operation->id )
    {

        case (1):
            return( mbedtls_psa_cipher_finish( &operation->ctx.mbedtls_ctx,
                                               output,
                                               output_size,
                                               output_length ) );
# 1498 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_driver_wrappers.h"
    }

    (void)output;
    (void)output_size;
    (void)output_length;

    return( ((psa_status_t)-135) );
}

static inline psa_status_t psa_driver_wrapper_cipher_abort(
    psa_cipher_operation_t *operation )
{
    psa_status_t status = ((psa_status_t)-151);

    switch( operation->id )
    {

        case (1):
            return( mbedtls_psa_cipher_abort( &operation->ctx.mbedtls_ctx ) );
# 1538 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_driver_wrappers.h"
    }

    (void)status;
    return( ((psa_status_t)-135) );
}




static inline psa_status_t psa_driver_wrapper_hash_compute(
    psa_algorithm_t alg,
    const uint8_t *input,
    size_t input_length,
    uint8_t *hash,
    size_t hash_size,
    size_t *hash_length)
{
    psa_status_t status = ((psa_status_t)-151);
# 1567 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_driver_wrappers.h"
    status = mbedtls_psa_hash_compute( alg, input, input_length,
                                       hash, hash_size, hash_length );
    if( status != ((psa_status_t)-134) )
        return( status );

    (void) status;
    (void) alg;
    (void) input;
    (void) input_length;
    (void) hash;
    (void) hash_size;
    (void) hash_length;

    return( ((psa_status_t)-134) );
}

static inline psa_status_t psa_driver_wrapper_hash_setup(
    psa_hash_operation_t *operation,
    psa_algorithm_t alg )
{
    psa_status_t status = ((psa_status_t)-151);
# 1602 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_driver_wrappers.h"
    status = mbedtls_psa_hash_setup( &operation->ctx.mbedtls_ctx, alg );
    if( status == ((psa_status_t)0) )
        operation->id = (1);

    if( status != ((psa_status_t)-134) )
        return( status );


    (void) status;
    (void) operation;
    (void) alg;
    return( ((psa_status_t)-134) );
}

static inline psa_status_t psa_driver_wrapper_hash_clone(
    const psa_hash_operation_t *source_operation,
    psa_hash_operation_t *target_operation )
{
    switch( source_operation->id )
    {

        case (1):
            target_operation->id = (1);
            return( mbedtls_psa_hash_clone( &source_operation->ctx.mbedtls_ctx,
                                            &target_operation->ctx.mbedtls_ctx ) );
# 1635 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_driver_wrappers.h"
        default:
            (void) target_operation;
            return( ((psa_status_t)-137) );
    }
}

static inline psa_status_t psa_driver_wrapper_hash_update(
    psa_hash_operation_t *operation,
    const uint8_t *input,
    size_t input_length )
{
    switch( operation->id )
    {

        case (1):
            return( mbedtls_psa_hash_update( &operation->ctx.mbedtls_ctx,
                                             input, input_length ) );







        default:
            (void) input;
            (void) input_length;
            return( ((psa_status_t)-137) );
    }
}

static inline psa_status_t psa_driver_wrapper_hash_finish(
    psa_hash_operation_t *operation,
    uint8_t *hash,
    size_t hash_size,
    size_t *hash_length )
{
    switch( operation->id )
    {

        case (1):
            return( mbedtls_psa_hash_finish( &operation->ctx.mbedtls_ctx,
                                             hash, hash_size, hash_length ) );







        default:
            (void) hash;
            (void) hash_size;
            (void) hash_length;
            return( ((psa_status_t)-137) );
    }
}

static inline psa_status_t psa_driver_wrapper_hash_abort(
    psa_hash_operation_t *operation )
{
    switch( operation->id )
    {

        case (1):
            return( mbedtls_psa_hash_abort( &operation->ctx.mbedtls_ctx ) );






        default:
            return( ((psa_status_t)-137) );
    }
}

static inline psa_status_t psa_driver_wrapper_aead_encrypt(
    const psa_key_attributes_t *attributes,
    const uint8_t *key_buffer, size_t key_buffer_size,
    psa_algorithm_t alg,
    const uint8_t *nonce, size_t nonce_length,
    const uint8_t *additional_data, size_t additional_data_length,
    const uint8_t *plaintext, size_t plaintext_length,
    uint8_t *ciphertext, size_t ciphertext_size, size_t *ciphertext_length )
{
    psa_status_t status = ((psa_status_t)-151);
    psa_key_location_t location =
        ((psa_key_location_t) ((psa_get_key_lifetime(attributes)) >> 8));

    switch( location )
    {
        case ((psa_key_location_t) 0x000000):
# 1747 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_driver_wrappers.h"
            return( mbedtls_psa_aead_encrypt(
                        attributes, key_buffer, key_buffer_size,
                        alg,
                        nonce, nonce_length,
                        additional_data, additional_data_length,
                        plaintext, plaintext_length,
                        ciphertext, ciphertext_size, ciphertext_length ) );



        default:

            (void)status;
            return( ((psa_status_t)-135) );
    }
}

static inline psa_status_t psa_driver_wrapper_aead_decrypt(
    const psa_key_attributes_t *attributes,
    const uint8_t *key_buffer, size_t key_buffer_size,
    psa_algorithm_t alg,
    const uint8_t *nonce, size_t nonce_length,
    const uint8_t *additional_data, size_t additional_data_length,
    const uint8_t *ciphertext, size_t ciphertext_length,
    uint8_t *plaintext, size_t plaintext_size, size_t *plaintext_length )
{
    psa_status_t status = ((psa_status_t)-151);
    psa_key_location_t location =
        ((psa_key_location_t) ((psa_get_key_lifetime(attributes)) >> 8));

    switch( location )
    {
        case ((psa_key_location_t) 0x000000):
# 1799 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_driver_wrappers.h"
            return( mbedtls_psa_aead_decrypt(
                        attributes, key_buffer, key_buffer_size,
                        alg,
                        nonce, nonce_length,
                        additional_data, additional_data_length,
                        ciphertext, ciphertext_length,
                        plaintext, plaintext_size, plaintext_length ) );



        default:

            (void)status;
            return( ((psa_status_t)-135) );
    }
}

static inline psa_status_t psa_driver_wrapper_aead_encrypt_setup(
   psa_aead_operation_t *operation,
   const psa_key_attributes_t *attributes,
   const uint8_t *key_buffer, size_t key_buffer_size,
   psa_algorithm_t alg )
{
    psa_status_t status = ((psa_status_t)-151);
    psa_key_location_t location =
        ((psa_key_location_t) ((psa_get_key_lifetime(attributes)) >> 8));

    switch( location )
    {
        case ((psa_key_location_t) 0x000000):
# 1847 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_driver_wrappers.h"
            operation->id = (1);
            status = mbedtls_psa_aead_encrypt_setup(
                        &operation->ctx.mbedtls_ctx, attributes,
                        key_buffer, key_buffer_size,
                        alg );

            return( status );



        default:

            (void)status;
            return( ((psa_status_t)-135) );
    }
}

static inline psa_status_t psa_driver_wrapper_aead_decrypt_setup(
   psa_aead_operation_t *operation,
   const psa_key_attributes_t *attributes,
   const uint8_t *key_buffer, size_t key_buffer_size,
   psa_algorithm_t alg )
{
    psa_status_t status = ((psa_status_t)-151);
    psa_key_location_t location =
        ((psa_key_location_t) ((psa_get_key_lifetime(attributes)) >> 8));

    switch( location )
    {
        case ((psa_key_location_t) 0x000000):
# 1896 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_driver_wrappers.h"
            operation->id = (1);
            status = mbedtls_psa_aead_decrypt_setup(
                        &operation->ctx.mbedtls_ctx,
                        attributes,
                        key_buffer, key_buffer_size,
                        alg );

            return( status );



        default:

            (void)status;
            return( ((psa_status_t)-135) );
    }
}

static inline psa_status_t psa_driver_wrapper_aead_set_nonce(
   psa_aead_operation_t *operation,
   const uint8_t *nonce,
   size_t nonce_length )
{
    switch( operation->id )
    {

        case (1):
            return( mbedtls_psa_aead_set_nonce( &operation->ctx.mbedtls_ctx,
                                                nonce,
                                                nonce_length ) );
# 1940 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_driver_wrappers.h"
    }

    (void)nonce;
    (void)nonce_length;

    return( ((psa_status_t)-135) );
}

static inline psa_status_t psa_driver_wrapper_aead_set_lengths(
   psa_aead_operation_t *operation,
   size_t ad_length,
   size_t plaintext_length )
{
    switch( operation->id )
    {

        case (1):
            return( mbedtls_psa_aead_set_lengths( &operation->ctx.mbedtls_ctx,
                                                  ad_length,
                                                  plaintext_length ) );
# 1974 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_driver_wrappers.h"
    }

    (void)ad_length;
    (void)plaintext_length;

    return( ((psa_status_t)-135) );
}

static inline psa_status_t psa_driver_wrapper_aead_update_ad(
   psa_aead_operation_t *operation,
   const uint8_t *input,
   size_t input_length )
{
    switch( operation->id )
    {

        case (1):
            return( mbedtls_psa_aead_update_ad( &operation->ctx.mbedtls_ctx,
                                                input,
                                                input_length ) );
# 2008 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_driver_wrappers.h"
    }

    (void)input;
    (void)input_length;

    return( ((psa_status_t)-135) );
}

static inline psa_status_t psa_driver_wrapper_aead_update(
   psa_aead_operation_t *operation,
   const uint8_t *input,
   size_t input_length,
   uint8_t *output,
   size_t output_size,
   size_t *output_length )
{
    switch( operation->id )
    {

        case (1):
            return( mbedtls_psa_aead_update( &operation->ctx.mbedtls_ctx,
                                             input, input_length,
                                             output, output_size,
                                             output_length ) );
# 2047 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_driver_wrappers.h"
    }

    (void)input;
    (void)input_length;
    (void)output;
    (void)output_size;
    (void)output_length;

    return( ((psa_status_t)-135) );
}

static inline psa_status_t psa_driver_wrapper_aead_finish(
   psa_aead_operation_t *operation,
   uint8_t *ciphertext,
   size_t ciphertext_size,
   size_t *ciphertext_length,
   uint8_t *tag,
   size_t tag_size,
   size_t *tag_length )
{
    switch( operation->id )
    {

        case (1):
            return( mbedtls_psa_aead_finish( &operation->ctx.mbedtls_ctx,
                                             ciphertext,
                                             ciphertext_size,
                                             ciphertext_length, tag,
                                             tag_size, tag_length ) );
# 2091 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_driver_wrappers.h"
    }

    (void)ciphertext;
    (void)ciphertext_size;
    (void)ciphertext_length;
    (void)tag;
    (void)tag_size;
    (void)tag_length;

    return( ((psa_status_t)-135) );
}

static inline psa_status_t psa_driver_wrapper_aead_verify(
   psa_aead_operation_t *operation,
   uint8_t *plaintext,
   size_t plaintext_size,
   size_t *plaintext_length,
   const uint8_t *tag,
   size_t tag_length )
{
    switch( operation->id )
    {

        case (1):
            {
                psa_status_t status = ((psa_status_t)-151);
                uint8_t check_tag[16u];
                size_t check_tag_length;

                status = mbedtls_psa_aead_finish( &operation->ctx.mbedtls_ctx,
                                                  plaintext,
                                                  plaintext_size,
                                                  plaintext_length,
                                                  check_tag,
                                                  sizeof( check_tag ),
                                                  &check_tag_length );

                if( status == ((psa_status_t)0) )
                {
                    if( tag_length != check_tag_length ||
                        mbedtls_ct_memcmp( tag, check_tag, tag_length )
                        != 0 )
                        status = ((psa_status_t)-149);
                }

                mbedtls_platform_zeroize( check_tag, sizeof( check_tag ) );

                return( status );
            }
# 2155 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_driver_wrappers.h"
    }

    (void)plaintext;
    (void)plaintext_size;
    (void)plaintext_length;
    (void)tag;
    (void)tag_length;

    return( ((psa_status_t)-135) );
}

static inline psa_status_t psa_driver_wrapper_aead_abort(
   psa_aead_operation_t *operation )
{
    switch( operation->id )
    {

        case (1):
            return( mbedtls_psa_aead_abort( &operation->ctx.mbedtls_ctx ) );
# 2187 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_driver_wrappers.h"
    }

    return( ((psa_status_t)-135) );
}




static inline psa_status_t psa_driver_wrapper_mac_compute(
    const psa_key_attributes_t *attributes,
    const uint8_t *key_buffer,
    size_t key_buffer_size,
    psa_algorithm_t alg,
    const uint8_t *input,
    size_t input_length,
    uint8_t *mac,
    size_t mac_size,
    size_t *mac_length )
{
    psa_status_t status = ((psa_status_t)-151);
    psa_key_location_t location =
        ((psa_key_location_t) ((psa_get_key_lifetime(attributes)) >> 8));

    switch( location )
    {
        case ((psa_key_location_t) 0x000000):
# 2228 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_driver_wrappers.h"
            status = mbedtls_psa_mac_compute(
                attributes, key_buffer, key_buffer_size, alg,
                input, input_length,
                mac, mac_size, mac_length );
            if( status != ((psa_status_t)-134) )
                return( status );

            return( ((psa_status_t)-134) );
# 2248 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_driver_wrappers.h"
        default:

            (void) key_buffer;
            (void) key_buffer_size;
            (void) alg;
            (void) input;
            (void) input_length;
            (void) mac;
            (void) mac_size;
            (void) mac_length;
            (void) status;
            return( ((psa_status_t)-135) );
    }
}

static inline psa_status_t psa_driver_wrapper_mac_sign_setup(
    psa_mac_operation_t *operation,
    const psa_key_attributes_t *attributes,
    const uint8_t *key_buffer,
    size_t key_buffer_size,
    psa_algorithm_t alg )
{
    psa_status_t status = ((psa_status_t)-151);
    psa_key_location_t location =
        ((psa_key_location_t) ((psa_get_key_lifetime(attributes)) >> 8));

    switch( location )
    {
        case ((psa_key_location_t) 0x000000):
# 2296 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_driver_wrappers.h"
            status = mbedtls_psa_mac_sign_setup( &operation->ctx.mbedtls_ctx,
                                                 attributes,
                                                 key_buffer, key_buffer_size,
                                                 alg );
            if( status == ((psa_status_t)0) )
                operation->id = (1);

            if( status != ((psa_status_t)-134) )
                return( status );

            return( ((psa_status_t)-134) );
# 2324 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_driver_wrappers.h"
        default:

            (void) status;
            (void) operation;
            (void) key_buffer;
            (void) key_buffer_size;
            (void) alg;
            return( ((psa_status_t)-135) );
    }
}

static inline psa_status_t psa_driver_wrapper_mac_verify_setup(
    psa_mac_operation_t *operation,
    const psa_key_attributes_t *attributes,
    const uint8_t *key_buffer,
    size_t key_buffer_size,
    psa_algorithm_t alg )
{
    psa_status_t status = ((psa_status_t)-151);
    psa_key_location_t location =
        ((psa_key_location_t) ((psa_get_key_lifetime(attributes)) >> 8));

    switch( location )
    {
        case ((psa_key_location_t) 0x000000):
# 2368 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_driver_wrappers.h"
            status = mbedtls_psa_mac_verify_setup( &operation->ctx.mbedtls_ctx,
                                                   attributes,
                                                   key_buffer, key_buffer_size,
                                                   alg );
            if( status == ((psa_status_t)0) )
                operation->id = (1);

            if( status != ((psa_status_t)-134) )
                return( status );

            return( ((psa_status_t)-134) );
# 2396 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_driver_wrappers.h"
        default:

            (void) status;
            (void) operation;
            (void) key_buffer;
            (void) key_buffer_size;
            (void) alg;
            return( ((psa_status_t)-135) );
    }
}

static inline psa_status_t psa_driver_wrapper_mac_update(
    psa_mac_operation_t *operation,
    const uint8_t *input,
    size_t input_length )
{
    switch( operation->id )
    {

        case (1):
            return( mbedtls_psa_mac_update( &operation->ctx.mbedtls_ctx,
                                            input, input_length ) );
# 2433 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_driver_wrappers.h"
        default:
            (void) input;
            (void) input_length;
            return( ((psa_status_t)-135) );
    }
}

static inline psa_status_t psa_driver_wrapper_mac_sign_finish(
    psa_mac_operation_t *operation,
    uint8_t *mac,
    size_t mac_size,
    size_t *mac_length )
{
    switch( operation->id )
    {

        case (1):
            return( mbedtls_psa_mac_sign_finish( &operation->ctx.mbedtls_ctx,
                                                 mac, mac_size, mac_length ) );
# 2467 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_driver_wrappers.h"
        default:
            (void) mac;
            (void) mac_size;
            (void) mac_length;
            return( ((psa_status_t)-135) );
    }
}

static inline psa_status_t psa_driver_wrapper_mac_verify_finish(
    psa_mac_operation_t *operation,
    const uint8_t *mac,
    size_t mac_length )
{
    switch( operation->id )
    {

        case (1):
            return( mbedtls_psa_mac_verify_finish( &operation->ctx.mbedtls_ctx,
                                                   mac, mac_length ) );
# 2501 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_driver_wrappers.h"
        default:
            (void) mac;
            (void) mac_length;
            return( ((psa_status_t)-135) );
    }
}

static inline psa_status_t psa_driver_wrapper_mac_abort(
    psa_mac_operation_t *operation )
{
    switch( operation->id )
    {

        case (1):
            return( mbedtls_psa_mac_abort( &operation->ctx.mbedtls_ctx ) );
# 2528 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_driver_wrappers.h"
        default:
            return( ((psa_status_t)-135) );
    }
}




static inline psa_status_t psa_driver_wrapper_asymmetric_encrypt(
    const psa_key_attributes_t *attributes, const uint8_t *key_buffer,
    size_t key_buffer_size, psa_algorithm_t alg, const uint8_t *input,
    size_t input_length, const uint8_t *salt, size_t salt_length,
    uint8_t *output, size_t output_size, size_t *output_length )
{
    psa_status_t status = ((psa_status_t)-151);
    psa_key_location_t location =
        ((psa_key_location_t) ((psa_get_key_lifetime(attributes)) >> 8));

    switch( location )
    {
        case ((psa_key_location_t) 0x000000):
# 2562 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_driver_wrappers.h"
            return( mbedtls_psa_asymmetric_encrypt( attributes,
                        key_buffer, key_buffer_size, alg, input, input_length,
                        salt, salt_length, output, output_size, output_length )
                  );
# 2577 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_driver_wrappers.h"
        default:

            (void)status;
            (void)key_buffer;
            (void)key_buffer_size;
            (void)alg;
            (void)input;
            (void)input_length;
            (void)salt;
            (void)salt_length;
            (void)output;
            (void)output_size;
            (void)output_length;
            return( ((psa_status_t)-135) );
    }
}

static inline psa_status_t psa_driver_wrapper_asymmetric_decrypt(
    const psa_key_attributes_t *attributes, const uint8_t *key_buffer,
    size_t key_buffer_size, psa_algorithm_t alg, const uint8_t *input,
    size_t input_length, const uint8_t *salt, size_t salt_length,
    uint8_t *output, size_t output_size, size_t *output_length )
{
    psa_status_t status = ((psa_status_t)-151);
    psa_key_location_t location =
        ((psa_key_location_t) ((psa_get_key_lifetime(attributes)) >> 8));

    switch( location )
    {
        case ((psa_key_location_t) 0x000000):
# 2620 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_driver_wrappers.h"
            return( mbedtls_psa_asymmetric_decrypt( attributes,
                        key_buffer, key_buffer_size, alg,input, input_length,
                        salt, salt_length, output, output_size,
                        output_length ) );
# 2635 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_driver_wrappers.h"
        default:

            (void)status;
            (void)key_buffer;
            (void)key_buffer_size;
            (void)alg;
            (void)input;
            (void)input_length;
            (void)salt;
            (void)salt_length;
            (void)output;
            (void)output_size;
            (void)output_length;
            return( ((psa_status_t)-135) );
    }
}

static inline psa_status_t psa_driver_wrapper_key_agreement(
    const psa_key_attributes_t *attributes,
    const uint8_t *key_buffer,
    size_t key_buffer_size,
    psa_algorithm_t alg,
    const uint8_t *peer_key,
    size_t peer_key_length,
    uint8_t *shared_secret,
    size_t shared_secret_size,
    size_t *shared_secret_length
 )
{
    psa_status_t status = ((psa_status_t)-151);
    psa_key_location_t location =
        ((psa_key_location_t) ((psa_get_key_lifetime(attributes)) >> 8));

    switch( location )
    {
        case ((psa_key_location_t) 0x000000):
# 2705 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_driver_wrappers.h"
            status = psa_key_agreement_raw_builtin( attributes,
                                                    key_buffer,
                                                    key_buffer_size,
                                                    alg,
                                                    peer_key,
                                                    peer_key_length,
                                                    shared_secret,
                                                    shared_secret_size,
                                                    shared_secret_length );
            return( status );
# 2725 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_driver_wrappers.h"
        default:
            (void) attributes;
            (void) key_buffer;
            (void) key_buffer_size;
            (void) peer_key;
            (void) peer_key_length;
            (void) shared_secret;
            (void) shared_secret_size;
            (void) shared_secret_length;
            return( ((psa_status_t)-134) );

    }
}

static inline psa_status_t psa_driver_wrapper_pake_setup(
    psa_pake_operation_t *operation,
    const psa_crypto_driver_pake_inputs_t *inputs )
{
    psa_status_t status = ((psa_status_t)-151);

    psa_key_location_t location =
            ((psa_key_location_t) ((psa_get_key_lifetime( &inputs->attributes )) >> 8));

    switch( location )
    {
        case ((psa_key_location_t) 0x000000):


            status = ((psa_status_t)-134);
# 2767 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_driver_wrappers.h"
            status = mbedtls_psa_pake_setup( &operation->data.ctx.mbedtls_ctx,
                        inputs );
            if( status == ((psa_status_t)0) )
                operation->id = (1);

            return status;

        default:

            (void)operation;
            return( ((psa_status_t)-135) );
    }
}

static inline psa_status_t psa_driver_wrapper_pake_output(
    psa_pake_operation_t *operation,
    psa_crypto_driver_pake_step_t step,
    uint8_t *output,
    size_t output_size,
    size_t *output_length )
{
    switch( operation->id )
    {

        case (1):
            return( mbedtls_psa_pake_output( &operation->data.ctx.mbedtls_ctx, step,
                                             output, output_size, output_length ) );
# 2804 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_driver_wrappers.h"
        default:
            (void) step;
            (void) output;
            (void) output_size;
            (void) output_length;
            return( ((psa_status_t)-135) );
    }
}

static inline psa_status_t psa_driver_wrapper_pake_input(
    psa_pake_operation_t *operation,
    psa_crypto_driver_pake_step_t step,
    const uint8_t *input,
    size_t input_length )
{
    switch( operation->id )
    {

        case (1):
            return( mbedtls_psa_pake_input( &operation->data.ctx.mbedtls_ctx,
                                            step, input,
                                            input_length ) );
# 2837 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_driver_wrappers.h"
        default:
            (void) step;
            (void) input;
            (void) input_length;
            return( ((psa_status_t)-135) );
    }
}

static inline psa_status_t psa_driver_wrapper_pake_get_implicit_key(
    psa_pake_operation_t *operation,
    uint8_t *output, size_t output_size,
    size_t *output_length )
{
    switch( operation->id )
    {

        case (1):
            return( mbedtls_psa_pake_get_implicit_key( &operation->data.ctx.mbedtls_ctx,
                                                       output, output_size, output_length ) );
# 2866 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_driver_wrappers.h"
        default:
            (void) output;
            (void) output_size;
            (void) output_length;
            return( ((psa_status_t)-135) );
    }
}

static inline psa_status_t psa_driver_wrapper_pake_abort(
    psa_pake_operation_t * operation )
{
    switch( operation->id )
    {

        case (1):
            return( mbedtls_psa_pake_abort( &operation->data.ctx.mbedtls_ctx ) );
# 2891 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_driver_wrappers.h"
        default:
            return( ((psa_status_t)-135) );
    }
}
# 25 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 2

# 1 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_ecp.h" 1
# 33 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_ecp.h"
psa_status_t mbedtls_psa_ecp_load_representation(psa_key_type_t type,
                                                 size_t curve_bits,
                                                 const uint8_t *data,
                                                 size_t data_length,
                                                 mbedtls_ecp_keypair **p_ecp);
# 46 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_ecp.h"
psa_status_t mbedtls_psa_ecp_load_public_part(mbedtls_ecp_keypair *ecp);
# 74 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_ecp.h"
psa_status_t mbedtls_psa_ecp_import_key(
    const psa_key_attributes_t *attributes,
    const uint8_t *data, size_t data_length,
    uint8_t *key_buffer, size_t key_buffer_size,
    size_t *key_buffer_length, size_t *bits);
# 88 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_ecp.h"
psa_status_t mbedtls_psa_ecp_export_key(psa_key_type_t type,
                                        mbedtls_ecp_keypair *ecp,
                                        uint8_t *data,
                                        size_t data_size,
                                        size_t *data_length);
# 118 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_ecp.h"
psa_status_t mbedtls_psa_ecp_export_public_key(
    const psa_key_attributes_t *attributes,
    const uint8_t *key_buffer, size_t key_buffer_size,
    uint8_t *data, size_t data_size, size_t *data_length);
# 142 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_ecp.h"
psa_status_t mbedtls_psa_ecp_generate_key(
    const psa_key_attributes_t *attributes,
    uint8_t *key_buffer, size_t key_buffer_size, size_t *key_buffer_length);
# 178 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_ecp.h"
psa_status_t mbedtls_psa_ecdsa_sign_hash(
    const psa_key_attributes_t *attributes,
    const uint8_t *key_buffer, size_t key_buffer_size,
    psa_algorithm_t alg, const uint8_t *hash, size_t hash_length,
    uint8_t *signature, size_t signature_size, size_t *signature_length);
# 213 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_ecp.h"
psa_status_t mbedtls_psa_ecdsa_verify_hash(
    const psa_key_attributes_t *attributes,
    const uint8_t *key_buffer, size_t key_buffer_size,
    psa_algorithm_t alg, const uint8_t *hash, size_t hash_length,
    const uint8_t *signature, size_t signature_length);
# 261 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_ecp.h"
psa_status_t mbedtls_psa_key_agreement_ecdh(
    const psa_key_attributes_t *attributes,
    const uint8_t *key_buffer, size_t key_buffer_size,
    psa_algorithm_t alg, const uint8_t *peer_key, size_t peer_key_length,
    uint8_t *shared_secret, size_t shared_secret_size,
    size_t *shared_secret_length);
# 27 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 2
# 1 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_ffdh.h" 1
# 40 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_ffdh.h"
psa_status_t mbedtls_psa_ffdh_key_agreement(
    const psa_key_attributes_t *attributes,
    const uint8_t *peer_key,
    size_t peer_key_length,
    const uint8_t *key_buffer,
    size_t key_buffer_size,
    uint8_t *shared_secret,
    size_t shared_secret_size,
    size_t *shared_secret_length);
# 67 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_ffdh.h"
psa_status_t mbedtls_psa_ffdh_export_public_key(
    const psa_key_attributes_t *attributes,
    const uint8_t *key_buffer,
    size_t key_buffer_size,
    uint8_t *data,
    size_t data_size,
    size_t *data_length);
# 96 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_ffdh.h"
psa_status_t mbedtls_psa_ffdh_generate_key(
    const psa_key_attributes_t *attributes,
    uint8_t *key_buffer,
    size_t key_buffer_size,
    size_t *key_buffer_length);
# 125 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_ffdh.h"
psa_status_t mbedtls_psa_ffdh_import_key(
    const psa_key_attributes_t *attributes,
    const uint8_t *data, size_t data_length,
    uint8_t *key_buffer, size_t key_buffer_size,
    size_t *key_buffer_length, size_t *bits);
# 28 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 2







# 1 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_slot_management.h" 1
# 14 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_slot_management.h"
# 1 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_se.h" 1
# 56 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_se.h"
void psa_unregister_all_se_drivers(void);





psa_status_t psa_init_all_se_drivers(void);






typedef struct psa_se_drv_table_entry_s psa_se_drv_table_entry_t;
# 87 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_se.h"
int psa_get_se_driver(psa_key_lifetime_t lifetime,
                      const psa_drv_se_t **p_methods,
                      psa_drv_se_context_t **p_drv_context);
# 98 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_se.h"
psa_se_drv_table_entry_t *psa_get_se_driver_entry(
    psa_key_lifetime_t lifetime);
# 108 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_se.h"
const psa_drv_se_t *psa_get_se_driver_methods(
    const psa_se_drv_table_entry_t *driver);
# 118 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_se.h"
psa_drv_se_context_t *psa_get_se_driver_context(
    psa_se_drv_table_entry_t *driver);
# 131 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_se.h"
psa_status_t psa_find_se_slot_for_key(
    const psa_key_attributes_t *attributes,
    psa_key_creation_method_t method,
    psa_se_drv_table_entry_t *driver,
    psa_key_slot_number_t *slot_number);






psa_status_t psa_destroy_se_key(psa_se_drv_table_entry_t *driver,
                                psa_key_slot_number_t slot_number);
# 157 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_se.h"
psa_status_t psa_load_se_persistent_data(
    const psa_se_drv_table_entry_t *driver);
# 173 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_se.h"
psa_status_t psa_save_se_persistent_data(
    const psa_se_drv_table_entry_t *driver);
# 183 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_se.h"
psa_status_t psa_destroy_se_persistent_data(psa_key_location_t location);




typedef struct {
    uint8_t slot_number[sizeof(psa_key_slot_number_t)];
} psa_se_key_data_storage_t;
# 15 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_slot_management.h" 2
# 48 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_slot_management.h"
static inline int psa_key_id_is_volatile(psa_key_id_t key_id)
{
    return (key_id >= ((psa_key_id_t) 0x40000000)) &&
           (key_id <= (((psa_key_id_t) 0x40000000) + 32 - 1));
}
# 93 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_slot_management.h"
psa_status_t psa_get_and_lock_key_slot(mbedtls_svc_key_id_t key,
                                       psa_key_slot_t **p_slot);






psa_status_t psa_initialize_key_slots(void);
# 126 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_slot_management.h"
void psa_wipe_all_key_slots(void);
# 161 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_slot_management.h"
psa_status_t psa_reserve_free_key_slot(psa_key_id_t *volatile_key_id,
                                       psa_key_slot_t **p_slot);
# 205 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_slot_management.h"
static inline psa_status_t psa_key_slot_state_transition(
    psa_key_slot_t *slot, psa_key_slot_state_t expected_state,
    psa_key_slot_state_t new_state)
{
    if (slot->state != expected_state) {
        return ((psa_status_t)-151);
    }
    slot->state = new_state;
    return ((psa_status_t)0);
}
# 230 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_slot_management.h"
static inline psa_status_t psa_register_read(psa_key_slot_t *slot)
{
    if ((slot->state != PSA_SLOT_FULL) ||
        (slot->var.occupied.registered_readers >= 0xffffffffU
# 233 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_slot_management.h"
                                                         )) {
        return ((psa_status_t)-151);
    }
    slot->var.occupied.registered_readers++;

    return ((psa_status_t)0);
}
# 265 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_slot_management.h"
psa_status_t psa_unregister_read(psa_key_slot_t *slot);
# 286 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_slot_management.h"
psa_status_t psa_unregister_read_under_mutex(psa_key_slot_t *slot);
# 300 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_slot_management.h"
static inline int psa_key_lifetime_is_external(psa_key_lifetime_t lifetime)
{
    return ((psa_key_location_t) ((lifetime) >> 8))
           != ((psa_key_location_t) 0x000000);
}
# 320 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_slot_management.h"
psa_status_t psa_validate_key_location(psa_key_lifetime_t lifetime,
                                       psa_se_drv_table_entry_t **p_drv);
# 331 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_slot_management.h"
psa_status_t psa_validate_key_persistence(psa_key_lifetime_t lifetime);
# 342 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_slot_management.h"
int psa_is_valid_key_id(mbedtls_svc_key_id_t key, int vendor_ok);
# 36 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 2


# 1 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_storage.h" 1
# 70 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_storage.h"
int psa_is_key_present_in_storage(const mbedtls_svc_key_id_t key);
# 103 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_storage.h"
psa_status_t psa_save_persistent_key(const psa_key_attributes_t *attr,
                                     const uint8_t *data,
                                     const size_t data_length);
# 133 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_storage.h"
psa_status_t psa_load_persistent_key(psa_key_attributes_t *attr,
                                     uint8_t **data,
                                     size_t *data_length);
# 148 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_storage.h"
psa_status_t psa_destroy_persistent_key(const mbedtls_svc_key_id_t key);
# 160 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_storage.h"
void psa_free_persistent_key_data(uint8_t *key_data, size_t key_data_length);
# 171 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_storage.h"
void psa_format_key_data_for_storage(const uint8_t *data,
                                     const size_t data_length,
                                     const psa_key_attributes_t *attr,
                                     uint8_t *storage_data);
# 192 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_storage.h"
psa_status_t psa_parse_key_data_from_storage(const uint8_t *storage_data,
                                             size_t storage_data_length,
                                             uint8_t **key_data,
                                             size_t *key_data_length,
                                             psa_key_attributes_t *attr);
# 39 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 2

# 1 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_random_impl.h" 1
# 13 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_random_impl.h"
# 1 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_util_internal.h" 1
# 15 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_util_internal.h"
# 1 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/psa_util.h" 1
# 22 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/psa_util.h"
# 1 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/asn1write.h" 1
# 15 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/asn1write.h"
# 1 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/asn1.h" 1
# 17 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/asn1.h"
# 1 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/lib/gcc/riscv32-unknown-elf/15.1.0/include/stddef.h" 1 3 4
# 18 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/asn1.h" 2
# 141 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/asn1.h"
typedef struct mbedtls_asn1_buf {
    int tag;
    size_t len;
    unsigned char *p;
}
mbedtls_asn1_buf;




typedef struct mbedtls_asn1_bitstring {
    size_t len;
    unsigned char unused_bits;
    unsigned char *p;
}
mbedtls_asn1_bitstring;




typedef struct mbedtls_asn1_sequence {
    mbedtls_asn1_buf buf;
# 171 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/asn1.h"
    struct mbedtls_asn1_sequence *next;
}
mbedtls_asn1_sequence;




typedef struct mbedtls_asn1_named_data {
    mbedtls_asn1_buf oid;
    mbedtls_asn1_buf val;
# 189 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/asn1.h"
    struct mbedtls_asn1_named_data *next;






    unsigned char next_merged;
}
mbedtls_asn1_named_data;
# 220 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/asn1.h"
int mbedtls_asn1_get_len(unsigned char **p,
                         const unsigned char *end,
                         size_t *len);
# 245 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/asn1.h"
int mbedtls_asn1_get_tag(unsigned char **p,
                         const unsigned char *end,
                         size_t *len, int tag);
# 266 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/asn1.h"
int mbedtls_asn1_get_bool(unsigned char **p,
                          const unsigned char *end,
                          int *val);
# 287 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/asn1.h"
int mbedtls_asn1_get_int(unsigned char **p,
                         const unsigned char *end,
                         int *val);
# 308 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/asn1.h"
int mbedtls_asn1_get_enum(unsigned char **p,
                          const unsigned char *end,
                          int *val);
# 329 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/asn1.h"
int mbedtls_asn1_get_bitstring(unsigned char **p, const unsigned char *end,
                               mbedtls_asn1_bitstring *bs);
# 350 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/asn1.h"
int mbedtls_asn1_get_bitstring_null(unsigned char **p,
                                    const unsigned char *end,
                                    size_t *len);
# 401 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/asn1.h"
int mbedtls_asn1_get_sequence_of(unsigned char **p,
                                 const unsigned char *end,
                                 mbedtls_asn1_sequence *cur,
                                 int tag);
# 426 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/asn1.h"
void mbedtls_asn1_sequence_free(mbedtls_asn1_sequence *seq);
# 513 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/asn1.h"
int mbedtls_asn1_traverse_sequence_of(
    unsigned char **p,
    const unsigned char *end,
    unsigned char tag_must_mask, unsigned char tag_must_val,
    unsigned char tag_may_mask, unsigned char tag_may_val,
    int (*cb)(void *ctx, int tag,
              unsigned char *start, size_t len),
    void *ctx);
# 541 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/asn1.h"
int mbedtls_asn1_get_mpi(unsigned char **p,
                         const unsigned char *end,
                         mbedtls_mpi *X);
# 562 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/asn1.h"
int mbedtls_asn1_get_alg(unsigned char **p,
                         const unsigned char *end,
                         mbedtls_asn1_buf *alg, mbedtls_asn1_buf *params);
# 581 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/asn1.h"
int mbedtls_asn1_get_alg_null(unsigned char **p,
                              const unsigned char *end,
                              mbedtls_asn1_buf *alg);
# 595 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/asn1.h"
const mbedtls_asn1_named_data *mbedtls_asn1_find_named_data(const mbedtls_asn1_named_data *list,
                                                            const char *oid, size_t len);
# 622 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/asn1.h"
void mbedtls_asn1_free_named_data_list(mbedtls_asn1_named_data **head);
# 631 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/asn1.h"
void mbedtls_asn1_free_named_data_list_shallow(mbedtls_asn1_named_data *name);
# 16 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/asn1write.h" 2
# 53 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/asn1write.h"
int mbedtls_asn1_write_len(unsigned char **p, const unsigned char *start,
                           size_t len);
# 67 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/asn1write.h"
int mbedtls_asn1_write_tag(unsigned char **p, const unsigned char *start,
                           unsigned char tag);
# 85 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/asn1write.h"
int mbedtls_asn1_write_raw_buffer(unsigned char **p, const unsigned char *start,
                                  const unsigned char *buf, size_t size);
# 103 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/asn1write.h"
int mbedtls_asn1_write_mpi(unsigned char **p, const unsigned char *start,
                           const mbedtls_mpi *X);
# 119 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/asn1write.h"
int mbedtls_asn1_write_null(unsigned char **p, const unsigned char *start);
# 135 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/asn1write.h"
int mbedtls_asn1_write_oid(unsigned char **p, const unsigned char *start,
                           const char *oid, size_t oid_len);
# 153 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/asn1write.h"
int mbedtls_asn1_write_algorithm_identifier(unsigned char **p,
                                            const unsigned char *start,
                                            const char *oid, size_t oid_len,
                                            size_t par_len);
# 174 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/asn1write.h"
int mbedtls_asn1_write_algorithm_identifier_ext(unsigned char **p,
                                                const unsigned char *start,
                                                const char *oid, size_t oid_len,
                                                size_t par_len, int has_par);
# 192 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/asn1write.h"
int mbedtls_asn1_write_bool(unsigned char **p, const unsigned char *start,
                            int boolean);
# 209 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/asn1write.h"
int mbedtls_asn1_write_int(unsigned char **p, const unsigned char *start, int val);
# 224 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/asn1write.h"
int mbedtls_asn1_write_enum(unsigned char **p, const unsigned char *start, int val);
# 243 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/asn1write.h"
int mbedtls_asn1_write_tagged_string(unsigned char **p, const unsigned char *start,
                                     int tag, const char *text,
                                     size_t text_len);
# 262 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/asn1write.h"
int mbedtls_asn1_write_printable_string(unsigned char **p,
                                        const unsigned char *start,
                                        const char *text, size_t text_len);
# 281 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/asn1write.h"
int mbedtls_asn1_write_utf8_string(unsigned char **p, const unsigned char *start,
                                   const char *text, size_t text_len);
# 299 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/asn1write.h"
int mbedtls_asn1_write_ia5_string(unsigned char **p, const unsigned char *start,
                                  const char *text, size_t text_len);
# 316 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/asn1write.h"
int mbedtls_asn1_write_bitstring(unsigned char **p, const unsigned char *start,
                                 const unsigned char *buf, size_t bits);
# 336 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/asn1write.h"
int mbedtls_asn1_write_named_bitstring(unsigned char **p,
                                       const unsigned char *start,
                                       const unsigned char *buf,
                                       size_t bits);
# 355 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/asn1write.h"
int mbedtls_asn1_write_octet_string(unsigned char **p, const unsigned char *start,
                                    const unsigned char *buf, size_t size);
# 379 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/asn1write.h"
mbedtls_asn1_named_data *mbedtls_asn1_store_named_data(mbedtls_asn1_named_data **list,
                                                       const char *oid, size_t oid_len,
                                                       const unsigned char *val,
                                                       size_t val_len);
# 23 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/psa_util.h" 2
# 57 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/psa_util.h"
int mbedtls_psa_get_random(void *p_rng,
                           unsigned char *output,
                           size_t output_size);
# 87 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/psa_util.h"
psa_ecc_family_t mbedtls_ecc_group_to_psa(mbedtls_ecp_group_id grpid,
                                          size_t *bits);
# 102 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/psa_util.h"
mbedtls_ecp_group_id mbedtls_ecc_group_from_psa(psa_ecc_family_t family,
                                                size_t bits);
# 121 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/psa_util.h"
static inline psa_algorithm_t mbedtls_md_psa_alg_from_type(mbedtls_md_type_t md_type)
{
    return ((psa_algorithm_t) 0x02000000) | (psa_algorithm_t) md_type;
}
# 138 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/psa_util.h"
static inline mbedtls_md_type_t mbedtls_md_type_from_psa_alg(psa_algorithm_t psa_alg)
{
    return (mbedtls_md_type_t) (psa_alg & ((psa_algorithm_t) 0x000000ff));
}
# 175 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/psa_util.h"
int mbedtls_ecdsa_raw_to_der(size_t bits, const unsigned char *raw, size_t raw_len,
                             unsigned char *der, size_t der_size, size_t *der_len);
# 200 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/psa_util.h"
int mbedtls_ecdsa_der_to_raw(size_t bits, const unsigned char *der, size_t der_len,
                             unsigned char *raw, size_t raw_size, size_t *raw_len);
# 16 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_util_internal.h" 2
# 42 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_util_internal.h"
typedef struct {

    int16_t psa_status;



    int16_t mbedtls_error;
} mbedtls_error_pair_t;


extern const mbedtls_error_pair_t psa_to_md_errors[4];
# 69 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_util_internal.h"
extern const mbedtls_error_pair_t psa_to_pk_rsa_errors[8];
# 79 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_util_internal.h"
int psa_generic_status_to_mbedtls(psa_status_t status);



int psa_status_to_mbedtls(psa_status_t status,
                          const mbedtls_error_pair_t *local_translations,
                          size_t local_errors_num,
                          int (*fallback_f)(psa_status_t));




int psa_pk_status_to_mbedtls(psa_status_t status);
# 14 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_random_impl.h" 2
# 26 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_random_impl.h"
# 1 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ctr_drbg.h" 1
# 55 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ctr_drbg.h"
# 1 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/aes.h" 1
# 35 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/aes.h"
# 1 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/lib/gcc/riscv32-unknown-elf/15.1.0/include/stddef.h" 1 3 4
# 36 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/aes.h" 2
# 63 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/aes.h"
typedef struct mbedtls_aes_context {
    int nr;
    size_t rk_offset;





    uint32_t buf[68];
# 80 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/aes.h"
}
mbedtls_aes_context;
# 107 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/aes.h"
void mbedtls_aes_init(mbedtls_aes_context *ctx);
# 116 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/aes.h"
void mbedtls_aes_free(mbedtls_aes_context *ctx);
# 154 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/aes.h"

int mbedtls_aes_setkey_enc(mbedtls_aes_context *ctx, const unsigned char *key,
                           unsigned int keybits);
# 174 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/aes.h"

int mbedtls_aes_setkey_dec(mbedtls_aes_context *ctx, const unsigned char *key,
                           unsigned int keybits);
# 246 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/aes.h"

int mbedtls_aes_crypt_ecb(mbedtls_aes_context *ctx,
                          int mode,
                          const unsigned char input[16],
                          unsigned char output[16]);
# 294 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/aes.h"

int mbedtls_aes_crypt_cbc(mbedtls_aes_context *ctx,
                          int mode,
                          size_t length,
                          unsigned char iv[16],
                          const unsigned char *input,
                          unsigned char *output);
# 388 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/aes.h"

int mbedtls_aes_crypt_cfb128(mbedtls_aes_context *ctx,
                             int mode,
                             size_t length,
                             size_t *iv_off,
                             unsigned char iv[16],
                             const unsigned char *input,
                             unsigned char *output);
# 433 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/aes.h"

int mbedtls_aes_crypt_cfb8(mbedtls_aes_context *ctx,
                           int mode,
                           size_t length,
                           unsigned char iv[16],
                           const unsigned char *input,
                           unsigned char *output);
# 488 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/aes.h"

int mbedtls_aes_crypt_ofb(mbedtls_aes_context *ctx,
                          size_t length,
                          size_t *iv_off,
                          unsigned char iv[16],
                          const unsigned char *input,
                          unsigned char *output);
# 571 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/aes.h"

int mbedtls_aes_crypt_ctr(mbedtls_aes_context *ctx,
                          size_t length,
                          size_t *nc_off,
                          unsigned char nonce_counter[16],
                          unsigned char stream_block[16],
                          const unsigned char *input,
                          unsigned char *output);
# 592 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/aes.h"

int mbedtls_internal_aes_encrypt(mbedtls_aes_context *ctx,
                                 const unsigned char input[16],
                                 unsigned char output[16]);
# 609 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/aes.h"

int mbedtls_internal_aes_decrypt(mbedtls_aes_context *ctx,
                                 const unsigned char input[16],
                                 unsigned char output[16]);
# 622 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/aes.h"
__attribute__((__warn_unused_result__))
int mbedtls_aes_self_test(int verbose);
# 56 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ctr_drbg.h" 2


# 1 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/entropy.h" 1
# 59 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ctr_drbg.h" 2
# 185 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ctr_drbg.h"
typedef struct mbedtls_ctr_drbg_context {
    unsigned char counter[16];
    int reseed_counter;
# 197 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ctr_drbg.h"
    int prediction_resistance;



    size_t entropy_len;

    int reseed_interval;






    mbedtls_aes_context aes_ctx;





    int(*f_entropy)(void *, unsigned char *, size_t);


    void *p_entropy;
# 231 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ctr_drbg.h"
}
mbedtls_ctr_drbg_context;
# 246 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ctr_drbg.h"
void mbedtls_ctr_drbg_init(mbedtls_ctr_drbg_context *ctx);
# 347 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ctr_drbg.h"
int mbedtls_ctr_drbg_seed(mbedtls_ctr_drbg_context *ctx,
                          int (*f_entropy)(void *, unsigned char *, size_t),
                          void *p_entropy,
                          const unsigned char *custom,
                          size_t len);







void mbedtls_ctr_drbg_free(mbedtls_ctr_drbg_context *ctx);
# 374 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ctr_drbg.h"
void mbedtls_ctr_drbg_set_prediction_resistance(mbedtls_ctr_drbg_context *ctx,
                                                int resistance);
# 401 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ctr_drbg.h"
void mbedtls_ctr_drbg_set_entropy_len(mbedtls_ctr_drbg_context *ctx,
                                      size_t len);
# 423 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ctr_drbg.h"
int mbedtls_ctr_drbg_set_nonce_len(mbedtls_ctr_drbg_context *ctx,
                                   size_t len);
# 438 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ctr_drbg.h"
void mbedtls_ctr_drbg_set_reseed_interval(mbedtls_ctr_drbg_context *ctx,
                                          int interval);
# 461 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ctr_drbg.h"
int mbedtls_ctr_drbg_reseed(mbedtls_ctr_drbg_context *ctx,
                            const unsigned char *additional, size_t len);
# 484 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ctr_drbg.h"
int mbedtls_ctr_drbg_update(mbedtls_ctr_drbg_context *ctx,
                            const unsigned char *additional,
                            size_t add_len);
# 519 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ctr_drbg.h"
int mbedtls_ctr_drbg_random_with_add(void *p_rng,
                                     unsigned char *output, size_t output_len,
                                     const unsigned char *additional, size_t add_len);
# 547 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ctr_drbg.h"
int mbedtls_ctr_drbg_random(void *p_rng,
                            unsigned char *output, size_t output_len);
# 589 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ctr_drbg.h"
int mbedtls_ctr_drbg_self_test(int verbose);
# 27 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_random_impl.h" 2
# 63 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_random_impl.h"
typedef mbedtls_ctr_drbg_context mbedtls_psa_drbg_context_t;




typedef struct {
    void (* entropy_init)(mbedtls_entropy_context *ctx);
    void (* entropy_free)(mbedtls_entropy_context *ctx);
    mbedtls_entropy_context entropy;
    mbedtls_psa_drbg_context_t drbg;
} mbedtls_psa_random_context_t;





static inline void mbedtls_psa_drbg_init(mbedtls_psa_drbg_context_t *p_rng)
{

    mbedtls_ctr_drbg_init(p_rng);



}





static inline void mbedtls_psa_drbg_free(mbedtls_psa_drbg_context_t *p_rng)
{

    mbedtls_ctr_drbg_free(p_rng);



}
# 112 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto_random_impl.h"
static inline int mbedtls_psa_drbg_seed(mbedtls_psa_drbg_context_t *drbg_ctx,
                                        mbedtls_entropy_context *entropy,
                                        const unsigned char *custom, size_t len)
{

    return mbedtls_ctr_drbg_seed(drbg_ctx, mbedtls_entropy_func, entropy, custom, len);




}
# 41 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 2
# 50 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
# 1 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/camellia.h" 1
# 16 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/camellia.h"
# 1 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/lib/gcc/riscv32-unknown-elf/15.1.0/include/stddef.h" 1 3 4
# 17 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/camellia.h" 2
# 41 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/camellia.h"
typedef struct mbedtls_camellia_context {
    int nr;
    uint32_t rk[68];
}
mbedtls_camellia_context;
# 57 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/camellia.h"
void mbedtls_camellia_init(mbedtls_camellia_context *ctx);
# 66 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/camellia.h"
void mbedtls_camellia_free(mbedtls_camellia_context *ctx);
# 80 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/camellia.h"
int mbedtls_camellia_setkey_enc(mbedtls_camellia_context *ctx,
                                const unsigned char *key,
                                unsigned int keybits);
# 97 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/camellia.h"
int mbedtls_camellia_setkey_dec(mbedtls_camellia_context *ctx,
                                const unsigned char *key,
                                unsigned int keybits);
# 117 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/camellia.h"
int mbedtls_camellia_crypt_ecb(mbedtls_camellia_context *ctx,
                               int mode,
                               const unsigned char input[16],
                               unsigned char output[16]);
# 151 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/camellia.h"
int mbedtls_camellia_crypt_cbc(mbedtls_camellia_context *ctx,
                               int mode,
                               size_t length,
                               unsigned char iv[16],
                               const unsigned char *input,
                               unsigned char *output);
# 197 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/camellia.h"
int mbedtls_camellia_crypt_cfb128(mbedtls_camellia_context *ctx,
                                  int mode,
                                  size_t length,
                                  size_t *iv_off,
                                  unsigned char iv[16],
                                  const unsigned char *input,
                                  unsigned char *output);
# 281 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/camellia.h"
int mbedtls_camellia_crypt_ctr(mbedtls_camellia_context *ctx,
                               size_t length,
                               size_t *nc_off,
                               unsigned char nonce_counter[16],
                               unsigned char stream_block[16],
                               const unsigned char *input,
                               unsigned char *output);
# 297 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/camellia.h"
int mbedtls_camellia_self_test(int verbose);
# 51 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 2






# 1 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/des.h" 1
# 22 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/des.h"
# 1 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/lib/gcc/riscv32-unknown-elf/15.1.0/include/stddef.h" 1 3 4
# 23 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/des.h" 2
# 48 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/des.h"
typedef struct mbedtls_des_context {
    uint32_t sk[32];
}
mbedtls_des_context;
# 60 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/des.h"
typedef struct mbedtls_des3_context {
    uint32_t sk[96];
}
mbedtls_des3_context;
# 78 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/des.h"
void mbedtls_des_init(mbedtls_des_context *ctx);
# 89 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/des.h"
void mbedtls_des_free(mbedtls_des_context *ctx);
# 100 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/des.h"
void mbedtls_des3_init(mbedtls_des3_context *ctx);
# 111 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/des.h"
void mbedtls_des3_free(mbedtls_des3_context *ctx);
# 125 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/des.h"
void mbedtls_des_key_set_parity(unsigned char key[8]);
# 141 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/des.h"

int mbedtls_des_key_check_key_parity(const unsigned char key[8]);
# 155 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/des.h"

int mbedtls_des_key_check_weak(const unsigned char key[8]);
# 170 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/des.h"

int mbedtls_des_setkey_enc(mbedtls_des_context *ctx, const unsigned char key[8]);
# 185 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/des.h"

int mbedtls_des_setkey_dec(mbedtls_des_context *ctx, const unsigned char key[8]);
# 200 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/des.h"

int mbedtls_des3_set2key_enc(mbedtls_des3_context *ctx,
                             const unsigned char key[8 * 2]);
# 216 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/des.h"

int mbedtls_des3_set2key_dec(mbedtls_des3_context *ctx,
                             const unsigned char key[8 * 2]);
# 232 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/des.h"

int mbedtls_des3_set3key_enc(mbedtls_des3_context *ctx,
                             const unsigned char key[8 * 3]);
# 248 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/des.h"

int mbedtls_des3_set3key_dec(mbedtls_des3_context *ctx,
                             const unsigned char key[8 * 3]);
# 265 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/des.h"

int mbedtls_des_crypt_ecb(mbedtls_des_context *ctx,
                          const unsigned char input[8],
                          unsigned char output[8]);
# 293 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/des.h"

int mbedtls_des_crypt_cbc(mbedtls_des_context *ctx,
                          int mode,
                          size_t length,
                          unsigned char iv[8],
                          const unsigned char *input,
                          unsigned char *output);
# 315 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/des.h"

int mbedtls_des3_crypt_ecb(mbedtls_des3_context *ctx,
                           const unsigned char input[8],
                           unsigned char output[8]);
# 345 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/des.h"

int mbedtls_des3_crypt_cbc(mbedtls_des3_context *ctx,
                           int mode,
                           size_t length,
                           unsigned char iv[8],
                           const unsigned char *input,
                           unsigned char *output);
# 366 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/des.h"
void mbedtls_des_setkey(uint32_t SK[32],
                        const unsigned char key[8]);
# 376 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/des.h"
__attribute__((__warn_unused_result__))
int mbedtls_des_self_test(int verbose);
# 58 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 2
# 1 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecdh.h" 1
# 59 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecdh.h"
typedef enum {
    MBEDTLS_ECDH_OURS,
    MBEDTLS_ECDH_THEIRS,
} mbedtls_ecdh_side;
# 105 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecdh.h"
typedef struct mbedtls_ecdh_context {

    mbedtls_ecp_group grp;
    mbedtls_mpi d;
    mbedtls_ecp_point Q;
    mbedtls_ecp_point Qp;
    mbedtls_mpi z;
    int point_format;
    mbedtls_ecp_point Vi;
    mbedtls_ecp_point Vf;
    mbedtls_mpi _d;

    int restart_enabled;
    mbedtls_ecp_restart_ctx rs;
# 141 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecdh.h"
}
mbedtls_ecdh_context;
# 155 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecdh.h"
mbedtls_ecp_group_id mbedtls_ecdh_get_grp_id(mbedtls_ecdh_context *ctx);
# 164 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecdh.h"
int mbedtls_ecdh_can_do(mbedtls_ecp_group_id gid);
# 191 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecdh.h"
int mbedtls_ecdh_gen_public(mbedtls_ecp_group *grp, mbedtls_mpi *d, mbedtls_ecp_point *Q,
                            mbedtls_f_rng_t *f_rng,
                            void *p_rng);
# 226 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecdh.h"
int mbedtls_ecdh_compute_shared(mbedtls_ecp_group *grp, mbedtls_mpi *z,
                                const mbedtls_ecp_point *Q, const mbedtls_mpi *d,
                                mbedtls_f_rng_t *f_rng,
                                void *p_rng);






void mbedtls_ecdh_init(mbedtls_ecdh_context *ctx);
# 254 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecdh.h"
int mbedtls_ecdh_setup(mbedtls_ecdh_context *ctx,
                       mbedtls_ecp_group_id grp_id);
# 264 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecdh.h"
void mbedtls_ecdh_free(mbedtls_ecdh_context *ctx);
# 291 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecdh.h"
int mbedtls_ecdh_make_params(mbedtls_ecdh_context *ctx, size_t *olen,
                             unsigned char *buf, size_t blen,
                             mbedtls_f_rng_t *f_rng,
                             void *p_rng);
# 320 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecdh.h"
int mbedtls_ecdh_read_params(mbedtls_ecdh_context *ctx,
                             const unsigned char **buf,
                             const unsigned char *end);
# 343 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecdh.h"
int mbedtls_ecdh_get_params(mbedtls_ecdh_context *ctx,
                            const mbedtls_ecp_keypair *key,
                            mbedtls_ecdh_side side);
# 373 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecdh.h"
int mbedtls_ecdh_make_public(mbedtls_ecdh_context *ctx, size_t *olen,
                             unsigned char *buf, size_t blen,
                             mbedtls_f_rng_t *f_rng,
                             void *p_rng);
# 397 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecdh.h"
int mbedtls_ecdh_read_public(mbedtls_ecdh_context *ctx,
                             const unsigned char *buf, size_t blen);
# 429 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecdh.h"
int mbedtls_ecdh_calc_secret(mbedtls_ecdh_context *ctx, size_t *olen,
                             unsigned char *buf, size_t blen,
                             mbedtls_f_rng_t *f_rng,
                             void *p_rng);
# 447 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/ecdh.h"
void mbedtls_ecdh_enable_restart(mbedtls_ecdh_context *ctx);
# 59 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 2


# 1 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/error.h" 1
# 15 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/error.h"
# 1 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/lib/gcc/riscv32-unknown-elf/15.1.0/include/stddef.h" 1 3 4
# 16 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/error.h" 2
# 142 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/error.h"
static inline int mbedtls_error_add(int high, int low,
                                    const char *file, int line)
{





    (void) file;
    (void) line;

    return high + low;
}
# 165 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/error.h"
void mbedtls_strerror(int errnum, char *buffer, size_t buflen);
# 180 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/error.h"
const char *mbedtls_high_level_strerr(int error_code);
# 195 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/error.h"
const char *mbedtls_low_level_strerr(int error_code);
# 62 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 2


# 1 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/pk.h" 1
# 73 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/pk.h"
typedef enum {
    MBEDTLS_PK_NONE=0,
    MBEDTLS_PK_RSA,
    MBEDTLS_PK_ECKEY,
    MBEDTLS_PK_ECKEY_DH,
    MBEDTLS_PK_ECDSA,
    MBEDTLS_PK_RSA_ALT,
    MBEDTLS_PK_RSASSA_PSS,
    MBEDTLS_PK_OPAQUE,
} mbedtls_pk_type_t;





typedef struct mbedtls_pk_rsassa_pss_options {
# 97 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/pk.h"
    mbedtls_md_type_t mgf1_hash_id;
# 106 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/pk.h"
    int expected_salt_len;

} mbedtls_pk_rsassa_pss_options;
# 187 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/pk.h"
typedef enum {
    MBEDTLS_PK_DEBUG_NONE = 0,
    MBEDTLS_PK_DEBUG_MPI,
    MBEDTLS_PK_DEBUG_ECP,
    MBEDTLS_PK_DEBUG_PSA_EC,
} mbedtls_pk_debug_type;




typedef struct mbedtls_pk_debug_item {
    mbedtls_pk_debug_type type;
    const char *name;
    void *value;
} mbedtls_pk_debug_item;
# 213 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/pk.h"
typedef struct mbedtls_pk_info_t mbedtls_pk_info_t;






typedef struct mbedtls_pk_context {
    const mbedtls_pk_info_t *pk_info;
    void *pk_ctx;
# 265 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/pk.h"
} mbedtls_pk_context;





typedef struct {
    const mbedtls_pk_info_t *pk_info;
    void *rs_ctx;
} mbedtls_pk_restart_ctx;
# 302 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/pk.h"
const mbedtls_pk_info_t *mbedtls_pk_info_from_type(mbedtls_pk_type_t pk_type);







void mbedtls_pk_init(mbedtls_pk_context *ctx);
# 323 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/pk.h"
void mbedtls_pk_free(mbedtls_pk_context *ctx);
# 332 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/pk.h"
void mbedtls_pk_restart_init(mbedtls_pk_restart_ctx *ctx);







void mbedtls_pk_restart_free(mbedtls_pk_restart_ctx *ctx);
# 358 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/pk.h"
int mbedtls_pk_setup(mbedtls_pk_context *ctx, const mbedtls_pk_info_t *info);
# 430 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/pk.h"
size_t mbedtls_pk_get_bitlen(const mbedtls_pk_context *ctx);
# 439 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/pk.h"
static inline size_t mbedtls_pk_get_len(const mbedtls_pk_context *ctx)
{
    return (mbedtls_pk_get_bitlen(ctx) + 7) / 8;
}
# 456 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/pk.h"
int mbedtls_pk_can_do(const mbedtls_pk_context *ctx, mbedtls_pk_type_t type);
# 600 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/pk.h"
int mbedtls_pk_get_psa_attributes(const mbedtls_pk_context *pk,
                                  psa_key_usage_t usage,
                                  psa_key_attributes_t *attributes);
# 647 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/pk.h"
int mbedtls_pk_import_into_psa(const mbedtls_pk_context *pk,
                               const psa_key_attributes_t *attributes,
                               mbedtls_svc_key_id_t *key_id);
# 685 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/pk.h"
int mbedtls_pk_copy_from_psa(mbedtls_svc_key_id_t key_id, mbedtls_pk_context *pk);
# 718 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/pk.h"
int mbedtls_pk_copy_public_from_psa(mbedtls_svc_key_id_t key_id, mbedtls_pk_context *pk);
# 751 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/pk.h"
int mbedtls_pk_verify(mbedtls_pk_context *ctx, mbedtls_md_type_t md_alg,
                      const unsigned char *hash, size_t hash_len,
                      const unsigned char *sig, size_t sig_len);
# 775 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/pk.h"
int mbedtls_pk_verify_restartable(mbedtls_pk_context *ctx,
                                  mbedtls_md_type_t md_alg,
                                  const unsigned char *hash, size_t hash_len,
                                  const unsigned char *sig, size_t sig_len,
                                  mbedtls_pk_restart_ctx *rs_ctx);
# 812 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/pk.h"
int mbedtls_pk_verify_ext(mbedtls_pk_type_t type, const void *options,
                          mbedtls_pk_context *ctx, mbedtls_md_type_t md_alg,
                          const unsigned char *hash, size_t hash_len,
                          const unsigned char *sig, size_t sig_len);
# 849 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/pk.h"
int mbedtls_pk_sign(mbedtls_pk_context *ctx, mbedtls_md_type_t md_alg,
                    const unsigned char *hash, size_t hash_len,
                    unsigned char *sig, size_t sig_size, size_t *sig_len,
                    mbedtls_f_rng_t *f_rng, void *p_rng);
# 883 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/pk.h"
int mbedtls_pk_sign_ext(mbedtls_pk_type_t pk_type,
                        mbedtls_pk_context *ctx,
                        mbedtls_md_type_t md_alg,
                        const unsigned char *hash, size_t hash_len,
                        unsigned char *sig, size_t sig_size, size_t *sig_len,
                        mbedtls_f_rng_t *f_rng,
                        void *p_rng);
# 920 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/pk.h"
int mbedtls_pk_sign_restartable(mbedtls_pk_context *ctx,
                                mbedtls_md_type_t md_alg,
                                const unsigned char *hash, size_t hash_len,
                                unsigned char *sig, size_t sig_size, size_t *sig_len,
                                mbedtls_f_rng_t *f_rng, void *p_rng,
                                mbedtls_pk_restart_ctx *rs_ctx);
# 947 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/pk.h"
int mbedtls_pk_decrypt(mbedtls_pk_context *ctx,
                       const unsigned char *input, size_t ilen,
                       unsigned char *output, size_t *olen, size_t osize,
                       mbedtls_f_rng_t *f_rng, void *p_rng);
# 973 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/pk.h"
int mbedtls_pk_encrypt(mbedtls_pk_context *ctx,
                       const unsigned char *input, size_t ilen,
                       unsigned char *output, size_t *olen, size_t osize,
                       mbedtls_f_rng_t *f_rng, void *p_rng);
# 992 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/pk.h"
int mbedtls_pk_check_pair(const mbedtls_pk_context *pub,
                          const mbedtls_pk_context *prv,
                          mbedtls_f_rng_t *f_rng,
                          void *p_rng);
# 1005 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/pk.h"
int mbedtls_pk_debug(const mbedtls_pk_context *ctx, mbedtls_pk_debug_item *items);
# 1014 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/pk.h"
const char *mbedtls_pk_get_name(const mbedtls_pk_context *ctx);
# 1024 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/pk.h"
mbedtls_pk_type_t mbedtls_pk_get_type(const mbedtls_pk_context *ctx);
# 1037 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/pk.h"
static inline mbedtls_rsa_context *mbedtls_pk_rsa(const mbedtls_pk_context pk)
{
    switch (mbedtls_pk_get_type(&pk)) {
        case MBEDTLS_PK_RSA:
            return (mbedtls_rsa_context *) (pk).pk_ctx;
        default:
            return 
# 1043 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/pk.h" 3 4
                  ((void *)0)
# 1043 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/pk.h"
                      ;
    }
}
# 1060 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/pk.h"
static inline mbedtls_ecp_keypair *mbedtls_pk_ec(const mbedtls_pk_context pk)
{
    switch (mbedtls_pk_get_type(&pk)) {
        case MBEDTLS_PK_ECKEY:
        case MBEDTLS_PK_ECKEY_DH:
        case MBEDTLS_PK_ECDSA:
            return (mbedtls_ecp_keypair *) (pk).pk_ctx;
        default:
            return 
# 1068 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/pk.h" 3 4
                  ((void *)0)
# 1068 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/pk.h"
                      ;
    }
}
# 1109 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/pk.h"
int mbedtls_pk_parse_key(mbedtls_pk_context *ctx,
                         const unsigned char *key, size_t keylen,
                         const unsigned char *pwd, size_t pwdlen,
                         mbedtls_f_rng_t *f_rng, void *p_rng);
# 1143 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/pk.h"
int mbedtls_pk_parse_public_key(mbedtls_pk_context *ctx,
                                const unsigned char *key, size_t keylen);
# 1213 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/pk.h"
int mbedtls_pk_write_key_der(const mbedtls_pk_context *ctx, unsigned char *buf, size_t size);
# 1228 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/pk.h"
int mbedtls_pk_write_pubkey_der(const mbedtls_pk_context *ctx, unsigned char *buf, size_t size);
# 1273 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/pk.h"
int mbedtls_pk_parse_subpubkey(unsigned char **p, const unsigned char *end,
                               mbedtls_pk_context *pk);
# 1288 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/pk.h"
int mbedtls_pk_write_pubkey(unsigned char **p, unsigned char *start,
                            const mbedtls_pk_context *key);
# 65 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 2
# 1 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/pk_wrap.h" 1
# 22 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/pk_wrap.h"
struct mbedtls_pk_info_t {

    mbedtls_pk_type_t type;


    const char *name;


    size_t (*get_bitlen)(mbedtls_pk_context *pk);


    int (*can_do)(mbedtls_pk_type_t type);


    int (*verify_func)(mbedtls_pk_context *pk, mbedtls_md_type_t md_alg,
                       const unsigned char *hash, size_t hash_len,
                       const unsigned char *sig, size_t sig_len);


    int (*sign_func)(mbedtls_pk_context *pk, mbedtls_md_type_t md_alg,
                     const unsigned char *hash, size_t hash_len,
                     unsigned char *sig, size_t sig_size, size_t *sig_len,
                     int (*f_rng)(void *, unsigned char *, size_t),
                     void *p_rng);



    int (*verify_rs_func)(mbedtls_pk_context *pk, mbedtls_md_type_t md_alg,
                          const unsigned char *hash, size_t hash_len,
                          const unsigned char *sig, size_t sig_len,
                          void *rs_ctx);


    int (*sign_rs_func)(mbedtls_pk_context *pk, mbedtls_md_type_t md_alg,
                        const unsigned char *hash, size_t hash_len,
                        unsigned char *sig, size_t sig_size, size_t *sig_len,
                        int (*f_rng)(void *, unsigned char *, size_t),
                        void *p_rng, void *rs_ctx);



    int (*decrypt_func)(mbedtls_pk_context *pk, const unsigned char *input, size_t ilen,
                        unsigned char *output, size_t *olen, size_t osize,
                        int (*f_rng)(void *, unsigned char *, size_t),
                        void *p_rng);


    int (*encrypt_func)(mbedtls_pk_context *pk, const unsigned char *input, size_t ilen,
                        unsigned char *output, size_t *olen, size_t osize,
                        int (*f_rng)(void *, unsigned char *, size_t),
                        void *p_rng);


    int (*check_pair_func)(mbedtls_pk_context *pub, mbedtls_pk_context *prv,
                           int (*f_rng)(void *, unsigned char *, size_t),
                           void *p_rng);


    void * (*ctx_alloc_func)(void);


    void (*ctx_free_func)(void *ctx);



    void *(*rs_alloc_func)(void);


    void (*rs_free_func)(void *rs_ctx);



    void (*debug_func)(mbedtls_pk_context *pk, mbedtls_pk_debug_item *items);

};
# 108 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/pk_wrap.h"
extern const mbedtls_pk_info_t mbedtls_rsa_info;



extern const mbedtls_pk_info_t mbedtls_eckey_info;
extern const mbedtls_pk_info_t mbedtls_eckeydh_info;



extern const mbedtls_pk_info_t mbedtls_ecdsa_info;
# 66 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 2
# 74 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
# 1 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/include/mbedtls/threading.h" 1
# 75 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 2

# 1 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/constant_time_internal.h" 1
# 12 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/constant_time_internal.h"
# 1 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/lib/gcc/riscv32-unknown-elf/15.1.0/include/stddef.h" 1 3 4
# 13 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/constant_time_internal.h" 2
# 80 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/constant_time_internal.h"
typedef uint32_t mbedtls_ct_condition_t;
typedef uint32_t mbedtls_ct_uint_t;
typedef int32_t mbedtls_ct_int_t;
# 99 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/constant_time_internal.h"
static inline mbedtls_ct_condition_t mbedtls_ct_bool(mbedtls_ct_uint_t x);
# 112 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/constant_time_internal.h"
static inline mbedtls_ct_condition_t mbedtls_ct_uint_ne(mbedtls_ct_uint_t x, mbedtls_ct_uint_t y);
# 125 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/constant_time_internal.h"
static inline mbedtls_ct_condition_t mbedtls_ct_uint_eq(mbedtls_ct_uint_t x,
                                                        mbedtls_ct_uint_t y);
# 139 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/constant_time_internal.h"
static inline mbedtls_ct_condition_t mbedtls_ct_uint_lt(mbedtls_ct_uint_t x, mbedtls_ct_uint_t y);
# 152 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/constant_time_internal.h"
static inline mbedtls_ct_condition_t mbedtls_ct_uint_gt(mbedtls_ct_uint_t x,
                                                        mbedtls_ct_uint_t y);
# 167 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/constant_time_internal.h"
static inline mbedtls_ct_condition_t mbedtls_ct_uint_ge(mbedtls_ct_uint_t x,
                                                        mbedtls_ct_uint_t y);
# 182 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/constant_time_internal.h"
static inline mbedtls_ct_condition_t mbedtls_ct_uint_le(mbedtls_ct_uint_t x,
                                                        mbedtls_ct_uint_t y);
# 200 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/constant_time_internal.h"
static inline mbedtls_ct_condition_t mbedtls_ct_bool_ne(mbedtls_ct_condition_t x,
                                                        mbedtls_ct_condition_t y);
# 215 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/constant_time_internal.h"
static inline mbedtls_ct_condition_t mbedtls_ct_bool_and(mbedtls_ct_condition_t x,
                                                         mbedtls_ct_condition_t y);
# 230 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/constant_time_internal.h"
static inline mbedtls_ct_condition_t mbedtls_ct_bool_or(mbedtls_ct_condition_t x,
                                                        mbedtls_ct_condition_t y);
# 243 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/constant_time_internal.h"
static inline mbedtls_ct_condition_t mbedtls_ct_bool_not(mbedtls_ct_condition_t x);
# 262 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/constant_time_internal.h"
static inline size_t mbedtls_ct_size_if(mbedtls_ct_condition_t condition,
                                        size_t if1,
                                        size_t if0);
# 278 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/constant_time_internal.h"
static inline unsigned mbedtls_ct_uint_if(mbedtls_ct_condition_t condition,
                                          unsigned if1,
                                          unsigned if0);
# 294 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/constant_time_internal.h"
static inline mbedtls_ct_condition_t mbedtls_ct_bool_if(mbedtls_ct_condition_t condition,
                                                        mbedtls_ct_condition_t if1,
                                                        mbedtls_ct_condition_t if0);
# 312 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/constant_time_internal.h"
static inline mbedtls_mpi_uint mbedtls_ct_mpi_uint_if(mbedtls_ct_condition_t condition,
                                                      mbedtls_mpi_uint if1,
                                                      mbedtls_mpi_uint if0);
# 332 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/constant_time_internal.h"
static inline unsigned mbedtls_ct_uint_if_else_0(mbedtls_ct_condition_t condition, unsigned if1);
# 348 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/constant_time_internal.h"
static inline mbedtls_ct_condition_t mbedtls_ct_bool_if_else_0(mbedtls_ct_condition_t condition,
                                                               mbedtls_ct_condition_t if1);
# 365 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/constant_time_internal.h"
static inline size_t mbedtls_ct_size_if_else_0(mbedtls_ct_condition_t condition, size_t if1);
# 383 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/constant_time_internal.h"
static inline mbedtls_mpi_uint mbedtls_ct_mpi_uint_if_else_0(mbedtls_ct_condition_t condition,
                                                             mbedtls_mpi_uint if1);
# 397 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/constant_time_internal.h"
static inline unsigned char mbedtls_ct_uchar_in_range_if(unsigned char low,
                                                         unsigned char high,
                                                         unsigned char c,
                                                         unsigned char t);
# 414 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/constant_time_internal.h"
static inline int mbedtls_ct_error_if(mbedtls_ct_condition_t condition, int if1, int if0);
# 430 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/constant_time_internal.h"
static inline int mbedtls_ct_error_if_else_0(mbedtls_ct_condition_t condition, int if1);
# 450 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/constant_time_internal.h"
void mbedtls_ct_zeroize_if(mbedtls_ct_condition_t condition, void *buf, size_t len);
# 465 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/constant_time_internal.h"
void mbedtls_ct_memmove_left(void *start,
                             size_t total,
                             size_t offset);
# 495 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/constant_time_internal.h"
void mbedtls_ct_memcpy_if(mbedtls_ct_condition_t condition,
                          unsigned char *dest,
                          const unsigned char *src1,
                          const unsigned char *src2,
                          size_t len
                          );
# 531 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/constant_time_internal.h"
void mbedtls_ct_memcpy_offset(unsigned char *dest,
                              const unsigned char *src,
                              size_t offset,
                              size_t offset_min,
                              size_t offset_max,
                              size_t len);
# 568 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/constant_time_internal.h"
int mbedtls_ct_memcmp_partial(const void *a,
                              const void *b,
                              size_t n,
                              size_t skip_head,
                              size_t skip_tail);




# 1 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/constant_time_impl.h" 1
# 11 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/constant_time_impl.h"
# 1 "/home/chandu/sdk/bl602_iot_sdk/toolchain/compiler/lib/gcc/riscv32-unknown-elf/15.1.0/include/stddef.h" 1 3 4
# 12 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/constant_time_impl.h" 2
# 35 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/constant_time_impl.h"
#pragma GCC diagnostic push
#pragma GCC diagnostic ignored "-Wredundant-decls"
# 85 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/constant_time_impl.h"
static inline mbedtls_ct_uint_t mbedtls_ct_compiler_opaque(mbedtls_ct_uint_t x)
{

    __asm__ volatile ("" : [x] "+r" (x) :);
    return x;



}
# 120 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/constant_time_impl.h"
static inline mbedtls_ct_condition_t mbedtls_ct_bool(mbedtls_ct_uint_t x)
{
# 184 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/constant_time_impl.h"
    const mbedtls_ct_uint_t xo = mbedtls_ct_compiler_opaque(x);







    mbedtls_ct_int_t y = (-xo) | -(xo >> 1);


    y = (((mbedtls_ct_uint_t) y) >> ((sizeof(mbedtls_ct_uint_t) * 8) - 1));


    return (mbedtls_ct_condition_t) (-y);




}

static inline mbedtls_ct_uint_t mbedtls_ct_if(mbedtls_ct_condition_t condition,
                                              mbedtls_ct_uint_t if1,
                                              mbedtls_ct_uint_t if0)
{
# 265 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/constant_time_impl.h"
    mbedtls_ct_condition_t not_cond =
        (mbedtls_ct_condition_t) (~mbedtls_ct_compiler_opaque(condition));
    return (mbedtls_ct_uint_t) ((condition & if1) | (not_cond & if0));

}

static inline mbedtls_ct_condition_t mbedtls_ct_uint_lt(mbedtls_ct_uint_t x, mbedtls_ct_uint_t y)
{
# 354 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/constant_time_impl.h"
    const mbedtls_ct_uint_t xo = mbedtls_ct_compiler_opaque(x);
    const mbedtls_ct_uint_t yo = mbedtls_ct_compiler_opaque(y);




    mbedtls_ct_condition_t cond = mbedtls_ct_bool((xo ^ yo) >> ((sizeof(mbedtls_ct_uint_t) * 8) - 1));
# 372 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/constant_time_impl.h"
    mbedtls_ct_uint_t ret = mbedtls_ct_if(cond, yo, (mbedtls_ct_uint_t) (xo - yo));


    ret = ret >> ((sizeof(mbedtls_ct_uint_t) * 8) - 1);


    return mbedtls_ct_bool(ret);

}

static inline mbedtls_ct_condition_t mbedtls_ct_uint_ne(mbedtls_ct_uint_t x, mbedtls_ct_uint_t y)
{

    const mbedtls_ct_uint_t diff = mbedtls_ct_compiler_opaque(x) ^ mbedtls_ct_compiler_opaque(y);


    return mbedtls_ct_bool(diff);
}

static inline unsigned char mbedtls_ct_uchar_in_range_if(unsigned char low,
                                                         unsigned char high,
                                                         unsigned char c,
                                                         unsigned char t)
{
    const unsigned char co = (unsigned char) mbedtls_ct_compiler_opaque(c);
    const unsigned char to = (unsigned char) mbedtls_ct_compiler_opaque(t);


    unsigned low_mask = ((unsigned) co - low) >> 8;

    unsigned high_mask = ((unsigned) high - co) >> 8;

    return (unsigned char) (~(low_mask | high_mask)) & to;
}





static inline size_t mbedtls_ct_size_if(mbedtls_ct_condition_t condition,
                                        size_t if1,
                                        size_t if0)
{
    return (size_t) mbedtls_ct_if(condition, (mbedtls_ct_uint_t) if1, (mbedtls_ct_uint_t) if0);
}

static inline unsigned mbedtls_ct_uint_if(mbedtls_ct_condition_t condition,
                                          unsigned if1,
                                          unsigned if0)
{
    return (unsigned) mbedtls_ct_if(condition, (mbedtls_ct_uint_t) if1, (mbedtls_ct_uint_t) if0);
}

static inline mbedtls_ct_condition_t mbedtls_ct_bool_if(mbedtls_ct_condition_t condition,
                                                        mbedtls_ct_condition_t if1,
                                                        mbedtls_ct_condition_t if0)
{
    return (mbedtls_ct_condition_t) mbedtls_ct_if(condition, (mbedtls_ct_uint_t) if1,
                                                  (mbedtls_ct_uint_t) if0);
}



static inline mbedtls_mpi_uint mbedtls_ct_mpi_uint_if(mbedtls_ct_condition_t condition,
                                                      mbedtls_mpi_uint if1,
                                                      mbedtls_mpi_uint if0)
{
    return (mbedtls_mpi_uint) mbedtls_ct_if(condition,
                                            (mbedtls_ct_uint_t) if1,
                                            (mbedtls_ct_uint_t) if0);
}



static inline size_t mbedtls_ct_size_if_else_0(mbedtls_ct_condition_t condition, size_t if1)
{
    return (size_t) (condition & if1);
}

static inline unsigned mbedtls_ct_uint_if_else_0(mbedtls_ct_condition_t condition, unsigned if1)
{
    return (unsigned) (condition & if1);
}

static inline mbedtls_ct_condition_t mbedtls_ct_bool_if_else_0(mbedtls_ct_condition_t condition,
                                                               mbedtls_ct_condition_t if1)
{
    return (mbedtls_ct_condition_t) (condition & if1);
}



static inline mbedtls_mpi_uint mbedtls_ct_mpi_uint_if_else_0(mbedtls_ct_condition_t condition,
                                                             mbedtls_mpi_uint if1)
{
    return (mbedtls_mpi_uint) (condition & if1);
}



static inline int mbedtls_ct_error_if(mbedtls_ct_condition_t condition, int if1, int if0)
{






    return -((int) mbedtls_ct_if(condition, (mbedtls_ct_uint_t) (-if1),
                                 (mbedtls_ct_uint_t) (-if0)));
}

static inline int mbedtls_ct_error_if_else_0(mbedtls_ct_condition_t condition, int if1)
{
    return -((int) (condition & (-if1)));
}

static inline mbedtls_ct_condition_t mbedtls_ct_uint_eq(mbedtls_ct_uint_t x,
                                                        mbedtls_ct_uint_t y)
{
    return ~mbedtls_ct_uint_ne(x, y);
}

static inline mbedtls_ct_condition_t mbedtls_ct_uint_gt(mbedtls_ct_uint_t x,
                                                        mbedtls_ct_uint_t y)
{
    return mbedtls_ct_uint_lt(y, x);
}

static inline mbedtls_ct_condition_t mbedtls_ct_uint_ge(mbedtls_ct_uint_t x,
                                                        mbedtls_ct_uint_t y)
{
    return ~mbedtls_ct_uint_lt(x, y);
}

static inline mbedtls_ct_condition_t mbedtls_ct_uint_le(mbedtls_ct_uint_t x,
                                                        mbedtls_ct_uint_t y)
{
    return ~mbedtls_ct_uint_gt(x, y);
}

static inline mbedtls_ct_condition_t mbedtls_ct_bool_ne(mbedtls_ct_condition_t x,
                                                        mbedtls_ct_condition_t y)
{
    return (mbedtls_ct_condition_t) (x ^ y);
}

static inline mbedtls_ct_condition_t mbedtls_ct_bool_and(mbedtls_ct_condition_t x,
                                                         mbedtls_ct_condition_t y)
{
    return (mbedtls_ct_condition_t) (x & y);
}

static inline mbedtls_ct_condition_t mbedtls_ct_bool_or(mbedtls_ct_condition_t x,
                                                        mbedtls_ct_condition_t y)
{
    return (mbedtls_ct_condition_t) (x | y);
}

static inline mbedtls_ct_condition_t mbedtls_ct_bool_not(mbedtls_ct_condition_t x)
{
    return (mbedtls_ct_condition_t) (~x);
}



#pragma GCC diagnostic pop
# 578 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/constant_time_internal.h" 2
# 77 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 2
# 88 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
static int key_type_is_raw_bytes(psa_key_type_t type)
{
    return (((type) & ((psa_key_type_t) 0x7000)) == ((psa_key_type_t) 0x1000) || ((type) & ((psa_key_type_t) 0x7000)) == ((psa_key_type_t) 0x2000));
}
# 100 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
typedef enum {
    PSA_CRYPTO_SUBSYSTEM_DRIVER_WRAPPERS = 1,
    PSA_CRYPTO_SUBSYSTEM_KEY_SLOTS,
    PSA_CRYPTO_SUBSYSTEM_RNG,
    PSA_CRYPTO_SUBSYSTEM_TRANSACTION,
} mbedtls_psa_crypto_subsystem;
# 117 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
typedef struct {
    uint8_t initialized;
    uint8_t rng_state;
    mbedtls_psa_random_context_t rng;
} psa_global_data_t;

static psa_global_data_t global_data;

static uint8_t psa_get_initialized(void)
{
    uint8_t initialized;





    initialized = global_data.rng_state == 2;
# 143 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
    initialized =
        (initialized && (global_data.initialized == ( 0x01 | 0x02 | 0x04)));





    return initialized;
}

static uint8_t psa_get_drivers_initialized(void)
{
    uint8_t initialized;





    initialized = (global_data.initialized & 0x01) != 0;





    return initialized;
}
# 286 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
int psa_can_do_hash(psa_algorithm_t hash_alg)
{
    (void) hash_alg;
    return psa_get_drivers_initialized();
}

int psa_can_do_cipher(psa_key_type_t key_type, psa_algorithm_t cipher_alg)
{
    (void) key_type;
    (void) cipher_alg;
    return psa_get_drivers_initialized();
}





static int psa_is_dh_key_size_valid(size_t bits)
{
    switch (bits) {

        case 2048:
            return 1;


        case 3072:
            return 1;


        case 4096:
            return 1;


        case 6144:
            return 1;


        case 8192:
            return 1;

        default:
            return 0;
    }
}




psa_status_t mbedtls_to_psa_error(int ret)
{



    int low_level_ret = -(-ret & 0x007f);
    switch (low_level_ret != 0 ? low_level_ret : ret) {
        case 0:
            return ((psa_status_t)0);


        case -0x0020:
        case -0x0022:
            return ((psa_status_t)-134);
        case -0x0021:
            return ((psa_status_t)-135);



        case -0x0060:
        case -0x0062:
        case -0x0064:
        case -0x0066:
        case -0x0068:
            return ((psa_status_t)-135);
        case -0x006A:
            return ((psa_status_t)-141);
        case -0x006C:
            return ((psa_status_t)-138);
# 372 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
        case -0x000D:
            return ((psa_status_t)-135);
        case -0x000F:
            return ((psa_status_t)-149);



        case -0x0051:
            return ((psa_status_t)-135);
# 391 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
        case -0x6080:
            return ((psa_status_t)-134);
        case -0x6100:
            return ((psa_status_t)-135);
        case -0x6180:
            return ((psa_status_t)-141);
        case -0x6200:
            return ((psa_status_t)-150);
        case -0x6280:
            return ((psa_status_t)-135);
        case -0x6300:
            return ((psa_status_t)-149);
        case -0x6380:
            return ((psa_status_t)-151);






        case -0x0034:
            return ((psa_status_t)-148);
        case -0x0036:
        case -0x0038:
            return ((psa_status_t)-134);
        case -0x003A:
            return ((psa_status_t)-148);



        case -0x0032:
            return ((psa_status_t)-134);


        case -0x0040:
        case -0x003D:
        case -0x003C:
            return ((psa_status_t)-148);


        case -0x0012:
            return ((psa_status_t)-149);
        case -0x0016:
            return ((psa_status_t)-138);
        case -0x0014:
            return ((psa_status_t)-135);
# 453 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
        case -0x5080:
            return ((psa_status_t)-134);
        case -0x5100:
            return ((psa_status_t)-135);
        case -0x5180:
            return ((psa_status_t)-141);
# 470 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
        case -0x0004:
            return ((psa_status_t)-135);
        case -0x0006:
            return ((psa_status_t)-135);
        case -0x0008:
            return ((psa_status_t)-138);
        case -0x000A:
            return ((psa_status_t)-135);
        case -0x000C:
            return ((psa_status_t)-135);
        case -0x000E:
            return ((psa_status_t)-135);
        case -0x0010:
            return ((psa_status_t)-141);



        case -0x3F80:
            return ((psa_status_t)-141);
        case -0x3F00:
        case -0x3E80:
            return ((psa_status_t)-135);





        case -0x3D80:
        case -0x3D00:
            return ((psa_status_t)-135);
        case -0x3C80:
            return ((psa_status_t)-134);
        case -0x3C00:
        case -0x3B80:
            return ((psa_status_t)-133);
        case -0x3B00:
            return ((psa_status_t)-135);
        case -0x3A80:
        case -0x3A00:
        case -0x3980:
            return ((psa_status_t)-134);
        case -0x3900:
            return ((psa_status_t)-149);
        case -0x3880:
            return ((psa_status_t)-138);


        case -0x0070:
            return ((psa_status_t)-147);
        case -0x0072:
            return ((psa_status_t)-134);


        case -0x4080:
            return ((psa_status_t)-135);
        case -0x4100:
            return ((psa_status_t)-150);
        case -0x4180:
            return ((psa_status_t)-147);
        case -0x4200:
            return ((psa_status_t)-135);
        case -0x4280:
        case -0x4300:
            return ((psa_status_t)-151);
        case -0x4380:
            return ((psa_status_t)-149);
        case -0x4400:
            return ((psa_status_t)-138);
        case -0x4480:
            return ((psa_status_t)-148);



        case -0x4F80:
        case -0x4C80:
            return ((psa_status_t)-135);
        case -0x4F00:
            return ((psa_status_t)-138);
        case -0x4E80:
            return ((psa_status_t)-134);
        case -0x4C00:
        case -0x4E00:
            return ((psa_status_t)-149);
        case -0x4D80:
            return ((psa_status_t)-141);
        case -0x4D00:
            return ((psa_status_t)-148);


        case -0x4B00:
            return ((psa_status_t)-248);



        case -0x006E:
            return ((psa_status_t)-151);

        default:
            return ((psa_status_t)-132);
    }
}
# 592 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
static void psa_wipe_tag_output_buffer(uint8_t *output_buffer, psa_status_t status,
                                       size_t output_buffer_size, size_t output_buffer_length)
{
    size_t offset = 0;

    if (output_buffer_size == 0) {


        return;
    }

    if (status == ((psa_status_t)0)) {
        offset = output_buffer_length;
    }

    memset(output_buffer + offset, '!', output_buffer_size - offset);
}


psa_status_t psa_validate_unstructured_key_bit_size(psa_key_type_t type,
                                                    size_t bits)
{

    switch (type) {
        case ((psa_key_type_t) 0x1001):
        case ((psa_key_type_t) 0x1100):
        case ((psa_key_type_t) 0x1200):
        case ((psa_key_type_t) 0x1203):
        case ((psa_key_type_t) 0x1205):
            break;

        case ((psa_key_type_t) 0x2400):
            if (bits != 128 && bits != 192 && bits != 256) {
                return ((psa_status_t)-135);
            }
            break;
# 644 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
        case ((psa_key_type_t) 0x2301):
            if (bits != 64 && bits != 128 && bits != 192) {
                return ((psa_status_t)-135);
            }
            break;


        case ((psa_key_type_t) 0x2004):
            if (bits != 256) {
                return ((psa_status_t)-135);
            }
            break;

        default:
            return ((psa_status_t)-134);
    }
    if (bits % 8 != 0) {
        return ((psa_status_t)-135);
    }

    return ((psa_status_t)0);
}
# 681 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
static psa_status_t psa_mac_key_can_do(
    psa_algorithm_t algorithm,
    psa_key_type_t key_type)
{
    if ((((algorithm) & (((psa_algorithm_t) 0x7f000000) | ((psa_algorithm_t) 0x00c00000))) == ((psa_algorithm_t) 0x03800000))) {
        if (key_type == ((psa_key_type_t) 0x1100)) {
            return ((psa_status_t)0);
        }
    }

    if ((((algorithm) & (((psa_algorithm_t) 0x7f000000) | ((psa_algorithm_t) 0x00c00000))) == ((psa_algorithm_t) 0x03c00000))) {


        if ((key_type & ((psa_key_type_t) 0x7000)) ==
            ((psa_key_type_t) 0x2000)) {


            if ((((key_type) & ((psa_key_type_t) 0x7000)) == ((psa_key_type_t) 0x2000) ? 1u << (((key_type) >> 8) & 7) : 0u) > 1) {
                return ((psa_status_t)0);
            }
        }
    }

    return ((psa_status_t)-135);
}

psa_status_t psa_allocate_buffer_to_slot(psa_key_slot_t *slot,
                                         size_t buffer_length)
{





    if (slot->key.data != 
# 715 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
                         ((void *)0)
# 715 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
                             ) {
        return ((psa_status_t)-139);
    }

    slot->key.data = calloc(1, buffer_length);
    if (slot->key.data == 
# 720 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
                         ((void *)0)
# 720 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
                             ) {
        return ((psa_status_t)-141);
    }


    slot->key.bytes = buffer_length;
    return ((psa_status_t)0);
}

psa_status_t psa_copy_key_material_into_slot(psa_key_slot_t *slot,
                                             const uint8_t *data,
                                             size_t data_length)
{
    psa_status_t status = psa_allocate_buffer_to_slot(slot,
                                                      data_length);
    if (status != ((psa_status_t)0)) {
        return status;
    }

    memcpy(slot->key.data, data, data_length);
    return ((psa_status_t)0);
}

psa_status_t psa_import_key_into_slot(
    const psa_key_attributes_t *attributes,
    const uint8_t *data, size_t data_length,
    uint8_t *key_buffer, size_t key_buffer_size,
    size_t *key_buffer_length, size_t *bits)
{
    psa_status_t status = ((psa_status_t)-151);
    psa_key_type_t type = attributes->type;


    if (data_length == 0) {
        return ((psa_status_t)-134);
    }

    if (key_type_is_raw_bytes(type)) {
        *bits = ((data_length) * 8u);

        status = psa_validate_unstructured_key_bit_size(attributes->type,
                                                        *bits);
        if (status != ((psa_status_t)0)) {
            return status;
        }


        memcpy(key_buffer, data, data_length);
        *key_buffer_length = data_length;
        (void) key_buffer_size;

        return ((psa_status_t)0);
    } else if ((((type) & ((psa_key_type_t) 0x7000) & ~((psa_key_type_t) 0x3000)) == ((psa_key_type_t) 0x4000))) {


        if (((((type) & ~((psa_key_type_t) 0x3000)) & ~((psa_key_type_t) 0x00ff)) == ((psa_key_type_t) 0x4200))) {
            if (psa_is_dh_key_size_valid(((data_length) * 8u)) == 0) {
                return ((psa_status_t)-134);
            }
            return mbedtls_psa_ffdh_import_key(attributes,
                                               data, data_length,
                                               key_buffer, key_buffer_size,
                                               key_buffer_length,
                                               bits);
        }




        if (((((type) & ~((psa_key_type_t) 0x3000)) & ~((psa_key_type_t) 0x00ff)) == ((psa_key_type_t) 0x4100))) {
            return mbedtls_psa_ecp_import_key(attributes,
                                              data, data_length,
                                              key_buffer, key_buffer_size,
                                              key_buffer_length,
                                              bits);
        }





        if ((((type) & ~((psa_key_type_t) 0x3000)) == ((psa_key_type_t) 0x4001))) {
            return mbedtls_psa_rsa_import_key(attributes,
                                              data, data_length,
                                              key_buffer, key_buffer_size,
                                              key_buffer_length,
                                              bits);
        }



    }

    return ((psa_status_t)-134);
}





static psa_algorithm_t psa_key_policy_algorithm_intersection(
    psa_key_type_t key_type,
    psa_algorithm_t alg1,
    psa_algorithm_t alg2)
{

    if (alg1 == alg2) {
        return alg1;
    }


    if ((((((alg1) & ~((psa_algorithm_t) 0x000000ff)) == ((psa_algorithm_t) 0x06000300)) || (((alg1) & ~((psa_algorithm_t) 0x000000ff)) == ((psa_algorithm_t) 0x06001300))) || (((alg1) & ~((psa_algorithm_t) 0x000000ff)) == ((psa_algorithm_t) 0x06000200)) || (((alg1) & ~((psa_algorithm_t) 0x000000ff) & ~((psa_algorithm_t) 0x00000100)) == ((psa_algorithm_t) 0x06000600)) || (((alg1) & ~((psa_algorithm_t) 0x000000ff)) == ((psa_algorithm_t) 0x06000900)) || (((alg1) & ~((psa_algorithm_t) 0x000000ff) & ~((psa_algorithm_t) 0x00000100)) == ((psa_algorithm_t) 0x06000400))) &&
        (((((alg2) & ~((psa_algorithm_t) 0x000000ff)) == ((psa_algorithm_t) 0x06000300)) || (((alg2) & ~((psa_algorithm_t) 0x000000ff)) == ((psa_algorithm_t) 0x06001300))) || (((alg2) & ~((psa_algorithm_t) 0x000000ff)) == ((psa_algorithm_t) 0x06000200)) || (((alg2) & ~((psa_algorithm_t) 0x000000ff) & ~((psa_algorithm_t) 0x00000100)) == ((psa_algorithm_t) 0x06000600)) || (((alg2) & ~((psa_algorithm_t) 0x000000ff)) == ((psa_algorithm_t) 0x06000900)) || (((alg2) & ~((psa_algorithm_t) 0x000000ff) & ~((psa_algorithm_t) 0x00000100)) == ((psa_algorithm_t) 0x06000400))) &&
        (alg1 & ~((psa_algorithm_t) 0x000000ff)) == (alg2 & ~((psa_algorithm_t) 0x000000ff))) {
        if ((((((((alg1) & ~((psa_algorithm_t) 0x000000ff)) == ((psa_algorithm_t) 0x06000300)) || (((alg1) & ~((psa_algorithm_t) 0x000000ff)) == ((psa_algorithm_t) 0x06001300))) || (((alg1) & ~((psa_algorithm_t) 0x000000ff)) == ((psa_algorithm_t) 0x06000200)) || (((alg1) & ~((psa_algorithm_t) 0x000000ff) & ~((psa_algorithm_t) 0x00000100)) == ((psa_algorithm_t) 0x06000600)) || (((alg1) & ~((psa_algorithm_t) 0x000000ff)) == ((psa_algorithm_t) 0x06000900)) || (((alg1) & ~((psa_algorithm_t) 0x000000ff) & ~((psa_algorithm_t) 0x00000100)) == ((psa_algorithm_t) 0x06000400))) && ((alg1) & ((psa_algorithm_t) 0x000000ff)) != 0) ? ((alg1) & ((psa_algorithm_t) 0x000000ff)) | ((psa_algorithm_t) 0x02000000) : 0) == ((psa_algorithm_t) 0x020000ff)) {
            return alg2;
        }
        if ((((((((alg2) & ~((psa_algorithm_t) 0x000000ff)) == ((psa_algorithm_t) 0x06000300)) || (((alg2) & ~((psa_algorithm_t) 0x000000ff)) == ((psa_algorithm_t) 0x06001300))) || (((alg2) & ~((psa_algorithm_t) 0x000000ff)) == ((psa_algorithm_t) 0x06000200)) || (((alg2) & ~((psa_algorithm_t) 0x000000ff) & ~((psa_algorithm_t) 0x00000100)) == ((psa_algorithm_t) 0x06000600)) || (((alg2) & ~((psa_algorithm_t) 0x000000ff)) == ((psa_algorithm_t) 0x06000900)) || (((alg2) & ~((psa_algorithm_t) 0x000000ff) & ~((psa_algorithm_t) 0x00000100)) == ((psa_algorithm_t) 0x06000400))) && ((alg2) & ((psa_algorithm_t) 0x000000ff)) != 0) ? ((alg2) & ((psa_algorithm_t) 0x000000ff)) | ((psa_algorithm_t) 0x02000000) : 0) == ((psa_algorithm_t) 0x020000ff)) {
            return alg1;
        }
    }



    if ((((alg1) & ((psa_algorithm_t) 0x7f000000)) == ((psa_algorithm_t) 0x05000000)) && (((alg2) & ((psa_algorithm_t) 0x7f000000)) == ((psa_algorithm_t) 0x05000000)) &&
        ((((alg1) & ~(((psa_algorithm_t) 0x003f0000) | ((psa_algorithm_t) 0x00008000))) | ((0) << 16 & ((psa_algorithm_t) 0x003f0000))) ==
         (((alg2) & ~(((psa_algorithm_t) 0x003f0000) | ((psa_algorithm_t) 0x00008000))) | ((0) << 16 & ((psa_algorithm_t) 0x003f0000))))) {
        size_t alg1_len = (((alg1) & ((psa_algorithm_t) 0x003f0000)) >> 16);
        size_t alg2_len = (((alg2) & ((psa_algorithm_t) 0x003f0000)) >> 16);
        size_t restricted_len = alg1_len > alg2_len ? alg1_len : alg2_len;


        if (((alg1 & ((psa_algorithm_t) 0x00008000)) != 0) &&
            ((alg2 & ((psa_algorithm_t) 0x00008000)) != 0)) {
            return ((((alg1) & ~(((psa_algorithm_t) 0x003f0000) | ((psa_algorithm_t) 0x00008000))) | ((restricted_len) << 16 & ((psa_algorithm_t) 0x003f0000))) | ((psa_algorithm_t) 0x00008000))
                                     ;
        }

        if (((alg1 & ((psa_algorithm_t) 0x00008000)) != 0) &&
            (alg1_len <= alg2_len)) {
            return alg2;
        }
        if (((alg2 & ((psa_algorithm_t) 0x00008000)) != 0) &&
            (alg2_len <= alg1_len)) {
            return alg1;
        }
    }



    if ((((alg1) & ((psa_algorithm_t) 0x7f000000)) == ((psa_algorithm_t) 0x03000000)) && (((alg2) & ((psa_algorithm_t) 0x7f000000)) == ((psa_algorithm_t) 0x03000000)) &&
        (((alg1) & ~(((psa_algorithm_t) 0x003f0000) | ((psa_algorithm_t) 0x00008000))) ==
         ((alg2) & ~(((psa_algorithm_t) 0x003f0000) | ((psa_algorithm_t) 0x00008000))))) {


        if (((psa_status_t)0) != psa_mac_key_can_do(alg1, key_type)) {
            return 0;
        }
# 887 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
        size_t alg1_len = ((alg1) & ((psa_algorithm_t) 0x003f0000) ? (((alg1) & ((psa_algorithm_t) 0x003f0000)) >> 16) : (((alg1) & (((psa_algorithm_t) 0x7f000000) | ((psa_algorithm_t) 0x00c00000))) == ((psa_algorithm_t) 0x03800000)) ? ( (((psa_algorithm_t) 0x02000000) | (((((psa_algorithm_t) 0x02000000) | ((alg1) & ((psa_algorithm_t) 0x000000ff)))) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000003) ? 16u : (((psa_algorithm_t) 0x02000000) | (((((psa_algorithm_t) 0x02000000) | ((alg1) & ((psa_algorithm_t) 0x000000ff)))) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000004) ? 20u : (((psa_algorithm_t) 0x02000000) | (((((psa_algorithm_t) 0x02000000) | ((alg1) & ((psa_algorithm_t) 0x000000ff)))) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000005) ? 20u : (((psa_algorithm_t) 0x02000000) | (((((psa_algorithm_t) 0x02000000) | ((alg1) & ((psa_algorithm_t) 0x000000ff)))) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000008) ? 28u : (((psa_algorithm_t) 0x02000000) | (((((psa_algorithm_t) 0x02000000) | ((alg1) & ((psa_algorithm_t) 0x000000ff)))) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000009) ? 32u : (((psa_algorithm_t) 0x02000000) | (((((psa_algorithm_t) 0x02000000) | ((alg1) & ((psa_algorithm_t) 0x000000ff)))) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x0200000a) ? 48u : (((psa_algorithm_t) 0x02000000) | (((((psa_algorithm_t) 0x02000000) | ((alg1) & ((psa_algorithm_t) 0x000000ff)))) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x0200000b) ? 64u : (((psa_algorithm_t) 0x02000000) | (((((psa_algorithm_t) 0x02000000) | ((alg1) & ((psa_algorithm_t) 0x000000ff)))) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x0200000c) ? 28u : (((psa_algorithm_t) 0x02000000) | (((((psa_algorithm_t) 0x02000000) | ((alg1) & ((psa_algorithm_t) 0x000000ff)))) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x0200000d) ? 32u : (((psa_algorithm_t) 0x02000000) | (((((psa_algorithm_t) 0x02000000) | ((alg1) & ((psa_algorithm_t) 0x000000ff)))) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000010) ? 28u : (((psa_algorithm_t) 0x02000000) | (((((psa_algorithm_t) 0x02000000) | ((alg1) & ((psa_algorithm_t) 0x000000ff)))) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000011) ? 32u : (((psa_algorithm_t) 0x02000000) | (((((psa_algorithm_t) 0x02000000) | ((alg1) & ((psa_algorithm_t) 0x000000ff)))) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000012) ? 48u : (((psa_algorithm_t) 0x02000000) | (((((psa_algorithm_t) 0x02000000) | ((alg1) & ((psa_algorithm_t) 0x000000ff)))) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000013) ? 64u : 0u) : (((alg1) & (((psa_algorithm_t) 0x7f000000) | ((psa_algorithm_t) 0x00c00000))) == ((psa_algorithm_t) 0x03c00000)) ? (((key_type) & ((psa_key_type_t) 0x7000)) == ((psa_key_type_t) 0x2000) ? 1u << (((key_type) >> 8) & 7) : 0u) : ((void) (key_type), (void) (0), 0u));
        size_t alg2_len = ((alg2) & ((psa_algorithm_t) 0x003f0000) ? (((alg2) & ((psa_algorithm_t) 0x003f0000)) >> 16) : (((alg2) & (((psa_algorithm_t) 0x7f000000) | ((psa_algorithm_t) 0x00c00000))) == ((psa_algorithm_t) 0x03800000)) ? ( (((psa_algorithm_t) 0x02000000) | (((((psa_algorithm_t) 0x02000000) | ((alg2) & ((psa_algorithm_t) 0x000000ff)))) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000003) ? 16u : (((psa_algorithm_t) 0x02000000) | (((((psa_algorithm_t) 0x02000000) | ((alg2) & ((psa_algorithm_t) 0x000000ff)))) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000004) ? 20u : (((psa_algorithm_t) 0x02000000) | (((((psa_algorithm_t) 0x02000000) | ((alg2) & ((psa_algorithm_t) 0x000000ff)))) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000005) ? 20u : (((psa_algorithm_t) 0x02000000) | (((((psa_algorithm_t) 0x02000000) | ((alg2) & ((psa_algorithm_t) 0x000000ff)))) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000008) ? 28u : (((psa_algorithm_t) 0x02000000) | (((((psa_algorithm_t) 0x02000000) | ((alg2) & ((psa_algorithm_t) 0x000000ff)))) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000009) ? 32u : (((psa_algorithm_t) 0x02000000) | (((((psa_algorithm_t) 0x02000000) | ((alg2) & ((psa_algorithm_t) 0x000000ff)))) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x0200000a) ? 48u : (((psa_algorithm_t) 0x02000000) | (((((psa_algorithm_t) 0x02000000) | ((alg2) & ((psa_algorithm_t) 0x000000ff)))) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x0200000b) ? 64u : (((psa_algorithm_t) 0x02000000) | (((((psa_algorithm_t) 0x02000000) | ((alg2) & ((psa_algorithm_t) 0x000000ff)))) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x0200000c) ? 28u : (((psa_algorithm_t) 0x02000000) | (((((psa_algorithm_t) 0x02000000) | ((alg2) & ((psa_algorithm_t) 0x000000ff)))) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x0200000d) ? 32u : (((psa_algorithm_t) 0x02000000) | (((((psa_algorithm_t) 0x02000000) | ((alg2) & ((psa_algorithm_t) 0x000000ff)))) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000010) ? 28u : (((psa_algorithm_t) 0x02000000) | (((((psa_algorithm_t) 0x02000000) | ((alg2) & ((psa_algorithm_t) 0x000000ff)))) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000011) ? 32u : (((psa_algorithm_t) 0x02000000) | (((((psa_algorithm_t) 0x02000000) | ((alg2) & ((psa_algorithm_t) 0x000000ff)))) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000012) ? 48u : (((psa_algorithm_t) 0x02000000) | (((((psa_algorithm_t) 0x02000000) | ((alg2) & ((psa_algorithm_t) 0x000000ff)))) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000013) ? 64u : 0u) : (((alg2) & (((psa_algorithm_t) 0x7f000000) | ((psa_algorithm_t) 0x00c00000))) == ((psa_algorithm_t) 0x03c00000)) ? (((key_type) & ((psa_key_type_t) 0x7000)) == ((psa_key_type_t) 0x2000) ? 1u << (((key_type) >> 8) & 7) : 0u) : ((void) (key_type), (void) (0), 0u));
        size_t restricted_len = alg1_len > alg2_len ? alg1_len : alg2_len;


        if (((alg1 & ((psa_algorithm_t) 0x00008000)) != 0) &&
            ((alg2 & ((psa_algorithm_t) 0x00008000)) != 0)) {
            return ((((alg1) & ~(((psa_algorithm_t) 0x003f0000) | ((psa_algorithm_t) 0x00008000))) | ((restricted_len) << 16 & ((psa_algorithm_t) 0x003f0000))) | ((psa_algorithm_t) 0x00008000));
        }




        if ((alg1 & ((psa_algorithm_t) 0x00008000)) != 0) {
            return (alg1_len <= alg2_len) ? alg2 : 0;
        }
        if ((alg2 & ((psa_algorithm_t) 0x00008000)) != 0) {
            return (alg2_len <= alg1_len) ? alg1 : 0;
        }





        if (alg1_len == alg2_len) {
            return (((alg1) & ~(((psa_algorithm_t) 0x003f0000) | ((psa_algorithm_t) 0x00008000))) | ((alg1_len) << 16 & ((psa_algorithm_t) 0x003f0000)));
        }
    }

    return 0;
}

static int psa_key_algorithm_permits(psa_key_type_t key_type,
                                     psa_algorithm_t policy_alg,
                                     psa_algorithm_t requested_alg)
{

    if (requested_alg == policy_alg) {
        return 1;
    }



    if ((((((requested_alg) & ~((psa_algorithm_t) 0x000000ff)) == ((psa_algorithm_t) 0x06000300)) || (((requested_alg) & ~((psa_algorithm_t) 0x000000ff)) == ((psa_algorithm_t) 0x06001300))) || (((requested_alg) & ~((psa_algorithm_t) 0x000000ff)) == ((psa_algorithm_t) 0x06000200)) || (((requested_alg) & ~((psa_algorithm_t) 0x000000ff) & ~((psa_algorithm_t) 0x00000100)) == ((psa_algorithm_t) 0x06000600)) || (((requested_alg) & ~((psa_algorithm_t) 0x000000ff)) == ((psa_algorithm_t) 0x06000900)) || (((requested_alg) & ~((psa_algorithm_t) 0x000000ff) & ~((psa_algorithm_t) 0x00000100)) == ((psa_algorithm_t) 0x06000400))) &&
        (((((((policy_alg) & ~((psa_algorithm_t) 0x000000ff)) == ((psa_algorithm_t) 0x06000300)) || (((policy_alg) & ~((psa_algorithm_t) 0x000000ff)) == ((psa_algorithm_t) 0x06001300))) || (((policy_alg) & ~((psa_algorithm_t) 0x000000ff)) == ((psa_algorithm_t) 0x06000200)) || (((policy_alg) & ~((psa_algorithm_t) 0x000000ff) & ~((psa_algorithm_t) 0x00000100)) == ((psa_algorithm_t) 0x06000600)) || (((policy_alg) & ~((psa_algorithm_t) 0x000000ff)) == ((psa_algorithm_t) 0x06000900)) || (((policy_alg) & ~((psa_algorithm_t) 0x000000ff) & ~((psa_algorithm_t) 0x00000100)) == ((psa_algorithm_t) 0x06000400))) && ((policy_alg) & ((psa_algorithm_t) 0x000000ff)) != 0) ? ((policy_alg) & ((psa_algorithm_t) 0x000000ff)) | ((psa_algorithm_t) 0x02000000) : 0) == ((psa_algorithm_t) 0x020000ff)) {
        return (policy_alg & ~((psa_algorithm_t) 0x000000ff)) ==
               (requested_alg & ~((psa_algorithm_t) 0x000000ff));
    }



    if ((((policy_alg) & ((psa_algorithm_t) 0x7f000000)) == ((psa_algorithm_t) 0x05000000)) &&
        (((requested_alg) & ((psa_algorithm_t) 0x7f000000)) == ((psa_algorithm_t) 0x05000000)) &&
        ((((policy_alg) & ~(((psa_algorithm_t) 0x003f0000) | ((psa_algorithm_t) 0x00008000))) | ((0) << 16 & ((psa_algorithm_t) 0x003f0000))) ==
         (((requested_alg) & ~(((psa_algorithm_t) 0x003f0000) | ((psa_algorithm_t) 0x00008000))) | ((0) << 16 & ((psa_algorithm_t) 0x003f0000)))) &&
        ((policy_alg & ((psa_algorithm_t) 0x00008000)) != 0)) {
        return (((policy_alg) & ((psa_algorithm_t) 0x003f0000)) >> 16) <=
               (((requested_alg) & ((psa_algorithm_t) 0x003f0000)) >> 16);
    }


    if ((((policy_alg) & ((psa_algorithm_t) 0x7f000000)) == ((psa_algorithm_t) 0x03000000)) &&
        (((requested_alg) & ((psa_algorithm_t) 0x7f000000)) == ((psa_algorithm_t) 0x03000000)) &&
        (((policy_alg) & ~(((psa_algorithm_t) 0x003f0000) | ((psa_algorithm_t) 0x00008000))) ==
         ((requested_alg) & ~(((psa_algorithm_t) 0x003f0000) | ((psa_algorithm_t) 0x00008000))))) {


        if (((psa_status_t)0) != psa_mac_key_can_do(policy_alg, key_type)) {
            return 0;
        }






        size_t requested_output_length = ((requested_alg) & ((psa_algorithm_t) 0x003f0000) ? (((requested_alg) & ((psa_algorithm_t) 0x003f0000)) >> 16) : (((requested_alg) & (((psa_algorithm_t) 0x7f000000) | ((psa_algorithm_t) 0x00c00000))) == ((psa_algorithm_t) 0x03800000)) ? ( (((psa_algorithm_t) 0x02000000) | (((((psa_algorithm_t) 0x02000000) | ((requested_alg) & ((psa_algorithm_t) 0x000000ff)))) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000003) ? 16u : (((psa_algorithm_t) 0x02000000) | (((((psa_algorithm_t) 0x02000000) | ((requested_alg) & ((psa_algorithm_t) 0x000000ff)))) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000004) ? 20u : (((psa_algorithm_t) 0x02000000) | (((((psa_algorithm_t) 0x02000000) | ((requested_alg) & ((psa_algorithm_t) 0x000000ff)))) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000005) ? 20u : (((psa_algorithm_t) 0x02000000) | (((((psa_algorithm_t) 0x02000000) | ((requested_alg) & ((psa_algorithm_t) 0x000000ff)))) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000008) ? 28u : (((psa_algorithm_t) 0x02000000) | (((((psa_algorithm_t) 0x02000000) | ((requested_alg) & ((psa_algorithm_t) 0x000000ff)))) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000009) ? 32u : (((psa_algorithm_t) 0x02000000) | (((((psa_algorithm_t) 0x02000000) | ((requested_alg) & ((psa_algorithm_t) 0x000000ff)))) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x0200000a) ? 48u : (((psa_algorithm_t) 0x02000000) | (((((psa_algorithm_t) 0x02000000) | ((requested_alg) & ((psa_algorithm_t) 0x000000ff)))) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x0200000b) ? 64u : (((psa_algorithm_t) 0x02000000) | (((((psa_algorithm_t) 0x02000000) | ((requested_alg) & ((psa_algorithm_t) 0x000000ff)))) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x0200000c) ? 28u : (((psa_algorithm_t) 0x02000000) | (((((psa_algorithm_t) 0x02000000) | ((requested_alg) & ((psa_algorithm_t) 0x000000ff)))) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x0200000d) ? 32u : (((psa_algorithm_t) 0x02000000) | (((((psa_algorithm_t) 0x02000000) | ((requested_alg) & ((psa_algorithm_t) 0x000000ff)))) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000010) ? 28u : (((psa_algorithm_t) 0x02000000) | (((((psa_algorithm_t) 0x02000000) | ((requested_alg) & ((psa_algorithm_t) 0x000000ff)))) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000011) ? 32u : (((psa_algorithm_t) 0x02000000) | (((((psa_algorithm_t) 0x02000000) | ((requested_alg) & ((psa_algorithm_t) 0x000000ff)))) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000012) ? 48u : (((psa_algorithm_t) 0x02000000) | (((((psa_algorithm_t) 0x02000000) | ((requested_alg) & ((psa_algorithm_t) 0x000000ff)))) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000013) ? 64u : 0u) : (((requested_alg) & (((psa_algorithm_t) 0x7f000000) | ((psa_algorithm_t) 0x00c00000))) == ((psa_algorithm_t) 0x03c00000)) ? (((key_type) & ((psa_key_type_t) 0x7000)) == ((psa_key_type_t) 0x2000) ? 1u << (((key_type) >> 8) & 7) : 0u) : ((void) (key_type), (void) (0), 0u))
                                       ;
        size_t default_output_length = ((((requested_alg) & ~(((psa_algorithm_t) 0x003f0000) | ((psa_algorithm_t) 0x00008000)))) & ((psa_algorithm_t) 0x003f0000) ? (((((requested_alg) & ~(((psa_algorithm_t) 0x003f0000) | ((psa_algorithm_t) 0x00008000)))) & ((psa_algorithm_t) 0x003f0000)) >> 16) : (((((requested_alg) & ~(((psa_algorithm_t) 0x003f0000) | ((psa_algorithm_t) 0x00008000)))) & (((psa_algorithm_t) 0x7f000000) | ((psa_algorithm_t) 0x00c00000))) == ((psa_algorithm_t) 0x03800000)) ? ( (((psa_algorithm_t) 0x02000000) | (((((psa_algorithm_t) 0x02000000) | ((((requested_alg) & ~(((psa_algorithm_t) 0x003f0000) | ((psa_algorithm_t) 0x00008000)))) & ((psa_algorithm_t) 0x000000ff)))) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000003) ? 16u : (((psa_algorithm_t) 0x02000000) | (((((psa_algorithm_t) 0x02000000) | ((((requested_alg) & ~(((psa_algorithm_t) 0x003f0000) | ((psa_algorithm_t) 0x00008000)))) & ((psa_algorithm_t) 0x000000ff)))) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000004) ? 20u : (((psa_algorithm_t) 0x02000000) | (((((psa_algorithm_t) 0x02000000) | ((((requested_alg) & ~(((psa_algorithm_t) 0x003f0000) | ((psa_algorithm_t) 0x00008000)))) & ((psa_algorithm_t) 0x000000ff)))) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000005) ? 20u : (((psa_algorithm_t) 0x02000000) | (((((psa_algorithm_t) 0x02000000) | ((((requested_alg) & ~(((psa_algorithm_t) 0x003f0000) | ((psa_algorithm_t) 0x00008000)))) & ((psa_algorithm_t) 0x000000ff)))) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000008) ? 28u : (((psa_algorithm_t) 0x02000000) | (((((psa_algorithm_t) 0x02000000) | ((((requested_alg) & ~(((psa_algorithm_t) 0x003f0000) | ((psa_algorithm_t) 0x00008000)))) & ((psa_algorithm_t) 0x000000ff)))) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000009) ? 32u : (((psa_algorithm_t) 0x02000000) | (((((psa_algorithm_t) 0x02000000) | ((((requested_alg) & ~(((psa_algorithm_t) 0x003f0000) | ((psa_algorithm_t) 0x00008000)))) & ((psa_algorithm_t) 0x000000ff)))) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x0200000a) ? 48u : (((psa_algorithm_t) 0x02000000) | (((((psa_algorithm_t) 0x02000000) | ((((requested_alg) & ~(((psa_algorithm_t) 0x003f0000) | ((psa_algorithm_t) 0x00008000)))) & ((psa_algorithm_t) 0x000000ff)))) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x0200000b) ? 64u : (((psa_algorithm_t) 0x02000000) | (((((psa_algorithm_t) 0x02000000) | ((((requested_alg) & ~(((psa_algorithm_t) 0x003f0000) | ((psa_algorithm_t) 0x00008000)))) & ((psa_algorithm_t) 0x000000ff)))) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x0200000c) ? 28u : (((psa_algorithm_t) 0x02000000) | (((((psa_algorithm_t) 0x02000000) | ((((requested_alg) & ~(((psa_algorithm_t) 0x003f0000) | ((psa_algorithm_t) 0x00008000)))) & ((psa_algorithm_t) 0x000000ff)))) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x0200000d) ? 32u : (((psa_algorithm_t) 0x02000000) | (((((psa_algorithm_t) 0x02000000) | ((((requested_alg) & ~(((psa_algorithm_t) 0x003f0000) | ((psa_algorithm_t) 0x00008000)))) & ((psa_algorithm_t) 0x000000ff)))) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000010) ? 28u : (((psa_algorithm_t) 0x02000000) | (((((psa_algorithm_t) 0x02000000) | ((((requested_alg) & ~(((psa_algorithm_t) 0x003f0000) | ((psa_algorithm_t) 0x00008000)))) & ((psa_algorithm_t) 0x000000ff)))) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000011) ? 32u : (((psa_algorithm_t) 0x02000000) | (((((psa_algorithm_t) 0x02000000) | ((((requested_alg) & ~(((psa_algorithm_t) 0x003f0000) | ((psa_algorithm_t) 0x00008000)))) & ((psa_algorithm_t) 0x000000ff)))) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000012) ? 48u : (((psa_algorithm_t) 0x02000000) | (((((psa_algorithm_t) 0x02000000) | ((((requested_alg) & ~(((psa_algorithm_t) 0x003f0000) | ((psa_algorithm_t) 0x00008000)))) & ((psa_algorithm_t) 0x000000ff)))) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000013) ? 64u : 0u) : (((((requested_alg) & ~(((psa_algorithm_t) 0x003f0000) | ((psa_algorithm_t) 0x00008000)))) & (((psa_algorithm_t) 0x7f000000) | ((psa_algorithm_t) 0x00c00000))) == ((psa_algorithm_t) 0x03c00000)) ? (((key_type) & ((psa_key_type_t) 0x7000)) == ((psa_key_type_t) 0x2000) ? 1u << (((key_type) >> 8) & 7) : 0u) : ((void) (key_type), (void) (0), 0u))

                                                   ;



        if ((((policy_alg) & ((psa_algorithm_t) 0x003f0000)) >> 16) == 0) {
            return requested_output_length == default_output_length;
        }



        if ((((requested_alg) & ((psa_algorithm_t) 0x003f0000)) >> 16) == 0 &&
            (((policy_alg) & ((psa_algorithm_t) 0x003f0000)) >> 16) == default_output_length) {
            return 1;
        }




        if ((policy_alg & ((psa_algorithm_t) 0x00008000)) != 0) {
            return (((policy_alg) & ((psa_algorithm_t) 0x003f0000)) >> 16) <=
                   requested_output_length;
        }
    }



    if (((((policy_alg) & ((psa_algorithm_t) 0x7f000000)) == ((psa_algorithm_t) 0x09000000)) && (((policy_alg) & ((psa_algorithm_t) 0xfe00ffff)) | ((psa_algorithm_t) 0x08000000)) == ((psa_algorithm_t) 0x08000000)) &&
        (((requested_alg) & ((psa_algorithm_t) 0x7f000000)) == ((psa_algorithm_t) 0x09000000))) {
        return (((requested_alg) & ((psa_algorithm_t) 0xffff0000)) | ((psa_algorithm_t) 0x09000000)) ==
               policy_alg;
    }

    return 0;
}
# 1017 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
static psa_status_t psa_key_policy_permits(const psa_key_policy_t *policy,
                                           psa_key_type_t key_type,
                                           psa_algorithm_t alg)
{

    if (alg == 0) {
        return ((psa_status_t)-135);
    }


    if ((((((((alg) & ~((psa_algorithm_t) 0x000000ff)) == ((psa_algorithm_t) 0x06000300)) || (((alg) & ~((psa_algorithm_t) 0x000000ff)) == ((psa_algorithm_t) 0x06001300))) || (((alg) & ~((psa_algorithm_t) 0x000000ff)) == ((psa_algorithm_t) 0x06000200)) || (((alg) & ~((psa_algorithm_t) 0x000000ff) & ~((psa_algorithm_t) 0x00000100)) == ((psa_algorithm_t) 0x06000600)) || (((alg) & ~((psa_algorithm_t) 0x000000ff)) == ((psa_algorithm_t) 0x06000900)) || (((alg) & ~((psa_algorithm_t) 0x000000ff) & ~((psa_algorithm_t) 0x00000100)) == ((psa_algorithm_t) 0x06000400))) && ((alg) & ((psa_algorithm_t) 0x000000ff)) != 0) ? (((((((alg) & ~((psa_algorithm_t) 0x000000ff)) == ((psa_algorithm_t) 0x06000300)) || (((alg) & ~((psa_algorithm_t) 0x000000ff)) == ((psa_algorithm_t) 0x06001300))) || (((alg) & ~((psa_algorithm_t) 0x000000ff)) == ((psa_algorithm_t) 0x06000200)) || (((alg) & ~((psa_algorithm_t) 0x000000ff) & ~((psa_algorithm_t) 0x00000100)) == ((psa_algorithm_t) 0x06000600)) || (((alg) & ~((psa_algorithm_t) 0x000000ff)) == ((psa_algorithm_t) 0x06000900)) || (((alg) & ~((psa_algorithm_t) 0x000000ff) & ~((psa_algorithm_t) 0x00000100)) == ((psa_algorithm_t) 0x06000400))) && ((alg) & ((psa_algorithm_t) 0x000000ff)) != 0) ? ((alg) & ((psa_algorithm_t) 0x000000ff)) | ((psa_algorithm_t) 0x02000000) : 0) == ((psa_algorithm_t) 0x020000ff) : (((alg) & ((psa_algorithm_t) 0x7f000000)) == ((psa_algorithm_t) 0x03000000)) ? (alg & ((psa_algorithm_t) 0x00008000)) != 0 : (((alg) & ((psa_algorithm_t) 0x7f000000)) == ((psa_algorithm_t) 0x05000000)) ? (alg & ((psa_algorithm_t) 0x00008000)) != 0 : (alg) == ((psa_algorithm_t) 0x020000ff))) {
        return ((psa_status_t)-135);
    }

    if (psa_key_algorithm_permits(key_type, policy->alg, alg) ||
        psa_key_algorithm_permits(key_type, policy->alg2, alg)) {
        return ((psa_status_t)0);
    } else {
        return ((psa_status_t)-133);
    }
}
# 1057 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
static psa_status_t psa_restrict_key_policy(
    psa_key_type_t key_type,
    psa_key_policy_t *policy,
    const psa_key_policy_t *constraint)
{
    psa_algorithm_t intersection_alg =
        psa_key_policy_algorithm_intersection(key_type, policy->alg,
                                              constraint->alg);
    psa_algorithm_t intersection_alg2 =
        psa_key_policy_algorithm_intersection(key_type, policy->alg2,
                                              constraint->alg2);
    if (intersection_alg == 0 && policy->alg != 0 && constraint->alg != 0) {
        return ((psa_status_t)-135);
    }
    if (intersection_alg2 == 0 && policy->alg2 != 0 && constraint->alg2 != 0) {
        return ((psa_status_t)-135);
    }
    policy->usage &= constraint->usage;
    policy->alg = intersection_alg;
    policy->alg2 = intersection_alg2;
    return ((psa_status_t)0);
}
# 1099 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
static psa_status_t psa_get_and_lock_key_slot_with_policy(
    mbedtls_svc_key_id_t key,
    psa_key_slot_t **p_slot,
    psa_key_usage_t usage,
    psa_algorithm_t alg)
{
    psa_status_t status = ((psa_status_t)-151);
    psa_key_slot_t *slot = 
# 1106 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
                          ((void *)0)
# 1106 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
                              ;

    status = psa_get_and_lock_key_slot(key, p_slot);
    if (status != ((psa_status_t)0)) {
        return status;
    }
    slot = *p_slot;





    if ((((slot->attr.type) & ((psa_key_type_t) 0x7000)) == ((psa_key_type_t) 0x4000))) {
        usage &= ~((psa_key_usage_t) 0x00000001);
    }

    if ((slot->attr.policy.usage & usage) != usage) {
        status = ((psa_status_t)-133);
        goto error;
    }


    if (alg != 0) {
        status = psa_key_policy_permits(&slot->attr.policy,
                                        slot->attr.type,
                                        alg);
        if (status != ((psa_status_t)0)) {
            goto error;
        }
    }

    return ((psa_status_t)0);

error:
    *p_slot = 
# 1140 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
             ((void *)0)
# 1140 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
                 ;
    psa_unregister_read_under_mutex(slot);

    return status;
}
# 1165 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
static psa_status_t psa_get_and_lock_transparent_key_slot_with_policy(
    mbedtls_svc_key_id_t key,
    psa_key_slot_t **p_slot,
    psa_key_usage_t usage,
    psa_algorithm_t alg)
{
    psa_status_t status = psa_get_and_lock_key_slot_with_policy(key, p_slot,
                                                                usage, alg);
    if (status != ((psa_status_t)0)) {
        return status;
    }

    if (psa_key_lifetime_is_external((*p_slot)->attr.lifetime)) {
        psa_unregister_read_under_mutex(*p_slot);
        *p_slot = 
# 1179 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
                 ((void *)0)
# 1179 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
                     ;
        return ((psa_status_t)-134);
    }

    return ((psa_status_t)0);
}

psa_status_t psa_remove_key_data_from_memory(psa_key_slot_t *slot)
{





    if (slot->key.data != 
# 1193 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
                         ((void *)0)
# 1193 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
                             ) {
        mbedtls_zeroize_and_free(slot->key.data, slot->key.bytes);
    }

    slot->key.data = 
# 1197 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
                    ((void *)0)
# 1197 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
                        ;


    slot->key.bytes = 0;

    return ((psa_status_t)0);
}



psa_status_t psa_wipe_key_slot(psa_key_slot_t *slot)
{
    psa_status_t status = psa_remove_key_data_from_memory(slot);
# 1221 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
    switch (slot->state) {
        case PSA_SLOT_FULL:


        case PSA_SLOT_PENDING_DELETION:


            if (slot->var.occupied.registered_readers != 1) {
                ;
                status = ((psa_status_t)-151);
            }
            break;
        case PSA_SLOT_FILLING:

            if (slot->var.occupied.registered_readers != 0) {
                ;
                status = ((psa_status_t)-151);
            }
            break;
        case PSA_SLOT_EMPTY:

            ;
            status = ((psa_status_t)-151);
            break;
        default:

            status = ((psa_status_t)-151);
    }
# 1264 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
    memset(slot, 0, sizeof(*slot));
# 1276 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
    return status;
}

psa_status_t psa_destroy_key(mbedtls_svc_key_id_t key)
{
    psa_key_slot_t *slot;
    psa_status_t status;
    psa_status_t overall_status = ((psa_status_t)0);




    if (mbedtls_svc_key_id_is_null(key)) {
        return ((psa_status_t)0);
    }
# 1299 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
    status = psa_get_and_lock_key_slot(key, &slot);
    if (status != ((psa_status_t)0)) {
        return status;
    }
# 1331 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
    overall_status = psa_key_slot_state_transition(slot, PSA_SLOT_FULL,
                                                   PSA_SLOT_PENDING_DELETION);

    if (overall_status != ((psa_status_t)0)) {
        goto exit;
    }

    if ((((psa_key_persistence_t) ((slot->attr.lifetime) & 0x000000ff)) == ((psa_key_persistence_t) 0xff))) {





        overall_status = ((psa_status_t)-133);
        goto exit;
    }
# 1407 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
exit:


    status = psa_unregister_read(slot);


    if (status != ((psa_status_t)0)) {
        overall_status = status;
    }
# 1424 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
    return overall_status;
}



psa_status_t psa_get_key_attributes(mbedtls_svc_key_id_t key,
                                    psa_key_attributes_t *attributes)
{
    psa_status_t status = ((psa_status_t)-151);
    psa_key_slot_t *slot;

    psa_reset_key_attributes(attributes);

    status = psa_get_and_lock_key_slot_with_policy(key, &slot, 0, 0);
    if (status != ((psa_status_t)0)) {
        return status;
    }

    *attributes = slot->attr;
# 1451 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
    return psa_unregister_read_under_mutex(slot);
}
# 1468 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
static psa_status_t psa_export_key_buffer_internal(const uint8_t *key_buffer,
                                                   size_t key_buffer_size,
                                                   uint8_t *data,
                                                   size_t data_size,
                                                   size_t *data_length)
{
    if (key_buffer_size > data_size) {
        return ((psa_status_t)-138);
    }
    memcpy(data, key_buffer, key_buffer_size);
    memset(data + key_buffer_size, 0,
           data_size - key_buffer_size);
    *data_length = key_buffer_size;
    return ((psa_status_t)0);
}

psa_status_t psa_export_key_internal(
    const psa_key_attributes_t *attributes,
    const uint8_t *key_buffer, size_t key_buffer_size,
    uint8_t *data, size_t data_size, size_t *data_length)
{
    psa_key_type_t type = attributes->type;

    if (key_type_is_raw_bytes(type) ||
        (((type) & ~((psa_key_type_t) 0x3000)) == ((psa_key_type_t) 0x4001)) ||
        ((((type) & ~((psa_key_type_t) 0x3000)) & ~((psa_key_type_t) 0x00ff)) == ((psa_key_type_t) 0x4100)) ||
        ((((type) & ~((psa_key_type_t) 0x3000)) & ~((psa_key_type_t) 0x00ff)) == ((psa_key_type_t) 0x4200))) {
        return psa_export_key_buffer_internal(
            key_buffer, key_buffer_size,
            data, data_size, data_length);
    } else {



        return ((psa_status_t)-134);
    }
}

psa_status_t psa_export_key(mbedtls_svc_key_id_t key,
                            uint8_t *data_external,
                            size_t data_size,
                            size_t *data_length)
{
    psa_status_t status = ((psa_status_t)-151);
    psa_status_t unlock_status = ((psa_status_t)-151);
    psa_key_slot_t *slot;
    psa_crypto_local_output_t LOCAL_OUTPUT_COPY_OF_data_external = ((psa_crypto_local_output_t) { 
# 1514 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 1514 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   , 
# 1514 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 1514 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   , 0 }); uint8_t *data = 
# 1514 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 1514 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   ;;




    if (data_size == 0) {
        return ((psa_status_t)-138);
    }





    *data_length = 0;





    status = psa_get_and_lock_key_slot_with_policy(key, &slot,
                                                   ((psa_key_usage_t) 0x00000001), 0);
    if (status != ((psa_status_t)0)) {
        return status;
    }

    status = psa_crypto_local_output_alloc(data_external, data_size, &LOCAL_OUTPUT_COPY_OF_data_external); if (status != ((psa_status_t)0)) { goto exit; } data = LOCAL_OUTPUT_COPY_OF_data_external.buffer;;

    status = psa_driver_wrapper_export_key(&slot->attr,
                                           slot->key.data, slot->key.bytes,
                                           data, data_size, data_length);


exit:

    unlock_status = psa_unregister_read_under_mutex(slot);

    data = 
# 1550 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 1550 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   ; do { psa_status_t local_output_status; local_output_status = psa_crypto_local_output_free(&LOCAL_OUTPUT_COPY_OF_data_external); if (local_output_status != ((psa_status_t)0)) { status = local_output_status; } } while (0);
    return (status == ((psa_status_t)0)) ? unlock_status : status;
}

psa_status_t psa_export_public_key_internal(
    const psa_key_attributes_t *attributes,
    const uint8_t *key_buffer,
    size_t key_buffer_size,
    uint8_t *data,
    size_t data_size,
    size_t *data_length)
{
    psa_key_type_t type = attributes->type;

    if ((((type) & ((psa_key_type_t) 0x7000)) == ((psa_key_type_t) 0x4000)) &&
        ((((type) & ~((psa_key_type_t) 0x3000)) == ((psa_key_type_t) 0x4001)) || ((((type) & ~((psa_key_type_t) 0x3000)) & ~((psa_key_type_t) 0x00ff)) == ((psa_key_type_t) 0x4100)) ||
         ((((type) & ~((psa_key_type_t) 0x3000)) & ~((psa_key_type_t) 0x00ff)) == ((psa_key_type_t) 0x4200)))) {

        return psa_export_key_buffer_internal(
            key_buffer, key_buffer_size,
            data, data_size, data_length);
    } else if ((((type) & ~((psa_key_type_t) 0x3000)) == ((psa_key_type_t) 0x4001))) {


        return mbedtls_psa_rsa_export_public_key(attributes,
                                                 key_buffer,
                                                 key_buffer_size,
                                                 data,
                                                 data_size,
                                                 data_length);





    } else if (((((type) & ~((psa_key_type_t) 0x3000)) & ~((psa_key_type_t) 0x00ff)) == ((psa_key_type_t) 0x4100))) {


        return mbedtls_psa_ecp_export_public_key(attributes,
                                                 key_buffer,
                                                 key_buffer_size,
                                                 data,
                                                 data_size,
                                                 data_length);





    } else if (((((type) & ~((psa_key_type_t) 0x3000)) & ~((psa_key_type_t) 0x00ff)) == ((psa_key_type_t) 0x4200))) {


        return mbedtls_psa_ffdh_export_public_key(attributes,
                                                  key_buffer,
                                                  key_buffer_size,
                                                  data, data_size,
                                                  data_length);




    } else {
        (void) key_buffer;
        (void) key_buffer_size;
        (void) data;
        (void) data_size;
        (void) data_length;
        return ((psa_status_t)-134);
    }
}

psa_status_t psa_export_public_key(mbedtls_svc_key_id_t key,
                                   uint8_t *data_external,
                                   size_t data_size,
                                   size_t *data_length)
{
    psa_status_t status = ((psa_status_t)-151);
    psa_status_t unlock_status = ((psa_status_t)-151);
    psa_key_slot_t *slot;

    psa_crypto_local_output_t LOCAL_OUTPUT_COPY_OF_data_external = ((psa_crypto_local_output_t) { 
# 1630 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 1630 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   , 
# 1630 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 1630 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   , 0 }); uint8_t *data = 
# 1630 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 1630 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   ;;




    if (data_size == 0) {
        return ((psa_status_t)-138);
    }





    *data_length = 0;


    status = psa_get_and_lock_key_slot_with_policy(key, &slot, 0, 0);
    if (status != ((psa_status_t)0)) {
        return status;
    }

    status = psa_crypto_local_output_alloc(data_external, data_size, &LOCAL_OUTPUT_COPY_OF_data_external); if (status != ((psa_status_t)0)) { goto exit; } data = LOCAL_OUTPUT_COPY_OF_data_external.buffer;;

    if (!(((slot->attr.type) & ((psa_key_type_t) 0x7000) & ~((psa_key_type_t) 0x3000)) == ((psa_key_type_t) 0x4000))) {
        status = ((psa_status_t)-135);
        goto exit;
    }

    status = psa_driver_wrapper_export_public_key(
        &slot->attr, slot->key.data, slot->key.bytes,
        data, data_size, data_length);

exit:
    unlock_status = psa_unregister_read_under_mutex(slot);

    data = 
# 1665 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 1665 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   ; do { psa_status_t local_output_status; local_output_status = psa_crypto_local_output_free(&LOCAL_OUTPUT_COPY_OF_data_external); if (local_output_status != ((psa_status_t)0)) { status = local_output_status; } } while (0);
    return (status == ((psa_status_t)0)) ? unlock_status : status;
}







static psa_status_t psa_validate_key_policy(const psa_key_policy_t *policy)
{
    if ((policy->usage & ~(((psa_key_usage_t) 0x00000001) |
                           ((psa_key_usage_t) 0x00000002) |
                           ((psa_key_usage_t) 0x00000100) |
                           ((psa_key_usage_t) 0x00000200) |
                           ((psa_key_usage_t) 0x00000400) |
                           ((psa_key_usage_t) 0x00000800) |
                           ((psa_key_usage_t) 0x00001000) |
                           ((psa_key_usage_t) 0x00002000) |
                           ((psa_key_usage_t) 0x00008000) |
                           ((psa_key_usage_t) 0x00004000))) != 0) {
        return ((psa_status_t)-135);
    }

    return ((psa_status_t)0);
}
# 1706 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
static psa_status_t psa_validate_key_attributes(
    const psa_key_attributes_t *attributes,
    psa_se_drv_table_entry_t **p_drv)
{
    psa_status_t status = ((psa_status_t)-135);
    psa_key_lifetime_t lifetime = psa_get_key_lifetime(attributes);
    mbedtls_svc_key_id_t key = psa_get_key_id(attributes);

    status = psa_validate_key_location(lifetime, p_drv);
    if (status != ((psa_status_t)0)) {
        return status;
    }

    status = psa_validate_key_persistence(lifetime);
    if (status != ((psa_status_t)0)) {
        return status;
    }

    if ((((psa_key_persistence_t) ((lifetime) & 0x000000ff)) == ((psa_key_persistence_t) 0x00))) {
        if ((key) != 0) {
            return ((psa_status_t)-135);
        }
    } else {
        if (!psa_is_valid_key_id(psa_get_key_id(attributes), 0)) {
            return ((psa_status_t)-135);
        }
    }

    status = psa_validate_key_policy(&attributes->policy);
    if (status != ((psa_status_t)0)) {
        return status;
    }





    if (psa_get_key_bits(attributes) > 0xfff8) {
        return ((psa_status_t)-134);
    }

    return ((psa_status_t)0);
}
# 1780 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
static psa_status_t psa_start_key_creation(
    psa_key_creation_method_t method,
    const psa_key_attributes_t *attributes,
    psa_key_slot_t **p_slot,
    psa_se_drv_table_entry_t **p_drv)
{
    psa_status_t status;

    (void) method;
    *p_drv = 
# 1789 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
            ((void *)0)
# 1789 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
                ;

    status = psa_validate_key_attributes(attributes, p_drv);
    if (status != ((psa_status_t)0)) {
        return status;
    }

    int key_is_volatile = (((psa_key_persistence_t) ((attributes->lifetime) & 0x000000ff)) == ((psa_key_persistence_t) 0x00));
    psa_key_id_t volatile_key_id;





    status = psa_reserve_free_key_slot(
        key_is_volatile ? &volatile_key_id : 
# 1804 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
                                            ((void *)0)
# 1804 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
                                                ,
        p_slot);




    if (status != ((psa_status_t)0)) {
        return status;
    }
    psa_key_slot_t *slot = *p_slot;
# 1823 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
    slot->attr = *attributes;
    if (key_is_volatile) {

        slot->attr.id = volatile_key_id;



    }
# 1883 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
    return ((psa_status_t)0);
}
# 1916 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
static psa_status_t psa_finish_key_creation(
    psa_key_slot_t *slot,
    psa_se_drv_table_entry_t *driver,
    mbedtls_svc_key_id_t *key)
{
    psa_status_t status = ((psa_status_t)0);
    (void) slot;
    (void) driver;
# 1980 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
    if (status == ((psa_status_t)0)) {
        *key = slot->attr.id;
        status = psa_key_slot_state_transition(slot, PSA_SLOT_FILLING,
                                               PSA_SLOT_FULL);
        if (status != ((psa_status_t)0)) {
            *key = ((psa_key_id_t) 0);
        }
    }





    return status;
}
# 2008 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
static void psa_fail_key_creation(psa_key_slot_t *slot,
                                  psa_se_drv_table_entry_t *driver)
{
    (void) driver;

    if (slot == 
# 2013 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
               ((void *)0)
# 2013 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
                   ) {
        return;
    }
# 2041 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
    psa_wipe_key_slot(slot);




}
# 2057 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
static psa_status_t psa_validate_optional_attributes(
    const psa_key_slot_t *slot,
    const psa_key_attributes_t *attributes)
{
    if (attributes->type != 0) {
        if (attributes->type != slot->attr.type) {
            return ((psa_status_t)-135);
        }
    }

    if (attributes->bits != 0) {
        if (attributes->bits != slot->attr.bits) {
            return ((psa_status_t)-135);
        }
    }

    return ((psa_status_t)0);
}

psa_status_t psa_import_key(const psa_key_attributes_t *attributes,
                            const uint8_t *data_external,
                            size_t data_length,
                            mbedtls_svc_key_id_t *key)
{
    psa_status_t status;
    psa_crypto_local_input_t LOCAL_INPUT_COPY_OF_data_external = ((psa_crypto_local_input_t) { 
# 2082 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 2082 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   , 0 }); const uint8_t *data = 
# 2082 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 2082 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   ;;
    psa_key_slot_t *slot = 
# 2083 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
                          ((void *)0)
# 2083 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
                              ;
    psa_se_drv_table_entry_t *driver = 
# 2084 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
                                      ((void *)0)
# 2084 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
                                          ;
    size_t bits;
    size_t storage_size = data_length;

    *key = ((psa_key_id_t) 0);




    if (data_length == 0) {
        return ((psa_status_t)-135);
    }


    if (data_length > 0xffffffffU 
# 2098 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
                              / 8) {
        return ((psa_status_t)-134);
    }

    status = psa_crypto_local_input_alloc(data_external, data_length, &LOCAL_INPUT_COPY_OF_data_external); if (status != ((psa_status_t)0)) { goto exit; } data = LOCAL_INPUT_COPY_OF_data_external.buffer;;

    status = psa_start_key_creation(PSA_KEY_CREATION_IMPORT, attributes,
                                    &slot, &driver);
    if (status != ((psa_status_t)0)) {
        goto exit;
    }





    if (slot->key.bytes == 0) {
        if (psa_key_lifetime_is_external(attributes->lifetime)) {
            status = psa_driver_wrapper_get_key_buffer_size_from_key_data(
                attributes, data, data_length, &storage_size);
            if (status != ((psa_status_t)0)) {
                goto exit;
            }
        }
        status = psa_allocate_buffer_to_slot(slot, storage_size);
        if (status != ((psa_status_t)0)) {
            goto exit;
        }
    }

    bits = slot->attr.bits;
    status = psa_driver_wrapper_import_key(attributes,
                                           data, data_length,
                                           slot->key.data,
                                           slot->key.bytes,
                                           &slot->key.bytes, &bits);
    if (status != ((psa_status_t)0)) {
        goto exit;
    }

    if (slot->attr.bits == 0) {
        slot->attr.bits = (psa_key_bits_t) bits;
    } else if (bits != slot->attr.bits) {
        status = ((psa_status_t)-135);
        goto exit;
    }



    if (bits > 0xfff8) {
        status = ((psa_status_t)-134);
        goto exit;
    }
    status = psa_validate_optional_attributes(slot, attributes);
    if (status != ((psa_status_t)0)) {
        goto exit;
    }

    status = psa_finish_key_creation(slot, driver, key);
exit:
    data = 
# 2158 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 2158 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   ; psa_crypto_local_input_free(&LOCAL_INPUT_COPY_OF_data_external);;
    if (status != ((psa_status_t)0)) {
        psa_fail_key_creation(slot, driver);
    }

    return status;
}
# 2213 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
psa_status_t psa_copy_key(mbedtls_svc_key_id_t source_key,
                          const psa_key_attributes_t *specified_attributes,
                          mbedtls_svc_key_id_t *target_key)
{
    psa_status_t status = ((psa_status_t)-151);
    psa_status_t unlock_status = ((psa_status_t)-151);
    psa_key_slot_t *source_slot = 
# 2219 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
                                 ((void *)0)
# 2219 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
                                     ;
    psa_key_slot_t *target_slot = 
# 2220 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
                                 ((void *)0)
# 2220 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
                                     ;
    psa_key_attributes_t actual_attributes = *specified_attributes;
    psa_se_drv_table_entry_t *driver = 
# 2222 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
                                      ((void *)0)
# 2222 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
                                          ;
    size_t storage_size = 0;

    *target_key = ((psa_key_id_t) 0);

    status = psa_get_and_lock_key_slot_with_policy(
        source_key, &source_slot, ((psa_key_usage_t) 0x00000002), 0);
    if (status != ((psa_status_t)0)) {
        goto exit;
    }

    status = psa_validate_optional_attributes(source_slot,
                                              specified_attributes);
    if (status != ((psa_status_t)0)) {
        goto exit;
    }






    actual_attributes.bits = source_slot->attr.bits;
    actual_attributes.type = source_slot->attr.type;


    status = psa_restrict_key_policy(source_slot->attr.type,
                                     &actual_attributes.policy,
                                     &source_slot->attr.policy);
    if (status != ((psa_status_t)0)) {
        goto exit;
    }

    status = psa_start_key_creation(PSA_KEY_CREATION_COPY, &actual_attributes,
                                    &target_slot, &driver);
    if (status != ((psa_status_t)0)) {
        goto exit;
    }
    if (((psa_key_location_t) ((target_slot->attr.lifetime) >> 8)) !=
        ((psa_key_location_t) ((source_slot->attr.lifetime) >> 8))) {







        status = ((psa_status_t)-134);
        goto exit;
    }






    if (psa_key_lifetime_is_external(actual_attributes.lifetime)) {
        status = psa_driver_wrapper_get_key_buffer_size(&actual_attributes,
                                                        &storage_size);
        if (status != ((psa_status_t)0)) {
            goto exit;
        }

        status = psa_allocate_buffer_to_slot(target_slot, storage_size);
        if (status != ((psa_status_t)0)) {
            goto exit;
        }

        status = psa_driver_wrapper_copy_key(&actual_attributes,
                                             source_slot->key.data,
                                             source_slot->key.bytes,
                                             target_slot->key.data,
                                             target_slot->key.bytes,
                                             &target_slot->key.bytes);
        if (status != ((psa_status_t)0)) {
            goto exit;
        }
    } else {
        status = psa_copy_key_material_into_slot(target_slot,
                                                 source_slot->key.data,
                                                 source_slot->key.bytes);
        if (status != ((psa_status_t)0)) {
            goto exit;
        }
    }
    status = psa_finish_key_creation(target_slot, driver, target_key);
exit:
    if (status != ((psa_status_t)0)) {
        psa_fail_key_creation(target_slot, driver);
    }

    unlock_status = psa_unregister_read_under_mutex(source_slot);

    return (status == ((psa_status_t)0)) ? unlock_status : status;
}







static int is_hash_supported(psa_algorithm_t alg)
{
    switch (alg) {

        case ((psa_algorithm_t) 0x02000003):
            return 1;


        case ((psa_algorithm_t) 0x02000004):
            return 1;


        case ((psa_algorithm_t) 0x02000005):
            return 1;


        case ((psa_algorithm_t) 0x02000008):
            return 1;


        case ((psa_algorithm_t) 0x02000009):
            return 1;


        case ((psa_algorithm_t) 0x0200000a):
            return 1;


        case ((psa_algorithm_t) 0x0200000b):
            return 1;


        case ((psa_algorithm_t) 0x02000010):
            return 1;


        case ((psa_algorithm_t) 0x02000011):
            return 1;


        case ((psa_algorithm_t) 0x02000012):
            return 1;


        case ((psa_algorithm_t) 0x02000013):
            return 1;

        default:
            return 0;
    }
}

psa_status_t psa_hash_abort(psa_hash_operation_t *operation)
{

    if (operation->id == 0) {
        return ((psa_status_t)0);
    }

    psa_status_t status = psa_driver_wrapper_hash_abort(operation);
    operation->id = 0;

    return status;
}

psa_status_t psa_hash_setup(psa_hash_operation_t *operation,
                            psa_algorithm_t alg)
{
    psa_status_t status = ((psa_status_t)-151);


    if (operation->id != 0) {
        status = ((psa_status_t)-137);
        goto exit;
    }

    if (!(((alg) & ((psa_algorithm_t) 0x7f000000)) == ((psa_algorithm_t) 0x02000000))) {
        status = ((psa_status_t)-135);
        goto exit;
    }






    memset(&operation->ctx, 0, sizeof(operation->ctx));

    status = psa_driver_wrapper_hash_setup(operation, alg);

exit:
    if (status != ((psa_status_t)0)) {
        psa_hash_abort(operation);
    }

    return status;
}

psa_status_t psa_hash_update(psa_hash_operation_t *operation,
                             const uint8_t *input_external,
                             size_t input_length)
{
    psa_status_t status = ((psa_status_t)-151);
    psa_crypto_local_input_t LOCAL_INPUT_COPY_OF_input_external = ((psa_crypto_local_input_t) { 
# 2427 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 2427 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   , 0 }); const uint8_t *input = 
# 2427 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 2427 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   ;;

    if (operation->id == 0) {
        status = ((psa_status_t)-137);
        goto exit;
    }



    if (input_length == 0) {
        return ((psa_status_t)0);
    }

    status = psa_crypto_local_input_alloc(input_external, input_length, &LOCAL_INPUT_COPY_OF_input_external); if (status != ((psa_status_t)0)) { goto exit; } input = LOCAL_INPUT_COPY_OF_input_external.buffer;;
    status = psa_driver_wrapper_hash_update(operation, input, input_length);

exit:
    if (status != ((psa_status_t)0)) {
        psa_hash_abort(operation);
    }

    input = 
# 2448 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 2448 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   ; psa_crypto_local_input_free(&LOCAL_INPUT_COPY_OF_input_external);;
    return status;
}

static psa_status_t psa_hash_finish_internal(psa_hash_operation_t *operation,
                                             uint8_t *hash,
                                             size_t hash_size,
                                             size_t *hash_length)
{
    psa_status_t status = ((psa_status_t)-151);

    *hash_length = 0;
    if (operation->id == 0) {
        return ((psa_status_t)-137);
    }

    status = psa_driver_wrapper_hash_finish(
        operation, hash, hash_size, hash_length);
    psa_hash_abort(operation);

    return status;
}

psa_status_t psa_hash_finish(psa_hash_operation_t *operation,
                             uint8_t *hash_external,
                             size_t hash_size,
                             size_t *hash_length)
{
    psa_status_t status = ((psa_status_t)-151);
    psa_crypto_local_output_t LOCAL_OUTPUT_COPY_OF_hash_external = ((psa_crypto_local_output_t) { 
# 2477 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 2477 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   , 
# 2477 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 2477 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   , 0 }); uint8_t *hash = 
# 2477 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 2477 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   ;;

    status = psa_crypto_local_output_alloc(hash_external, hash_size, &LOCAL_OUTPUT_COPY_OF_hash_external); if (status != ((psa_status_t)0)) { goto exit; } hash = LOCAL_OUTPUT_COPY_OF_hash_external.buffer;;
    status = psa_hash_finish_internal(operation, hash, hash_size, hash_length);


exit:

    hash = 
# 2485 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 2485 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   ; do { psa_status_t local_output_status; local_output_status = psa_crypto_local_output_free(&LOCAL_OUTPUT_COPY_OF_hash_external); if (local_output_status != ((psa_status_t)0)) { status = local_output_status; } } while (0);
    return status;
}

psa_status_t psa_hash_verify(psa_hash_operation_t *operation,
                             const uint8_t *hash_external,
                             size_t hash_length)
{
    uint8_t actual_hash[64u];
    size_t actual_hash_length;
    psa_status_t status = ((psa_status_t)-151);
    psa_crypto_local_input_t LOCAL_INPUT_COPY_OF_hash_external = ((psa_crypto_local_input_t) { 
# 2496 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 2496 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   , 0 }); const uint8_t *hash = 
# 2496 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 2496 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   ;;

    status = psa_hash_finish_internal(
        operation,
        actual_hash, sizeof(actual_hash),
        &actual_hash_length);

    if (status != ((psa_status_t)0)) {
        goto exit;
    }

    if (actual_hash_length != hash_length) {
        status = ((psa_status_t)-149);
        goto exit;
    }

    status = psa_crypto_local_input_alloc(hash_external, hash_length, &LOCAL_INPUT_COPY_OF_hash_external); if (status != ((psa_status_t)0)) { goto exit; } hash = LOCAL_INPUT_COPY_OF_hash_external.buffer;;
    if (mbedtls_ct_memcmp(hash, actual_hash, actual_hash_length) != 0) {
        status = ((psa_status_t)-149);
    }

exit:
    mbedtls_platform_zeroize(actual_hash, sizeof(actual_hash));
    if (status != ((psa_status_t)0)) {
        psa_hash_abort(operation);
    }
    hash = 
# 2522 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 2522 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   ; psa_crypto_local_input_free(&LOCAL_INPUT_COPY_OF_hash_external);;
    return status;
}

psa_status_t psa_hash_compute(psa_algorithm_t alg,
                              const uint8_t *input_external, size_t input_length,
                              uint8_t *hash_external, size_t hash_size,
                              size_t *hash_length)
{
    psa_status_t status = ((psa_status_t)-151);
    psa_crypto_local_input_t LOCAL_INPUT_COPY_OF_input_external = ((psa_crypto_local_input_t) { 
# 2532 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 2532 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   , 0 }); const uint8_t *input = 
# 2532 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 2532 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   ;;
    psa_crypto_local_output_t LOCAL_OUTPUT_COPY_OF_hash_external = ((psa_crypto_local_output_t) { 
# 2533 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 2533 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   , 
# 2533 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 2533 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   , 0 }); uint8_t *hash = 
# 2533 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 2533 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   ;;

    *hash_length = 0;
    if (!(((alg) & ((psa_algorithm_t) 0x7f000000)) == ((psa_algorithm_t) 0x02000000))) {
        return ((psa_status_t)-135);
    }

    status = psa_crypto_local_input_alloc(input_external, input_length, &LOCAL_INPUT_COPY_OF_input_external); if (status != ((psa_status_t)0)) { goto exit; } input = LOCAL_INPUT_COPY_OF_input_external.buffer;;
    status = psa_crypto_local_output_alloc(hash_external, hash_size, &LOCAL_OUTPUT_COPY_OF_hash_external); if (status != ((psa_status_t)0)) { goto exit; } hash = LOCAL_OUTPUT_COPY_OF_hash_external.buffer;;
    status = psa_driver_wrapper_hash_compute(alg, input, input_length,
                                             hash, hash_size, hash_length);


exit:

    input = 
# 2548 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 2548 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   ; psa_crypto_local_input_free(&LOCAL_INPUT_COPY_OF_input_external);;
    hash = 
# 2549 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 2549 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   ; do { psa_status_t local_output_status; local_output_status = psa_crypto_local_output_free(&LOCAL_OUTPUT_COPY_OF_hash_external); if (local_output_status != ((psa_status_t)0)) { status = local_output_status; } } while (0);
    return status;
}

psa_status_t psa_hash_compare(psa_algorithm_t alg,
                              const uint8_t *input_external, size_t input_length,
                              const uint8_t *hash_external, size_t hash_length)
{
    uint8_t actual_hash[64u];
    size_t actual_hash_length;
    psa_status_t status = ((psa_status_t)-151);

    psa_crypto_local_input_t LOCAL_INPUT_COPY_OF_input_external = ((psa_crypto_local_input_t) { 
# 2561 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 2561 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   , 0 }); const uint8_t *input = 
# 2561 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 2561 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   ;;
    psa_crypto_local_input_t LOCAL_INPUT_COPY_OF_hash_external = ((psa_crypto_local_input_t) { 
# 2562 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 2562 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   , 0 }); const uint8_t *hash = 
# 2562 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 2562 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   ;;

    if (!(((alg) & ((psa_algorithm_t) 0x7f000000)) == ((psa_algorithm_t) 0x02000000))) {
        status = ((psa_status_t)-135);
        return status;
    }

    status = psa_crypto_local_input_alloc(input_external, input_length, &LOCAL_INPUT_COPY_OF_input_external); if (status != ((psa_status_t)0)) { goto exit; } input = LOCAL_INPUT_COPY_OF_input_external.buffer;;
    status = psa_driver_wrapper_hash_compute(
        alg, input, input_length,
        actual_hash, sizeof(actual_hash),
        &actual_hash_length);
    if (status != ((psa_status_t)0)) {
        goto exit;
    }
    if (actual_hash_length != hash_length) {
        status = ((psa_status_t)-149);
        goto exit;
    }

    status = psa_crypto_local_input_alloc(hash_external, hash_length, &LOCAL_INPUT_COPY_OF_hash_external); if (status != ((psa_status_t)0)) { goto exit; } hash = LOCAL_INPUT_COPY_OF_hash_external.buffer;;
    if (mbedtls_ct_memcmp(hash, actual_hash, actual_hash_length) != 0) {
        status = ((psa_status_t)-149);
    }

exit:
    mbedtls_platform_zeroize(actual_hash, sizeof(actual_hash));

    input = 
# 2590 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 2590 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   ; psa_crypto_local_input_free(&LOCAL_INPUT_COPY_OF_input_external);;
    hash = 
# 2591 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 2591 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   ; psa_crypto_local_input_free(&LOCAL_INPUT_COPY_OF_hash_external);;

    return status;
}

psa_status_t psa_hash_clone(const psa_hash_operation_t *source_operation,
                            psa_hash_operation_t *target_operation)
{
    if (source_operation->id == 0 ||
        target_operation->id != 0) {
        return ((psa_status_t)-137);
    }






    memset(&target_operation->ctx, 0, sizeof(target_operation->ctx));

    psa_status_t status = psa_driver_wrapper_hash_clone(source_operation,
                                                        target_operation);
    if (status != ((psa_status_t)0)) {
        psa_hash_abort(target_operation);
    }

    return status;
}






psa_status_t psa_mac_abort(psa_mac_operation_t *operation)
{

    if (operation->id == 0) {
        return ((psa_status_t)0);
    }

    psa_status_t status = psa_driver_wrapper_mac_abort(operation);
    operation->mac_size = 0;
    operation->is_sign = 0;
    operation->id = 0;

    return status;
}

static psa_status_t psa_mac_finalize_alg_and_key_validation(
    psa_algorithm_t alg,
    const psa_key_attributes_t *attributes,
    uint8_t *mac_size)
{
    psa_status_t status = ((psa_status_t)-151);
    psa_key_type_t key_type = psa_get_key_type(attributes);
    size_t key_bits = psa_get_key_bits(attributes);

    if (!(((alg) & ((psa_algorithm_t) 0x7f000000)) == ((psa_algorithm_t) 0x03000000))) {
        return ((psa_status_t)-135);
    }


    status = psa_mac_key_can_do(alg, key_type);
    if (status != ((psa_status_t)0)) {
        return status;
    }


    *mac_size = ((alg) & ((psa_algorithm_t) 0x003f0000) ? (((alg) & ((psa_algorithm_t) 0x003f0000)) >> 16) : (((alg) & (((psa_algorithm_t) 0x7f000000) | ((psa_algorithm_t) 0x00c00000))) == ((psa_algorithm_t) 0x03800000)) ? ( (((psa_algorithm_t) 0x02000000) | (((((psa_algorithm_t) 0x02000000) | ((alg) & ((psa_algorithm_t) 0x000000ff)))) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000003) ? 16u : (((psa_algorithm_t) 0x02000000) | (((((psa_algorithm_t) 0x02000000) | ((alg) & ((psa_algorithm_t) 0x000000ff)))) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000004) ? 20u : (((psa_algorithm_t) 0x02000000) | (((((psa_algorithm_t) 0x02000000) | ((alg) & ((psa_algorithm_t) 0x000000ff)))) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000005) ? 20u : (((psa_algorithm_t) 0x02000000) | (((((psa_algorithm_t) 0x02000000) | ((alg) & ((psa_algorithm_t) 0x000000ff)))) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000008) ? 28u : (((psa_algorithm_t) 0x02000000) | (((((psa_algorithm_t) 0x02000000) | ((alg) & ((psa_algorithm_t) 0x000000ff)))) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000009) ? 32u : (((psa_algorithm_t) 0x02000000) | (((((psa_algorithm_t) 0x02000000) | ((alg) & ((psa_algorithm_t) 0x000000ff)))) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x0200000a) ? 48u : (((psa_algorithm_t) 0x02000000) | (((((psa_algorithm_t) 0x02000000) | ((alg) & ((psa_algorithm_t) 0x000000ff)))) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x0200000b) ? 64u : (((psa_algorithm_t) 0x02000000) | (((((psa_algorithm_t) 0x02000000) | ((alg) & ((psa_algorithm_t) 0x000000ff)))) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x0200000c) ? 28u : (((psa_algorithm_t) 0x02000000) | (((((psa_algorithm_t) 0x02000000) | ((alg) & ((psa_algorithm_t) 0x000000ff)))) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x0200000d) ? 32u : (((psa_algorithm_t) 0x02000000) | (((((psa_algorithm_t) 0x02000000) | ((alg) & ((psa_algorithm_t) 0x000000ff)))) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000010) ? 28u : (((psa_algorithm_t) 0x02000000) | (((((psa_algorithm_t) 0x02000000) | ((alg) & ((psa_algorithm_t) 0x000000ff)))) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000011) ? 32u : (((psa_algorithm_t) 0x02000000) | (((((psa_algorithm_t) 0x02000000) | ((alg) & ((psa_algorithm_t) 0x000000ff)))) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000012) ? 48u : (((psa_algorithm_t) 0x02000000) | (((((psa_algorithm_t) 0x02000000) | ((alg) & ((psa_algorithm_t) 0x000000ff)))) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000013) ? 64u : 0u) : (((alg) & (((psa_algorithm_t) 0x7f000000) | ((psa_algorithm_t) 0x00c00000))) == ((psa_algorithm_t) 0x03c00000)) ? (((key_type) & ((psa_key_type_t) 0x7000)) == ((psa_key_type_t) 0x2000) ? 1u << (((key_type) >> 8) & 7) : 0u) : ((void) (key_type), (void) (key_bits), 0u));

    if (*mac_size < 4) {




        return ((psa_status_t)-134);
    }

    if (*mac_size > ((((alg) & ~(((psa_algorithm_t) 0x003f0000) | ((psa_algorithm_t) 0x00008000)))) & ((psa_algorithm_t) 0x003f0000) ? (((((alg) & ~(((psa_algorithm_t) 0x003f0000) | ((psa_algorithm_t) 0x00008000)))) & ((psa_algorithm_t) 0x003f0000)) >> 16) : (((((alg) & ~(((psa_algorithm_t) 0x003f0000) | ((psa_algorithm_t) 0x00008000)))) & (((psa_algorithm_t) 0x7f000000) | ((psa_algorithm_t) 0x00c00000))) == ((psa_algorithm_t) 0x03800000)) ? ( (((psa_algorithm_t) 0x02000000) | (((((psa_algorithm_t) 0x02000000) | ((((alg) & ~(((psa_algorithm_t) 0x003f0000) | ((psa_algorithm_t) 0x00008000)))) & ((psa_algorithm_t) 0x000000ff)))) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000003) ? 16u : (((psa_algorithm_t) 0x02000000) | (((((psa_algorithm_t) 0x02000000) | ((((alg) & ~(((psa_algorithm_t) 0x003f0000) | ((psa_algorithm_t) 0x00008000)))) & ((psa_algorithm_t) 0x000000ff)))) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000004) ? 20u : (((psa_algorithm_t) 0x02000000) | (((((psa_algorithm_t) 0x02000000) | ((((alg) & ~(((psa_algorithm_t) 0x003f0000) | ((psa_algorithm_t) 0x00008000)))) & ((psa_algorithm_t) 0x000000ff)))) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000005) ? 20u : (((psa_algorithm_t) 0x02000000) | (((((psa_algorithm_t) 0x02000000) | ((((alg) & ~(((psa_algorithm_t) 0x003f0000) | ((psa_algorithm_t) 0x00008000)))) & ((psa_algorithm_t) 0x000000ff)))) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000008) ? 28u : (((psa_algorithm_t) 0x02000000) | (((((psa_algorithm_t) 0x02000000) | ((((alg) & ~(((psa_algorithm_t) 0x003f0000) | ((psa_algorithm_t) 0x00008000)))) & ((psa_algorithm_t) 0x000000ff)))) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000009) ? 32u : (((psa_algorithm_t) 0x02000000) | (((((psa_algorithm_t) 0x02000000) | ((((alg) & ~(((psa_algorithm_t) 0x003f0000) | ((psa_algorithm_t) 0x00008000)))) & ((psa_algorithm_t) 0x000000ff)))) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x0200000a) ? 48u : (((psa_algorithm_t) 0x02000000) | (((((psa_algorithm_t) 0x02000000) | ((((alg) & ~(((psa_algorithm_t) 0x003f0000) | ((psa_algorithm_t) 0x00008000)))) & ((psa_algorithm_t) 0x000000ff)))) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x0200000b) ? 64u : (((psa_algorithm_t) 0x02000000) | (((((psa_algorithm_t) 0x02000000) | ((((alg) & ~(((psa_algorithm_t) 0x003f0000) | ((psa_algorithm_t) 0x00008000)))) & ((psa_algorithm_t) 0x000000ff)))) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x0200000c) ? 28u : (((psa_algorithm_t) 0x02000000) | (((((psa_algorithm_t) 0x02000000) | ((((alg) & ~(((psa_algorithm_t) 0x003f0000) | ((psa_algorithm_t) 0x00008000)))) & ((psa_algorithm_t) 0x000000ff)))) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x0200000d) ? 32u : (((psa_algorithm_t) 0x02000000) | (((((psa_algorithm_t) 0x02000000) | ((((alg) & ~(((psa_algorithm_t) 0x003f0000) | ((psa_algorithm_t) 0x00008000)))) & ((psa_algorithm_t) 0x000000ff)))) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000010) ? 28u : (((psa_algorithm_t) 0x02000000) | (((((psa_algorithm_t) 0x02000000) | ((((alg) & ~(((psa_algorithm_t) 0x003f0000) | ((psa_algorithm_t) 0x00008000)))) & ((psa_algorithm_t) 0x000000ff)))) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000011) ? 32u : (((psa_algorithm_t) 0x02000000) | (((((psa_algorithm_t) 0x02000000) | ((((alg) & ~(((psa_algorithm_t) 0x003f0000) | ((psa_algorithm_t) 0x00008000)))) & ((psa_algorithm_t) 0x000000ff)))) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000012) ? 48u : (((psa_algorithm_t) 0x02000000) | (((((psa_algorithm_t) 0x02000000) | ((((alg) & ~(((psa_algorithm_t) 0x003f0000) | ((psa_algorithm_t) 0x00008000)))) & ((psa_algorithm_t) 0x000000ff)))) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000013) ? 64u : 0u) : (((((alg) & ~(((psa_algorithm_t) 0x003f0000) | ((psa_algorithm_t) 0x00008000)))) & (((psa_algorithm_t) 0x7f000000) | ((psa_algorithm_t) 0x00c00000))) == ((psa_algorithm_t) 0x03c00000)) ? (((key_type) & ((psa_key_type_t) 0x7000)) == ((psa_key_type_t) 0x2000) ? 1u << (((key_type) >> 8) & 7) : 0u) : ((void) (key_type), (void) (key_bits), 0u))
                                                                ) {


        return ((psa_status_t)-135);
    }

    if (*mac_size > 64u) {
# 2687 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
        return ((psa_status_t)-134);
    }

    return ((psa_status_t)0);
}

static psa_status_t psa_mac_setup(psa_mac_operation_t *operation,
                                  mbedtls_svc_key_id_t key,
                                  psa_algorithm_t alg,
                                  int is_sign)
{
    psa_status_t status = ((psa_status_t)-151);
    psa_status_t unlock_status = ((psa_status_t)-151);
    psa_key_slot_t *slot = 
# 2700 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
                          ((void *)0)
# 2700 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
                              ;


    if (operation->id != 0) {
        status = ((psa_status_t)-137);
        goto exit;
    }






    memset(&operation->ctx, 0, sizeof(operation->ctx));

    status = psa_get_and_lock_key_slot_with_policy(
        key,
        &slot,
        is_sign ? ((psa_key_usage_t) 0x00000400) : ((psa_key_usage_t) 0x00000800),
        alg);
    if (status != ((psa_status_t)0)) {
        goto exit;
    }

    status = psa_mac_finalize_alg_and_key_validation(alg, &slot->attr,
                                                     &operation->mac_size);
    if (status != ((psa_status_t)0)) {
        goto exit;
    }

    operation->is_sign = is_sign;

    if (is_sign) {
        status = psa_driver_wrapper_mac_sign_setup(operation,
                                                   &slot->attr,
                                                   slot->key.data,
                                                   slot->key.bytes,
                                                   alg);
    } else {
        status = psa_driver_wrapper_mac_verify_setup(operation,
                                                     &slot->attr,
                                                     slot->key.data,
                                                     slot->key.bytes,
                                                     alg);
    }

exit:
    if (status != ((psa_status_t)0)) {
        psa_mac_abort(operation);
    }

    unlock_status = psa_unregister_read_under_mutex(slot);

    return (status == ((psa_status_t)0)) ? unlock_status : status;
}

psa_status_t psa_mac_sign_setup(psa_mac_operation_t *operation,
                                mbedtls_svc_key_id_t key,
                                psa_algorithm_t alg)
{
    return psa_mac_setup(operation, key, alg, 1);
}

psa_status_t psa_mac_verify_setup(psa_mac_operation_t *operation,
                                  mbedtls_svc_key_id_t key,
                                  psa_algorithm_t alg)
{
    return psa_mac_setup(operation, key, alg, 0);
}

psa_status_t psa_mac_update(psa_mac_operation_t *operation,
                            const uint8_t *input_external,
                            size_t input_length)
{
    psa_status_t status = ((psa_status_t)-151);
    psa_crypto_local_input_t LOCAL_INPUT_COPY_OF_input_external = ((psa_crypto_local_input_t) { 
# 2775 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 2775 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   , 0 }); const uint8_t *input = 
# 2775 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 2775 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   ;;

    if (operation->id == 0) {
        status = ((psa_status_t)-137);
        return status;
    }



    if (input_length == 0) {
        status = ((psa_status_t)0);
        return status;
    }

    status = psa_crypto_local_input_alloc(input_external, input_length, &LOCAL_INPUT_COPY_OF_input_external); if (status != ((psa_status_t)0)) { goto exit; } input = LOCAL_INPUT_COPY_OF_input_external.buffer;;
    status = psa_driver_wrapper_mac_update(operation, input, input_length);

    if (status != ((psa_status_t)0)) {
        psa_mac_abort(operation);
    }


exit:

    input = 
# 2799 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 2799 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   ; psa_crypto_local_input_free(&LOCAL_INPUT_COPY_OF_input_external);;

    return status;
}

psa_status_t psa_mac_sign_finish(psa_mac_operation_t *operation,
                                 uint8_t *mac_external,
                                 size_t mac_size,
                                 size_t *mac_length)
{
    psa_status_t status = ((psa_status_t)-151);
    psa_status_t abort_status = ((psa_status_t)-151);
    psa_crypto_local_output_t LOCAL_OUTPUT_COPY_OF_mac_external = ((psa_crypto_local_output_t) { 
# 2811 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 2811 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   , 
# 2811 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 2811 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   , 0 }); uint8_t *mac = 
# 2811 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 2811 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   ;;
    status = psa_crypto_local_output_alloc(mac_external, mac_size, &LOCAL_OUTPUT_COPY_OF_mac_external); if (status != ((psa_status_t)0)) { goto exit; } mac = LOCAL_OUTPUT_COPY_OF_mac_external.buffer;;

    if (operation->id == 0) {
        status = ((psa_status_t)-137);
        goto exit;
    }

    if (!operation->is_sign) {
        status = ((psa_status_t)-137);
        goto exit;
    }



    if (operation->mac_size == 0) {
        status = ((psa_status_t)-137);
        goto exit;
    }

    if (mac_size < operation->mac_size) {
        status = ((psa_status_t)-138);
        goto exit;
    }


    status = psa_driver_wrapper_mac_sign_finish(operation,
                                                mac, operation->mac_size,
                                                mac_length);

exit:






    if (status != ((psa_status_t)0)) {
        *mac_length = mac_size;
        operation->mac_size = 0;
    }

    if (mac != 
# 2853 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
              ((void *)0)
# 2853 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
                  ) {
        psa_wipe_tag_output_buffer(mac, status, mac_size, *mac_length);
    }

    abort_status = psa_mac_abort(operation);
    mac = 
# 2858 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 2858 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   ; do { psa_status_t local_output_status; local_output_status = psa_crypto_local_output_free(&LOCAL_OUTPUT_COPY_OF_mac_external); if (local_output_status != ((psa_status_t)0)) { status = local_output_status; } } while (0);

    return status == ((psa_status_t)0) ? abort_status : status;
}

psa_status_t psa_mac_verify_finish(psa_mac_operation_t *operation,
                                   const uint8_t *mac_external,
                                   size_t mac_length)
{
    psa_status_t status = ((psa_status_t)-151);
    psa_status_t abort_status = ((psa_status_t)-151);
    psa_crypto_local_input_t LOCAL_INPUT_COPY_OF_mac_external = ((psa_crypto_local_input_t) { 
# 2869 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 2869 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   , 0 }); const uint8_t *mac = 
# 2869 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 2869 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   ;;

    if (operation->id == 0) {
        status = ((psa_status_t)-137);
        goto exit;
    }

    if (operation->is_sign) {
        status = ((psa_status_t)-137);
        goto exit;
    }

    if (operation->mac_size != mac_length) {
        status = ((psa_status_t)-149);
        goto exit;
    }

    status = psa_crypto_local_input_alloc(mac_external, mac_length, &LOCAL_INPUT_COPY_OF_mac_external); if (status != ((psa_status_t)0)) { goto exit; } mac = LOCAL_INPUT_COPY_OF_mac_external.buffer;;
    status = psa_driver_wrapper_mac_verify_finish(operation,
                                                  mac, mac_length);

exit:
    abort_status = psa_mac_abort(operation);
    mac = 
# 2892 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 2892 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   ; psa_crypto_local_input_free(&LOCAL_INPUT_COPY_OF_mac_external);;

    return status == ((psa_status_t)0) ? abort_status : status;
}

static psa_status_t psa_mac_compute_internal(mbedtls_svc_key_id_t key,
                                             psa_algorithm_t alg,
                                             const uint8_t *input,
                                             size_t input_length,
                                             uint8_t *mac,
                                             size_t mac_size,
                                             size_t *mac_length,
                                             int is_sign)
{
    psa_status_t status = ((psa_status_t)-151);
    psa_status_t unlock_status = ((psa_status_t)-151);
    psa_key_slot_t *slot;
    uint8_t operation_mac_size = 0;

    status = psa_get_and_lock_key_slot_with_policy(
        key,
        &slot,
        is_sign ? ((psa_key_usage_t) 0x00000400) : ((psa_key_usage_t) 0x00000800),
        alg);
    if (status != ((psa_status_t)0)) {
        goto exit;
    }

    status = psa_mac_finalize_alg_and_key_validation(alg, &slot->attr,
                                                     &operation_mac_size);
    if (status != ((psa_status_t)0)) {
        goto exit;
    }

    if (mac_size < operation_mac_size) {
        status = ((psa_status_t)-138);
        goto exit;
    }

    status = psa_driver_wrapper_mac_compute(
        &slot->attr,
        slot->key.data, slot->key.bytes,
        alg,
        input, input_length,
        mac, operation_mac_size, mac_length);

exit:






    if (status != ((psa_status_t)0)) {
        *mac_length = mac_size;
        operation_mac_size = 0;
    }

    psa_wipe_tag_output_buffer(mac, status, mac_size, *mac_length);

    unlock_status = psa_unregister_read_under_mutex(slot);

    return (status == ((psa_status_t)0)) ? unlock_status : status;
}

psa_status_t psa_mac_compute(mbedtls_svc_key_id_t key,
                             psa_algorithm_t alg,
                             const uint8_t *input_external,
                             size_t input_length,
                             uint8_t *mac_external,
                             size_t mac_size,
                             size_t *mac_length)
{
    psa_status_t status = ((psa_status_t)-151);
    psa_crypto_local_input_t LOCAL_INPUT_COPY_OF_input_external = ((psa_crypto_local_input_t) { 
# 2966 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 2966 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   , 0 }); const uint8_t *input = 
# 2966 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 2966 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   ;;
    psa_crypto_local_output_t LOCAL_OUTPUT_COPY_OF_mac_external = ((psa_crypto_local_output_t) { 
# 2967 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 2967 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   , 
# 2967 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 2967 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   , 0 }); uint8_t *mac = 
# 2967 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 2967 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   ;;

    status = psa_crypto_local_input_alloc(input_external, input_length, &LOCAL_INPUT_COPY_OF_input_external); if (status != ((psa_status_t)0)) { goto exit; } input = LOCAL_INPUT_COPY_OF_input_external.buffer;;
    status = psa_crypto_local_output_alloc(mac_external, mac_size, &LOCAL_OUTPUT_COPY_OF_mac_external); if (status != ((psa_status_t)0)) { goto exit; } mac = LOCAL_OUTPUT_COPY_OF_mac_external.buffer;;
    status = psa_mac_compute_internal(key, alg,
                                      input, input_length,
                                      mac, mac_size, mac_length, 1);


exit:

    input = 
# 2978 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 2978 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   ; psa_crypto_local_input_free(&LOCAL_INPUT_COPY_OF_input_external);;
    mac = 
# 2979 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 2979 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   ; do { psa_status_t local_output_status; local_output_status = psa_crypto_local_output_free(&LOCAL_OUTPUT_COPY_OF_mac_external); if (local_output_status != ((psa_status_t)0)) { status = local_output_status; } } while (0);

    return status;
}

psa_status_t psa_mac_verify(mbedtls_svc_key_id_t key,
                            psa_algorithm_t alg,
                            const uint8_t *input_external,
                            size_t input_length,
                            const uint8_t *mac_external,
                            size_t mac_length)
{
    psa_status_t status = ((psa_status_t)-151);
    uint8_t actual_mac[64u];
    size_t actual_mac_length;
    psa_crypto_local_input_t LOCAL_INPUT_COPY_OF_input_external = ((psa_crypto_local_input_t) { 
# 2994 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 2994 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   , 0 }); const uint8_t *input = 
# 2994 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 2994 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   ;;
    psa_crypto_local_input_t LOCAL_INPUT_COPY_OF_mac_external = ((psa_crypto_local_input_t) { 
# 2995 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 2995 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   , 0 }); const uint8_t *mac = 
# 2995 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 2995 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   ;;

    status = psa_crypto_local_input_alloc(input_external, input_length, &LOCAL_INPUT_COPY_OF_input_external); if (status != ((psa_status_t)0)) { goto exit; } input = LOCAL_INPUT_COPY_OF_input_external.buffer;;
    status = psa_mac_compute_internal(key, alg,
                                      input, input_length,
                                      actual_mac, sizeof(actual_mac),
                                      &actual_mac_length, 0);
    if (status != ((psa_status_t)0)) {
        goto exit;
    }

    if (mac_length != actual_mac_length) {
        status = ((psa_status_t)-149);
        goto exit;
    }

    status = psa_crypto_local_input_alloc(mac_external, mac_length, &LOCAL_INPUT_COPY_OF_mac_external); if (status != ((psa_status_t)0)) { goto exit; } mac = LOCAL_INPUT_COPY_OF_mac_external.buffer;;
    if (mbedtls_ct_memcmp(mac, actual_mac, actual_mac_length) != 0) {
        status = ((psa_status_t)-149);
        goto exit;
    }

exit:
    mbedtls_platform_zeroize(actual_mac, sizeof(actual_mac));
    input = 
# 3019 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 3019 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   ; psa_crypto_local_input_free(&LOCAL_INPUT_COPY_OF_input_external);;
    mac = 
# 3020 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 3020 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   ; psa_crypto_local_input_free(&LOCAL_INPUT_COPY_OF_mac_external);;

    return status;
}





static psa_status_t psa_sign_verify_check_alg(int input_is_message,
                                              psa_algorithm_t alg)
{
    if (input_is_message) {
        if (!((((((alg) & ~((psa_algorithm_t) 0x000000ff)) == ((psa_algorithm_t) 0x06000300)) || (((alg) & ~((psa_algorithm_t) 0x000000ff)) == ((psa_algorithm_t) 0x06001300))) || (((alg) & ~((psa_algorithm_t) 0x000000ff)) == ((psa_algorithm_t) 0x06000200)) || (((alg) & ~((psa_algorithm_t) 0x000000ff) & ~((psa_algorithm_t) 0x00000100)) == ((psa_algorithm_t) 0x06000600)) || (((alg) & ~((psa_algorithm_t) 0x000000ff)) == ((psa_algorithm_t) 0x06000900)) || (((alg) & ~((psa_algorithm_t) 0x000000ff) & ~((psa_algorithm_t) 0x00000100)) == ((psa_algorithm_t) 0x06000400))) || (alg) == ((psa_algorithm_t) 0x06000800))) {
            return ((psa_status_t)-135);
        }
    }

    psa_algorithm_t hash_alg = 0;
    if ((((((alg) & ~((psa_algorithm_t) 0x000000ff)) == ((psa_algorithm_t) 0x06000300)) || (((alg) & ~((psa_algorithm_t) 0x000000ff)) == ((psa_algorithm_t) 0x06001300))) || (((alg) & ~((psa_algorithm_t) 0x000000ff)) == ((psa_algorithm_t) 0x06000200)) || (((alg) & ~((psa_algorithm_t) 0x000000ff) & ~((psa_algorithm_t) 0x00000100)) == ((psa_algorithm_t) 0x06000600)) || (((alg) & ~((psa_algorithm_t) 0x000000ff)) == ((psa_algorithm_t) 0x06000900)) || (((alg) & ~((psa_algorithm_t) 0x000000ff) & ~((psa_algorithm_t) 0x00000100)) == ((psa_algorithm_t) 0x06000400)))) {
        hash_alg = (((((((alg) & ~((psa_algorithm_t) 0x000000ff)) == ((psa_algorithm_t) 0x06000300)) || (((alg) & ~((psa_algorithm_t) 0x000000ff)) == ((psa_algorithm_t) 0x06001300))) || (((alg) & ~((psa_algorithm_t) 0x000000ff)) == ((psa_algorithm_t) 0x06000200)) || (((alg) & ~((psa_algorithm_t) 0x000000ff) & ~((psa_algorithm_t) 0x00000100)) == ((psa_algorithm_t) 0x06000600)) || (((alg) & ~((psa_algorithm_t) 0x000000ff)) == ((psa_algorithm_t) 0x06000900)) || (((alg) & ~((psa_algorithm_t) 0x000000ff) & ~((psa_algorithm_t) 0x00000100)) == ((psa_algorithm_t) 0x06000400))) && ((alg) & ((psa_algorithm_t) 0x000000ff)) != 0) ? ((alg) & ((psa_algorithm_t) 0x000000ff)) | ((psa_algorithm_t) 0x02000000) : 0);
    }






    if (hash_alg == 0 && input_is_message) {
        return ((psa_status_t)-135);
    }
    if (hash_alg == ((psa_algorithm_t) 0x020000ff)) {
        return ((psa_status_t)-135);
    }
# 3072 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
    if (hash_alg != 0 && !is_hash_supported(hash_alg)) {
        return ((psa_status_t)-134);
    }

    return ((psa_status_t)0);
}

static psa_status_t psa_sign_internal(mbedtls_svc_key_id_t key,
                                      int input_is_message,
                                      psa_algorithm_t alg,
                                      const uint8_t *input,
                                      size_t input_length,
                                      uint8_t *signature,
                                      size_t signature_size,
                                      size_t *signature_length)
{
    psa_status_t status = ((psa_status_t)-151);
    psa_status_t unlock_status = ((psa_status_t)-151);
    psa_key_slot_t *slot;

    *signature_length = 0;

    status = psa_sign_verify_check_alg(input_is_message, alg);
    if (status != ((psa_status_t)0)) {
        return status;
    }





    if (signature_size == 0) {
        return ((psa_status_t)-138);
    }

    status = psa_get_and_lock_key_slot_with_policy(
        key, &slot,
        input_is_message ? ((psa_key_usage_t) 0x00000400) :
        ((psa_key_usage_t) 0x00001000),
        alg);

    if (status != ((psa_status_t)0)) {
        goto exit;
    }

    if (!(((slot->attr.type) & ((psa_key_type_t) 0x7000)) == ((psa_key_type_t) 0x7000))) {
        status = ((psa_status_t)-135);
        goto exit;
    }

    if (input_is_message) {
        status = psa_driver_wrapper_sign_message(
            &slot->attr, slot->key.data, slot->key.bytes,
            alg, input, input_length,
            signature, signature_size, signature_length);
    } else {

        status = psa_driver_wrapper_sign_hash(
            &slot->attr, slot->key.data, slot->key.bytes,
            alg, input, input_length,
            signature, signature_size, signature_length);
    }


exit:
    psa_wipe_tag_output_buffer(signature, status, signature_size,
                               *signature_length);

    unlock_status = psa_unregister_read_under_mutex(slot);

    return (status == ((psa_status_t)0)) ? unlock_status : status;
}

static psa_status_t psa_verify_internal(mbedtls_svc_key_id_t key,
                                        int input_is_message,
                                        psa_algorithm_t alg,
                                        const uint8_t *input,
                                        size_t input_length,
                                        const uint8_t *signature,
                                        size_t signature_length)
{
    psa_status_t status = ((psa_status_t)-151);
    psa_status_t unlock_status = ((psa_status_t)-151);
    psa_key_slot_t *slot;

    status = psa_sign_verify_check_alg(input_is_message, alg);
    if (status != ((psa_status_t)0)) {
        return status;
    }

    status = psa_get_and_lock_key_slot_with_policy(
        key, &slot,
        input_is_message ? ((psa_key_usage_t) 0x00000800) :
        ((psa_key_usage_t) 0x00002000),
        alg);

    if (status != ((psa_status_t)0)) {
        return status;
    }

    if (input_is_message) {
        status = psa_driver_wrapper_verify_message(
            &slot->attr, slot->key.data, slot->key.bytes,
            alg, input, input_length,
            signature, signature_length);
    } else {
        status = psa_driver_wrapper_verify_hash(
            &slot->attr, slot->key.data, slot->key.bytes,
            alg, input, input_length,
            signature, signature_length);
    }

    unlock_status = psa_unregister_read_under_mutex(slot);

    return (status == ((psa_status_t)0)) ? unlock_status : status;

}

psa_status_t psa_sign_message_builtin(
    const psa_key_attributes_t *attributes,
    const uint8_t *key_buffer,
    size_t key_buffer_size,
    psa_algorithm_t alg,
    const uint8_t *input,
    size_t input_length,
    uint8_t *signature,
    size_t signature_size,
    size_t *signature_length)
{
    psa_status_t status = ((psa_status_t)-151);

    if ((((((alg) & ~((psa_algorithm_t) 0x000000ff)) == ((psa_algorithm_t) 0x06000300)) || (((alg) & ~((psa_algorithm_t) 0x000000ff)) == ((psa_algorithm_t) 0x06001300))) || (((alg) & ~((psa_algorithm_t) 0x000000ff)) == ((psa_algorithm_t) 0x06000200)) || (((alg) & ~((psa_algorithm_t) 0x000000ff) & ~((psa_algorithm_t) 0x00000100)) == ((psa_algorithm_t) 0x06000600)) || (((alg) & ~((psa_algorithm_t) 0x000000ff)) == ((psa_algorithm_t) 0x06000900)) || (((alg) & ~((psa_algorithm_t) 0x000000ff) & ~((psa_algorithm_t) 0x00000100)) == ((psa_algorithm_t) 0x06000400)))) {
        size_t hash_length;
        uint8_t hash[64u];

        status = psa_driver_wrapper_hash_compute(
            (((((((alg) & ~((psa_algorithm_t) 0x000000ff)) == ((psa_algorithm_t) 0x06000300)) || (((alg) & ~((psa_algorithm_t) 0x000000ff)) == ((psa_algorithm_t) 0x06001300))) || (((alg) & ~((psa_algorithm_t) 0x000000ff)) == ((psa_algorithm_t) 0x06000200)) || (((alg) & ~((psa_algorithm_t) 0x000000ff) & ~((psa_algorithm_t) 0x00000100)) == ((psa_algorithm_t) 0x06000600)) || (((alg) & ~((psa_algorithm_t) 0x000000ff)) == ((psa_algorithm_t) 0x06000900)) || (((alg) & ~((psa_algorithm_t) 0x000000ff) & ~((psa_algorithm_t) 0x00000100)) == ((psa_algorithm_t) 0x06000400))) && ((alg) & ((psa_algorithm_t) 0x000000ff)) != 0) ? ((alg) & ((psa_algorithm_t) 0x000000ff)) | ((psa_algorithm_t) 0x02000000) : 0),
            input, input_length,
            hash, sizeof(hash), &hash_length);

        if (status != ((psa_status_t)0)) {
            return status;
        }

        return psa_driver_wrapper_sign_hash(
            attributes, key_buffer, key_buffer_size,
            alg, hash, hash_length,
            signature, signature_size, signature_length);
    }

    return ((psa_status_t)-134);
}

psa_status_t psa_sign_message(mbedtls_svc_key_id_t key,
                              psa_algorithm_t alg,
                              const uint8_t *input_external,
                              size_t input_length,
                              uint8_t *signature_external,
                              size_t signature_size,
                              size_t *signature_length)
{
    psa_status_t status = ((psa_status_t)-151);
    psa_crypto_local_input_t LOCAL_INPUT_COPY_OF_input_external = ((psa_crypto_local_input_t) { 
# 3234 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 3234 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   , 0 }); const uint8_t *input = 
# 3234 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 3234 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   ;;
    psa_crypto_local_output_t LOCAL_OUTPUT_COPY_OF_signature_external = ((psa_crypto_local_output_t) { 
# 3235 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 3235 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   , 
# 3235 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 3235 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   , 0 }); uint8_t *signature = 
# 3235 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 3235 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   ;;

    status = psa_crypto_local_input_alloc(input_external, input_length, &LOCAL_INPUT_COPY_OF_input_external); if (status != ((psa_status_t)0)) { goto exit; } input = LOCAL_INPUT_COPY_OF_input_external.buffer;;
    status = psa_crypto_local_output_alloc(signature_external, signature_size, &LOCAL_OUTPUT_COPY_OF_signature_external); if (status != ((psa_status_t)0)) { goto exit; } signature = LOCAL_OUTPUT_COPY_OF_signature_external.buffer;;
    status = psa_sign_internal(key, 1, alg, input, input_length, signature,
                               signature_size, signature_length);


exit:

    input = 
# 3245 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 3245 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   ; psa_crypto_local_input_free(&LOCAL_INPUT_COPY_OF_input_external);;
    signature = 
# 3246 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 3246 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   ; do { psa_status_t local_output_status; local_output_status = psa_crypto_local_output_free(&LOCAL_OUTPUT_COPY_OF_signature_external); if (local_output_status != ((psa_status_t)0)) { status = local_output_status; } } while (0);
    return status;
}

psa_status_t psa_verify_message_builtin(
    const psa_key_attributes_t *attributes,
    const uint8_t *key_buffer,
    size_t key_buffer_size,
    psa_algorithm_t alg,
    const uint8_t *input,
    size_t input_length,
    const uint8_t *signature,
    size_t signature_length)
{
    psa_status_t status = ((psa_status_t)-151);

    if ((((((alg) & ~((psa_algorithm_t) 0x000000ff)) == ((psa_algorithm_t) 0x06000300)) || (((alg) & ~((psa_algorithm_t) 0x000000ff)) == ((psa_algorithm_t) 0x06001300))) || (((alg) & ~((psa_algorithm_t) 0x000000ff)) == ((psa_algorithm_t) 0x06000200)) || (((alg) & ~((psa_algorithm_t) 0x000000ff) & ~((psa_algorithm_t) 0x00000100)) == ((psa_algorithm_t) 0x06000600)) || (((alg) & ~((psa_algorithm_t) 0x000000ff)) == ((psa_algorithm_t) 0x06000900)) || (((alg) & ~((psa_algorithm_t) 0x000000ff) & ~((psa_algorithm_t) 0x00000100)) == ((psa_algorithm_t) 0x06000400)))) {
        size_t hash_length;
        uint8_t hash[64u];

        status = psa_driver_wrapper_hash_compute(
            (((((((alg) & ~((psa_algorithm_t) 0x000000ff)) == ((psa_algorithm_t) 0x06000300)) || (((alg) & ~((psa_algorithm_t) 0x000000ff)) == ((psa_algorithm_t) 0x06001300))) || (((alg) & ~((psa_algorithm_t) 0x000000ff)) == ((psa_algorithm_t) 0x06000200)) || (((alg) & ~((psa_algorithm_t) 0x000000ff) & ~((psa_algorithm_t) 0x00000100)) == ((psa_algorithm_t) 0x06000600)) || (((alg) & ~((psa_algorithm_t) 0x000000ff)) == ((psa_algorithm_t) 0x06000900)) || (((alg) & ~((psa_algorithm_t) 0x000000ff) & ~((psa_algorithm_t) 0x00000100)) == ((psa_algorithm_t) 0x06000400))) && ((alg) & ((psa_algorithm_t) 0x000000ff)) != 0) ? ((alg) & ((psa_algorithm_t) 0x000000ff)) | ((psa_algorithm_t) 0x02000000) : 0),
            input, input_length,
            hash, sizeof(hash), &hash_length);

        if (status != ((psa_status_t)0)) {
            return status;
        }

        return psa_driver_wrapper_verify_hash(
            attributes, key_buffer, key_buffer_size,
            alg, hash, hash_length,
            signature, signature_length);
    }

    return ((psa_status_t)-134);
}

psa_status_t psa_verify_message(mbedtls_svc_key_id_t key,
                                psa_algorithm_t alg,
                                const uint8_t *input_external,
                                size_t input_length,
                                const uint8_t *signature_external,
                                size_t signature_length)
{
    psa_status_t status = ((psa_status_t)-151);
    psa_crypto_local_input_t LOCAL_INPUT_COPY_OF_input_external = ((psa_crypto_local_input_t) { 
# 3292 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 3292 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   , 0 }); const uint8_t *input = 
# 3292 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 3292 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   ;;
    psa_crypto_local_input_t LOCAL_INPUT_COPY_OF_signature_external = ((psa_crypto_local_input_t) { 
# 3293 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 3293 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   , 0 }); const uint8_t *signature = 
# 3293 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 3293 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   ;;

    status = psa_crypto_local_input_alloc(input_external, input_length, &LOCAL_INPUT_COPY_OF_input_external); if (status != ((psa_status_t)0)) { goto exit; } input = LOCAL_INPUT_COPY_OF_input_external.buffer;;
    status = psa_crypto_local_input_alloc(signature_external, signature_length, &LOCAL_INPUT_COPY_OF_signature_external); if (status != ((psa_status_t)0)) { goto exit; } signature = LOCAL_INPUT_COPY_OF_signature_external.buffer;;
    status = psa_verify_internal(key, 1, alg, input, input_length, signature,
                                 signature_length);


exit:

    input = 
# 3303 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 3303 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   ; psa_crypto_local_input_free(&LOCAL_INPUT_COPY_OF_input_external);;
    signature = 
# 3304 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 3304 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   ; psa_crypto_local_input_free(&LOCAL_INPUT_COPY_OF_signature_external);;

    return status;
}

psa_status_t psa_sign_hash_builtin(
    const psa_key_attributes_t *attributes,
    const uint8_t *key_buffer, size_t key_buffer_size,
    psa_algorithm_t alg, const uint8_t *hash, size_t hash_length,
    uint8_t *signature, size_t signature_size, size_t *signature_length)
{
    if (attributes->type == ((psa_key_type_t) 0x7001)) {
        if ((((alg) & ~((psa_algorithm_t) 0x000000ff)) == ((psa_algorithm_t) 0x06000200)) ||
            ((((alg) & ~((psa_algorithm_t) 0x000000ff)) == ((psa_algorithm_t) 0x06000300)) || (((alg) & ~((psa_algorithm_t) 0x000000ff)) == ((psa_algorithm_t) 0x06001300)))) {


            return mbedtls_psa_rsa_sign_hash(
                attributes,
                key_buffer, key_buffer_size,
                alg, hash, hash_length,
                signature, signature_size, signature_length);


        } else {
            return ((psa_status_t)-135);
        }
    } else if (((((attributes->type) & ~((psa_key_type_t) 0x3000)) & ~((psa_key_type_t) 0x00ff)) == ((psa_key_type_t) 0x4100))) {
        if ((((alg) & ~((psa_algorithm_t) 0x000000ff) & ~((psa_algorithm_t) 0x00000100)) == ((psa_algorithm_t) 0x06000600))) {


            return mbedtls_psa_ecdsa_sign_hash(
                attributes,
                key_buffer, key_buffer_size,
                alg, hash, hash_length,
                signature, signature_size, signature_length);


        } else {
            return ((psa_status_t)-135);
        }
    }

    (void) key_buffer;
    (void) key_buffer_size;
    (void) hash;
    (void) hash_length;
    (void) signature;
    (void) signature_size;
    (void) signature_length;

    return ((psa_status_t)-134);
}

psa_status_t psa_sign_hash(mbedtls_svc_key_id_t key,
                           psa_algorithm_t alg,
                           const uint8_t *hash_external,
                           size_t hash_length,
                           uint8_t *signature_external,
                           size_t signature_size,
                           size_t *signature_length)
{
    psa_status_t status = ((psa_status_t)-151);
    psa_crypto_local_input_t LOCAL_INPUT_COPY_OF_hash_external = ((psa_crypto_local_input_t) { 
# 3366 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 3366 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   , 0 }); const uint8_t *hash = 
# 3366 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 3366 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   ;;
    psa_crypto_local_output_t LOCAL_OUTPUT_COPY_OF_signature_external = ((psa_crypto_local_output_t) { 
# 3367 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 3367 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   , 
# 3367 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 3367 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   , 0 }); uint8_t *signature = 
# 3367 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 3367 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   ;;

    status = psa_crypto_local_input_alloc(hash_external, hash_length, &LOCAL_INPUT_COPY_OF_hash_external); if (status != ((psa_status_t)0)) { goto exit; } hash = LOCAL_INPUT_COPY_OF_hash_external.buffer;;
    status = psa_crypto_local_output_alloc(signature_external, signature_size, &LOCAL_OUTPUT_COPY_OF_signature_external); if (status != ((psa_status_t)0)) { goto exit; } signature = LOCAL_OUTPUT_COPY_OF_signature_external.buffer;;
    status = psa_sign_internal(key, 0, alg, hash, hash_length, signature,
                               signature_size, signature_length);


exit:

    hash = 
# 3377 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 3377 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   ; psa_crypto_local_input_free(&LOCAL_INPUT_COPY_OF_hash_external);;
    signature = 
# 3378 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 3378 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   ; do { psa_status_t local_output_status; local_output_status = psa_crypto_local_output_free(&LOCAL_OUTPUT_COPY_OF_signature_external); if (local_output_status != ((psa_status_t)0)) { status = local_output_status; } } while (0);

    return status;
}

psa_status_t psa_verify_hash_builtin(
    const psa_key_attributes_t *attributes,
    const uint8_t *key_buffer, size_t key_buffer_size,
    psa_algorithm_t alg, const uint8_t *hash, size_t hash_length,
    const uint8_t *signature, size_t signature_length)
{
    if ((((attributes->type) & ~((psa_key_type_t) 0x3000)) == ((psa_key_type_t) 0x4001))) {
        if ((((alg) & ~((psa_algorithm_t) 0x000000ff)) == ((psa_algorithm_t) 0x06000200)) ||
            ((((alg) & ~((psa_algorithm_t) 0x000000ff)) == ((psa_algorithm_t) 0x06000300)) || (((alg) & ~((psa_algorithm_t) 0x000000ff)) == ((psa_algorithm_t) 0x06001300)))) {


            return mbedtls_psa_rsa_verify_hash(
                attributes,
                key_buffer, key_buffer_size,
                alg, hash, hash_length,
                signature, signature_length);


        } else {
            return ((psa_status_t)-135);
        }
    } else if (((((attributes->type) & ~((psa_key_type_t) 0x3000)) & ~((psa_key_type_t) 0x00ff)) == ((psa_key_type_t) 0x4100))) {
        if ((((alg) & ~((psa_algorithm_t) 0x000000ff) & ~((psa_algorithm_t) 0x00000100)) == ((psa_algorithm_t) 0x06000600))) {


            return mbedtls_psa_ecdsa_verify_hash(
                attributes,
                key_buffer, key_buffer_size,
                alg, hash, hash_length,
                signature, signature_length);


        } else {
            return ((psa_status_t)-135);
        }
    }

    (void) key_buffer;
    (void) key_buffer_size;
    (void) hash;
    (void) hash_length;
    (void) signature;
    (void) signature_length;

    return ((psa_status_t)-134);
}

psa_status_t psa_verify_hash(mbedtls_svc_key_id_t key,
                             psa_algorithm_t alg,
                             const uint8_t *hash_external,
                             size_t hash_length,
                             const uint8_t *signature_external,
                             size_t signature_length)
{
    psa_status_t status = ((psa_status_t)-151);
    psa_crypto_local_input_t LOCAL_INPUT_COPY_OF_hash_external = ((psa_crypto_local_input_t) { 
# 3438 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 3438 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   , 0 }); const uint8_t *hash = 
# 3438 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 3438 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   ;;
    psa_crypto_local_input_t LOCAL_INPUT_COPY_OF_signature_external = ((psa_crypto_local_input_t) { 
# 3439 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 3439 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   , 0 }); const uint8_t *signature = 
# 3439 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 3439 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   ;;

    status = psa_crypto_local_input_alloc(hash_external, hash_length, &LOCAL_INPUT_COPY_OF_hash_external); if (status != ((psa_status_t)0)) { goto exit; } hash = LOCAL_INPUT_COPY_OF_hash_external.buffer;;
    status = psa_crypto_local_input_alloc(signature_external, signature_length, &LOCAL_INPUT_COPY_OF_signature_external); if (status != ((psa_status_t)0)) { goto exit; } signature = LOCAL_INPUT_COPY_OF_signature_external.buffer;;
    status = psa_verify_internal(key, 0, alg, hash, hash_length, signature,
                                 signature_length);


exit:

    hash = 
# 3449 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 3449 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   ; psa_crypto_local_input_free(&LOCAL_INPUT_COPY_OF_hash_external);;
    signature = 
# 3450 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 3450 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   ; psa_crypto_local_input_free(&LOCAL_INPUT_COPY_OF_signature_external);;

    return status;
}

psa_status_t psa_asymmetric_encrypt(mbedtls_svc_key_id_t key,
                                    psa_algorithm_t alg,
                                    const uint8_t *input_external,
                                    size_t input_length,
                                    const uint8_t *salt_external,
                                    size_t salt_length,
                                    uint8_t *output_external,
                                    size_t output_size,
                                    size_t *output_length)
{
    psa_status_t status = ((psa_status_t)-151);
    psa_status_t unlock_status = ((psa_status_t)-151);
    psa_key_slot_t *slot;

    psa_crypto_local_input_t LOCAL_INPUT_COPY_OF_input_external = ((psa_crypto_local_input_t) { 
# 3469 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 3469 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   , 0 }); const uint8_t *input = 
# 3469 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 3469 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   ;;
    psa_crypto_local_input_t LOCAL_INPUT_COPY_OF_salt_external = ((psa_crypto_local_input_t) { 
# 3470 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 3470 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   , 0 }); const uint8_t *salt = 
# 3470 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 3470 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   ;;
    psa_crypto_local_output_t LOCAL_OUTPUT_COPY_OF_output_external = ((psa_crypto_local_output_t) { 
# 3471 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 3471 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   , 
# 3471 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 3471 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   , 0 }); uint8_t *output = 
# 3471 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 3471 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   ;;

    (void) input;
    (void) input_length;
    (void) salt;
    (void) output;
    (void) output_size;

    *output_length = 0;

    if (!(((alg) & ~((psa_algorithm_t) 0x000000ff)) == ((psa_algorithm_t) 0x07000300)) && salt_length != 0) {
        return ((psa_status_t)-135);
    }

    status = psa_get_and_lock_key_slot_with_policy(
        key, &slot, ((psa_key_usage_t) 0x00000100), alg);
    if (status != ((psa_status_t)0)) {
        return status;
    }
    if (!((((slot->attr.type) & ((psa_key_type_t) 0x7000)) == ((psa_key_type_t) 0x4000)) ||
          (((slot->attr.type) & ((psa_key_type_t) 0x7000)) == ((psa_key_type_t) 0x7000)))) {
        status = ((psa_status_t)-135);
        goto exit;
    }

    status = psa_crypto_local_input_alloc(input_external, input_length, &LOCAL_INPUT_COPY_OF_input_external); if (status != ((psa_status_t)0)) { goto exit; } input = LOCAL_INPUT_COPY_OF_input_external.buffer;;
    status = psa_crypto_local_input_alloc(salt_external, salt_length, &LOCAL_INPUT_COPY_OF_salt_external); if (status != ((psa_status_t)0)) { goto exit; } salt = LOCAL_INPUT_COPY_OF_salt_external.buffer;;
    status = psa_crypto_local_output_alloc(output_external, output_size, &LOCAL_OUTPUT_COPY_OF_output_external); if (status != ((psa_status_t)0)) { goto exit; } output = LOCAL_OUTPUT_COPY_OF_output_external.buffer;;

    status = psa_driver_wrapper_asymmetric_encrypt(
        &slot->attr, slot->key.data, slot->key.bytes,
        alg, input, input_length, salt, salt_length,
        output, output_size, output_length);
exit:
    unlock_status = psa_unregister_read_under_mutex(slot);

    input = 
# 3507 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 3507 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   ; psa_crypto_local_input_free(&LOCAL_INPUT_COPY_OF_input_external);;
    salt = 
# 3508 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 3508 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   ; psa_crypto_local_input_free(&LOCAL_INPUT_COPY_OF_salt_external);;
    output = 
# 3509 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 3509 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   ; do { psa_status_t local_output_status; local_output_status = psa_crypto_local_output_free(&LOCAL_OUTPUT_COPY_OF_output_external); if (local_output_status != ((psa_status_t)0)) { status = local_output_status; } } while (0);

    return (status == ((psa_status_t)0)) ? unlock_status : status;
}

psa_status_t psa_asymmetric_decrypt(mbedtls_svc_key_id_t key,
                                    psa_algorithm_t alg,
                                    const uint8_t *input_external,
                                    size_t input_length,
                                    const uint8_t *salt_external,
                                    size_t salt_length,
                                    uint8_t *output_external,
                                    size_t output_size,
                                    size_t *output_length)
{
    psa_status_t status = ((psa_status_t)-151);
    psa_status_t unlock_status = ((psa_status_t)-151);
    psa_key_slot_t *slot;

    psa_crypto_local_input_t LOCAL_INPUT_COPY_OF_input_external = ((psa_crypto_local_input_t) { 
# 3528 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 3528 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   , 0 }); const uint8_t *input = 
# 3528 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 3528 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   ;;
    psa_crypto_local_input_t LOCAL_INPUT_COPY_OF_salt_external = ((psa_crypto_local_input_t) { 
# 3529 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 3529 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   , 0 }); const uint8_t *salt = 
# 3529 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 3529 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   ;;
    psa_crypto_local_output_t LOCAL_OUTPUT_COPY_OF_output_external = ((psa_crypto_local_output_t) { 
# 3530 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 3530 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   , 
# 3530 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 3530 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   , 0 }); uint8_t *output = 
# 3530 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 3530 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   ;;

    (void) input;
    (void) input_length;
    (void) salt;
    (void) output;
    (void) output_size;

    *output_length = 0;

    if (!(((alg) & ~((psa_algorithm_t) 0x000000ff)) == ((psa_algorithm_t) 0x07000300)) && salt_length != 0) {
        return ((psa_status_t)-135);
    }

    status = psa_get_and_lock_key_slot_with_policy(
        key, &slot, ((psa_key_usage_t) 0x00000200), alg);
    if (status != ((psa_status_t)0)) {
        return status;
    }
    if (!(((slot->attr.type) & ((psa_key_type_t) 0x7000)) == ((psa_key_type_t) 0x7000))) {
        status = ((psa_status_t)-135);
        goto exit;
    }

    status = psa_crypto_local_input_alloc(input_external, input_length, &LOCAL_INPUT_COPY_OF_input_external); if (status != ((psa_status_t)0)) { goto exit; } input = LOCAL_INPUT_COPY_OF_input_external.buffer;;
    status = psa_crypto_local_input_alloc(salt_external, salt_length, &LOCAL_INPUT_COPY_OF_salt_external); if (status != ((psa_status_t)0)) { goto exit; } salt = LOCAL_INPUT_COPY_OF_salt_external.buffer;;
    status = psa_crypto_local_output_alloc(output_external, output_size, &LOCAL_OUTPUT_COPY_OF_output_external); if (status != ((psa_status_t)0)) { goto exit; } output = LOCAL_OUTPUT_COPY_OF_output_external.buffer;;

    status = psa_driver_wrapper_asymmetric_decrypt(
        &slot->attr, slot->key.data, slot->key.bytes,
        alg, input, input_length, salt, salt_length,
        output, output_size, output_length);

exit:
    unlock_status = psa_unregister_read_under_mutex(slot);

    input = 
# 3566 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 3566 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   ; psa_crypto_local_input_free(&LOCAL_INPUT_COPY_OF_input_external);;
    salt = 
# 3567 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 3567 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   ; psa_crypto_local_input_free(&LOCAL_INPUT_COPY_OF_salt_external);;
    output = 
# 3568 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 3568 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   ; do { psa_status_t local_output_status; local_output_status = psa_crypto_local_output_free(&LOCAL_OUTPUT_COPY_OF_output_external); if (local_output_status != ((psa_status_t)0)) { status = local_output_status; } } while (0);

    return (status == ((psa_status_t)0)) ? unlock_status : status;
}





static uint32_t psa_interruptible_max_ops = 0xffffffffUL
# 3577 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
                                                                              ;

void psa_interruptible_set_max_ops(uint32_t max_ops)
{
    psa_interruptible_max_ops = max_ops;
}

uint32_t psa_interruptible_get_max_ops(void)
{
    return psa_interruptible_max_ops;
}

uint32_t psa_sign_hash_get_num_ops(
    const psa_sign_hash_interruptible_operation_t *operation)
{
    return operation->num_ops;
}

uint32_t psa_verify_hash_get_num_ops(
    const psa_verify_hash_interruptible_operation_t *operation)
{
    return operation->num_ops;
}

static psa_status_t psa_sign_hash_abort_internal(
    psa_sign_hash_interruptible_operation_t *operation)
{
    if (operation->id == 0) {



        return ((psa_status_t)0);
    }

    psa_status_t status = ((psa_status_t)-151);

    status = psa_driver_wrapper_sign_hash_abort(operation);

    operation->id = 0;





    return status;
}

psa_status_t psa_sign_hash_start(
    psa_sign_hash_interruptible_operation_t *operation,
    mbedtls_svc_key_id_t key, psa_algorithm_t alg,
    const uint8_t *hash_external, size_t hash_length)
{
    psa_status_t status = ((psa_status_t)-151);
    psa_status_t unlock_status = ((psa_status_t)-151);
    psa_key_slot_t *slot;

    psa_crypto_local_input_t LOCAL_INPUT_COPY_OF_hash_external = ((psa_crypto_local_input_t) { 
# 3633 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 3633 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   , 0 }); const uint8_t *hash = 
# 3633 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 3633 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   ;;



    if (operation->id != 0 || operation->error_occurred) {
        return ((psa_status_t)-137);
    }






    memset(&operation->ctx, 0, sizeof(operation->ctx));

    status = psa_sign_verify_check_alg(0, alg);
    if (status != ((psa_status_t)0)) {
        operation->error_occurred = 1;
        return status;
    }

    status = psa_get_and_lock_key_slot_with_policy(key, &slot,
                                                   ((psa_key_usage_t) 0x00001000),
                                                   alg);

    if (status != ((psa_status_t)0)) {
        goto exit;
    }

    if (!(((slot->attr.type) & ((psa_key_type_t) 0x7000)) == ((psa_key_type_t) 0x7000))) {
        status = ((psa_status_t)-135);
        goto exit;
    }

    status = psa_crypto_local_input_alloc(hash_external, hash_length, &LOCAL_INPUT_COPY_OF_hash_external); if (status != ((psa_status_t)0)) { goto exit; } hash = LOCAL_INPUT_COPY_OF_hash_external.buffer;;


    operation->num_ops = 0;

    status = psa_driver_wrapper_sign_hash_start(operation, &slot->attr,
                                                slot->key.data,
                                                slot->key.bytes, alg,
                                                hash, hash_length);
exit:

    if (status != ((psa_status_t)0)) {
        operation->error_occurred = 1;
        psa_sign_hash_abort_internal(operation);
    }

    unlock_status = psa_unregister_read_under_mutex(slot);

    if (unlock_status != ((psa_status_t)0)) {
        operation->error_occurred = 1;
    }

    hash = 
# 3689 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 3689 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   ; psa_crypto_local_input_free(&LOCAL_INPUT_COPY_OF_hash_external);;

    return (status == ((psa_status_t)0)) ? unlock_status : status;
}


psa_status_t psa_sign_hash_complete(
    psa_sign_hash_interruptible_operation_t *operation,
    uint8_t *signature_external, size_t signature_size,
    size_t *signature_length)
{
    psa_status_t status = ((psa_status_t)-151);

    psa_crypto_local_output_t LOCAL_OUTPUT_COPY_OF_signature_external = ((psa_crypto_local_output_t) { 
# 3702 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 3702 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   , 
# 3702 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 3702 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   , 0 }); uint8_t *signature = 
# 3702 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 3702 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   ;;

    *signature_length = 0;



    if (operation->id == 0 || operation->error_occurred) {
        status = ((psa_status_t)-137);
        goto exit;
    }



    if (signature_size == 0) {
        status = ((psa_status_t)-138);
        goto exit;
    }

    status = psa_crypto_local_output_alloc(signature_external, signature_size, &LOCAL_OUTPUT_COPY_OF_signature_external); if (status != ((psa_status_t)0)) { goto exit; } signature = LOCAL_OUTPUT_COPY_OF_signature_external.buffer;;

    status = psa_driver_wrapper_sign_hash_complete(operation, signature,
                                                   signature_size,
                                                   signature_length);


    operation->num_ops = psa_driver_wrapper_sign_hash_get_num_ops(operation);

exit:

    if (signature != 
# 3731 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
                    ((void *)0)
# 3731 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
                        ) {
        psa_wipe_tag_output_buffer(signature, status, signature_size,
                                   *signature_length);
    }

    if (status != ((psa_status_t)-248)) {
        if (status != ((psa_status_t)0)) {
            operation->error_occurred = 1;
        }

        psa_sign_hash_abort_internal(operation);
    }

    signature = 
# 3744 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 3744 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   ; do { psa_status_t local_output_status; local_output_status = psa_crypto_local_output_free(&LOCAL_OUTPUT_COPY_OF_signature_external); if (local_output_status != ((psa_status_t)0)) { status = local_output_status; } } while (0);

    return status;
}

psa_status_t psa_sign_hash_abort(
    psa_sign_hash_interruptible_operation_t *operation)
{
    psa_status_t status = ((psa_status_t)-151);

    status = psa_sign_hash_abort_internal(operation);



    operation->num_ops = 0;


    operation->error_occurred = 0;

    return status;
}

static psa_status_t psa_verify_hash_abort_internal(
    psa_verify_hash_interruptible_operation_t *operation)
{
    if (operation->id == 0) {



        return ((psa_status_t)0);
    }

    psa_status_t status = ((psa_status_t)-151);

    status = psa_driver_wrapper_verify_hash_abort(operation);

    operation->id = 0;





    return status;
}

psa_status_t psa_verify_hash_start(
    psa_verify_hash_interruptible_operation_t *operation,
    mbedtls_svc_key_id_t key, psa_algorithm_t alg,
    const uint8_t *hash_external, size_t hash_length,
    const uint8_t *signature_external, size_t signature_length)
{
    psa_status_t status = ((psa_status_t)-151);
    psa_status_t unlock_status = ((psa_status_t)-151);
    psa_key_slot_t *slot;

    psa_crypto_local_input_t LOCAL_INPUT_COPY_OF_hash_external = ((psa_crypto_local_input_t) { 
# 3799 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 3799 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   , 0 }); const uint8_t *hash = 
# 3799 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 3799 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   ;;
    psa_crypto_local_input_t LOCAL_INPUT_COPY_OF_signature_external = ((psa_crypto_local_input_t) { 
# 3800 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 3800 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   , 0 }); const uint8_t *signature = 
# 3800 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 3800 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   ;;



    if (operation->id != 0 || operation->error_occurred) {
        return ((psa_status_t)-137);
    }






    memset(&operation->ctx, 0, sizeof(operation->ctx));

    status = psa_sign_verify_check_alg(0, alg);
    if (status != ((psa_status_t)0)) {
        operation->error_occurred = 1;
        return status;
    }

    status = psa_get_and_lock_key_slot_with_policy(key, &slot,
                                                   ((psa_key_usage_t) 0x00002000),
                                                   alg);

    if (status != ((psa_status_t)0)) {
        operation->error_occurred = 1;
        return status;
    }

    status = psa_crypto_local_input_alloc(hash_external, hash_length, &LOCAL_INPUT_COPY_OF_hash_external); if (status != ((psa_status_t)0)) { goto exit; } hash = LOCAL_INPUT_COPY_OF_hash_external.buffer;;
    status = psa_crypto_local_input_alloc(signature_external, signature_length, &LOCAL_INPUT_COPY_OF_signature_external); if (status != ((psa_status_t)0)) { goto exit; } signature = LOCAL_INPUT_COPY_OF_signature_external.buffer;;


    operation->num_ops = 0;

    status = psa_driver_wrapper_verify_hash_start(operation, &slot->attr,
                                                  slot->key.data,
                                                  slot->key.bytes,
                                                  alg, hash, hash_length,
                                                  signature, signature_length);

exit:


    if (status != ((psa_status_t)0)) {
        operation->error_occurred = 1;
        psa_verify_hash_abort_internal(operation);
    }

    unlock_status = psa_unregister_read_under_mutex(slot);

    if (unlock_status != ((psa_status_t)0)) {
        operation->error_occurred = 1;
    }

    hash = 
# 3856 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 3856 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   ; psa_crypto_local_input_free(&LOCAL_INPUT_COPY_OF_hash_external);;
    signature = 
# 3857 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 3857 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   ; psa_crypto_local_input_free(&LOCAL_INPUT_COPY_OF_signature_external);;

    return (status == ((psa_status_t)0)) ? unlock_status : status;
}

psa_status_t psa_verify_hash_complete(
    psa_verify_hash_interruptible_operation_t *operation)
{
    psa_status_t status = ((psa_status_t)-151);



    if (operation->id == 0 || operation->error_occurred) {
        status = ((psa_status_t)-137);
        goto exit;
    }

    status = psa_driver_wrapper_verify_hash_complete(operation);


    operation->num_ops = psa_driver_wrapper_verify_hash_get_num_ops(
        operation);

exit:

    if (status != ((psa_status_t)-248)) {
        if (status != ((psa_status_t)0)) {
            operation->error_occurred = 1;
        }

        psa_verify_hash_abort_internal(operation);
    }

    return status;
}

psa_status_t psa_verify_hash_abort(
    psa_verify_hash_interruptible_operation_t *operation)
{
    psa_status_t status = ((psa_status_t)-151);

    status = psa_verify_hash_abort_internal(operation);



    operation->num_ops = 0;


    operation->error_occurred = 0;

    return status;
}






void mbedtls_psa_interruptible_set_max_ops(uint32_t max_ops)
{







    if (max_ops == 0) {
        max_ops = 1;
    }

    mbedtls_ecp_set_max_ops(max_ops);





}

uint32_t mbedtls_psa_sign_hash_get_num_ops(
    const mbedtls_psa_sign_hash_interruptible_operation_t *operation)
{




    return operation->num_ops;






}

uint32_t mbedtls_psa_verify_hash_get_num_ops(
    const mbedtls_psa_verify_hash_interruptible_operation_t *operation)
{




    return operation->num_ops;






}
# 3978 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
static inline int can_do_interruptible_sign_verify(psa_algorithm_t alg)
{


    if (((((alg) & ~((psa_algorithm_t) 0x000000ff) & ~((psa_algorithm_t) 0x00000100)) == ((psa_algorithm_t) 0x06000600)) && (((alg) & ((psa_algorithm_t) 0x00000100)) != 0))) {
        return 1;
    }


    if (((((alg) & ~((psa_algorithm_t) 0x000000ff) & ~((psa_algorithm_t) 0x00000100)) == ((psa_algorithm_t) 0x06000600)) && !(((alg) & ((psa_algorithm_t) 0x00000100)) != 0))) {
        return 1;
    }


    (void) alg;
    return 0;
}

psa_status_t mbedtls_psa_sign_hash_start(
    mbedtls_psa_sign_hash_interruptible_operation_t *operation,
    const psa_key_attributes_t *attributes, const uint8_t *key_buffer,
    size_t key_buffer_size, psa_algorithm_t alg,
    const uint8_t *hash, size_t hash_length)
{
    psa_status_t status = ((psa_status_t)-151);
    size_t required_hash_length;

    if (!(((attributes->type) & ~((psa_key_type_t) 0x00ff)) == ((psa_key_type_t) 0x7100))) {
        return ((psa_status_t)-134);
    }
    psa_ecc_family_t curve = ((psa_ecc_family_t) (((((attributes->type) & ~((psa_key_type_t) 0x3000)) & ~((psa_key_type_t) 0x00ff)) == ((psa_key_type_t) 0x4100)) ? ((attributes->type) & ((psa_key_type_t) 0x00ff)) : 0));
    if (!((curve & 0xc0) == 0)) {
        return ((psa_status_t)-135);
    }

    if (!can_do_interruptible_sign_verify(alg)) {
        return ((psa_status_t)-134);
    }





    mbedtls_ecdsa_restart_init(&operation->restart_ctx);


    operation->num_ops = 0;

    status = mbedtls_psa_ecp_load_representation(attributes->type,
                                                 attributes->bits,
                                                 key_buffer,
                                                 key_buffer_size,
                                                 &operation->ctx);

    if (status != ((psa_status_t)0)) {
        return status;
    }

    operation->coordinate_bytes = (((operation->ctx->grp.nbits) + 7u) / 8u)
                                  ;

    psa_algorithm_t hash_alg = (((((((alg) & ~((psa_algorithm_t) 0x000000ff)) == ((psa_algorithm_t) 0x06000300)) || (((alg) & ~((psa_algorithm_t) 0x000000ff)) == ((psa_algorithm_t) 0x06001300))) || (((alg) & ~((psa_algorithm_t) 0x000000ff)) == ((psa_algorithm_t) 0x06000200)) || (((alg) & ~((psa_algorithm_t) 0x000000ff) & ~((psa_algorithm_t) 0x00000100)) == ((psa_algorithm_t) 0x06000600)) || (((alg) & ~((psa_algorithm_t) 0x000000ff)) == ((psa_algorithm_t) 0x06000900)) || (((alg) & ~((psa_algorithm_t) 0x000000ff) & ~((psa_algorithm_t) 0x00000100)) == ((psa_algorithm_t) 0x06000400))) && ((alg) & ((psa_algorithm_t) 0x000000ff)) != 0) ? ((alg) & ((psa_algorithm_t) 0x000000ff)) | ((psa_algorithm_t) 0x02000000) : 0);
    operation->md_alg = mbedtls_md_type_from_psa_alg(hash_alg);
    operation->alg = alg;



    required_hash_length = (hash_length < operation->coordinate_bytes ?
                            hash_length : operation->coordinate_bytes);

    if (required_hash_length > sizeof(operation->hash)) {

        return ((psa_status_t)-151);
    }

    memcpy(operation->hash, hash, required_hash_length);
    operation->hash_length = required_hash_length;

    return ((psa_status_t)0);
# 4072 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
}

psa_status_t mbedtls_psa_sign_hash_complete(
    mbedtls_psa_sign_hash_interruptible_operation_t *operation,
    uint8_t *signature, size_t signature_size,
    size_t *signature_length)
{




    psa_status_t status = ((psa_status_t)-151);
    mbedtls_mpi r;
    mbedtls_mpi s;

    mbedtls_mpi_init(&r);
    mbedtls_mpi_init(&s);


    mbedtls_psa_interruptible_set_max_ops(psa_interruptible_get_max_ops());

    if (signature_size < 2 * operation->coordinate_bytes) {
        status = ((psa_status_t)-138);
        goto exit;
    }

    if ((((operation->alg) & ((psa_algorithm_t) 0x00000100)) != 0)) {


        status = mbedtls_to_psa_error(
            mbedtls_ecdsa_sign_det_restartable(&operation->ctx->grp,
                                               &r,
                                               &s,
                                               &operation->ctx->d,
                                               operation->hash,
                                               operation->hash_length,
                                               operation->md_alg,
                                               mbedtls_psa_get_random,
                                               
# 4110 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
                                              ((void *)0)
# 4110 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
                                                                      ,
                                               &operation->restart_ctx));




    } else {
        status = mbedtls_to_psa_error(
            mbedtls_ecdsa_sign_restartable(&operation->ctx->grp,
                                           &r,
                                           &s,
                                           &operation->ctx->d,
                                           operation->hash,
                                           operation->hash_length,
                                           mbedtls_psa_get_random,
                                           
# 4125 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
                                          ((void *)0)
# 4125 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
                                                                  ,
                                           mbedtls_psa_get_random,
                                           
# 4127 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
                                          ((void *)0)
# 4127 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
                                                                  ,
                                           &operation->restart_ctx));
    }



    operation->num_ops += operation->restart_ctx.ecp.ops_done;

    if (status == ((psa_status_t)0)) {
        status = mbedtls_to_psa_error(
            mbedtls_mpi_write_binary(&r,
                                     signature,
                                     operation->coordinate_bytes)
            );

        if (status != ((psa_status_t)0)) {
            goto exit;
        }

        status = mbedtls_to_psa_error(
            mbedtls_mpi_write_binary(&s,
                                     signature +
                                     operation->coordinate_bytes,
                                     operation->coordinate_bytes)
            );

        if (status != ((psa_status_t)0)) {
            goto exit;
        }

        *signature_length = operation->coordinate_bytes * 2;

        status = ((psa_status_t)0);
    }

exit:

    mbedtls_mpi_free(&r);
    mbedtls_mpi_free(&s);
    return status;
# 4180 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
}

psa_status_t mbedtls_psa_sign_hash_abort(
    mbedtls_psa_sign_hash_interruptible_operation_t *operation)
{





    if (operation->ctx) {
        mbedtls_ecdsa_free(operation->ctx);
        free(operation->ctx);
        operation->ctx = 
# 4193 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
                        ((void *)0)
# 4193 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
                            ;
    }

    mbedtls_ecdsa_restart_free(&operation->restart_ctx);

    operation->num_ops = 0;

    return ((psa_status_t)0);
# 4211 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
}

psa_status_t mbedtls_psa_verify_hash_start(
    mbedtls_psa_verify_hash_interruptible_operation_t *operation,
    const psa_key_attributes_t *attributes,
    const uint8_t *key_buffer, size_t key_buffer_size,
    psa_algorithm_t alg,
    const uint8_t *hash, size_t hash_length,
    const uint8_t *signature, size_t signature_length)
{
    psa_status_t status = ((psa_status_t)-151);
    size_t coordinate_bytes = 0;
    size_t required_hash_length = 0;

    if (!((((attributes->type) & ~((psa_key_type_t) 0x3000)) & ~((psa_key_type_t) 0x00ff)) == ((psa_key_type_t) 0x4100))) {
        return ((psa_status_t)-134);
    }
    psa_ecc_family_t curve = ((psa_ecc_family_t) (((((attributes->type) & ~((psa_key_type_t) 0x3000)) & ~((psa_key_type_t) 0x00ff)) == ((psa_key_type_t) 0x4100)) ? ((attributes->type) & ((psa_key_type_t) 0x00ff)) : 0));
    if (!((curve & 0xc0) == 0)) {
        return ((psa_status_t)-135);
    }

    if (!can_do_interruptible_sign_verify(alg)) {
        return ((psa_status_t)-134);
    }





    mbedtls_ecdsa_restart_init(&operation->restart_ctx);
    mbedtls_mpi_init(&operation->r);
    mbedtls_mpi_init(&operation->s);


    operation->num_ops = 0;

    status = mbedtls_psa_ecp_load_representation(attributes->type,
                                                 attributes->bits,
                                                 key_buffer,
                                                 key_buffer_size,
                                                 &operation->ctx);

    if (status != ((psa_status_t)0)) {
        return status;
    }

    coordinate_bytes = (((operation->ctx->grp.nbits) + 7u) / 8u);

    if (signature_length != 2 * coordinate_bytes) {
        return ((psa_status_t)-149);
    }

    status = mbedtls_to_psa_error(
        mbedtls_mpi_read_binary(&operation->r,
                                signature,
                                coordinate_bytes));

    if (status != ((psa_status_t)0)) {
        return status;
    }

    status = mbedtls_to_psa_error(
        mbedtls_mpi_read_binary(&operation->s,
                                signature +
                                coordinate_bytes,
                                coordinate_bytes));

    if (status != ((psa_status_t)0)) {
        return status;
    }

    status = mbedtls_psa_ecp_load_public_part(operation->ctx);

    if (status != ((psa_status_t)0)) {
        return status;
    }



    required_hash_length = (hash_length < coordinate_bytes ? hash_length :
                            coordinate_bytes);

    if (required_hash_length > sizeof(operation->hash)) {

        return ((psa_status_t)-151);
    }

    memcpy(operation->hash, hash, required_hash_length);
    operation->hash_length = required_hash_length;

    return ((psa_status_t)0);
# 4320 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
}

psa_status_t mbedtls_psa_verify_hash_complete(
    mbedtls_psa_verify_hash_interruptible_operation_t *operation)
{





    psa_status_t status = ((psa_status_t)-151);


    mbedtls_psa_interruptible_set_max_ops(psa_interruptible_get_max_ops());

    status = mbedtls_to_psa_error(
        mbedtls_ecdsa_verify_restartable(&operation->ctx->grp,
                                         operation->hash,
                                         operation->hash_length,
                                         &operation->ctx->Q,
                                         &operation->r,
                                         &operation->s,
                                         &operation->restart_ctx));



    operation->num_ops += operation->restart_ctx.ecp.ops_done;

    return status;
# 4357 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
}

psa_status_t mbedtls_psa_verify_hash_abort(
    mbedtls_psa_verify_hash_interruptible_operation_t *operation)
{





    if (operation->ctx) {
        mbedtls_ecdsa_free(operation->ctx);
        free(operation->ctx);
        operation->ctx = 
# 4370 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
                        ((void *)0)
# 4370 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
                            ;
    }

    mbedtls_ecdsa_restart_free(&operation->restart_ctx);

    operation->num_ops = 0;

    mbedtls_mpi_free(&operation->r);
    mbedtls_mpi_free(&operation->s);

    return ((psa_status_t)0);
# 4390 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
}

static psa_status_t psa_generate_random_internal(uint8_t *output,
                                                 size_t output_size)
{
    if (psa_get_initialized() == 0) return ((psa_status_t)-137);;
# 4416 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
    while (output_size > 0) {
        int ret = -0x0072;
        size_t request_size =
            (output_size > 1024 ?
             1024 :
             output_size);

        ret = mbedtls_ctr_drbg_random(&global_data.rng.drbg, output, request_size);



        if (ret != 0) {
            return mbedtls_to_psa_error(ret);
        }
        output_size -= request_size;
        output += request_size;
    }
    return ((psa_status_t)0);

}






static psa_status_t psa_cipher_setup(psa_cipher_operation_t *operation,
                                     mbedtls_svc_key_id_t key,
                                     psa_algorithm_t alg,
                                     mbedtls_operation_t cipher_operation)
{
    psa_status_t status = ((psa_status_t)-151);
    psa_status_t unlock_status = ((psa_status_t)-151);
    psa_key_slot_t *slot = 
# 4449 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
                          ((void *)0)
# 4449 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
                              ;
    psa_key_usage_t usage = (cipher_operation == MBEDTLS_ENCRYPT ?
                             ((psa_key_usage_t) 0x00000100) :
                             ((psa_key_usage_t) 0x00000200));


    if (operation->id != 0) {
        status = ((psa_status_t)-137);
        goto exit;
    }

    if (!(((alg) & ((psa_algorithm_t) 0x7f000000)) == ((psa_algorithm_t) 0x04000000))) {
        status = ((psa_status_t)-135);
        goto exit;
    }

    status = psa_get_and_lock_key_slot_with_policy(key, &slot, usage, alg);
    if (status != ((psa_status_t)0)) {
        goto exit;
    }





    operation->iv_set = 0;
    if (alg == ((psa_algorithm_t) 0x04404400)) {
        operation->iv_required = 0;
    } else {
        operation->iv_required = 1;
    }
    operation->default_iv_length = ((((slot->attr.type) & ((psa_key_type_t) 0x7000)) == ((psa_key_type_t) 0x2000) ? 1u << (((slot->attr.type) >> 8) & 7) : 0u) > 1 && ((alg) == ((psa_algorithm_t) 0x04c01000) || (alg) == ((psa_algorithm_t) 0x04c01100) || (alg) == ((psa_algorithm_t) 0x04c01200) || (alg) == ((psa_algorithm_t) 0x0440ff00) || (alg) == ((psa_algorithm_t) 0x04404000) || (alg) == ((psa_algorithm_t) 0x04404100)) ? (((slot->attr.type) & ((psa_key_type_t) 0x7000)) == ((psa_key_type_t) 0x2000) ? 1u << (((slot->attr.type) >> 8) & 7) : 0u) : (slot->attr.type) == ((psa_key_type_t) 0x2004) && (alg) == ((psa_algorithm_t) 0x04800100) ? 12u : (alg) == ((psa_algorithm_t) 0x04c01300) ? 13u : 0u);







    memset(&operation->ctx, 0, sizeof(operation->ctx));


    if (cipher_operation == MBEDTLS_ENCRYPT) {
        status = psa_driver_wrapper_cipher_encrypt_setup(operation,
                                                         &slot->attr,
                                                         slot->key.data,
                                                         slot->key.bytes,
                                                         alg);
    } else {
        status = psa_driver_wrapper_cipher_decrypt_setup(operation,
                                                         &slot->attr,
                                                         slot->key.data,
                                                         slot->key.bytes,
                                                         alg);
    }

exit:
    if (status != ((psa_status_t)0)) {
        psa_cipher_abort(operation);
    }

    unlock_status = psa_unregister_read_under_mutex(slot);

    return (status == ((psa_status_t)0)) ? unlock_status : status;
}

psa_status_t psa_cipher_encrypt_setup(psa_cipher_operation_t *operation,
                                      mbedtls_svc_key_id_t key,
                                      psa_algorithm_t alg)
{
    return psa_cipher_setup(operation, key, alg, MBEDTLS_ENCRYPT);
}

psa_status_t psa_cipher_decrypt_setup(psa_cipher_operation_t *operation,
                                      mbedtls_svc_key_id_t key,
                                      psa_algorithm_t alg)
{
    return psa_cipher_setup(operation, key, alg, MBEDTLS_DECRYPT);
}

psa_status_t psa_cipher_generate_iv(psa_cipher_operation_t *operation,
                                    uint8_t *iv_external,
                                    size_t iv_size,
                                    size_t *iv_length)
{
    psa_status_t status = ((psa_status_t)-151);
    size_t default_iv_length = 0;

    psa_crypto_local_output_t LOCAL_OUTPUT_COPY_OF_iv_external = ((psa_crypto_local_output_t) { 
# 4537 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 4537 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   , 
# 4537 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 4537 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   , 0 }); uint8_t *iv = 
# 4537 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 4537 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   ;;

    if (operation->id == 0) {
        status = ((psa_status_t)-137);
        goto exit;
    }

    if (operation->iv_set || !operation->iv_required) {
        status = ((psa_status_t)-137);
        goto exit;
    }

    default_iv_length = operation->default_iv_length;
    if (iv_size < default_iv_length) {
        status = ((psa_status_t)-138);
        goto exit;
    }

    if (default_iv_length > 16u) {
        status = ((psa_status_t)-132);
        goto exit;
    }

    status = psa_crypto_local_output_alloc(iv_external, default_iv_length, &LOCAL_OUTPUT_COPY_OF_iv_external); if (status != ((psa_status_t)0)) { goto exit; } iv = LOCAL_OUTPUT_COPY_OF_iv_external.buffer;;

    status = psa_generate_random_internal(iv, default_iv_length);
    if (status != ((psa_status_t)0)) {
        goto exit;
    }

    status = psa_driver_wrapper_cipher_set_iv(operation,
                                              iv, default_iv_length);

exit:
    if (status == ((psa_status_t)0)) {
        *iv_length = default_iv_length;
        operation->iv_set = 1;
    } else {
        *iv_length = 0;
        psa_cipher_abort(operation);
        if (iv != 
# 4577 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
                 ((void *)0)
# 4577 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
                     ) {
            mbedtls_platform_zeroize(iv, default_iv_length);
        }
    }

    iv = 
# 4582 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 4582 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   ; do { psa_status_t local_output_status; local_output_status = psa_crypto_local_output_free(&LOCAL_OUTPUT_COPY_OF_iv_external); if (local_output_status != ((psa_status_t)0)) { status = local_output_status; } } while (0);
    return status;
}

psa_status_t psa_cipher_set_iv(psa_cipher_operation_t *operation,
                               const uint8_t *iv_external,
                               size_t iv_length)
{
    psa_status_t status = ((psa_status_t)-151);

    psa_crypto_local_input_t LOCAL_INPUT_COPY_OF_iv_external = ((psa_crypto_local_input_t) { 
# 4592 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 4592 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   , 0 }); const uint8_t *iv = 
# 4592 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 4592 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   ;;

    if (operation->id == 0) {
        status = ((psa_status_t)-137);
        goto exit;
    }

    if (operation->iv_set || !operation->iv_required) {
        status = ((psa_status_t)-137);
        goto exit;
    }

    if (iv_length > 16u) {
        status = ((psa_status_t)-135);
        goto exit;
    }

    status = psa_crypto_local_input_alloc(iv_external, iv_length, &LOCAL_INPUT_COPY_OF_iv_external); if (status != ((psa_status_t)0)) { goto exit; } iv = LOCAL_INPUT_COPY_OF_iv_external.buffer;;

    status = psa_driver_wrapper_cipher_set_iv(operation,
                                              iv,
                                              iv_length);

exit:
    if (status == ((psa_status_t)0)) {
        operation->iv_set = 1;
    } else {
        psa_cipher_abort(operation);
    }

    iv = 
# 4622 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 4622 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   ; psa_crypto_local_input_free(&LOCAL_INPUT_COPY_OF_iv_external);;

    return status;
}

psa_status_t psa_cipher_update(psa_cipher_operation_t *operation,
                               const uint8_t *input_external,
                               size_t input_length,
                               uint8_t *output_external,
                               size_t output_size,
                               size_t *output_length)
{
    psa_status_t status = ((psa_status_t)-151);

    psa_crypto_local_input_t LOCAL_INPUT_COPY_OF_input_external = ((psa_crypto_local_input_t) { 
# 4636 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 4636 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   , 0 }); const uint8_t *input = 
# 4636 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 4636 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   ;;
    psa_crypto_local_output_t LOCAL_OUTPUT_COPY_OF_output_external = ((psa_crypto_local_output_t) { 
# 4637 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 4637 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   , 
# 4637 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 4637 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   , 0 }); uint8_t *output = 
# 4637 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 4637 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   ;;

    if (operation->id == 0) {
        status = ((psa_status_t)-137);
        goto exit;
    }

    if (operation->iv_required && !operation->iv_set) {
        status = ((psa_status_t)-137);
        goto exit;
    }

    status = psa_crypto_local_input_alloc(input_external, input_length, &LOCAL_INPUT_COPY_OF_input_external); if (status != ((psa_status_t)0)) { goto exit; } input = LOCAL_INPUT_COPY_OF_input_external.buffer;;
    status = psa_crypto_local_output_alloc(output_external, output_size, &LOCAL_OUTPUT_COPY_OF_output_external); if (status != ((psa_status_t)0)) { goto exit; } output = LOCAL_OUTPUT_COPY_OF_output_external.buffer;;

    status = psa_driver_wrapper_cipher_update(operation,
                                              input,
                                              input_length,
                                              output,
                                              output_size,
                                              output_length);

exit:
    if (status != ((psa_status_t)0)) {
        psa_cipher_abort(operation);
    }

    input = 
# 4664 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 4664 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   ; psa_crypto_local_input_free(&LOCAL_INPUT_COPY_OF_input_external);;
    output = 
# 4665 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 4665 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   ; do { psa_status_t local_output_status; local_output_status = psa_crypto_local_output_free(&LOCAL_OUTPUT_COPY_OF_output_external); if (local_output_status != ((psa_status_t)0)) { status = local_output_status; } } while (0);

    return status;
}

psa_status_t psa_cipher_finish(psa_cipher_operation_t *operation,
                               uint8_t *output_external,
                               size_t output_size,
                               size_t *output_length)
{
    psa_status_t status = ((psa_status_t)-132);

    psa_crypto_local_output_t LOCAL_OUTPUT_COPY_OF_output_external = ((psa_crypto_local_output_t) { 
# 4677 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 4677 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   , 
# 4677 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 4677 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   , 0 }); uint8_t *output = 
# 4677 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 4677 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   ;;

    if (operation->id == 0) {
        status = ((psa_status_t)-137);
        goto exit;
    }

    if (operation->iv_required && !operation->iv_set) {
        status = ((psa_status_t)-137);
        goto exit;
    }

    status = psa_crypto_local_output_alloc(output_external, output_size, &LOCAL_OUTPUT_COPY_OF_output_external); if (status != ((psa_status_t)0)) { goto exit; } output = LOCAL_OUTPUT_COPY_OF_output_external.buffer;;

    status = psa_driver_wrapper_cipher_finish(operation,
                                              output,
                                              output_size,
                                              output_length);

exit:
                                                           ;
    psa_status_t abort_status = psa_cipher_abort(operation);







    if (abort_status != ((psa_status_t)0)) {
        status = abort_status;
    }





    mbedtls_ct_condition_t success =
        mbedtls_ct_bool_not(mbedtls_ct_bool(status));
    *output_length = mbedtls_ct_size_if_else_0(success, *output_length);

    output = 
# 4718 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 4718 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   ; do { psa_status_t local_output_status; local_output_status = psa_crypto_local_output_free(&LOCAL_OUTPUT_COPY_OF_output_external); if (local_output_status != ((psa_status_t)0)) { status = local_output_status; } } while (0);

    return status;
}

psa_status_t psa_cipher_abort(psa_cipher_operation_t *operation)
{
    if (operation->id == 0) {



        return ((psa_status_t)0);
    }

    psa_driver_wrapper_cipher_abort(operation);

    operation->id = 0;
    operation->iv_set = 0;
    operation->iv_required = 0;

    return ((psa_status_t)0);
}

psa_status_t psa_cipher_encrypt(mbedtls_svc_key_id_t key,
                                psa_algorithm_t alg,
                                const uint8_t *input_external,
                                size_t input_length,
                                uint8_t *output_external,
                                size_t output_size,
                                size_t *output_length)
{
    psa_status_t status = ((psa_status_t)-151);
    psa_status_t unlock_status = ((psa_status_t)-151);
    psa_key_slot_t *slot = 
# 4751 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
                          ((void *)0)
# 4751 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
                              ;
    uint8_t local_iv[16u];
    size_t default_iv_length = 0;

    psa_crypto_local_input_t LOCAL_INPUT_COPY_OF_input_external = ((psa_crypto_local_input_t) { 
# 4755 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 4755 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   , 0 }); const uint8_t *input = 
# 4755 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 4755 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   ;;
    psa_crypto_local_output_t LOCAL_OUTPUT_COPY_OF_output_external = ((psa_crypto_local_output_t) { 
# 4756 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 4756 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   , 
# 4756 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 4756 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   , 0 }); uint8_t *output = 
# 4756 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 4756 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   ;;

    if (!(((alg) & ((psa_algorithm_t) 0x7f000000)) == ((psa_algorithm_t) 0x04000000))) {
        status = ((psa_status_t)-135);
        goto exit;
    }

    status = psa_get_and_lock_key_slot_with_policy(key, &slot,
                                                   ((psa_key_usage_t) 0x00000100),
                                                   alg);
    if (status != ((psa_status_t)0)) {
        goto exit;
    }

    default_iv_length = ((((slot->attr.type) & ((psa_key_type_t) 0x7000)) == ((psa_key_type_t) 0x2000) ? 1u << (((slot->attr.type) >> 8) & 7) : 0u) > 1 && ((alg) == ((psa_algorithm_t) 0x04c01000) || (alg) == ((psa_algorithm_t) 0x04c01100) || (alg) == ((psa_algorithm_t) 0x04c01200) || (alg) == ((psa_algorithm_t) 0x0440ff00) || (alg) == ((psa_algorithm_t) 0x04404000) || (alg) == ((psa_algorithm_t) 0x04404100)) ? (((slot->attr.type) & ((psa_key_type_t) 0x7000)) == ((psa_key_type_t) 0x2000) ? 1u << (((slot->attr.type) >> 8) & 7) : 0u) : (slot->attr.type) == ((psa_key_type_t) 0x2004) && (alg) == ((psa_algorithm_t) 0x04800100) ? 12u : (alg) == ((psa_algorithm_t) 0x04c01300) ? 13u : 0u);
    if (default_iv_length > 16u) {
        status = ((psa_status_t)-132);
        goto exit;
    }

    if (default_iv_length > 0) {
        if (output_size < default_iv_length) {
            status = ((psa_status_t)-138);
            goto exit;
        }

        status = psa_generate_random_internal(local_iv, default_iv_length);
        if (status != ((psa_status_t)0)) {
            goto exit;
        }
    }

    status = psa_crypto_local_input_alloc(input_external, input_length, &LOCAL_INPUT_COPY_OF_input_external); if (status != ((psa_status_t)0)) { goto exit; } input = LOCAL_INPUT_COPY_OF_input_external.buffer;;
    status = psa_crypto_local_output_alloc(output_external, output_size, &LOCAL_OUTPUT_COPY_OF_output_external); if (status != ((psa_status_t)0)) { goto exit; } output = LOCAL_OUTPUT_COPY_OF_output_external.buffer;;

    status = psa_driver_wrapper_cipher_encrypt(
        &slot->attr, slot->key.data, slot->key.bytes,
        alg, local_iv, default_iv_length, input, input_length,
        psa_crypto_buffer_offset(output, default_iv_length),
        output_size - default_iv_length, output_length);

exit:
    unlock_status = psa_unregister_read_under_mutex(slot);
    if (status == ((psa_status_t)0)) {
        status = unlock_status;
    }

    if (status == ((psa_status_t)0)) {
        if (default_iv_length > 0) {
            memcpy(output, local_iv, default_iv_length);
        }
        *output_length += default_iv_length;
    } else {
        *output_length = 0;
    }

    input = 
# 4812 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 4812 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   ; psa_crypto_local_input_free(&LOCAL_INPUT_COPY_OF_input_external);;
    output = 
# 4813 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 4813 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   ; do { psa_status_t local_output_status; local_output_status = psa_crypto_local_output_free(&LOCAL_OUTPUT_COPY_OF_output_external); if (local_output_status != ((psa_status_t)0)) { status = local_output_status; } } while (0);

    return status;
}

psa_status_t psa_cipher_decrypt(mbedtls_svc_key_id_t key,
                                psa_algorithm_t alg,
                                const uint8_t *input_external,
                                size_t input_length,
                                uint8_t *output_external,
                                size_t output_size,
                                size_t *output_length)
{
    psa_status_t status = ((psa_status_t)-151);
    psa_status_t unlock_status = ((psa_status_t)-151);
    psa_key_slot_t *slot = 
# 4828 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
                          ((void *)0)
# 4828 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
                              ;

    psa_crypto_local_input_t LOCAL_INPUT_COPY_OF_input_external = ((psa_crypto_local_input_t) { 
# 4830 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 4830 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   , 0 }); const uint8_t *input = 
# 4830 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 4830 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   ;;
    psa_crypto_local_output_t LOCAL_OUTPUT_COPY_OF_output_external = ((psa_crypto_local_output_t) { 
# 4831 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 4831 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   , 
# 4831 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 4831 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   , 0 }); uint8_t *output = 
# 4831 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 4831 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   ;;

    if (!(((alg) & ((psa_algorithm_t) 0x7f000000)) == ((psa_algorithm_t) 0x04000000))) {
        status = ((psa_status_t)-135);
        goto exit;
    }

    status = psa_get_and_lock_key_slot_with_policy(key, &slot,
                                                   ((psa_key_usage_t) 0x00000200),
                                                   alg);
    if (status != ((psa_status_t)0)) {
        goto exit;
    }

    if (input_length < ((((slot->attr.type) & ((psa_key_type_t) 0x7000)) == ((psa_key_type_t) 0x2000) ? 1u << (((slot->attr.type) >> 8) & 7) : 0u) > 1 && ((alg) == ((psa_algorithm_t) 0x04c01000) || (alg) == ((psa_algorithm_t) 0x04c01100) || (alg) == ((psa_algorithm_t) 0x04c01200) || (alg) == ((psa_algorithm_t) 0x0440ff00) || (alg) == ((psa_algorithm_t) 0x04404000) || (alg) == ((psa_algorithm_t) 0x04404100)) ? (((slot->attr.type) & ((psa_key_type_t) 0x7000)) == ((psa_key_type_t) 0x2000) ? 1u << (((slot->attr.type) >> 8) & 7) : 0u) : (slot->attr.type) == ((psa_key_type_t) 0x2004) && (alg) == ((psa_algorithm_t) 0x04800100) ? 12u : (alg) == ((psa_algorithm_t) 0x04c01300) ? 13u : 0u)) {
        status = ((psa_status_t)-135);
        goto exit;
    }

    status = psa_crypto_local_input_alloc(input_external, input_length, &LOCAL_INPUT_COPY_OF_input_external); if (status != ((psa_status_t)0)) { goto exit; } input = LOCAL_INPUT_COPY_OF_input_external.buffer;;
    status = psa_crypto_local_output_alloc(output_external, output_size, &LOCAL_OUTPUT_COPY_OF_output_external); if (status != ((psa_status_t)0)) { goto exit; } output = LOCAL_OUTPUT_COPY_OF_output_external.buffer;;

    status = psa_driver_wrapper_cipher_decrypt(
        &slot->attr, slot->key.data, slot->key.bytes,
        alg, input, input_length,
        output, output_size, output_length);

exit:
    unlock_status = psa_unregister_read_under_mutex(slot);
    if (unlock_status != ((psa_status_t)0)) {
        status = unlock_status;
    }





    mbedtls_ct_condition_t success =
        mbedtls_ct_bool_not(mbedtls_ct_bool(status));
    *output_length = mbedtls_ct_size_if_else_0(success, *output_length);

    input = 
# 4872 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 4872 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   ; psa_crypto_local_input_free(&LOCAL_INPUT_COPY_OF_input_external);;
    output = 
# 4873 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 4873 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   ; do { psa_status_t local_output_status; local_output_status = psa_crypto_local_output_free(&LOCAL_OUTPUT_COPY_OF_output_external); if (local_output_status != ((psa_status_t)0)) { status = local_output_status; } } while (0);

    return status;
}







static psa_algorithm_t psa_aead_get_base_algorithm(psa_algorithm_t alg)
{
    return ( (((alg) & ~(((psa_algorithm_t) 0x003f0000) | ((psa_algorithm_t) 0x00008000))) | ((0) << 16 & ((psa_algorithm_t) 0x003f0000))) == (((((psa_algorithm_t) 0x05500100)) & ~(((psa_algorithm_t) 0x003f0000) | ((psa_algorithm_t) 0x00008000))) | ((0) << 16 & ((psa_algorithm_t) 0x003f0000))) ? ((psa_algorithm_t) 0x05500100) : (((alg) & ~(((psa_algorithm_t) 0x003f0000) | ((psa_algorithm_t) 0x00008000))) | ((0) << 16 & ((psa_algorithm_t) 0x003f0000))) == (((((psa_algorithm_t) 0x05500200)) & ~(((psa_algorithm_t) 0x003f0000) | ((psa_algorithm_t) 0x00008000))) | ((0) << 16 & ((psa_algorithm_t) 0x003f0000))) ? ((psa_algorithm_t) 0x05500200) : (((alg) & ~(((psa_algorithm_t) 0x003f0000) | ((psa_algorithm_t) 0x00008000))) | ((0) << 16 & ((psa_algorithm_t) 0x003f0000))) == (((((psa_algorithm_t) 0x05100500)) & ~(((psa_algorithm_t) 0x003f0000) | ((psa_algorithm_t) 0x00008000))) | ((0) << 16 & ((psa_algorithm_t) 0x003f0000))) ? ((psa_algorithm_t) 0x05100500) : 0);
}


static psa_status_t psa_aead_check_nonce_length(psa_algorithm_t alg,
                                                size_t nonce_length)
{
    psa_algorithm_t base_alg = psa_aead_get_base_algorithm(alg);

    switch (base_alg) {

        case ((psa_algorithm_t) 0x05500200):






            if (nonce_length != 0) {
                return ((psa_status_t)0);
            }
            break;


        case ((psa_algorithm_t) 0x05500100):
            if (nonce_length >= 7 && nonce_length <= 13) {
                return ((psa_status_t)0);
            }
            break;
# 4925 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
        default:
            (void) nonce_length;
            return ((psa_status_t)-134);
    }

    return ((psa_status_t)-135);
}

static psa_status_t psa_aead_check_algorithm(psa_algorithm_t alg)
{
    if (!(((alg) & ((psa_algorithm_t) 0x7f000000)) == ((psa_algorithm_t) 0x05000000)) || (((((((alg) & ~((psa_algorithm_t) 0x000000ff)) == ((psa_algorithm_t) 0x06000300)) || (((alg) & ~((psa_algorithm_t) 0x000000ff)) == ((psa_algorithm_t) 0x06001300))) || (((alg) & ~((psa_algorithm_t) 0x000000ff)) == ((psa_algorithm_t) 0x06000200)) || (((alg) & ~((psa_algorithm_t) 0x000000ff) & ~((psa_algorithm_t) 0x00000100)) == ((psa_algorithm_t) 0x06000600)) || (((alg) & ~((psa_algorithm_t) 0x000000ff)) == ((psa_algorithm_t) 0x06000900)) || (((alg) & ~((psa_algorithm_t) 0x000000ff) & ~((psa_algorithm_t) 0x00000100)) == ((psa_algorithm_t) 0x06000400))) && ((alg) & ((psa_algorithm_t) 0x000000ff)) != 0) ? (((((((alg) & ~((psa_algorithm_t) 0x000000ff)) == ((psa_algorithm_t) 0x06000300)) || (((alg) & ~((psa_algorithm_t) 0x000000ff)) == ((psa_algorithm_t) 0x06001300))) || (((alg) & ~((psa_algorithm_t) 0x000000ff)) == ((psa_algorithm_t) 0x06000200)) || (((alg) & ~((psa_algorithm_t) 0x000000ff) & ~((psa_algorithm_t) 0x00000100)) == ((psa_algorithm_t) 0x06000600)) || (((alg) & ~((psa_algorithm_t) 0x000000ff)) == ((psa_algorithm_t) 0x06000900)) || (((alg) & ~((psa_algorithm_t) 0x000000ff) & ~((psa_algorithm_t) 0x00000100)) == ((psa_algorithm_t) 0x06000400))) && ((alg) & ((psa_algorithm_t) 0x000000ff)) != 0) ? ((alg) & ((psa_algorithm_t) 0x000000ff)) | ((psa_algorithm_t) 0x02000000) : 0) == ((psa_algorithm_t) 0x020000ff) : (((alg) & ((psa_algorithm_t) 0x7f000000)) == ((psa_algorithm_t) 0x03000000)) ? (alg & ((psa_algorithm_t) 0x00008000)) != 0 : (((alg) & ((psa_algorithm_t) 0x7f000000)) == ((psa_algorithm_t) 0x05000000)) ? (alg & ((psa_algorithm_t) 0x00008000)) != 0 : (alg) == ((psa_algorithm_t) 0x020000ff))) {
        return ((psa_status_t)-135);
    }

    return ((psa_status_t)0);
}

psa_status_t psa_aead_encrypt(mbedtls_svc_key_id_t key,
                              psa_algorithm_t alg,
                              const uint8_t *nonce_external,
                              size_t nonce_length,
                              const uint8_t *additional_data_external,
                              size_t additional_data_length,
                              const uint8_t *plaintext_external,
                              size_t plaintext_length,
                              uint8_t *ciphertext_external,
                              size_t ciphertext_size,
                              size_t *ciphertext_length)
{
    psa_status_t status = ((psa_status_t)-151);
    psa_key_slot_t *slot;

    psa_crypto_local_input_t LOCAL_INPUT_COPY_OF_nonce_external = ((psa_crypto_local_input_t) { 
# 4957 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 4957 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   , 0 }); const uint8_t *nonce = 
# 4957 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 4957 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   ;;
    psa_crypto_local_input_t LOCAL_INPUT_COPY_OF_additional_data_external = ((psa_crypto_local_input_t) { 
# 4958 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 4958 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   , 0 }); const uint8_t *additional_data = 
# 4958 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 4958 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   ;;
    psa_crypto_local_input_t LOCAL_INPUT_COPY_OF_plaintext_external = ((psa_crypto_local_input_t) { 
# 4959 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 4959 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   , 0 }); const uint8_t *plaintext = 
# 4959 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 4959 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   ;;
    psa_crypto_local_output_t LOCAL_OUTPUT_COPY_OF_ciphertext_external = ((psa_crypto_local_output_t) { 
# 4960 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 4960 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   , 
# 4960 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 4960 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   , 0 }); uint8_t *ciphertext = 
# 4960 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 4960 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   ;;

    *ciphertext_length = 0;

    status = psa_aead_check_algorithm(alg);
    if (status != ((psa_status_t)0)) {
        return status;
    }

    status = psa_get_and_lock_key_slot_with_policy(
        key, &slot, ((psa_key_usage_t) 0x00000100), alg);
    if (status != ((psa_status_t)0)) {
        return status;
    }

    status = psa_crypto_local_input_alloc(nonce_external, nonce_length, &LOCAL_INPUT_COPY_OF_nonce_external); if (status != ((psa_status_t)0)) { goto exit; } nonce = LOCAL_INPUT_COPY_OF_nonce_external.buffer;;
    status = psa_crypto_local_input_alloc(additional_data_external, additional_data_length, &LOCAL_INPUT_COPY_OF_additional_data_external); if (status != ((psa_status_t)0)) { goto exit; } additional_data = LOCAL_INPUT_COPY_OF_additional_data_external.buffer;;
    status = psa_crypto_local_input_alloc(plaintext_external, plaintext_length, &LOCAL_INPUT_COPY_OF_plaintext_external); if (status != ((psa_status_t)0)) { goto exit; } plaintext = LOCAL_INPUT_COPY_OF_plaintext_external.buffer;;
    status = psa_crypto_local_output_alloc(ciphertext_external, ciphertext_size, &LOCAL_OUTPUT_COPY_OF_ciphertext_external); if (status != ((psa_status_t)0)) { goto exit; } ciphertext = LOCAL_OUTPUT_COPY_OF_ciphertext_external.buffer;;

    status = psa_aead_check_nonce_length(alg, nonce_length);
    if (status != ((psa_status_t)0)) {
        goto exit;
    }

    status = psa_driver_wrapper_aead_encrypt(
        &slot->attr, slot->key.data, slot->key.bytes,
        alg,
        nonce, nonce_length,
        additional_data, additional_data_length,
        plaintext, plaintext_length,
        ciphertext, ciphertext_size, ciphertext_length);

    if (status != ((psa_status_t)0) && ciphertext_size != 0) {
        memset(ciphertext, 0, ciphertext_size);
    }

exit:
    nonce = 
# 4998 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 4998 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   ; psa_crypto_local_input_free(&LOCAL_INPUT_COPY_OF_nonce_external);;
    additional_data = 
# 4999 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 4999 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   ; psa_crypto_local_input_free(&LOCAL_INPUT_COPY_OF_additional_data_external);;
    plaintext = 
# 5000 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 5000 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   ; psa_crypto_local_input_free(&LOCAL_INPUT_COPY_OF_plaintext_external);;
    ciphertext = 
# 5001 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 5001 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   ; do { psa_status_t local_output_status; local_output_status = psa_crypto_local_output_free(&LOCAL_OUTPUT_COPY_OF_ciphertext_external); if (local_output_status != ((psa_status_t)0)) { status = local_output_status; } } while (0);

    psa_unregister_read_under_mutex(slot);

    return status;
}

psa_status_t psa_aead_decrypt(mbedtls_svc_key_id_t key,
                              psa_algorithm_t alg,
                              const uint8_t *nonce_external,
                              size_t nonce_length,
                              const uint8_t *additional_data_external,
                              size_t additional_data_length,
                              const uint8_t *ciphertext_external,
                              size_t ciphertext_length,
                              uint8_t *plaintext_external,
                              size_t plaintext_size,
                              size_t *plaintext_length)
{
    psa_status_t status = ((psa_status_t)-151);
    psa_key_slot_t *slot;

    psa_crypto_local_input_t LOCAL_INPUT_COPY_OF_nonce_external = ((psa_crypto_local_input_t) { 
# 5023 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 5023 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   , 0 }); const uint8_t *nonce = 
# 5023 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 5023 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   ;;
    psa_crypto_local_input_t LOCAL_INPUT_COPY_OF_additional_data_external = ((psa_crypto_local_input_t) { 
# 5024 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 5024 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   , 0 }); const uint8_t *additional_data = 
# 5024 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 5024 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   ;;
    psa_crypto_local_input_t LOCAL_INPUT_COPY_OF_ciphertext_external = ((psa_crypto_local_input_t) { 
# 5025 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 5025 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   , 0 }); const uint8_t *ciphertext = 
# 5025 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 5025 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   ;;
    psa_crypto_local_output_t LOCAL_OUTPUT_COPY_OF_plaintext_external = ((psa_crypto_local_output_t) { 
# 5026 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 5026 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   , 
# 5026 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 5026 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   , 0 }); uint8_t *plaintext = 
# 5026 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 5026 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   ;;

    *plaintext_length = 0;

    status = psa_aead_check_algorithm(alg);
    if (status != ((psa_status_t)0)) {
        return status;
    }

    status = psa_get_and_lock_key_slot_with_policy(
        key, &slot, ((psa_key_usage_t) 0x00000200), alg);
    if (status != ((psa_status_t)0)) {
        return status;
    }

    status = psa_crypto_local_input_alloc(nonce_external, nonce_length, &LOCAL_INPUT_COPY_OF_nonce_external); if (status != ((psa_status_t)0)) { goto exit; } nonce = LOCAL_INPUT_COPY_OF_nonce_external.buffer;;
    status = psa_crypto_local_input_alloc(additional_data_external, additional_data_length, &LOCAL_INPUT_COPY_OF_additional_data_external); if (status != ((psa_status_t)0)) { goto exit; } additional_data = LOCAL_INPUT_COPY_OF_additional_data_external.buffer;
                                      ;
    status = psa_crypto_local_input_alloc(ciphertext_external, ciphertext_length, &LOCAL_INPUT_COPY_OF_ciphertext_external); if (status != ((psa_status_t)0)) { goto exit; } ciphertext = LOCAL_INPUT_COPY_OF_ciphertext_external.buffer;;
    status = psa_crypto_local_output_alloc(plaintext_external, plaintext_size, &LOCAL_OUTPUT_COPY_OF_plaintext_external); if (status != ((psa_status_t)0)) { goto exit; } plaintext = LOCAL_OUTPUT_COPY_OF_plaintext_external.buffer;;

    status = psa_aead_check_nonce_length(alg, nonce_length);
    if (status != ((psa_status_t)0)) {
        goto exit;
    }

    status = psa_driver_wrapper_aead_decrypt(
        &slot->attr, slot->key.data, slot->key.bytes,
        alg,
        nonce, nonce_length,
        additional_data, additional_data_length,
        ciphertext, ciphertext_length,
        plaintext, plaintext_size, plaintext_length);

    if (status != ((psa_status_t)0) && plaintext_size != 0) {
        memset(plaintext, 0, plaintext_size);
    }

exit:
    nonce = 
# 5065 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 5065 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   ; psa_crypto_local_input_free(&LOCAL_INPUT_COPY_OF_nonce_external);;
    additional_data = 
# 5066 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 5066 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   ; psa_crypto_local_input_free(&LOCAL_INPUT_COPY_OF_additional_data_external);;
    ciphertext = 
# 5067 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 5067 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   ; psa_crypto_local_input_free(&LOCAL_INPUT_COPY_OF_ciphertext_external);;
    plaintext = 
# 5068 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 5068 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   ; do { psa_status_t local_output_status; local_output_status = psa_crypto_local_output_free(&LOCAL_OUTPUT_COPY_OF_plaintext_external); if (local_output_status != ((psa_status_t)0)) { status = local_output_status; } } while (0);

    psa_unregister_read_under_mutex(slot);

    return status;
}

static psa_status_t psa_validate_tag_length(psa_algorithm_t alg)
{
    const uint8_t tag_len = (((alg) & ((psa_algorithm_t) 0x003f0000)) >> 16);

    switch ((((alg) & ~(((psa_algorithm_t) 0x003f0000) | ((psa_algorithm_t) 0x00008000))) | ((0) << 16 & ((psa_algorithm_t) 0x003f0000)))) {

        case (((((psa_algorithm_t) 0x05500100)) & ~(((psa_algorithm_t) 0x003f0000) | ((psa_algorithm_t) 0x00008000))) | ((0) << 16 & ((psa_algorithm_t) 0x003f0000))):

            if (tag_len < 4 || tag_len > 16 || tag_len % 2) {
                return ((psa_status_t)-135);
            }
            break;



        case (((((psa_algorithm_t) 0x05500200)) & ~(((psa_algorithm_t) 0x003f0000) | ((psa_algorithm_t) 0x00008000))) | ((0) << 16 & ((psa_algorithm_t) 0x003f0000))):

            if (tag_len != 4 && tag_len != 8 && (tag_len < 12 || tag_len > 16)) {
                return ((psa_status_t)-135);
            }
            break;
# 5107 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
        default:
            (void) tag_len;
            return ((psa_status_t)-134);
    }
    return ((psa_status_t)0);
}


static psa_status_t psa_aead_setup(psa_aead_operation_t *operation,
                                   int is_encrypt,
                                   mbedtls_svc_key_id_t key,
                                   psa_algorithm_t alg)
{
    psa_status_t status = ((psa_status_t)-151);
    psa_status_t unlock_status = ((psa_status_t)-151);
    psa_key_slot_t *slot = 
# 5122 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
                          ((void *)0)
# 5122 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
                              ;
    psa_key_usage_t key_usage = 0;

    status = psa_aead_check_algorithm(alg);
    if (status != ((psa_status_t)0)) {
        goto exit;
    }

    if (operation->id != 0) {
        status = ((psa_status_t)-137);
        goto exit;
    }

    if (operation->nonce_set || operation->lengths_set ||
        operation->ad_started || operation->body_started) {
        status = ((psa_status_t)-137);
        goto exit;
    }






    memset(&operation->ctx, 0, sizeof(operation->ctx));

    if (is_encrypt) {
        key_usage = ((psa_key_usage_t) 0x00000100);
    } else {
        key_usage = ((psa_key_usage_t) 0x00000200);
    }

    status = psa_get_and_lock_key_slot_with_policy(key, &slot, key_usage,
                                                   alg);
    if (status != ((psa_status_t)0)) {
        goto exit;
    }

    if ((status = psa_validate_tag_length(alg)) != ((psa_status_t)0)) {
        goto exit;
    }

    if (is_encrypt) {
        status = psa_driver_wrapper_aead_encrypt_setup(operation,
                                                       &slot->attr,
                                                       slot->key.data,
                                                       slot->key.bytes,
                                                       alg);
    } else {
        status = psa_driver_wrapper_aead_decrypt_setup(operation,
                                                       &slot->attr,
                                                       slot->key.data,
                                                       slot->key.bytes,
                                                       alg);
    }
    if (status != ((psa_status_t)0)) {
        goto exit;
    }

    operation->key_type = psa_get_key_type(&slot->attr);

exit:
    unlock_status = psa_unregister_read_under_mutex(slot);

    if (status == ((psa_status_t)0)) {
        status = unlock_status;
        operation->alg = psa_aead_get_base_algorithm(alg);
        operation->is_encrypt = is_encrypt;
    } else {
        psa_aead_abort(operation);
    }

    return status;
}


psa_status_t psa_aead_encrypt_setup(psa_aead_operation_t *operation,
                                    mbedtls_svc_key_id_t key,
                                    psa_algorithm_t alg)
{
    return psa_aead_setup(operation, 1, key, alg);
}


psa_status_t psa_aead_decrypt_setup(psa_aead_operation_t *operation,
                                    mbedtls_svc_key_id_t key,
                                    psa_algorithm_t alg)
{
    return psa_aead_setup(operation, 0, key, alg);
}

static psa_status_t psa_aead_set_nonce_internal(psa_aead_operation_t *operation,
                                                const uint8_t *nonce,
                                                size_t nonce_length)
{
    psa_status_t status = ((psa_status_t)-151);

    if (operation->id == 0) {
        status = ((psa_status_t)-137);
        goto exit;
    }

    if (operation->nonce_set) {
        status = ((psa_status_t)-137);
        goto exit;
    }

    status = psa_aead_check_nonce_length(operation->alg, nonce_length);
    if (status != ((psa_status_t)0)) {
        status = ((psa_status_t)-135);
        goto exit;
    }

    status = psa_driver_wrapper_aead_set_nonce(operation, nonce,
                                               nonce_length);

exit:
    if (status == ((psa_status_t)0)) {
        operation->nonce_set = 1;
    } else {
        psa_aead_abort(operation);
    }

    return status;
}


psa_status_t psa_aead_generate_nonce(psa_aead_operation_t *operation,
                                     uint8_t *nonce_external,
                                     size_t nonce_size,
                                     size_t *nonce_length)
{
    psa_status_t status = ((psa_status_t)-151);
    uint8_t local_nonce[13u];
    size_t required_nonce_size = 0;

    psa_crypto_local_output_t LOCAL_OUTPUT_COPY_OF_nonce_external = ((psa_crypto_local_output_t) { 
# 5258 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 5258 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   , 
# 5258 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 5258 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   , 0 }); uint8_t *nonce = 
# 5258 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 5258 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   ;;
    status = psa_crypto_local_output_alloc(nonce_external, nonce_size, &LOCAL_OUTPUT_COPY_OF_nonce_external); if (status != ((psa_status_t)0)) { goto exit; } nonce = LOCAL_OUTPUT_COPY_OF_nonce_external.buffer;;

    *nonce_length = 0;

    if (operation->id == 0) {
        status = ((psa_status_t)-137);
        goto exit;
    }

    if (operation->nonce_set || !operation->is_encrypt) {
        status = ((psa_status_t)-137);
        goto exit;
    }
# 5282 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
    required_nonce_size = ((((operation->key_type) & ((psa_key_type_t) 0x7000)) == ((psa_key_type_t) 0x2000) ? 1u << (((operation->key_type) >> 8) & 7) : 0u) == 16 ? (!(((operation->alg) ^ (((psa_algorithm_t) 0x05500100))) & ~(((psa_algorithm_t) 0x003f0000) | ((psa_algorithm_t) 0x00008000)))) ? 13u : (!(((operation->alg) ^ (((psa_algorithm_t) 0x05500200))) & ~(((psa_algorithm_t) 0x003f0000) | ((psa_algorithm_t) 0x00008000)))) ? 12u : 0u : (operation->key_type) == ((psa_key_type_t) 0x2004) && (!(((operation->alg) ^ (((psa_algorithm_t) 0x05100500))) & ~(((psa_algorithm_t) 0x003f0000) | ((psa_algorithm_t) 0x00008000)))) ? 12u : 0u)
                                                               ;
    if (nonce_size < required_nonce_size) {
        status = ((psa_status_t)-138);
        goto exit;
    }

    status = psa_generate_random_internal(local_nonce, required_nonce_size);
    if (status != ((psa_status_t)0)) {
        goto exit;
    }

    status = psa_aead_set_nonce_internal(operation, local_nonce,
                                         required_nonce_size);

exit:
    if (status == ((psa_status_t)0)) {
        memcpy(nonce, local_nonce, required_nonce_size);
        *nonce_length = required_nonce_size;
    } else {
        psa_aead_abort(operation);
    }

    nonce = 
# 5305 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 5305 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   ; do { psa_status_t local_output_status; local_output_status = psa_crypto_local_output_free(&LOCAL_OUTPUT_COPY_OF_nonce_external); if (local_output_status != ((psa_status_t)0)) { status = local_output_status; } } while (0);

    return status;
}



psa_status_t psa_aead_set_nonce(psa_aead_operation_t *operation,
                                const uint8_t *nonce_external,
                                size_t nonce_length)
{
    psa_status_t status;

    psa_crypto_local_input_t LOCAL_INPUT_COPY_OF_nonce_external = ((psa_crypto_local_input_t) { 
# 5318 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 5318 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   , 0 }); const uint8_t *nonce = 
# 5318 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 5318 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   ;;
    status = psa_crypto_local_input_alloc(nonce_external, nonce_length, &LOCAL_INPUT_COPY_OF_nonce_external); if (status != ((psa_status_t)0)) { goto exit; } nonce = LOCAL_INPUT_COPY_OF_nonce_external.buffer;;

    status = psa_aead_set_nonce_internal(operation, nonce, nonce_length);



exit:


    nonce = 
# 5328 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 5328 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   ; psa_crypto_local_input_free(&LOCAL_INPUT_COPY_OF_nonce_external);;

    return status;
}


psa_status_t psa_aead_set_lengths(psa_aead_operation_t *operation,
                                  size_t ad_length,
                                  size_t plaintext_length)
{
    psa_status_t status = ((psa_status_t)-151);

    if (operation->id == 0) {
        status = ((psa_status_t)-137);
        goto exit;
    }

    if (operation->lengths_set || operation->ad_started ||
        operation->body_started) {
        status = ((psa_status_t)-137);
        goto exit;
    }

    switch (operation->alg) {

        case ((psa_algorithm_t) 0x05500200):
# 5364 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
            break;


        case ((psa_algorithm_t) 0x05500100):
            if (ad_length > 0xFF00) {
                status = ((psa_status_t)-135);
                goto exit;
            }
            break;






        default:
            break;
    }

    status = psa_driver_wrapper_aead_set_lengths(operation, ad_length,
                                                 plaintext_length);

exit:
    if (status == ((psa_status_t)0)) {
        operation->ad_remaining = ad_length;
        operation->body_remaining = plaintext_length;
        operation->lengths_set = 1;
    } else {
        psa_aead_abort(operation);
    }

    return status;
}


psa_status_t psa_aead_update_ad(psa_aead_operation_t *operation,
                                const uint8_t *input_external,
                                size_t input_length)
{
    psa_status_t status = ((psa_status_t)-151);

    psa_crypto_local_input_t LOCAL_INPUT_COPY_OF_input_external = ((psa_crypto_local_input_t) { 
# 5405 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 5405 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   , 0 }); const uint8_t *input = 
# 5405 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 5405 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   ;;
    status = psa_crypto_local_input_alloc(input_external, input_length, &LOCAL_INPUT_COPY_OF_input_external); if (status != ((psa_status_t)0)) { goto exit; } input = LOCAL_INPUT_COPY_OF_input_external.buffer;;

    if (operation->id == 0) {
        status = ((psa_status_t)-137);
        goto exit;
    }

    if (!operation->nonce_set || operation->body_started) {
        status = ((psa_status_t)-137);
        goto exit;
    }


    if (input_length == 0) {
        status = ((psa_status_t)0);
        goto exit;
    }

    if (operation->lengths_set) {
        if (operation->ad_remaining < input_length) {
            status = ((psa_status_t)-135);
            goto exit;
        }

        operation->ad_remaining -= input_length;
    }

    else if (operation->alg == ((psa_algorithm_t) 0x05500100)) {
        status = ((psa_status_t)-137);
        goto exit;
    }


    status = psa_driver_wrapper_aead_update_ad(operation, input,
                                               input_length);

exit:
    if (status == ((psa_status_t)0)) {
        operation->ad_started = 1;
    } else {
        psa_aead_abort(operation);
    }

    input = 
# 5449 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 5449 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   ; psa_crypto_local_input_free(&LOCAL_INPUT_COPY_OF_input_external);;

    return status;
}



psa_status_t psa_aead_update(psa_aead_operation_t *operation,
                             const uint8_t *input_external,
                             size_t input_length,
                             uint8_t *output_external,
                             size_t output_size,
                             size_t *output_length)
{
    psa_status_t status = ((psa_status_t)-151);


    psa_crypto_local_input_t LOCAL_INPUT_COPY_OF_input_external = ((psa_crypto_local_input_t) { 
# 5466 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 5466 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   , 0 }); const uint8_t *input = 
# 5466 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 5466 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   ;;
    psa_crypto_local_output_t LOCAL_OUTPUT_COPY_OF_output_external = ((psa_crypto_local_output_t) { 
# 5467 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 5467 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   , 
# 5467 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 5467 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   , 0 }); uint8_t *output = 
# 5467 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 5467 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   ;;

    status = psa_crypto_local_input_alloc(input_external, input_length, &LOCAL_INPUT_COPY_OF_input_external); if (status != ((psa_status_t)0)) { goto exit; } input = LOCAL_INPUT_COPY_OF_input_external.buffer;;
    status = psa_crypto_local_output_alloc(output_external, output_size, &LOCAL_OUTPUT_COPY_OF_output_external); if (status != ((psa_status_t)0)) { goto exit; } output = LOCAL_OUTPUT_COPY_OF_output_external.buffer;;

    *output_length = 0;

    if (operation->id == 0) {
        status = ((psa_status_t)-137);
        goto exit;
    }

    if (!operation->nonce_set) {
        status = ((psa_status_t)-137);
        goto exit;
    }

    if (operation->lengths_set) {


        if (operation->ad_remaining != 0) {
            status = ((psa_status_t)-135);
            goto exit;
        }


        if (operation->body_remaining < input_length) {
            status = ((psa_status_t)-135);
            goto exit;
        }

        operation->body_remaining -= input_length;
    }

    else if (operation->alg == ((psa_algorithm_t) 0x05500100)) {
        status = ((psa_status_t)-137);
        goto exit;
    }


    status = psa_driver_wrapper_aead_update(operation, input, input_length,
                                            output, output_size,
                                            output_length);

exit:
    if (status == ((psa_status_t)0)) {
        operation->body_started = 1;
    } else {
        psa_aead_abort(operation);
    }

    input = 
# 5518 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 5518 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   ; psa_crypto_local_input_free(&LOCAL_INPUT_COPY_OF_input_external);;
    output = 
# 5519 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 5519 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   ; do { psa_status_t local_output_status; local_output_status = psa_crypto_local_output_free(&LOCAL_OUTPUT_COPY_OF_output_external); if (local_output_status != ((psa_status_t)0)) { status = local_output_status; } } while (0);

    return status;
}

static psa_status_t psa_aead_final_checks(const psa_aead_operation_t *operation)
{
    if (operation->id == 0 || !operation->nonce_set) {
        return ((psa_status_t)-137);
    }

    if (operation->lengths_set && (operation->ad_remaining != 0 ||
                                   operation->body_remaining != 0)) {
        return ((psa_status_t)-135);
    }

    return ((psa_status_t)0);
}


psa_status_t psa_aead_finish(psa_aead_operation_t *operation,
                             uint8_t *ciphertext_external,
                             size_t ciphertext_size,
                             size_t *ciphertext_length,
                             uint8_t *tag_external,
                             size_t tag_size,
                             size_t *tag_length)
{
    psa_status_t status = ((psa_status_t)-151);

    psa_crypto_local_output_t LOCAL_OUTPUT_COPY_OF_ciphertext_external = ((psa_crypto_local_output_t) { 
# 5549 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 5549 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   , 
# 5549 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 5549 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   , 0 }); uint8_t *ciphertext = 
# 5549 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 5549 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   ;;
    psa_crypto_local_output_t LOCAL_OUTPUT_COPY_OF_tag_external = ((psa_crypto_local_output_t) { 
# 5550 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 5550 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   , 
# 5550 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 5550 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   , 0 }); uint8_t *tag = 
# 5550 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 5550 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   ;;

    status = psa_crypto_local_output_alloc(ciphertext_external, ciphertext_size, &LOCAL_OUTPUT_COPY_OF_ciphertext_external); if (status != ((psa_status_t)0)) { goto exit; } ciphertext = LOCAL_OUTPUT_COPY_OF_ciphertext_external.buffer;;
    status = psa_crypto_local_output_alloc(tag_external, tag_size, &LOCAL_OUTPUT_COPY_OF_tag_external); if (status != ((psa_status_t)0)) { goto exit; } tag = LOCAL_OUTPUT_COPY_OF_tag_external.buffer;;

    *ciphertext_length = 0;
    *tag_length = tag_size;

    status = psa_aead_final_checks(operation);
    if (status != ((psa_status_t)0)) {
        goto exit;
    }

    if (!operation->is_encrypt) {
        status = ((psa_status_t)-137);
        goto exit;
    }

    status = psa_driver_wrapper_aead_finish(operation, ciphertext,
                                            ciphertext_size,
                                            ciphertext_length,
                                            tag, tag_size, tag_length);

exit:







    psa_wipe_tag_output_buffer(tag, status, tag_size, *tag_length);

    psa_aead_abort(operation);

    ciphertext = 
# 5585 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 5585 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   ; do { psa_status_t local_output_status; local_output_status = psa_crypto_local_output_free(&LOCAL_OUTPUT_COPY_OF_ciphertext_external); if (local_output_status != ((psa_status_t)0)) { status = local_output_status; } } while (0);
    tag = 
# 5586 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 5586 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   ; do { psa_status_t local_output_status; local_output_status = psa_crypto_local_output_free(&LOCAL_OUTPUT_COPY_OF_tag_external); if (local_output_status != ((psa_status_t)0)) { status = local_output_status; } } while (0);

    return status;
}



psa_status_t psa_aead_verify(psa_aead_operation_t *operation,
                             uint8_t *plaintext_external,
                             size_t plaintext_size,
                             size_t *plaintext_length,
                             const uint8_t *tag_external,
                             size_t tag_length)
{
    psa_status_t status = ((psa_status_t)-151);

    psa_crypto_local_output_t LOCAL_OUTPUT_COPY_OF_plaintext_external = ((psa_crypto_local_output_t) { 
# 5602 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 5602 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   , 
# 5602 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 5602 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   , 0 }); uint8_t *plaintext = 
# 5602 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 5602 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   ;;
    psa_crypto_local_input_t LOCAL_INPUT_COPY_OF_tag_external = ((psa_crypto_local_input_t) { 
# 5603 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 5603 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   , 0 }); const uint8_t *tag = 
# 5603 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 5603 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   ;;

    status = psa_crypto_local_output_alloc(plaintext_external, plaintext_size, &LOCAL_OUTPUT_COPY_OF_plaintext_external); if (status != ((psa_status_t)0)) { goto exit; } plaintext = LOCAL_OUTPUT_COPY_OF_plaintext_external.buffer;;
    status = psa_crypto_local_input_alloc(tag_external, tag_length, &LOCAL_INPUT_COPY_OF_tag_external); if (status != ((psa_status_t)0)) { goto exit; } tag = LOCAL_INPUT_COPY_OF_tag_external.buffer;;

    *plaintext_length = 0;

    status = psa_aead_final_checks(operation);
    if (status != ((psa_status_t)0)) {
        goto exit;
    }

    if (operation->is_encrypt) {
        status = ((psa_status_t)-137);
        goto exit;
    }

    status = psa_driver_wrapper_aead_verify(operation, plaintext,
                                            plaintext_size,
                                            plaintext_length,
                                            tag, tag_length);

exit:
    psa_aead_abort(operation);

    plaintext = 
# 5628 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 5628 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   ; do { psa_status_t local_output_status; local_output_status = psa_crypto_local_output_free(&LOCAL_OUTPUT_COPY_OF_plaintext_external); if (local_output_status != ((psa_status_t)0)) { status = local_output_status; } } while (0);
    tag = 
# 5629 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 5629 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   ; psa_crypto_local_input_free(&LOCAL_INPUT_COPY_OF_tag_external);;

    return status;
}


psa_status_t psa_aead_abort(psa_aead_operation_t *operation)
{
    psa_status_t status = ((psa_status_t)-151);

    if (operation->id == 0) {



        return ((psa_status_t)0);
    }

    status = psa_driver_wrapper_aead_abort(operation);

    memset(operation, 0, sizeof(*operation));

    return status;
}
# 5679 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
static psa_status_t psa_key_derivation_start_hmac(
    psa_mac_operation_t *operation,
    psa_algorithm_t hash_alg,
    const uint8_t *hmac_key,
    size_t hmac_key_length)
{
    psa_status_t status = ((psa_status_t)-151);
    psa_key_attributes_t attributes = { ((psa_key_type_t) 0x0000), 0, ((psa_key_lifetime_t) 0x00000000), { 0, 0, 0 }, ((psa_key_id_t) 0) };
    psa_set_key_type(&attributes, ((psa_key_type_t) 0x1100));
    psa_set_key_bits(&attributes, ((hmac_key_length) * 8u));
    psa_set_key_usage_flags(&attributes, ((psa_key_usage_t) 0x00001000));







    memset(operation, 0, sizeof(*operation));

    operation->is_sign = 1;
    operation->mac_size = ( (((psa_algorithm_t) 0x02000000) | ((hash_alg) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000003) ? 16u : (((psa_algorithm_t) 0x02000000) | ((hash_alg) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000004) ? 20u : (((psa_algorithm_t) 0x02000000) | ((hash_alg) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000005) ? 20u : (((psa_algorithm_t) 0x02000000) | ((hash_alg) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000008) ? 28u : (((psa_algorithm_t) 0x02000000) | ((hash_alg) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000009) ? 32u : (((psa_algorithm_t) 0x02000000) | ((hash_alg) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x0200000a) ? 48u : (((psa_algorithm_t) 0x02000000) | ((hash_alg) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x0200000b) ? 64u : (((psa_algorithm_t) 0x02000000) | ((hash_alg) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x0200000c) ? 28u : (((psa_algorithm_t) 0x02000000) | ((hash_alg) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x0200000d) ? 32u : (((psa_algorithm_t) 0x02000000) | ((hash_alg) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000010) ? 28u : (((psa_algorithm_t) 0x02000000) | ((hash_alg) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000011) ? 32u : (((psa_algorithm_t) 0x02000000) | ((hash_alg) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000012) ? 48u : (((psa_algorithm_t) 0x02000000) | ((hash_alg) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000013) ? 64u : 0u);

    status = psa_driver_wrapper_mac_sign_setup(operation,
                                               &attributes,
                                               hmac_key, hmac_key_length,
                                               (((psa_algorithm_t) 0x03800000) | ((hash_alg) & ((psa_algorithm_t) 0x000000ff))));

    psa_reset_key_attributes(&attributes);
    return status;
}







static psa_algorithm_t psa_key_derivation_get_kdf_alg(
    const psa_key_derivation_operation_t *operation)
{
    if ((((operation->alg) & ((psa_algorithm_t) 0x7f000000)) == ((psa_algorithm_t) 0x09000000))) {
        return (((operation->alg) & ((psa_algorithm_t) 0xfe00ffff)) | ((psa_algorithm_t) 0x08000000));
    } else {
        return operation->alg;
    }
}

psa_status_t psa_key_derivation_abort(psa_key_derivation_operation_t *operation)
{
    psa_status_t status = ((psa_status_t)0);
    psa_algorithm_t kdf_alg = psa_key_derivation_get_kdf_alg(operation);
    if (kdf_alg == 0) {



    } else

    if ((((kdf_alg) & ~((psa_algorithm_t) 0x000000ff)) == ((psa_algorithm_t) 0x08000100) || ((kdf_alg) & ~((psa_algorithm_t) 0x000000ff)) == ((psa_algorithm_t) 0x08000400) || ((kdf_alg) & ~((psa_algorithm_t) 0x000000ff)) == ((psa_algorithm_t) 0x08000500))) {
        free(operation->ctx.hkdf.info);
        status = psa_mac_abort(&operation->ctx.hkdf.hmac);
    } else



    if ((((kdf_alg) & ~((psa_algorithm_t) 0x000000ff)) == ((psa_algorithm_t) 0x08000200)) ||

        (((kdf_alg) & ~((psa_algorithm_t) 0x000000ff)) == ((psa_algorithm_t) 0x08000300))) {
        if (operation->ctx.tls12_prf.secret != 
# 5747 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
                                              ((void *)0)
# 5747 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
                                                  ) {
            mbedtls_zeroize_and_free(operation->ctx.tls12_prf.secret,
                                     operation->ctx.tls12_prf.secret_length);
        }

        if (operation->ctx.tls12_prf.seed != 
# 5752 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
                                            ((void *)0)
# 5752 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
                                                ) {
            mbedtls_zeroize_and_free(operation->ctx.tls12_prf.seed,
                                     operation->ctx.tls12_prf.seed_length);
        }

        if (operation->ctx.tls12_prf.label != 
# 5757 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
                                             ((void *)0)
# 5757 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
                                                 ) {
            mbedtls_zeroize_and_free(operation->ctx.tls12_prf.label,
                                     operation->ctx.tls12_prf.label_length);
        }

        if (operation->ctx.tls12_prf.other_secret != 
# 5762 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
                                                    ((void *)0)
# 5762 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
                                                        ) {
            mbedtls_zeroize_and_free(operation->ctx.tls12_prf.other_secret,
                                     operation->ctx.tls12_prf.other_secret_length);
        }

        status = ((psa_status_t)0);



    } else



    if (kdf_alg == ((psa_algorithm_t) 0x08000609)) {
        mbedtls_platform_zeroize(operation->ctx.tls12_ecjpake_to_pms.data,
                                 sizeof(operation->ctx.tls12_ecjpake_to_pms.data));
    } else


    if (((((kdf_alg) & ~((psa_algorithm_t) 0x000000ff)) == ((psa_algorithm_t) 0x08800100)) || ((kdf_alg) == ((psa_algorithm_t) 0x08800200)))) {
        if (operation->ctx.pbkdf2.salt != 
# 5782 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
                                         ((void *)0)
# 5782 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
                                             ) {
            mbedtls_zeroize_and_free(operation->ctx.pbkdf2.salt,
                                     operation->ctx.pbkdf2.salt_length);
        }

        status = ((psa_status_t)0);
    } else

    {
        status = ((psa_status_t)-137);
    }
    mbedtls_platform_zeroize(operation, sizeof(*operation));
    return status;
}

psa_status_t psa_key_derivation_get_capacity(const psa_key_derivation_operation_t *operation,
                                             size_t *capacity)
{
    if (operation->alg == 0) {

        return ((psa_status_t)-137);
    }

    *capacity = operation->capacity;
    return ((psa_status_t)0);
}

psa_status_t psa_key_derivation_set_capacity(psa_key_derivation_operation_t *operation,
                                             size_t capacity)
{
    if (operation->alg == 0) {
        return ((psa_status_t)-137);
    }
    if (capacity > operation->capacity) {
        return ((psa_status_t)-135);
    }
    operation->capacity = capacity;
    return ((psa_status_t)0);
}



static psa_status_t psa_key_derivation_hkdf_read(psa_hkdf_key_derivation_t *hkdf,
                                                 psa_algorithm_t kdf_alg,
                                                 uint8_t *output,
                                                 size_t output_length)
{
    psa_algorithm_t hash_alg = (((psa_algorithm_t) 0x02000000) | ((kdf_alg) & ((psa_algorithm_t) 0x000000ff)));
    uint8_t hash_length = ( (((psa_algorithm_t) 0x02000000) | ((hash_alg) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000003) ? 16u : (((psa_algorithm_t) 0x02000000) | ((hash_alg) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000004) ? 20u : (((psa_algorithm_t) 0x02000000) | ((hash_alg) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000005) ? 20u : (((psa_algorithm_t) 0x02000000) | ((hash_alg) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000008) ? 28u : (((psa_algorithm_t) 0x02000000) | ((hash_alg) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000009) ? 32u : (((psa_algorithm_t) 0x02000000) | ((hash_alg) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x0200000a) ? 48u : (((psa_algorithm_t) 0x02000000) | ((hash_alg) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x0200000b) ? 64u : (((psa_algorithm_t) 0x02000000) | ((hash_alg) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x0200000c) ? 28u : (((psa_algorithm_t) 0x02000000) | ((hash_alg) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x0200000d) ? 32u : (((psa_algorithm_t) 0x02000000) | ((hash_alg) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000010) ? 28u : (((psa_algorithm_t) 0x02000000) | ((hash_alg) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000011) ? 32u : (((psa_algorithm_t) 0x02000000) | ((hash_alg) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000012) ? 48u : (((psa_algorithm_t) 0x02000000) | ((hash_alg) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000013) ? 64u : 0u);
    size_t hmac_output_length;
    psa_status_t status;

    const uint8_t last_block = (((kdf_alg) & ~((psa_algorithm_t) 0x000000ff)) == ((psa_algorithm_t) 0x08000400)) ? 0 : 0xff;




    if (hkdf->state < 2 ||
        (!hkdf->info_set

         && !(((kdf_alg) & ~((psa_algorithm_t) 0x000000ff)) == ((psa_algorithm_t) 0x08000400))

        )) {
        return ((psa_status_t)-137);
    }
    hkdf->state = 3;

    while (output_length != 0) {

        uint8_t n = hash_length - hkdf->offset_in_block;
        if (n > output_length) {
            n = (uint8_t) output_length;
        }
        memcpy(output, hkdf->output_block + hkdf->offset_in_block, n);
        output += n;
        output_length -= n;
        hkdf->offset_in_block += n;
        if (output_length == 0) {
            break;
        }





        if (hkdf->block_number == last_block) {
            return ((psa_status_t)-137);
        }


        ++hkdf->block_number;
        hkdf->offset_in_block = 0;

        status = psa_key_derivation_start_hmac(&hkdf->hmac,
                                               hash_alg,
                                               hkdf->prk,
                                               hash_length);
        if (status != ((psa_status_t)0)) {
            return status;
        }

        if (hkdf->block_number != 1) {
            status = psa_mac_update(&hkdf->hmac,
                                    hkdf->output_block,
                                    hash_length);
            if (status != ((psa_status_t)0)) {
                return status;
            }
        }
        status = psa_mac_update(&hkdf->hmac,
                                hkdf->info,
                                hkdf->info_length);
        if (status != ((psa_status_t)0)) {
            return status;
        }
        status = psa_mac_update(&hkdf->hmac,
                                &hkdf->block_number, 1);
        if (status != ((psa_status_t)0)) {
            return status;
        }
        status = psa_mac_sign_finish(&hkdf->hmac,
                                     hkdf->output_block,
                                     sizeof(hkdf->output_block),
                                     &hmac_output_length);
        if (status != ((psa_status_t)0)) {
            return status;
        }
    }

    return ((psa_status_t)0);
}




static psa_status_t psa_key_derivation_tls12_prf_generate_next_block(
    psa_tls12_prf_key_derivation_t *tls12_prf,
    psa_algorithm_t alg)
{
    psa_algorithm_t hash_alg = (((psa_algorithm_t) 0x02000000) | ((alg) & ((psa_algorithm_t) 0x000000ff)));
    uint8_t hash_length = ( (((psa_algorithm_t) 0x02000000) | ((hash_alg) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000003) ? 16u : (((psa_algorithm_t) 0x02000000) | ((hash_alg) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000004) ? 20u : (((psa_algorithm_t) 0x02000000) | ((hash_alg) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000005) ? 20u : (((psa_algorithm_t) 0x02000000) | ((hash_alg) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000008) ? 28u : (((psa_algorithm_t) 0x02000000) | ((hash_alg) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000009) ? 32u : (((psa_algorithm_t) 0x02000000) | ((hash_alg) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x0200000a) ? 48u : (((psa_algorithm_t) 0x02000000) | ((hash_alg) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x0200000b) ? 64u : (((psa_algorithm_t) 0x02000000) | ((hash_alg) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x0200000c) ? 28u : (((psa_algorithm_t) 0x02000000) | ((hash_alg) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x0200000d) ? 32u : (((psa_algorithm_t) 0x02000000) | ((hash_alg) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000010) ? 28u : (((psa_algorithm_t) 0x02000000) | ((hash_alg) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000011) ? 32u : (((psa_algorithm_t) 0x02000000) | ((hash_alg) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000012) ? 48u : (((psa_algorithm_t) 0x02000000) | ((hash_alg) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000013) ? 64u : 0u);
    psa_mac_operation_t hmac;
    size_t hmac_output_length;
    psa_status_t status, cleanup_status;






    if (tls12_prf->block_number == 0xff) {
        return ((psa_status_t)-151);
    }


    ++tls12_prf->block_number;
    tls12_prf->left_in_block = hash_length;
# 5957 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
    status = psa_key_derivation_start_hmac(&hmac,
                                           hash_alg,
                                           tls12_prf->secret,
                                           tls12_prf->secret_length);
    if (status != ((psa_status_t)0)) {
        goto cleanup;
    }


    if (tls12_prf->block_number == 1) {



        status = psa_mac_update(&hmac,
                                tls12_prf->label,
                                tls12_prf->label_length);
        if (status != ((psa_status_t)0)) {
            goto cleanup;
        }
        status = psa_mac_update(&hmac,
                                tls12_prf->seed,
                                tls12_prf->seed_length);
        if (status != ((psa_status_t)0)) {
            goto cleanup;
        }
    } else {

        status = psa_mac_update(&hmac, tls12_prf->Ai, hash_length);
        if (status != ((psa_status_t)0)) {
            goto cleanup;
        }
    }

    status = psa_mac_sign_finish(&hmac,
                                 tls12_prf->Ai, hash_length,
                                 &hmac_output_length);
    if (hmac_output_length != hash_length) {
        status = ((psa_status_t)-151);
    }
    if (status != ((psa_status_t)0)) {
        goto cleanup;
    }


    status = psa_key_derivation_start_hmac(&hmac,
                                           hash_alg,
                                           tls12_prf->secret,
                                           tls12_prf->secret_length);
    if (status != ((psa_status_t)0)) {
        goto cleanup;
    }
    status = psa_mac_update(&hmac, tls12_prf->Ai, hash_length);
    if (status != ((psa_status_t)0)) {
        goto cleanup;
    }
    status = psa_mac_update(&hmac, tls12_prf->label, tls12_prf->label_length);
    if (status != ((psa_status_t)0)) {
        goto cleanup;
    }
    status = psa_mac_update(&hmac, tls12_prf->seed, tls12_prf->seed_length);
    if (status != ((psa_status_t)0)) {
        goto cleanup;
    }
    status = psa_mac_sign_finish(&hmac,
                                 tls12_prf->output_block, hash_length,
                                 &hmac_output_length);
    if (status != ((psa_status_t)0)) {
        goto cleanup;
    }


cleanup:
    cleanup_status = psa_mac_abort(&hmac);
    if (status == ((psa_status_t)0) && cleanup_status != ((psa_status_t)0)) {
        status = cleanup_status;
    }

    return status;
}

static psa_status_t psa_key_derivation_tls12_prf_read(
    psa_tls12_prf_key_derivation_t *tls12_prf,
    psa_algorithm_t alg,
    uint8_t *output,
    size_t output_length)
{
    psa_algorithm_t hash_alg = (((psa_algorithm_t) 0x02000000) | ((alg) & ((psa_algorithm_t) 0x000000ff)));
    uint8_t hash_length = ( (((psa_algorithm_t) 0x02000000) | ((hash_alg) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000003) ? 16u : (((psa_algorithm_t) 0x02000000) | ((hash_alg) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000004) ? 20u : (((psa_algorithm_t) 0x02000000) | ((hash_alg) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000005) ? 20u : (((psa_algorithm_t) 0x02000000) | ((hash_alg) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000008) ? 28u : (((psa_algorithm_t) 0x02000000) | ((hash_alg) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000009) ? 32u : (((psa_algorithm_t) 0x02000000) | ((hash_alg) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x0200000a) ? 48u : (((psa_algorithm_t) 0x02000000) | ((hash_alg) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x0200000b) ? 64u : (((psa_algorithm_t) 0x02000000) | ((hash_alg) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x0200000c) ? 28u : (((psa_algorithm_t) 0x02000000) | ((hash_alg) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x0200000d) ? 32u : (((psa_algorithm_t) 0x02000000) | ((hash_alg) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000010) ? 28u : (((psa_algorithm_t) 0x02000000) | ((hash_alg) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000011) ? 32u : (((psa_algorithm_t) 0x02000000) | ((hash_alg) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000012) ? 48u : (((psa_algorithm_t) 0x02000000) | ((hash_alg) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000013) ? 64u : 0u);
    psa_status_t status;
    uint8_t offset, length;

    switch (tls12_prf->state) {
        case PSA_TLS12_PRF_STATE_LABEL_SET:
            tls12_prf->state = PSA_TLS12_PRF_STATE_OUTPUT;
            break;
        case PSA_TLS12_PRF_STATE_OUTPUT:
            break;
        default:
            return ((psa_status_t)-137);
    }

    while (output_length != 0) {

        if (tls12_prf->left_in_block == 0) {
            status = psa_key_derivation_tls12_prf_generate_next_block(tls12_prf,
                                                                      alg);
            if (status != ((psa_status_t)0)) {
                return status;
            }

            continue;
        }

        if (tls12_prf->left_in_block > output_length) {
            length = (uint8_t) output_length;
        } else {
            length = tls12_prf->left_in_block;
        }

        offset = hash_length - tls12_prf->left_in_block;
        memcpy(output, tls12_prf->output_block + offset, length);
        output += length;
        output_length -= length;
        tls12_prf->left_in_block -= length;
    }

    return ((psa_status_t)0);
}




static psa_status_t psa_key_derivation_tls12_ecjpake_to_pms_read(
    psa_tls12_ecjpake_to_pms_t *ecjpake,
    uint8_t *output,
    size_t output_length)
{
    psa_status_t status = ((psa_status_t)-151);
    size_t output_size = 0;

    if (output_length != 32) {
        return ((psa_status_t)-135);
    }

    status = psa_hash_compute(((psa_algorithm_t) 0x02000009), ecjpake->data,
                              32u, output, output_length,
                              &output_size);
    if (status != ((psa_status_t)0)) {
        return status;
    }

    if (output_size != output_length) {
        return ((psa_status_t)-132);
    }

    return ((psa_status_t)0);
}



static psa_status_t psa_key_derivation_pbkdf2_generate_block(
    psa_pbkdf2_key_derivation_t *pbkdf2,
    psa_algorithm_t prf_alg,
    uint8_t prf_output_length,
    psa_key_attributes_t *attributes)
{
    psa_status_t status;
    psa_mac_operation_t mac_operation;






    memset(&mac_operation, 0, sizeof(mac_operation));
    size_t mac_output_length;
    uint8_t U_i[64u];
    uint8_t *U_accumulator = pbkdf2->output_block;
    uint64_t i;
    uint8_t block_counter[4];

    mac_operation.is_sign = 1;
    mac_operation.mac_size = prf_output_length;
    { if (0) { mbedtls_put_unaligned_uint32((block_counter) + (0), (uint32_t) (pbkdf2->block_number)); } else { mbedtls_put_unaligned_uint32((block_counter) + (0), __builtin_bswap32((uint32_t) (pbkdf2->block_number))); } };

    status = psa_driver_wrapper_mac_sign_setup(&mac_operation,
                                               attributes,
                                               pbkdf2->password,
                                               pbkdf2->password_length,
                                               prf_alg);
    if (status != ((psa_status_t)0)) {
        goto cleanup;
    }
    status = psa_mac_update(&mac_operation, pbkdf2->salt, pbkdf2->salt_length);
    if (status != ((psa_status_t)0)) {
        goto cleanup;
    }
    status = psa_mac_update(&mac_operation, block_counter, sizeof(block_counter));
    if (status != ((psa_status_t)0)) {
        goto cleanup;
    }
    status = psa_mac_sign_finish(&mac_operation, U_i, sizeof(U_i),
                                 &mac_output_length);
    if (status != ((psa_status_t)0)) {
        goto cleanup;
    }

    if (mac_output_length != prf_output_length) {
        status = ((psa_status_t)-151);
        goto cleanup;
    }

    memcpy(U_accumulator, U_i, prf_output_length);

    for (i = 1; i < pbkdf2->input_cost; i++) {



        status = psa_driver_wrapper_mac_compute(attributes,
                                                pbkdf2->password,
                                                pbkdf2->password_length,
                                                prf_alg, U_i, prf_output_length,
                                                U_i, prf_output_length,
                                                &mac_output_length);
        if (status != ((psa_status_t)0)) {
            goto cleanup;
        }

        mbedtls_xor(U_accumulator, U_accumulator, U_i, prf_output_length);
    }

cleanup:

    mbedtls_platform_zeroize(U_i, 64u);
    return status;
}

static psa_status_t psa_key_derivation_pbkdf2_read(
    psa_pbkdf2_key_derivation_t *pbkdf2,
    psa_algorithm_t kdf_alg,
    uint8_t *output,
    size_t output_length)
{
    psa_status_t status;
    psa_algorithm_t prf_alg;
    uint8_t prf_output_length;
    psa_key_attributes_t attributes = { ((psa_key_type_t) 0x0000), 0, ((psa_key_lifetime_t) 0x00000000), { 0, 0, 0 }, ((psa_key_id_t) 0) };
    psa_set_key_bits(&attributes, ((pbkdf2->password_length) * 8u));
    psa_set_key_usage_flags(&attributes, ((psa_key_usage_t) 0x00000400));

    if ((((kdf_alg) & ~((psa_algorithm_t) 0x000000ff)) == ((psa_algorithm_t) 0x08800100))) {
        prf_alg = (((psa_algorithm_t) 0x03800000) | (((((psa_algorithm_t) 0x02000000) | ((kdf_alg) & ((psa_algorithm_t) 0x000000ff)))) & ((psa_algorithm_t) 0x000000ff)));
        prf_output_length = ( (((psa_algorithm_t) 0x02000000) | ((prf_alg) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000003) ? 16u : (((psa_algorithm_t) 0x02000000) | ((prf_alg) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000004) ? 20u : (((psa_algorithm_t) 0x02000000) | ((prf_alg) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000005) ? 20u : (((psa_algorithm_t) 0x02000000) | ((prf_alg) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000008) ? 28u : (((psa_algorithm_t) 0x02000000) | ((prf_alg) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000009) ? 32u : (((psa_algorithm_t) 0x02000000) | ((prf_alg) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x0200000a) ? 48u : (((psa_algorithm_t) 0x02000000) | ((prf_alg) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x0200000b) ? 64u : (((psa_algorithm_t) 0x02000000) | ((prf_alg) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x0200000c) ? 28u : (((psa_algorithm_t) 0x02000000) | ((prf_alg) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x0200000d) ? 32u : (((psa_algorithm_t) 0x02000000) | ((prf_alg) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000010) ? 28u : (((psa_algorithm_t) 0x02000000) | ((prf_alg) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000011) ? 32u : (((psa_algorithm_t) 0x02000000) | ((prf_alg) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000012) ? 48u : (((psa_algorithm_t) 0x02000000) | ((prf_alg) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000013) ? 64u : 0u);
        psa_set_key_type(&attributes, ((psa_key_type_t) 0x1100));
    } else if (kdf_alg == ((psa_algorithm_t) 0x08800200)) {
        prf_alg = ((psa_algorithm_t) 0x03c00200);
        prf_output_length = ((((psa_algorithm_t) 0x03c00200)) & ((psa_algorithm_t) 0x003f0000) ? (((((psa_algorithm_t) 0x03c00200)) & ((psa_algorithm_t) 0x003f0000)) >> 16) : (((((psa_algorithm_t) 0x03c00200)) & (((psa_algorithm_t) 0x7f000000) | ((psa_algorithm_t) 0x00c00000))) == ((psa_algorithm_t) 0x03800000)) ? ( (((psa_algorithm_t) 0x02000000) | (((((psa_algorithm_t) 0x02000000) | ((((psa_algorithm_t) 0x03c00200)) & ((psa_algorithm_t) 0x000000ff)))) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000003) ? 16u : (((psa_algorithm_t) 0x02000000) | (((((psa_algorithm_t) 0x02000000) | ((((psa_algorithm_t) 0x03c00200)) & ((psa_algorithm_t) 0x000000ff)))) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000004) ? 20u : (((psa_algorithm_t) 0x02000000) | (((((psa_algorithm_t) 0x02000000) | ((((psa_algorithm_t) 0x03c00200)) & ((psa_algorithm_t) 0x000000ff)))) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000005) ? 20u : (((psa_algorithm_t) 0x02000000) | (((((psa_algorithm_t) 0x02000000) | ((((psa_algorithm_t) 0x03c00200)) & ((psa_algorithm_t) 0x000000ff)))) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000008) ? 28u : (((psa_algorithm_t) 0x02000000) | (((((psa_algorithm_t) 0x02000000) | ((((psa_algorithm_t) 0x03c00200)) & ((psa_algorithm_t) 0x000000ff)))) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000009) ? 32u : (((psa_algorithm_t) 0x02000000) | (((((psa_algorithm_t) 0x02000000) | ((((psa_algorithm_t) 0x03c00200)) & ((psa_algorithm_t) 0x000000ff)))) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x0200000a) ? 48u : (((psa_algorithm_t) 0x02000000) | (((((psa_algorithm_t) 0x02000000) | ((((psa_algorithm_t) 0x03c00200)) & ((psa_algorithm_t) 0x000000ff)))) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x0200000b) ? 64u : (((psa_algorithm_t) 0x02000000) | (((((psa_algorithm_t) 0x02000000) | ((((psa_algorithm_t) 0x03c00200)) & ((psa_algorithm_t) 0x000000ff)))) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x0200000c) ? 28u : (((psa_algorithm_t) 0x02000000) | (((((psa_algorithm_t) 0x02000000) | ((((psa_algorithm_t) 0x03c00200)) & ((psa_algorithm_t) 0x000000ff)))) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x0200000d) ? 32u : (((psa_algorithm_t) 0x02000000) | (((((psa_algorithm_t) 0x02000000) | ((((psa_algorithm_t) 0x03c00200)) & ((psa_algorithm_t) 0x000000ff)))) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000010) ? 28u : (((psa_algorithm_t) 0x02000000) | (((((psa_algorithm_t) 0x02000000) | ((((psa_algorithm_t) 0x03c00200)) & ((psa_algorithm_t) 0x000000ff)))) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000011) ? 32u : (((psa_algorithm_t) 0x02000000) | (((((psa_algorithm_t) 0x02000000) | ((((psa_algorithm_t) 0x03c00200)) & ((psa_algorithm_t) 0x000000ff)))) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000012) ? 48u : (((psa_algorithm_t) 0x02000000) | (((((psa_algorithm_t) 0x02000000) | ((((psa_algorithm_t) 0x03c00200)) & ((psa_algorithm_t) 0x000000ff)))) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000013) ? 64u : 0u) : (((((psa_algorithm_t) 0x03c00200)) & (((psa_algorithm_t) 0x7f000000) | ((psa_algorithm_t) 0x00c00000))) == ((psa_algorithm_t) 0x03c00000)) ? (((((psa_key_type_t) 0x2400)) & ((psa_key_type_t) 0x7000)) == ((psa_key_type_t) 0x2000) ? 1u << (((((psa_key_type_t) 0x2400)) >> 8) & 7) : 0u) : ((void) (((psa_key_type_t) 0x2400)), (void) (128U), 0u));
        psa_set_key_type(&attributes, ((psa_key_type_t) 0x2400));
    } else {
        return ((psa_status_t)-135);
    }

    switch (pbkdf2->state) {
        case PSA_PBKDF2_STATE_PASSWORD_SET:

            pbkdf2->bytes_used = prf_output_length;
            pbkdf2->state = PSA_PBKDF2_STATE_OUTPUT;
            break;
        case PSA_PBKDF2_STATE_OUTPUT:
            break;
        default:
            return ((psa_status_t)-137);
    }

    while (output_length != 0) {
        uint8_t n = prf_output_length - pbkdf2->bytes_used;
        if (n > output_length) {
            n = (uint8_t) output_length;
        }
        memcpy(output, pbkdf2->output_block + pbkdf2->bytes_used, n);
        output += n;
        output_length -= n;
        pbkdf2->bytes_used += n;

        if (output_length == 0) {
            break;
        }


        pbkdf2->bytes_used = 0;
        pbkdf2->block_number++;

        status = psa_key_derivation_pbkdf2_generate_block(pbkdf2, prf_alg,
                                                          prf_output_length,
                                                          &attributes);
        if (status != ((psa_status_t)0)) {
            return status;
        }
    }

    return ((psa_status_t)0);
}


psa_status_t psa_key_derivation_output_bytes(
    psa_key_derivation_operation_t *operation,
    uint8_t *output_external,
    size_t output_length)
{
    psa_status_t status;
    psa_crypto_local_output_t LOCAL_OUTPUT_COPY_OF_output_external = ((psa_crypto_local_output_t) { 
# 6267 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 6267 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   , 
# 6267 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 6267 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   , 0 }); uint8_t *output = 
# 6267 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 6267 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   ;;

    psa_algorithm_t kdf_alg = psa_key_derivation_get_kdf_alg(operation);

    if (operation->alg == 0) {

        return ((psa_status_t)-137);
    }

    if (output_length == 0 && operation->capacity == 0) {






        return ((psa_status_t)-143);
    }

    status = psa_crypto_local_output_alloc(output_external, output_length, &LOCAL_OUTPUT_COPY_OF_output_external); if (status != ((psa_status_t)0)) { goto exit; } output = LOCAL_OUTPUT_COPY_OF_output_external.buffer;;
    if (output_length > operation->capacity) {
        operation->capacity = 0;


        status = ((psa_status_t)-143);
        goto exit;
    }

    operation->capacity -= output_length;


    if ((((kdf_alg) & ~((psa_algorithm_t) 0x000000ff)) == ((psa_algorithm_t) 0x08000100) || ((kdf_alg) & ~((psa_algorithm_t) 0x000000ff)) == ((psa_algorithm_t) 0x08000400) || ((kdf_alg) & ~((psa_algorithm_t) 0x000000ff)) == ((psa_algorithm_t) 0x08000500))) {
        status = psa_key_derivation_hkdf_read(&operation->ctx.hkdf, kdf_alg,
                                              output, output_length);
    } else



    if ((((kdf_alg) & ~((psa_algorithm_t) 0x000000ff)) == ((psa_algorithm_t) 0x08000200)) ||
        (((kdf_alg) & ~((psa_algorithm_t) 0x000000ff)) == ((psa_algorithm_t) 0x08000300))) {
        status = psa_key_derivation_tls12_prf_read(&operation->ctx.tls12_prf,
                                                   kdf_alg, output,
                                                   output_length);
    } else



    if (kdf_alg == ((psa_algorithm_t) 0x08000609)) {
        status = psa_key_derivation_tls12_ecjpake_to_pms_read(
            &operation->ctx.tls12_ecjpake_to_pms, output, output_length);
    } else


    if (((((kdf_alg) & ~((psa_algorithm_t) 0x000000ff)) == ((psa_algorithm_t) 0x08800100)) || ((kdf_alg) == ((psa_algorithm_t) 0x08800200)))) {
        status = psa_key_derivation_pbkdf2_read(&operation->ctx.pbkdf2, kdf_alg,
                                                output, output_length);
    } else


    {
        (void) kdf_alg;
        status = ((psa_status_t)-137);
        output = 
# 6329 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
       ((void *)0)
# 6329 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
       ; do { psa_status_t local_output_status; local_output_status = psa_crypto_local_output_free(&LOCAL_OUTPUT_COPY_OF_output_external); if (local_output_status != ((psa_status_t)0)) { status = local_output_status; } } while (0);

        return status;
    }

exit:
    if (status != ((psa_status_t)0)) {




        psa_algorithm_t alg = operation->alg;
        psa_key_derivation_abort(operation);
        operation->alg = alg;
        if (output != 
# 6343 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
                     ((void *)0)
# 6343 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
                         ) {
            memset(output, '!', output_length);
        }
    }

    output = 
# 6348 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 6348 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   ; do { psa_status_t local_output_status; local_output_status = psa_crypto_local_output_free(&LOCAL_OUTPUT_COPY_OF_output_external); if (local_output_status != ((psa_status_t)0)) { status = local_output_status; } } while (0);
    return status;
}


static void psa_des_set_key_parity(uint8_t *data, size_t data_size)
{
    if (data_size >= 8) {
        mbedtls_des_key_set_parity(data);
    }
    if (data_size >= 16) {
        mbedtls_des_key_set_parity(data + 8);
    }
    if (data_size >= 24) {
        mbedtls_des_key_set_parity(data + 16);
    }
}
# 6398 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
static psa_status_t psa_generate_derived_ecc_key_weierstrass_helper(
    psa_key_slot_t *slot,
    size_t bits,
    psa_key_derivation_operation_t *operation,
    uint8_t **data
    )
{
    unsigned key_out_of_range = 1;
    mbedtls_mpi k;
    mbedtls_mpi diff_N_2;
    int ret = -0x006E;
    psa_status_t status = ((psa_status_t)-151);
    size_t m;
    size_t m_bytes = 0;

    mbedtls_mpi_init(&k);
    mbedtls_mpi_init(&diff_N_2);

    psa_ecc_family_t curve = ((psa_ecc_family_t) (((((slot->attr.type) & ~((psa_key_type_t) 0x3000)) & ~((psa_key_type_t) 0x00ff)) == ((psa_key_type_t) 0x4100)) ? ((slot->attr.type) & ((psa_key_type_t) 0x00ff)) : 0))
                        ;
    mbedtls_ecp_group_id grp_id =
        mbedtls_ecc_group_from_psa(curve, bits);

    if (grp_id == MBEDTLS_ECP_DP_NONE) {
        ret = -0x0068;
        goto cleanup;
    }

    mbedtls_ecp_group ecp_group;
    mbedtls_ecp_group_init(&ecp_group);

    do { if ((ret = (mbedtls_ecp_group_load(&ecp_group, grp_id))) != 0) goto cleanup; } while (0);



    m = ecp_group.nbits;

    m_bytes = (((m) + 7u) / 8u);


    do { if ((ret = (mbedtls_mpi_sub_int(&diff_N_2, &ecp_group.N, 2))) != 0) goto cleanup; } while (0);



    *data = calloc(1, m_bytes);
    if (*data == 
# 6443 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
                ((void *)0)
# 6443 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
                    ) {
        ret = -0x006A;
        goto cleanup;
    }

    while (key_out_of_range) {

        if ((status = psa_key_derivation_output_bytes(operation, *data, m_bytes)) != 0) {
            goto cleanup;
        }


        if (m % 8 != 0) {




            uint8_t clear_bit_mask = (1 << (m % 8)) - 1;
            (*data)[0] &= clear_bit_mask;
        }




        do { if ((ret = (mbedtls_mpi_read_binary(&k, *data, m_bytes))) != 0) goto cleanup; } while (0);





        do { if ((ret = (mbedtls_mpi_lt_mpi_ct(&diff_N_2, &k, &key_out_of_range))) != 0) goto cleanup; } while (0);
    }


    do { if ((ret = (mbedtls_mpi_add_int(&k, &k, 1))) != 0) goto cleanup; } while (0);
    do { if ((ret = (mbedtls_mpi_write_binary(&k, *data, m_bytes))) != 0) goto cleanup; } while (0);
cleanup:
    if (ret != 0) {
        status = mbedtls_to_psa_error(ret);
    }
    if (status != ((psa_status_t)0)) {
        mbedtls_zeroize_and_free(*data, m_bytes);
        *data = 
# 6485 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
               ((void *)0)
# 6485 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
                   ;
    }
    mbedtls_mpi_free(&k);
    mbedtls_mpi_free(&diff_N_2);
    return status;
}
# 6506 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
static psa_status_t psa_generate_derived_ecc_key_montgomery_helper(
    size_t bits,
    psa_key_derivation_operation_t *operation,
    uint8_t **data
    )
{
    size_t output_length;
    psa_status_t status = ((psa_status_t)-151);

    switch (bits) {
        case 255:
            output_length = 32;
            break;
        case 448:
            output_length = 56;
            break;
        default:
            return ((psa_status_t)-135);
            break;
    }

    *data = calloc(1, output_length);

    if (*data == 
# 6529 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
                ((void *)0)
# 6529 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
                    ) {
        return ((psa_status_t)-141);
    }

    status = psa_key_derivation_output_bytes(operation, *data, output_length);

    if (status != ((psa_status_t)0)) {
        return status;
    }

    switch (bits) {
        case 255:
            (*data)[0] &= 248;
            (*data)[31] &= 127;
            (*data)[31] |= 64;
            break;
        case 448:
            (*data)[0] &= 252;
            (*data)[55] |= 128;
            break;
        default:
            return ((psa_status_t)-151);
            break;
    }

    return status;
}
# 6579 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
static psa_status_t psa_generate_derived_key_internal(
    psa_key_slot_t *slot,
    size_t bits,
    psa_key_derivation_operation_t *operation)
{
    uint8_t *data = 
# 6584 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
                   ((void *)0)
# 6584 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
                       ;
    size_t bytes = (((bits) + 7u) / 8u);
    size_t storage_size = bytes;
    psa_status_t status = ((psa_status_t)-151);

    if ((((slot->attr.type) & ((psa_key_type_t) 0x7000)) == ((psa_key_type_t) 0x4000))) {
        return ((psa_status_t)-135);
    }



    if (((((slot->attr.type) & ~((psa_key_type_t) 0x3000)) & ~((psa_key_type_t) 0x00ff)) == ((psa_key_type_t) 0x4100))) {
        psa_ecc_family_t curve = ((psa_ecc_family_t) (((((slot->attr.type) & ~((psa_key_type_t) 0x3000)) & ~((psa_key_type_t) 0x00ff)) == ((psa_key_type_t) 0x4100)) ? ((slot->attr.type) & ((psa_key_type_t) 0x00ff)) : 0));
        if (((curve & 0xc0) == 0)) {

            status = psa_generate_derived_ecc_key_weierstrass_helper(slot, bits, operation, &data);
            if (status != ((psa_status_t)0)) {
                goto exit;
            }
        } else {

            status = psa_generate_derived_ecc_key_montgomery_helper(bits, operation, &data);
            if (status != ((psa_status_t)0)) {
                goto exit;
            }
        }
    } else


    if (key_type_is_raw_bytes(slot->attr.type)) {
        if (bits % 8 != 0) {
            return ((psa_status_t)-135);
        }
        data = calloc(1, bytes);
        if (data == 
# 6618 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
                   ((void *)0)
# 6618 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
                       ) {
            return ((psa_status_t)-141);
        }

        status = psa_key_derivation_output_bytes(operation, data, bytes);
        if (status != ((psa_status_t)0)) {
            goto exit;
        }

        if (slot->attr.type == ((psa_key_type_t) 0x2301)) {
            psa_des_set_key_parity(data, bytes);
        }

    } else {
        return ((psa_status_t)-134);
    }

    slot->attr.bits = (psa_key_bits_t) bits;

    if (psa_key_lifetime_is_external(slot->attr.lifetime)) {
        status = psa_driver_wrapper_get_key_buffer_size(&slot->attr,
                                                        &storage_size);
        if (status != ((psa_status_t)0)) {
            goto exit;
        }
    }
    status = psa_allocate_buffer_to_slot(slot, storage_size);
    if (status != ((psa_status_t)0)) {
        goto exit;
    }

    status = psa_driver_wrapper_import_key(&slot->attr,
                                           data, bytes,
                                           slot->key.data,
                                           slot->key.bytes,
                                           &slot->key.bytes, &bits);
    if (bits != slot->attr.bits) {
        status = ((psa_status_t)-135);
    }

exit:
    mbedtls_zeroize_and_free(data, bytes);
    return status;
}

static const psa_custom_key_parameters_t default_custom_production =
    { 0 };

int psa_custom_key_parameters_are_default(
    const psa_custom_key_parameters_t *custom,
    size_t custom_data_length)
{
    if (custom->flags != 0) {
        return 0;
    }
    if (custom_data_length != 0) {
        return 0;
    }
    return 1;
}

psa_status_t psa_key_derivation_output_key_custom(
    const psa_key_attributes_t *attributes,
    psa_key_derivation_operation_t *operation,
    const psa_custom_key_parameters_t *custom,
    const uint8_t *custom_data,
    size_t custom_data_length,
    mbedtls_svc_key_id_t *key)
{
    psa_status_t status;
    psa_key_slot_t *slot = 
# 6688 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
                          ((void *)0)
# 6688 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
                              ;
    psa_se_drv_table_entry_t *driver = 
# 6689 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
                                      ((void *)0)
# 6689 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
                                          ;

    *key = ((psa_key_id_t) 0);



    if (psa_get_key_bits(attributes) == 0) {
        return ((psa_status_t)-135);
    }

    (void) custom_data;
    if (!psa_custom_key_parameters_are_default(custom, custom_data_length)) {
        return ((psa_status_t)-135);
    }

    if (operation->alg == ((psa_algorithm_t)0)) {
        return ((psa_status_t)-137);
    }

    if (!operation->can_output_key) {
        return ((psa_status_t)-133);
    }

    status = psa_start_key_creation(PSA_KEY_CREATION_DERIVE, attributes,
                                    &slot, &driver);






    if (status == ((psa_status_t)0)) {
        status = psa_generate_derived_key_internal(slot,
                                                   attributes->bits,
                                                   operation);
    }
    if (status == ((psa_status_t)0)) {
        status = psa_finish_key_creation(slot, driver, key);
    }
    if (status != ((psa_status_t)0)) {
        psa_fail_key_creation(slot, driver);
    }

    return status;
}

psa_status_t psa_key_derivation_output_key_ext(
    const psa_key_attributes_t *attributes,
    psa_key_derivation_operation_t *operation,
    const psa_key_production_parameters_t *params,
    size_t params_data_length,
    mbedtls_svc_key_id_t *key)
{
    return psa_key_derivation_output_key_custom(
        attributes, operation,
        (const psa_custom_key_parameters_t *) params,
        params->data, params_data_length,
        key);
}

psa_status_t psa_key_derivation_output_key(
    const psa_key_attributes_t *attributes,
    psa_key_derivation_operation_t *operation,
    mbedtls_svc_key_id_t *key)
{
    return psa_key_derivation_output_key_custom(attributes, operation,
                                                &default_custom_production,
                                                
# 6756 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
                                               ((void *)0)
# 6756 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
                                                   , 0,
                                                key);
}







static int is_kdf_alg_supported(psa_algorithm_t kdf_alg)
{

    if ((((kdf_alg) & ~((psa_algorithm_t) 0x000000ff)) == ((psa_algorithm_t) 0x08000100))) {
        return 1;
    }


    if ((((kdf_alg) & ~((psa_algorithm_t) 0x000000ff)) == ((psa_algorithm_t) 0x08000400))) {
        return 1;
    }


    if ((((kdf_alg) & ~((psa_algorithm_t) 0x000000ff)) == ((psa_algorithm_t) 0x08000500))) {
        return 1;
    }


    if ((((kdf_alg) & ~((psa_algorithm_t) 0x000000ff)) == ((psa_algorithm_t) 0x08000200))) {
        return 1;
    }


    if ((((kdf_alg) & ~((psa_algorithm_t) 0x000000ff)) == ((psa_algorithm_t) 0x08000300))) {
        return 1;
    }


    if (kdf_alg == ((psa_algorithm_t) 0x08000609)) {
        return 1;
    }


    if ((((kdf_alg) & ~((psa_algorithm_t) 0x000000ff)) == ((psa_algorithm_t) 0x08800100))) {
        return 1;
    }


    if (kdf_alg == ((psa_algorithm_t) 0x08800200)) {
        return 1;
    }

    return 0;
}

static psa_status_t psa_hash_try_support(psa_algorithm_t alg)
{
    psa_hash_operation_t operation = { 0, { 0 } };
    psa_status_t status = psa_hash_setup(&operation, alg);
    psa_hash_abort(&operation);
    return status;
}

static psa_status_t psa_key_derivation_set_maximum_capacity(
    psa_key_derivation_operation_t *operation,
    psa_algorithm_t kdf_alg)
{

    if (kdf_alg == ((psa_algorithm_t) 0x08000609)) {
        operation->capacity = ( (((psa_algorithm_t) 0x02000000) | ((((psa_algorithm_t) 0x02000009)) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000003) ? 16u : (((psa_algorithm_t) 0x02000000) | ((((psa_algorithm_t) 0x02000009)) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000004) ? 20u : (((psa_algorithm_t) 0x02000000) | ((((psa_algorithm_t) 0x02000009)) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000005) ? 20u : (((psa_algorithm_t) 0x02000000) | ((((psa_algorithm_t) 0x02000009)) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000008) ? 28u : (((psa_algorithm_t) 0x02000000) | ((((psa_algorithm_t) 0x02000009)) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000009) ? 32u : (((psa_algorithm_t) 0x02000000) | ((((psa_algorithm_t) 0x02000009)) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x0200000a) ? 48u : (((psa_algorithm_t) 0x02000000) | ((((psa_algorithm_t) 0x02000009)) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x0200000b) ? 64u : (((psa_algorithm_t) 0x02000000) | ((((psa_algorithm_t) 0x02000009)) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x0200000c) ? 28u : (((psa_algorithm_t) 0x02000000) | ((((psa_algorithm_t) 0x02000009)) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x0200000d) ? 32u : (((psa_algorithm_t) 0x02000000) | ((((psa_algorithm_t) 0x02000009)) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000010) ? 28u : (((psa_algorithm_t) 0x02000000) | ((((psa_algorithm_t) 0x02000009)) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000011) ? 32u : (((psa_algorithm_t) 0x02000000) | ((((psa_algorithm_t) 0x02000009)) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000012) ? 48u : (((psa_algorithm_t) 0x02000000) | ((((psa_algorithm_t) 0x02000009)) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000013) ? 64u : 0u);
        return ((psa_status_t)0);
    }


    if (kdf_alg == ((psa_algorithm_t) 0x08800200)) {






        operation->capacity = 0xffffffffU
# 6837 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
                                     ;

        return ((psa_status_t)0);
    }




    psa_algorithm_t hash_alg = (((kdf_alg) & 0x000000ff) == 0 ? ((psa_algorithm_t) 0) : 0x02000000 | ((kdf_alg) & 0x000000ff));
    size_t hash_size = ( (((psa_algorithm_t) 0x02000000) | ((hash_alg) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000003) ? 16u : (((psa_algorithm_t) 0x02000000) | ((hash_alg) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000004) ? 20u : (((psa_algorithm_t) 0x02000000) | ((hash_alg) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000005) ? 20u : (((psa_algorithm_t) 0x02000000) | ((hash_alg) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000008) ? 28u : (((psa_algorithm_t) 0x02000000) | ((hash_alg) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000009) ? 32u : (((psa_algorithm_t) 0x02000000) | ((hash_alg) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x0200000a) ? 48u : (((psa_algorithm_t) 0x02000000) | ((hash_alg) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x0200000b) ? 64u : (((psa_algorithm_t) 0x02000000) | ((hash_alg) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x0200000c) ? 28u : (((psa_algorithm_t) 0x02000000) | ((hash_alg) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x0200000d) ? 32u : (((psa_algorithm_t) 0x02000000) | ((hash_alg) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000010) ? 28u : (((psa_algorithm_t) 0x02000000) | ((hash_alg) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000011) ? 32u : (((psa_algorithm_t) 0x02000000) | ((hash_alg) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000012) ? 48u : (((psa_algorithm_t) 0x02000000) | ((hash_alg) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000013) ? 64u : 0u);
    if (hash_size == 0) {
        return ((psa_status_t)-134);
    }




    psa_status_t status = psa_hash_try_support(hash_alg);
    if (status != ((psa_status_t)0)) {
        return status;
    }


    if ((((kdf_alg) & ~((psa_algorithm_t) 0x000000ff)) == ((psa_algorithm_t) 0x08000100))) {
        operation->capacity = 255 * hash_size;
    } else


    if ((((kdf_alg) & ~((psa_algorithm_t) 0x000000ff)) == ((psa_algorithm_t) 0x08000400))) {
        operation->capacity = hash_size;
    } else


    if ((((kdf_alg) & ~((psa_algorithm_t) 0x000000ff)) == ((psa_algorithm_t) 0x08000500))) {
        operation->capacity = 255 * hash_size;
    } else


    if ((((kdf_alg) & ~((psa_algorithm_t) 0x000000ff)) == ((psa_algorithm_t) 0x08000200)) &&
        (hash_alg == ((psa_algorithm_t) 0x02000009) || hash_alg == ((psa_algorithm_t) 0x0200000a))) {
        operation->capacity = 0xffffffffU
# 6877 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
                                     ;
    } else


    if ((((kdf_alg) & ~((psa_algorithm_t) 0x000000ff)) == ((psa_algorithm_t) 0x08000300)) &&
        (hash_alg == ((psa_algorithm_t) 0x02000009) || hash_alg == ((psa_algorithm_t) 0x0200000a))) {


        operation->capacity = 48U;
    } else


    if ((((kdf_alg) & ~((psa_algorithm_t) 0x000000ff)) == ((psa_algorithm_t) 0x08800100))) {



        operation->capacity = 0xffffffffU
# 6893 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
                                     ;

    } else

    {
        (void) hash_size;
        status = ((psa_status_t)-134);
    }
    return status;
}

static psa_status_t psa_key_derivation_setup_kdf(
    psa_key_derivation_operation_t *operation,
    psa_algorithm_t kdf_alg)
{


    memset(&operation->ctx, 0, sizeof(operation->ctx));


    if (!is_kdf_alg_supported(kdf_alg)) {
        return ((psa_status_t)-134);
    }

    psa_status_t status = psa_key_derivation_set_maximum_capacity(operation,
                                                                  kdf_alg);
    return status;
}

static psa_status_t psa_key_agreement_try_support(psa_algorithm_t alg)
{

    if (alg == ((psa_algorithm_t) 0x09020000)) {
        return ((psa_status_t)0);
    }


    if (alg == ((psa_algorithm_t) 0x09010000)) {
        return ((psa_status_t)0);
    }

    (void) alg;
    return ((psa_status_t)-134);
}

static int psa_key_derivation_allows_free_form_secret_input(
    psa_algorithm_t kdf_alg)
{

    if (kdf_alg == ((psa_algorithm_t) 0x08000609)) {
        return 0;
    }

    (void) kdf_alg;
    return 1;
}


psa_status_t psa_key_derivation_setup(psa_key_derivation_operation_t *operation,
                                      psa_algorithm_t alg)
{
    psa_status_t status;

    if (operation->alg != 0) {
        return ((psa_status_t)-137);
    }

    if (((((alg) & ((psa_algorithm_t) 0x7f000000)) == ((psa_algorithm_t) 0x09000000)) && (((alg) & ((psa_algorithm_t) 0xfe00ffff)) | ((psa_algorithm_t) 0x08000000)) == ((psa_algorithm_t) 0x08000000))) {
        return ((psa_status_t)-135);
    } else if ((((alg) & ((psa_algorithm_t) 0x7f000000)) == ((psa_algorithm_t) 0x09000000))) {

        psa_algorithm_t kdf_alg = (((alg) & ((psa_algorithm_t) 0xfe00ffff)) | ((psa_algorithm_t) 0x08000000));
        psa_algorithm_t ka_alg = (((alg) & ((psa_algorithm_t) 0xffff0000)) | ((psa_algorithm_t) 0x09000000));
        status = psa_key_agreement_try_support(ka_alg);
        if (status != ((psa_status_t)0)) {
            return status;
        }
        if (!psa_key_derivation_allows_free_form_secret_input(kdf_alg)) {
            return ((psa_status_t)-135);
        }
        status = psa_key_derivation_setup_kdf(operation, kdf_alg);



    } else if ((((alg) & ((psa_algorithm_t) 0x7f000000)) == ((psa_algorithm_t) 0x08000000))) {

        status = psa_key_derivation_setup_kdf(operation, alg);



    } else {
        return ((psa_status_t)-135);
    }

    if (status == ((psa_status_t)0)) {
        operation->alg = alg;
    }
    return status;
}


static psa_status_t psa_hkdf_input(psa_hkdf_key_derivation_t *hkdf,
                                   psa_algorithm_t kdf_alg,
                                   psa_key_derivation_step_t step,
                                   const uint8_t *data,
                                   size_t data_length)
{
    psa_algorithm_t hash_alg = (((psa_algorithm_t) 0x02000000) | ((kdf_alg) & ((psa_algorithm_t) 0x000000ff)));
    psa_status_t status;
    switch (step) {
        case ((psa_key_derivation_step_t) 0x0202):

            if ((((kdf_alg) & ~((psa_algorithm_t) 0x000000ff)) == ((psa_algorithm_t) 0x08000500))) {
                return ((psa_status_t)-135);
            }

            if (hkdf->state != 0) {
                return ((psa_status_t)-137);
            } else {
                status = psa_key_derivation_start_hmac(&hkdf->hmac,
                                                       hash_alg,
                                                       data, data_length);
                if (status != ((psa_status_t)0)) {
                    return status;
                }
                hkdf->state = 1;
                return ((psa_status_t)0);
            }
        case ((psa_key_derivation_step_t) 0x0101):

            if ((((kdf_alg) & ~((psa_algorithm_t) 0x000000ff)) == ((psa_algorithm_t) 0x08000500))) {




                if (hkdf->state != 0) {
                    return ((psa_status_t)-137);
                }


                if (data_length != ( (((psa_algorithm_t) 0x02000000) | ((hash_alg) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000003) ? 16u : (((psa_algorithm_t) 0x02000000) | ((hash_alg) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000004) ? 20u : (((psa_algorithm_t) 0x02000000) | ((hash_alg) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000005) ? 20u : (((psa_algorithm_t) 0x02000000) | ((hash_alg) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000008) ? 28u : (((psa_algorithm_t) 0x02000000) | ((hash_alg) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000009) ? 32u : (((psa_algorithm_t) 0x02000000) | ((hash_alg) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x0200000a) ? 48u : (((psa_algorithm_t) 0x02000000) | ((hash_alg) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x0200000b) ? 64u : (((psa_algorithm_t) 0x02000000) | ((hash_alg) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x0200000c) ? 28u : (((psa_algorithm_t) 0x02000000) | ((hash_alg) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x0200000d) ? 32u : (((psa_algorithm_t) 0x02000000) | ((hash_alg) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000010) ? 28u : (((psa_algorithm_t) 0x02000000) | ((hash_alg) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000011) ? 32u : (((psa_algorithm_t) 0x02000000) | ((hash_alg) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000012) ? 48u : (((psa_algorithm_t) 0x02000000) | ((hash_alg) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000013) ? 64u : 0u)) {
                    return ((psa_status_t)-135);
                }

                memcpy(hkdf->prk, data, data_length);
            } else

            {


                if (hkdf->state == 0) {

                    if ((((kdf_alg) & ~((psa_algorithm_t) 0x000000ff)) == ((psa_algorithm_t) 0x08000400))) {
                        return ((psa_status_t)-137);
                    }

                    status = psa_key_derivation_start_hmac(&hkdf->hmac,
                                                           hash_alg,
                                                           
# 7051 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
                                                          ((void *)0)
# 7051 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
                                                              , 0);
                    if (status != ((psa_status_t)0)) {
                        return status;
                    }
                    hkdf->state = 1;
                }
                if (hkdf->state != 1) {
                    return ((psa_status_t)-137);
                }
                status = psa_mac_update(&hkdf->hmac,
                                        data, data_length);
                if (status != ((psa_status_t)0)) {
                    return status;
                }
                status = psa_mac_sign_finish(&hkdf->hmac,
                                             hkdf->prk,
                                             sizeof(hkdf->prk),
                                             &data_length);
                if (status != ((psa_status_t)0)) {
                    return status;
                }
            }

            hkdf->state = 2;
            hkdf->block_number = 0;

            if ((((kdf_alg) & ~((psa_algorithm_t) 0x000000ff)) == ((psa_algorithm_t) 0x08000400))) {

                memcpy(hkdf->output_block, hkdf->prk, ( (((psa_algorithm_t) 0x02000000) | ((hash_alg) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000003) ? 16u : (((psa_algorithm_t) 0x02000000) | ((hash_alg) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000004) ? 20u : (((psa_algorithm_t) 0x02000000) | ((hash_alg) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000005) ? 20u : (((psa_algorithm_t) 0x02000000) | ((hash_alg) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000008) ? 28u : (((psa_algorithm_t) 0x02000000) | ((hash_alg) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000009) ? 32u : (((psa_algorithm_t) 0x02000000) | ((hash_alg) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x0200000a) ? 48u : (((psa_algorithm_t) 0x02000000) | ((hash_alg) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x0200000b) ? 64u : (((psa_algorithm_t) 0x02000000) | ((hash_alg) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x0200000c) ? 28u : (((psa_algorithm_t) 0x02000000) | ((hash_alg) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x0200000d) ? 32u : (((psa_algorithm_t) 0x02000000) | ((hash_alg) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000010) ? 28u : (((psa_algorithm_t) 0x02000000) | ((hash_alg) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000011) ? 32u : (((psa_algorithm_t) 0x02000000) | ((hash_alg) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000012) ? 48u : (((psa_algorithm_t) 0x02000000) | ((hash_alg) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000013) ? 64u : 0u));
                hkdf->offset_in_block = 0;
            } else

            {


                hkdf->offset_in_block = ( (((psa_algorithm_t) 0x02000000) | ((hash_alg) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000003) ? 16u : (((psa_algorithm_t) 0x02000000) | ((hash_alg) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000004) ? 20u : (((psa_algorithm_t) 0x02000000) | ((hash_alg) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000005) ? 20u : (((psa_algorithm_t) 0x02000000) | ((hash_alg) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000008) ? 28u : (((psa_algorithm_t) 0x02000000) | ((hash_alg) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000009) ? 32u : (((psa_algorithm_t) 0x02000000) | ((hash_alg) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x0200000a) ? 48u : (((psa_algorithm_t) 0x02000000) | ((hash_alg) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x0200000b) ? 64u : (((psa_algorithm_t) 0x02000000) | ((hash_alg) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x0200000c) ? 28u : (((psa_algorithm_t) 0x02000000) | ((hash_alg) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x0200000d) ? 32u : (((psa_algorithm_t) 0x02000000) | ((hash_alg) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000010) ? 28u : (((psa_algorithm_t) 0x02000000) | ((hash_alg) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000011) ? 32u : (((psa_algorithm_t) 0x02000000) | ((hash_alg) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000012) ? 48u : (((psa_algorithm_t) 0x02000000) | ((hash_alg) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000013) ? 64u : 0u);
            }

            return ((psa_status_t)0);
        case ((psa_key_derivation_step_t) 0x0203):

            if ((((kdf_alg) & ~((psa_algorithm_t) 0x000000ff)) == ((psa_algorithm_t) 0x08000400))) {
                return ((psa_status_t)-135);
            }


            if ((((kdf_alg) & ~((psa_algorithm_t) 0x000000ff)) == ((psa_algorithm_t) 0x08000500)) &&
                hkdf->state == 0) {
                return ((psa_status_t)-137);
            }

            if (hkdf->state == 3) {
                return ((psa_status_t)-137);
            }
            if (hkdf->info_set) {
                return ((psa_status_t)-137);
            }
            hkdf->info_length = data_length;
            if (data_length != 0) {
                hkdf->info = calloc(1, data_length);
                if (hkdf->info == 
# 7111 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
                                 ((void *)0)
# 7111 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
                                     ) {
                    return ((psa_status_t)-141);
                }
                memcpy(hkdf->info, data, data_length);
            }
            hkdf->info_set = 1;
            return ((psa_status_t)0);
        default:
            return ((psa_status_t)-135);
    }
}




static psa_status_t psa_tls12_prf_set_seed(psa_tls12_prf_key_derivation_t *prf,
                                           const uint8_t *data,
                                           size_t data_length)
{
    if (prf->state != PSA_TLS12_PRF_STATE_INIT) {
        return ((psa_status_t)-137);
    }

    if (data_length != 0) {
        prf->seed = calloc(1, data_length);
        if (prf->seed == 
# 7136 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
                        ((void *)0)
# 7136 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
                            ) {
            return ((psa_status_t)-141);
        }

        memcpy(prf->seed, data, data_length);
        prf->seed_length = data_length;
    }

    prf->state = PSA_TLS12_PRF_STATE_SEED_SET;

    return ((psa_status_t)0);
}

static psa_status_t psa_tls12_prf_set_key(psa_tls12_prf_key_derivation_t *prf,
                                          const uint8_t *data,
                                          size_t data_length)
{
    if (prf->state != PSA_TLS12_PRF_STATE_SEED_SET &&
        prf->state != PSA_TLS12_PRF_STATE_OTHER_KEY_SET) {
        return ((psa_status_t)-137);
    }

    if (data_length != 0) {
        prf->secret = calloc(1, data_length);
        if (prf->secret == 
# 7160 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
                          ((void *)0)
# 7160 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
                              ) {
            return ((psa_status_t)-141);
        }

        memcpy(prf->secret, data, data_length);
        prf->secret_length = data_length;
    }

    prf->state = PSA_TLS12_PRF_STATE_KEY_SET;

    return ((psa_status_t)0);
}

static psa_status_t psa_tls12_prf_set_label(psa_tls12_prf_key_derivation_t *prf,
                                            const uint8_t *data,
                                            size_t data_length)
{
    if (prf->state != PSA_TLS12_PRF_STATE_KEY_SET) {
        return ((psa_status_t)-137);
    }

    if (data_length != 0) {
        prf->label = calloc(1, data_length);
        if (prf->label == 
# 7183 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
                         ((void *)0)
# 7183 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
                             ) {
            return ((psa_status_t)-141);
        }

        memcpy(prf->label, data, data_length);
        prf->label_length = data_length;
    }

    prf->state = PSA_TLS12_PRF_STATE_LABEL_SET;

    return ((psa_status_t)0);
}

static psa_status_t psa_tls12_prf_input(psa_tls12_prf_key_derivation_t *prf,
                                        psa_key_derivation_step_t step,
                                        const uint8_t *data,
                                        size_t data_length)
{
    switch (step) {
        case ((psa_key_derivation_step_t) 0x0204):
            return psa_tls12_prf_set_seed(prf, data, data_length);
        case ((psa_key_derivation_step_t) 0x0101):
            return psa_tls12_prf_set_key(prf, data, data_length);
        case ((psa_key_derivation_step_t) 0x0201):
            return psa_tls12_prf_set_label(prf, data, data_length);
        default:
            return ((psa_status_t)-135);
    }
}




static psa_status_t psa_tls12_prf_psk_to_ms_set_key(
    psa_tls12_prf_key_derivation_t *prf,
    const uint8_t *data,
    size_t data_length)
{
    psa_status_t status;
    const size_t pms_len = (prf->state == PSA_TLS12_PRF_STATE_OTHER_KEY_SET ?
                            4 + data_length + prf->other_secret_length :
                            4 + 2 * data_length);

    if (data_length > 128u) {
        return ((psa_status_t)-135);
    }

    uint8_t *pms = calloc(1, pms_len);
    if (pms == 
# 7231 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
              ((void *)0)
# 7231 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
                  ) {
        return ((psa_status_t)-141);
    }
    uint8_t *cur = pms;
# 7254 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
    if (prf->state == PSA_TLS12_PRF_STATE_OTHER_KEY_SET) {
        *cur++ = ((uint8_t) (((prf->other_secret_length) >> 8) & 0xff));
        *cur++ = ((uint8_t) ((prf->other_secret_length) & 0xff));
        if (prf->other_secret_length != 0) {
            memcpy(cur, prf->other_secret, prf->other_secret_length);
            mbedtls_platform_zeroize(prf->other_secret, prf->other_secret_length);
            cur += prf->other_secret_length;
        }
    } else {
        *cur++ = ((uint8_t) (((data_length) >> 8) & 0xff));
        *cur++ = ((uint8_t) ((data_length) & 0xff));
        memset(cur, 0, data_length);
        cur += data_length;
    }

    *cur++ = ((uint8_t) (((data_length) >> 8) & 0xff));
    *cur++ = ((uint8_t) ((data_length) & 0xff));
    memcpy(cur, data, data_length);
    cur += data_length;

    status = psa_tls12_prf_set_key(prf, pms, (size_t) (cur - pms));

    mbedtls_zeroize_and_free(pms, pms_len);
    return status;
}

static psa_status_t psa_tls12_prf_psk_to_ms_set_other_key(
    psa_tls12_prf_key_derivation_t *prf,
    const uint8_t *data,
    size_t data_length)
{
    if (prf->state != PSA_TLS12_PRF_STATE_SEED_SET) {
        return ((psa_status_t)-137);
    }

    if (data_length != 0) {
        prf->other_secret = calloc(1, data_length);
        if (prf->other_secret == 
# 7291 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
                                ((void *)0)
# 7291 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
                                    ) {
            return ((psa_status_t)-141);
        }

        memcpy(prf->other_secret, data, data_length);
        prf->other_secret_length = data_length;
    } else {
        prf->other_secret_length = 0;
    }

    prf->state = PSA_TLS12_PRF_STATE_OTHER_KEY_SET;

    return ((psa_status_t)0);
}

static psa_status_t psa_tls12_prf_psk_to_ms_input(
    psa_tls12_prf_key_derivation_t *prf,
    psa_key_derivation_step_t step,
    const uint8_t *data,
    size_t data_length)
{
    switch (step) {
        case ((psa_key_derivation_step_t) 0x0101):
            return psa_tls12_prf_psk_to_ms_set_key(prf,
                                                   data, data_length);
            break;
        case ((psa_key_derivation_step_t) 0x0103):
            return psa_tls12_prf_psk_to_ms_set_other_key(prf,
                                                         data,
                                                         data_length);
            break;
        default:
            return psa_tls12_prf_input(prf, step, data, data_length);
            break;

    }
}



static psa_status_t psa_tls12_ecjpake_to_pms_input(
    psa_tls12_ecjpake_to_pms_t *ecjpake,
    psa_key_derivation_step_t step,
    const uint8_t *data,
    size_t data_length)
{
    if (data_length != 65u ||
        step != ((psa_key_derivation_step_t) 0x0101)) {
        return ((psa_status_t)-135);
    }


    if (data[0] != 0x04) {
        return ((psa_status_t)-135);
    }


    memcpy(ecjpake->data, data + 1, 32u);

    return ((psa_status_t)0);
}



static psa_status_t psa_pbkdf2_set_input_cost(
    psa_pbkdf2_key_derivation_t *pbkdf2,
    psa_key_derivation_step_t step,
    uint64_t data)
{
    if (step != ((psa_key_derivation_step_t) 0x0205)) {
        return ((psa_status_t)-135);
    }

    if (pbkdf2->state != PSA_PBKDF2_STATE_INIT) {
        return ((psa_status_t)-137);
    }

    if (data > 0xffffffffU) {
        return ((psa_status_t)-134);
    }

    if (data == 0) {
        return ((psa_status_t)-135);
    }

    pbkdf2->input_cost = data;
    pbkdf2->state = PSA_PBKDF2_STATE_INPUT_COST_SET;

    return ((psa_status_t)0);
}

static psa_status_t psa_pbkdf2_set_salt(psa_pbkdf2_key_derivation_t *pbkdf2,
                                        const uint8_t *data,
                                        size_t data_length)
{
    if (pbkdf2->state == PSA_PBKDF2_STATE_INPUT_COST_SET) {
        pbkdf2->state = PSA_PBKDF2_STATE_SALT_SET;
    } else if (pbkdf2->state == PSA_PBKDF2_STATE_SALT_SET) {

    } else {
        return ((psa_status_t)-137);
    }

    if (data_length == 0) {

    } else {
        uint8_t *next_salt;

        next_salt = calloc(1, data_length + pbkdf2->salt_length);
        if (next_salt == 
# 7400 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
                        ((void *)0)
# 7400 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
                            ) {
            return ((psa_status_t)-141);
        }

        if (pbkdf2->salt_length != 0) {
            memcpy(next_salt, pbkdf2->salt, pbkdf2->salt_length);
        }
        memcpy(next_salt + pbkdf2->salt_length, data, data_length);
        pbkdf2->salt_length += data_length;
        free(pbkdf2->salt);
        pbkdf2->salt = next_salt;
    }
    return ((psa_status_t)0);
}


static psa_status_t psa_pbkdf2_hmac_set_password(psa_algorithm_t hash_alg,
                                                 const uint8_t *input,
                                                 size_t input_len,
                                                 uint8_t *output,
                                                 size_t *output_len)
{
    psa_status_t status = ((psa_status_t)0);
    if (input_len > ( (((psa_algorithm_t) 0x02000000) | ((hash_alg) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000003) ? 64u : (((psa_algorithm_t) 0x02000000) | ((hash_alg) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000004) ? 64u : (((psa_algorithm_t) 0x02000000) | ((hash_alg) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000005) ? 64u : (((psa_algorithm_t) 0x02000000) | ((hash_alg) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000008) ? 64u : (((psa_algorithm_t) 0x02000000) | ((hash_alg) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000009) ? 64u : (((psa_algorithm_t) 0x02000000) | ((hash_alg) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x0200000a) ? 128u : (((psa_algorithm_t) 0x02000000) | ((hash_alg) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x0200000b) ? 128u : (((psa_algorithm_t) 0x02000000) | ((hash_alg) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x0200000c) ? 128u : (((psa_algorithm_t) 0x02000000) | ((hash_alg) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x0200000d) ? 128u : (((psa_algorithm_t) 0x02000000) | ((hash_alg) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000010) ? 144u : (((psa_algorithm_t) 0x02000000) | ((hash_alg) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000011) ? 136u : (((psa_algorithm_t) 0x02000000) | ((hash_alg) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000012) ? 104u : (((psa_algorithm_t) 0x02000000) | ((hash_alg) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000013) ? 72u : 0u)) {
        return psa_hash_compute(hash_alg, input, input_len, output,
                                144u, output_len);
    } else if (input_len > 0) {
        memcpy(output, input, input_len);
    }
    *output_len = ( (((psa_algorithm_t) 0x02000000) | ((hash_alg) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000003) ? 64u : (((psa_algorithm_t) 0x02000000) | ((hash_alg) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000004) ? 64u : (((psa_algorithm_t) 0x02000000) | ((hash_alg) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000005) ? 64u : (((psa_algorithm_t) 0x02000000) | ((hash_alg) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000008) ? 64u : (((psa_algorithm_t) 0x02000000) | ((hash_alg) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000009) ? 64u : (((psa_algorithm_t) 0x02000000) | ((hash_alg) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x0200000a) ? 128u : (((psa_algorithm_t) 0x02000000) | ((hash_alg) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x0200000b) ? 128u : (((psa_algorithm_t) 0x02000000) | ((hash_alg) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x0200000c) ? 128u : (((psa_algorithm_t) 0x02000000) | ((hash_alg) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x0200000d) ? 128u : (((psa_algorithm_t) 0x02000000) | ((hash_alg) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000010) ? 144u : (((psa_algorithm_t) 0x02000000) | ((hash_alg) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000011) ? 136u : (((psa_algorithm_t) 0x02000000) | ((hash_alg) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000012) ? 104u : (((psa_algorithm_t) 0x02000000) | ((hash_alg) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000013) ? 72u : 0u);
    return status;
}



static psa_status_t psa_pbkdf2_cmac_set_password(const uint8_t *input,
                                                 size_t input_len,
                                                 uint8_t *output,
                                                 size_t *output_len)
{
    psa_status_t status = ((psa_status_t)0);
    if (input_len != ((((psa_algorithm_t) 0x03c00200)) & ((psa_algorithm_t) 0x003f0000) ? (((((psa_algorithm_t) 0x03c00200)) & ((psa_algorithm_t) 0x003f0000)) >> 16) : (((((psa_algorithm_t) 0x03c00200)) & (((psa_algorithm_t) 0x7f000000) | ((psa_algorithm_t) 0x00c00000))) == ((psa_algorithm_t) 0x03800000)) ? ( (((psa_algorithm_t) 0x02000000) | (((((psa_algorithm_t) 0x02000000) | ((((psa_algorithm_t) 0x03c00200)) & ((psa_algorithm_t) 0x000000ff)))) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000003) ? 16u : (((psa_algorithm_t) 0x02000000) | (((((psa_algorithm_t) 0x02000000) | ((((psa_algorithm_t) 0x03c00200)) & ((psa_algorithm_t) 0x000000ff)))) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000004) ? 20u : (((psa_algorithm_t) 0x02000000) | (((((psa_algorithm_t) 0x02000000) | ((((psa_algorithm_t) 0x03c00200)) & ((psa_algorithm_t) 0x000000ff)))) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000005) ? 20u : (((psa_algorithm_t) 0x02000000) | (((((psa_algorithm_t) 0x02000000) | ((((psa_algorithm_t) 0x03c00200)) & ((psa_algorithm_t) 0x000000ff)))) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000008) ? 28u : (((psa_algorithm_t) 0x02000000) | (((((psa_algorithm_t) 0x02000000) | ((((psa_algorithm_t) 0x03c00200)) & ((psa_algorithm_t) 0x000000ff)))) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000009) ? 32u : (((psa_algorithm_t) 0x02000000) | (((((psa_algorithm_t) 0x02000000) | ((((psa_algorithm_t) 0x03c00200)) & ((psa_algorithm_t) 0x000000ff)))) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x0200000a) ? 48u : (((psa_algorithm_t) 0x02000000) | (((((psa_algorithm_t) 0x02000000) | ((((psa_algorithm_t) 0x03c00200)) & ((psa_algorithm_t) 0x000000ff)))) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x0200000b) ? 64u : (((psa_algorithm_t) 0x02000000) | (((((psa_algorithm_t) 0x02000000) | ((((psa_algorithm_t) 0x03c00200)) & ((psa_algorithm_t) 0x000000ff)))) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x0200000c) ? 28u : (((psa_algorithm_t) 0x02000000) | (((((psa_algorithm_t) 0x02000000) | ((((psa_algorithm_t) 0x03c00200)) & ((psa_algorithm_t) 0x000000ff)))) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x0200000d) ? 32u : (((psa_algorithm_t) 0x02000000) | (((((psa_algorithm_t) 0x02000000) | ((((psa_algorithm_t) 0x03c00200)) & ((psa_algorithm_t) 0x000000ff)))) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000010) ? 28u : (((psa_algorithm_t) 0x02000000) | (((((psa_algorithm_t) 0x02000000) | ((((psa_algorithm_t) 0x03c00200)) & ((psa_algorithm_t) 0x000000ff)))) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000011) ? 32u : (((psa_algorithm_t) 0x02000000) | (((((psa_algorithm_t) 0x02000000) | ((((psa_algorithm_t) 0x03c00200)) & ((psa_algorithm_t) 0x000000ff)))) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000012) ? 48u : (((psa_algorithm_t) 0x02000000) | (((((psa_algorithm_t) 0x02000000) | ((((psa_algorithm_t) 0x03c00200)) & ((psa_algorithm_t) 0x000000ff)))) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000013) ? 64u : 0u) : (((((psa_algorithm_t) 0x03c00200)) & (((psa_algorithm_t) 0x7f000000) | ((psa_algorithm_t) 0x00c00000))) == ((psa_algorithm_t) 0x03c00000)) ? (((((psa_key_type_t) 0x2400)) & ((psa_key_type_t) 0x7000)) == ((psa_key_type_t) 0x2000) ? 1u << (((((psa_key_type_t) 0x2400)) >> 8) & 7) : 0u) : ((void) (((psa_key_type_t) 0x2400)), (void) (128U), 0u))) {
        psa_key_attributes_t attributes = { ((psa_key_type_t) 0x0000), 0, ((psa_key_lifetime_t) 0x00000000), { 0, 0, 0 }, ((psa_key_id_t) 0) };
        uint8_t zeros[16] = { 0 };
        psa_set_key_type(&attributes, ((psa_key_type_t) 0x2400));
        psa_set_key_bits(&attributes, ((sizeof(zeros)) * 8u));
        psa_set_key_usage_flags(&attributes, ((psa_key_usage_t) 0x00000400));



        status = psa_driver_wrapper_mac_compute(&attributes,
                                                zeros, sizeof(zeros),
                                                ((psa_algorithm_t) 0x03c00200), input, input_len,
                                                output,
                                                ((((psa_algorithm_t) 0x03c00200)) & ((psa_algorithm_t) 0x003f0000) ? (((((psa_algorithm_t) 0x03c00200)) & ((psa_algorithm_t) 0x003f0000)) >> 16) : (((((psa_algorithm_t) 0x03c00200)) & (((psa_algorithm_t) 0x7f000000) | ((psa_algorithm_t) 0x00c00000))) == ((psa_algorithm_t) 0x03800000)) ? ( (((psa_algorithm_t) 0x02000000) | (((((psa_algorithm_t) 0x02000000) | ((((psa_algorithm_t) 0x03c00200)) & ((psa_algorithm_t) 0x000000ff)))) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000003) ? 16u : (((psa_algorithm_t) 0x02000000) | (((((psa_algorithm_t) 0x02000000) | ((((psa_algorithm_t) 0x03c00200)) & ((psa_algorithm_t) 0x000000ff)))) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000004) ? 20u : (((psa_algorithm_t) 0x02000000) | (((((psa_algorithm_t) 0x02000000) | ((((psa_algorithm_t) 0x03c00200)) & ((psa_algorithm_t) 0x000000ff)))) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000005) ? 20u : (((psa_algorithm_t) 0x02000000) | (((((psa_algorithm_t) 0x02000000) | ((((psa_algorithm_t) 0x03c00200)) & ((psa_algorithm_t) 0x000000ff)))) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000008) ? 28u : (((psa_algorithm_t) 0x02000000) | (((((psa_algorithm_t) 0x02000000) | ((((psa_algorithm_t) 0x03c00200)) & ((psa_algorithm_t) 0x000000ff)))) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000009) ? 32u : (((psa_algorithm_t) 0x02000000) | (((((psa_algorithm_t) 0x02000000) | ((((psa_algorithm_t) 0x03c00200)) & ((psa_algorithm_t) 0x000000ff)))) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x0200000a) ? 48u : (((psa_algorithm_t) 0x02000000) | (((((psa_algorithm_t) 0x02000000) | ((((psa_algorithm_t) 0x03c00200)) & ((psa_algorithm_t) 0x000000ff)))) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x0200000b) ? 64u : (((psa_algorithm_t) 0x02000000) | (((((psa_algorithm_t) 0x02000000) | ((((psa_algorithm_t) 0x03c00200)) & ((psa_algorithm_t) 0x000000ff)))) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x0200000c) ? 28u : (((psa_algorithm_t) 0x02000000) | (((((psa_algorithm_t) 0x02000000) | ((((psa_algorithm_t) 0x03c00200)) & ((psa_algorithm_t) 0x000000ff)))) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x0200000d) ? 32u : (((psa_algorithm_t) 0x02000000) | (((((psa_algorithm_t) 0x02000000) | ((((psa_algorithm_t) 0x03c00200)) & ((psa_algorithm_t) 0x000000ff)))) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000010) ? 28u : (((psa_algorithm_t) 0x02000000) | (((((psa_algorithm_t) 0x02000000) | ((((psa_algorithm_t) 0x03c00200)) & ((psa_algorithm_t) 0x000000ff)))) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000011) ? 32u : (((psa_algorithm_t) 0x02000000) | (((((psa_algorithm_t) 0x02000000) | ((((psa_algorithm_t) 0x03c00200)) & ((psa_algorithm_t) 0x000000ff)))) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000012) ? 48u : (((psa_algorithm_t) 0x02000000) | (((((psa_algorithm_t) 0x02000000) | ((((psa_algorithm_t) 0x03c00200)) & ((psa_algorithm_t) 0x000000ff)))) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000013) ? 64u : 0u) : (((((psa_algorithm_t) 0x03c00200)) & (((psa_algorithm_t) 0x7f000000) | ((psa_algorithm_t) 0x00c00000))) == ((psa_algorithm_t) 0x03c00000)) ? (((((psa_key_type_t) 0x2400)) & ((psa_key_type_t) 0x7000)) == ((psa_key_type_t) 0x2000) ? 1u << (((((psa_key_type_t) 0x2400)) >> 8) & 7) : 0u) : ((void) (((psa_key_type_t) 0x2400)), (void) (128U), 0u))

                                                                            ,
                                                output_len);
    } else {
        memcpy(output, input, input_len);
        *output_len = ((((psa_algorithm_t) 0x03c00200)) & ((psa_algorithm_t) 0x003f0000) ? (((((psa_algorithm_t) 0x03c00200)) & ((psa_algorithm_t) 0x003f0000)) >> 16) : (((((psa_algorithm_t) 0x03c00200)) & (((psa_algorithm_t) 0x7f000000) | ((psa_algorithm_t) 0x00c00000))) == ((psa_algorithm_t) 0x03800000)) ? ( (((psa_algorithm_t) 0x02000000) | (((((psa_algorithm_t) 0x02000000) | ((((psa_algorithm_t) 0x03c00200)) & ((psa_algorithm_t) 0x000000ff)))) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000003) ? 16u : (((psa_algorithm_t) 0x02000000) | (((((psa_algorithm_t) 0x02000000) | ((((psa_algorithm_t) 0x03c00200)) & ((psa_algorithm_t) 0x000000ff)))) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000004) ? 20u : (((psa_algorithm_t) 0x02000000) | (((((psa_algorithm_t) 0x02000000) | ((((psa_algorithm_t) 0x03c00200)) & ((psa_algorithm_t) 0x000000ff)))) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000005) ? 20u : (((psa_algorithm_t) 0x02000000) | (((((psa_algorithm_t) 0x02000000) | ((((psa_algorithm_t) 0x03c00200)) & ((psa_algorithm_t) 0x000000ff)))) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000008) ? 28u : (((psa_algorithm_t) 0x02000000) | (((((psa_algorithm_t) 0x02000000) | ((((psa_algorithm_t) 0x03c00200)) & ((psa_algorithm_t) 0x000000ff)))) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000009) ? 32u : (((psa_algorithm_t) 0x02000000) | (((((psa_algorithm_t) 0x02000000) | ((((psa_algorithm_t) 0x03c00200)) & ((psa_algorithm_t) 0x000000ff)))) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x0200000a) ? 48u : (((psa_algorithm_t) 0x02000000) | (((((psa_algorithm_t) 0x02000000) | ((((psa_algorithm_t) 0x03c00200)) & ((psa_algorithm_t) 0x000000ff)))) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x0200000b) ? 64u : (((psa_algorithm_t) 0x02000000) | (((((psa_algorithm_t) 0x02000000) | ((((psa_algorithm_t) 0x03c00200)) & ((psa_algorithm_t) 0x000000ff)))) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x0200000c) ? 28u : (((psa_algorithm_t) 0x02000000) | (((((psa_algorithm_t) 0x02000000) | ((((psa_algorithm_t) 0x03c00200)) & ((psa_algorithm_t) 0x000000ff)))) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x0200000d) ? 32u : (((psa_algorithm_t) 0x02000000) | (((((psa_algorithm_t) 0x02000000) | ((((psa_algorithm_t) 0x03c00200)) & ((psa_algorithm_t) 0x000000ff)))) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000010) ? 28u : (((psa_algorithm_t) 0x02000000) | (((((psa_algorithm_t) 0x02000000) | ((((psa_algorithm_t) 0x03c00200)) & ((psa_algorithm_t) 0x000000ff)))) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000011) ? 32u : (((psa_algorithm_t) 0x02000000) | (((((psa_algorithm_t) 0x02000000) | ((((psa_algorithm_t) 0x03c00200)) & ((psa_algorithm_t) 0x000000ff)))) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000012) ? 48u : (((psa_algorithm_t) 0x02000000) | (((((psa_algorithm_t) 0x02000000) | ((((psa_algorithm_t) 0x03c00200)) & ((psa_algorithm_t) 0x000000ff)))) & ((psa_algorithm_t) 0x000000ff))) == ((psa_algorithm_t) 0x02000013) ? 64u : 0u) : (((((psa_algorithm_t) 0x03c00200)) & (((psa_algorithm_t) 0x7f000000) | ((psa_algorithm_t) 0x00c00000))) == ((psa_algorithm_t) 0x03c00000)) ? (((((psa_key_type_t) 0x2400)) & ((psa_key_type_t) 0x7000)) == ((psa_key_type_t) 0x2000) ? 1u << (((((psa_key_type_t) 0x2400)) >> 8) & 7) : 0u) : ((void) (((psa_key_type_t) 0x2400)), (void) (128U), 0u));
    }
    return status;
}


static psa_status_t psa_pbkdf2_set_password(psa_pbkdf2_key_derivation_t *pbkdf2,
                                            psa_algorithm_t kdf_alg,
                                            const uint8_t *data,
                                            size_t data_length)
{
    psa_status_t status = ((psa_status_t)0);
    if (pbkdf2->state != PSA_PBKDF2_STATE_SALT_SET) {
        return ((psa_status_t)-137);
    }


    if ((((kdf_alg) & ~((psa_algorithm_t) 0x000000ff)) == ((psa_algorithm_t) 0x08800100))) {
        psa_algorithm_t hash_alg = (((psa_algorithm_t) 0x02000000) | ((kdf_alg) & ((psa_algorithm_t) 0x000000ff)));
        status = psa_pbkdf2_hmac_set_password(hash_alg, data, data_length,
                                              pbkdf2->password,
                                              &pbkdf2->password_length);
    } else


    if (kdf_alg == ((psa_algorithm_t) 0x08800200)) {
        status = psa_pbkdf2_cmac_set_password(data, data_length,
                                              pbkdf2->password,
                                              &pbkdf2->password_length);
    } else

    {
        return ((psa_status_t)-135);
    }

    pbkdf2->state = PSA_PBKDF2_STATE_PASSWORD_SET;

    return status;
}

static psa_status_t psa_pbkdf2_input(psa_pbkdf2_key_derivation_t *pbkdf2,
                                     psa_algorithm_t kdf_alg,
                                     psa_key_derivation_step_t step,
                                     const uint8_t *data,
                                     size_t data_length)
{
    switch (step) {
        case ((psa_key_derivation_step_t) 0x0202):
            return psa_pbkdf2_set_salt(pbkdf2, data, data_length);
        case ((psa_key_derivation_step_t) 0x0102):
            return psa_pbkdf2_set_password(pbkdf2, kdf_alg, data, data_length);
        default:
            return ((psa_status_t)-135);
    }
}
# 7526 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
static int psa_key_derivation_check_input_type(
    psa_key_derivation_step_t step,
    psa_key_type_t key_type)
{
    switch (step) {
        case ((psa_key_derivation_step_t) 0x0101):
            if (key_type == ((psa_key_type_t) 0x1200)) {
                return ((psa_status_t)0);
            }
            if (key_type == ((psa_key_type_t) 0x0000)) {
                return ((psa_status_t)0);
            }
            break;
        case ((psa_key_derivation_step_t) 0x0103):
            if (key_type == ((psa_key_type_t) 0x1200)) {
                return ((psa_status_t)0);
            }
            if (key_type == ((psa_key_type_t) 0x0000)) {
                return ((psa_status_t)0);
            }
            break;
        case ((psa_key_derivation_step_t) 0x0201):
        case ((psa_key_derivation_step_t) 0x0202):
        case ((psa_key_derivation_step_t) 0x0203):
        case ((psa_key_derivation_step_t) 0x0204):
            if (key_type == ((psa_key_type_t) 0x1001)) {
                return ((psa_status_t)0);
            }
            if (key_type == ((psa_key_type_t) 0x0000)) {
                return ((psa_status_t)0);
            }
            break;
        case ((psa_key_derivation_step_t) 0x0102):
            if (key_type == ((psa_key_type_t) 0x1203)) {
                return ((psa_status_t)0);
            }
            if (key_type == ((psa_key_type_t) 0x1200)) {
                return ((psa_status_t)0);
            }
            if (key_type == ((psa_key_type_t) 0x0000)) {
                return ((psa_status_t)0);
            }
            break;
    }
    return ((psa_status_t)-135);
}

static psa_status_t psa_key_derivation_input_internal(
    psa_key_derivation_operation_t *operation,
    psa_key_derivation_step_t step,
    psa_key_type_t key_type,
    const uint8_t *data,
    size_t data_length)
{
    psa_status_t status;
    psa_algorithm_t kdf_alg = psa_key_derivation_get_kdf_alg(operation);

    if (kdf_alg == ((psa_algorithm_t)0)) {

        status = ((psa_status_t)-137);
        goto exit;
    }

    status = psa_key_derivation_check_input_type(step, key_type);
    if (status != ((psa_status_t)0)) {
        goto exit;
    }


    if ((((kdf_alg) & ~((psa_algorithm_t) 0x000000ff)) == ((psa_algorithm_t) 0x08000100) || ((kdf_alg) & ~((psa_algorithm_t) 0x000000ff)) == ((psa_algorithm_t) 0x08000400) || ((kdf_alg) & ~((psa_algorithm_t) 0x000000ff)) == ((psa_algorithm_t) 0x08000500))) {
        status = psa_hkdf_input(&operation->ctx.hkdf, kdf_alg,
                                step, data, data_length);
    } else


    if ((((kdf_alg) & ~((psa_algorithm_t) 0x000000ff)) == ((psa_algorithm_t) 0x08000200))) {
        status = psa_tls12_prf_input(&operation->ctx.tls12_prf,
                                     step, data, data_length);
    } else


    if ((((kdf_alg) & ~((psa_algorithm_t) 0x000000ff)) == ((psa_algorithm_t) 0x08000300))) {
        status = psa_tls12_prf_psk_to_ms_input(&operation->ctx.tls12_prf,
                                               step, data, data_length);
    } else


    if (kdf_alg == ((psa_algorithm_t) 0x08000609)) {
        status = psa_tls12_ecjpake_to_pms_input(
            &operation->ctx.tls12_ecjpake_to_pms, step, data, data_length);
    } else


    if (((((kdf_alg) & ~((psa_algorithm_t) 0x000000ff)) == ((psa_algorithm_t) 0x08800100)) || ((kdf_alg) == ((psa_algorithm_t) 0x08800200)))) {
        status = psa_pbkdf2_input(&operation->ctx.pbkdf2, kdf_alg,
                                  step, data, data_length);
    } else

    {

        (void) data;
        (void) data_length;
        (void) kdf_alg;
        return ((psa_status_t)-137);
    }

exit:
    if (status != ((psa_status_t)0)) {
        psa_key_derivation_abort(operation);
    }
    return status;
}

static psa_status_t psa_key_derivation_input_integer_internal(
    psa_key_derivation_operation_t *operation,
    psa_key_derivation_step_t step,
    uint64_t value)
{
    psa_status_t status;
    psa_algorithm_t kdf_alg = psa_key_derivation_get_kdf_alg(operation);

    if (kdf_alg == ((psa_algorithm_t)0)) {

        status = ((psa_status_t)-137);
        goto exit;
    }


    if (((((kdf_alg) & ~((psa_algorithm_t) 0x000000ff)) == ((psa_algorithm_t) 0x08800100)) || ((kdf_alg) == ((psa_algorithm_t) 0x08800200)))) {
        status = psa_pbkdf2_set_input_cost(
            &operation->ctx.pbkdf2, step, value);
    } else

    {
        (void) step;
        (void) value;
        (void) kdf_alg;
        status = ((psa_status_t)-135);
    }

exit:
    if (status != ((psa_status_t)0)) {
        psa_key_derivation_abort(operation);
    }
    return status;
}

psa_status_t psa_key_derivation_input_bytes(
    psa_key_derivation_operation_t *operation,
    psa_key_derivation_step_t step,
    const uint8_t *data_external,
    size_t data_length)
{
    psa_status_t status = ((psa_status_t)-151);
    psa_crypto_local_input_t LOCAL_INPUT_COPY_OF_data_external = ((psa_crypto_local_input_t) { 
# 7680 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 7680 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   , 0 }); const uint8_t *data = 
# 7680 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 7680 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   ;;

    status = psa_crypto_local_input_alloc(data_external, data_length, &LOCAL_INPUT_COPY_OF_data_external); if (status != ((psa_status_t)0)) { goto exit; } data = LOCAL_INPUT_COPY_OF_data_external.buffer;;

    status = psa_key_derivation_input_internal(operation, step,
                                               ((psa_key_type_t) 0x0000),
                                               data, data_length);

exit:

    data = 
# 7690 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 7690 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   ; psa_crypto_local_input_free(&LOCAL_INPUT_COPY_OF_data_external);;
    return status;
}

psa_status_t psa_key_derivation_input_integer(
    psa_key_derivation_operation_t *operation,
    psa_key_derivation_step_t step,
    uint64_t value)
{
    return psa_key_derivation_input_integer_internal(operation, step, value);
}

psa_status_t psa_key_derivation_input_key(
    psa_key_derivation_operation_t *operation,
    psa_key_derivation_step_t step,
    mbedtls_svc_key_id_t key)
{
    psa_status_t status = ((psa_status_t)-151);
    psa_status_t unlock_status = ((psa_status_t)-151);
    psa_key_slot_t *slot;

    status = psa_get_and_lock_transparent_key_slot_with_policy(
        key, &slot, ((psa_key_usage_t) 0x00004000), operation->alg);
    if (status != ((psa_status_t)0)) {
        psa_key_derivation_abort(operation);
        return status;
    }



    if (step == ((psa_key_derivation_step_t) 0x0101) ||
        step == ((psa_key_derivation_step_t) 0x0102)) {
        operation->can_output_key = 1;
    }

    status = psa_key_derivation_input_internal(operation,
                                               step, slot->attr.type,
                                               slot->key.data,
                                               slot->key.bytes);

    unlock_status = psa_unregister_read_under_mutex(slot);

    return (status == ((psa_status_t)0)) ? unlock_status : status;
}







psa_status_t psa_key_agreement_raw_builtin(const psa_key_attributes_t *attributes,
                                           const uint8_t *key_buffer,
                                           size_t key_buffer_size,
                                           psa_algorithm_t alg,
                                           const uint8_t *peer_key,
                                           size_t peer_key_length,
                                           uint8_t *shared_secret,
                                           size_t shared_secret_size,
                                           size_t *shared_secret_length)
{
    switch (alg) {

        case ((psa_algorithm_t) 0x09020000):
            return mbedtls_psa_key_agreement_ecdh(attributes, key_buffer,
                                                  key_buffer_size, alg,
                                                  peer_key, peer_key_length,
                                                  shared_secret,
                                                  shared_secret_size,
                                                  shared_secret_length);



        case ((psa_algorithm_t) 0x09010000):
            return mbedtls_psa_ffdh_key_agreement(attributes,
                                                  peer_key,
                                                  peer_key_length,
                                                  key_buffer,
                                                  key_buffer_size,
                                                  shared_secret,
                                                  shared_secret_size,
                                                  shared_secret_length);


        default:
            (void) attributes;
            (void) key_buffer;
            (void) key_buffer_size;
            (void) peer_key;
            (void) peer_key_length;
            (void) shared_secret;
            (void) shared_secret_size;
            (void) shared_secret_length;
            return ((psa_status_t)-134);
    }
}







static psa_status_t psa_key_agreement_raw_internal(psa_algorithm_t alg,
                                                   psa_key_slot_t *private_key,
                                                   const uint8_t *peer_key,
                                                   size_t peer_key_length,
                                                   uint8_t *shared_secret,
                                                   size_t shared_secret_size,
                                                   size_t *shared_secret_length)
{
    if (!((((alg) & ((psa_algorithm_t) 0x7f000000)) == ((psa_algorithm_t) 0x09000000)) && (((alg) & ((psa_algorithm_t) 0xfe00ffff)) | ((psa_algorithm_t) 0x08000000)) == ((psa_algorithm_t) 0x08000000))) {
        return ((psa_status_t)-134);
    }

    return psa_driver_wrapper_key_agreement(&private_key->attr,
                                            private_key->key.data,
                                            private_key->key.bytes, alg,
                                            peer_key, peer_key_length,
                                            shared_secret,
                                            shared_secret_size,
                                            shared_secret_length);
}




static psa_status_t psa_key_agreement_internal(psa_key_derivation_operation_t *operation,
                                               psa_key_derivation_step_t step,
                                               psa_key_slot_t *private_key,
                                               const uint8_t *peer_key,
                                               size_t peer_key_length)
{
    psa_status_t status;
    uint8_t shared_secret[(((8192u) + 7u) / 8u)] = { 0 };
    size_t shared_secret_length = 0;
    psa_algorithm_t ka_alg = (((operation->alg) & ((psa_algorithm_t) 0xffff0000)) | ((psa_algorithm_t) 0x09000000));



    status = psa_key_agreement_raw_internal(ka_alg,
                                            private_key,
                                            peer_key, peer_key_length,
                                            shared_secret,
                                            sizeof(shared_secret),
                                            &shared_secret_length);
    if (status != ((psa_status_t)0)) {
        goto exit;
    }




    status = psa_key_derivation_input_internal(operation, step,
                                               ((psa_key_type_t) 0x1200),
                                               shared_secret,
                                               shared_secret_length);
exit:
    mbedtls_platform_zeroize(shared_secret, shared_secret_length);
    return status;
}

psa_status_t psa_key_derivation_key_agreement(psa_key_derivation_operation_t *operation,
                                              psa_key_derivation_step_t step,
                                              mbedtls_svc_key_id_t private_key,
                                              const uint8_t *peer_key_external,
                                              size_t peer_key_length)
{
    psa_status_t status = ((psa_status_t)-151);
    psa_status_t unlock_status = ((psa_status_t)-151);
    psa_key_slot_t *slot;
    psa_crypto_local_input_t LOCAL_INPUT_COPY_OF_peer_key_external = ((psa_crypto_local_input_t) { 
# 7861 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 7861 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   , 0 }); const uint8_t *peer_key = 
# 7861 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 7861 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   ;;

    if (!(((operation->alg) & ((psa_algorithm_t) 0x7f000000)) == ((psa_algorithm_t) 0x09000000))) {
        return ((psa_status_t)-135);
    }
    status = psa_get_and_lock_transparent_key_slot_with_policy(
        private_key, &slot, ((psa_key_usage_t) 0x00004000), operation->alg);
    if (status != ((psa_status_t)0)) {
        return status;
    }

    status = psa_crypto_local_input_alloc(peer_key_external, peer_key_length, &LOCAL_INPUT_COPY_OF_peer_key_external); if (status != ((psa_status_t)0)) { goto exit; } peer_key = LOCAL_INPUT_COPY_OF_peer_key_external.buffer;;
    status = psa_key_agreement_internal(operation, step,
                                        slot,
                                        peer_key, peer_key_length);


exit:

    if (status != ((psa_status_t)0)) {
        psa_key_derivation_abort(operation);
    } else {


        if (step == ((psa_key_derivation_step_t) 0x0101)) {
            operation->can_output_key = 1;
        }
    }

    unlock_status = psa_unregister_read_under_mutex(slot);
    peer_key = 
# 7891 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 7891 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   ; psa_crypto_local_input_free(&LOCAL_INPUT_COPY_OF_peer_key_external);;

    return (status == ((psa_status_t)0)) ? unlock_status : status;
}

psa_status_t psa_raw_key_agreement(psa_algorithm_t alg,
                                   mbedtls_svc_key_id_t private_key,
                                   const uint8_t *peer_key_external,
                                   size_t peer_key_length,
                                   uint8_t *output_external,
                                   size_t output_size,
                                   size_t *output_length)
{
    psa_status_t status = ((psa_status_t)-151);
    psa_status_t unlock_status = ((psa_status_t)-151);
    psa_key_slot_t *slot = 
# 7906 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
                          ((void *)0)
# 7906 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
                              ;
    size_t expected_length;
    psa_crypto_local_input_t LOCAL_INPUT_COPY_OF_peer_key_external = ((psa_crypto_local_input_t) { 
# 7908 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 7908 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   , 0 }); const uint8_t *peer_key = 
# 7908 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 7908 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   ;;
    psa_crypto_local_output_t LOCAL_OUTPUT_COPY_OF_output_external = ((psa_crypto_local_output_t) { 
# 7909 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 7909 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   , 
# 7909 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 7909 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   , 0 }); uint8_t *output = 
# 7909 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 7909 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   ;;
    status = psa_crypto_local_output_alloc(output_external, output_size, &LOCAL_OUTPUT_COPY_OF_output_external); if (status != ((psa_status_t)0)) { goto exit; } output = LOCAL_OUTPUT_COPY_OF_output_external.buffer;;

    if (!(((alg) & ((psa_algorithm_t) 0x7f000000)) == ((psa_algorithm_t) 0x09000000))) {
        status = ((psa_status_t)-135);
        goto exit;
    }
    status = psa_get_and_lock_transparent_key_slot_with_policy(
        private_key, &slot, ((psa_key_usage_t) 0x00004000), alg);
    if (status != ((psa_status_t)0)) {
        goto exit;
    }
# 7930 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
    expected_length =
        (((((slot->attr.type) & ~((psa_key_type_t) 0x00ff)) == ((psa_key_type_t) 0x7100)) || (((slot->attr.type) & ~((psa_key_type_t) 0x00ff)) == ((psa_key_type_t) 0x7200))) ? (((slot->attr.bits) + 7u) / 8u) : 0u);
    if (output_size < expected_length) {
        status = ((psa_status_t)-138);
        goto exit;
    }

    status = psa_crypto_local_input_alloc(peer_key_external, peer_key_length, &LOCAL_INPUT_COPY_OF_peer_key_external); if (status != ((psa_status_t)0)) { goto exit; } peer_key = LOCAL_INPUT_COPY_OF_peer_key_external.buffer;;
    status = psa_key_agreement_raw_internal(alg, slot,
                                            peer_key, peer_key_length,
                                            output, output_size,
                                            output_length);

exit:


    if (output != 
# 7946 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
                 ((void *)0) 
# 7946 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
                      && status != ((psa_status_t)0)) {







        psa_generate_random_internal(output, output_size);
        *output_length = output_size;
    }

    if (output == 
# 7958 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
                 ((void *)0)
# 7958 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
                     ) {

        *output_length = 0;
    }

    unlock_status = psa_unregister_read_under_mutex(slot);

    peer_key = 
# 7965 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 7965 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   ; psa_crypto_local_input_free(&LOCAL_INPUT_COPY_OF_peer_key_external);;
    output = 
# 7966 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 7966 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   ; do { psa_status_t local_output_status; local_output_status = psa_crypto_local_output_free(&LOCAL_OUTPUT_COPY_OF_output_external); if (local_output_status != ((psa_status_t)0)) { status = local_output_status; } } while (0);
    return (status == ((psa_status_t)0)) ? unlock_status : status;
}
# 7984 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
static void mbedtls_psa_random_init(mbedtls_psa_random_context_t *rng)
{






    if (rng->entropy_init == 
# 7992 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
                            ((void *)0)
# 7992 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
                                ) {
        rng->entropy_init = mbedtls_entropy_init;
    }
    if (rng->entropy_free == 
# 7995 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
                            ((void *)0)
# 7995 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
                                ) {
        rng->entropy_free = mbedtls_entropy_free;
    }

    rng->entropy_init(&rng->entropy);
# 8010 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
    mbedtls_psa_drbg_init(&rng->drbg);

}






static void mbedtls_psa_random_free(mbedtls_psa_random_context_t *rng)
{



    mbedtls_psa_drbg_free(&rng->drbg);
    rng->entropy_free(&rng->entropy);

}



static psa_status_t mbedtls_psa_random_seed(mbedtls_psa_random_context_t *rng)
{





    const unsigned char drbg_seed[] = "PSA";
    int ret = mbedtls_psa_drbg_seed(&rng->drbg, &rng->entropy,
                                    drbg_seed, sizeof(drbg_seed) - 1);
    return mbedtls_to_psa_error(ret);

}

psa_status_t psa_generate_random(uint8_t *output_external,
                                 size_t output_size)
{
    psa_status_t status;

    psa_crypto_local_output_t LOCAL_OUTPUT_COPY_OF_output_external = ((psa_crypto_local_output_t) { 
# 8050 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 8050 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   , 
# 8050 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 8050 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   , 0 }); uint8_t *output = 
# 8050 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 8050 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   ;;
    status = psa_crypto_local_output_alloc(output_external, output_size, &LOCAL_OUTPUT_COPY_OF_output_external); if (status != ((psa_status_t)0)) { goto exit; } output = LOCAL_OUTPUT_COPY_OF_output_external.buffer;;

    status = psa_generate_random_internal(output, output_size);


exit:

    output = 
# 8058 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 8058 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   ; do { psa_status_t local_output_status; local_output_status = psa_crypto_local_output_free(&LOCAL_OUTPUT_COPY_OF_output_external); if (local_output_status != ((psa_status_t)0)) { status = local_output_status; } } while (0);
    return status;
}
# 8093 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
static psa_status_t psa_validate_key_type_and_size_for_key_generation(
    psa_key_type_t type, size_t bits)
{
    psa_status_t status = ((psa_status_t)-151);

    if (key_type_is_raw_bytes(type)) {
        status = psa_validate_unstructured_key_bit_size(type, bits);
        if (status != ((psa_status_t)0)) {
            return status;
        }
    } else

    if ((((type) & ~((psa_key_type_t) 0x3000)) == ((psa_key_type_t) 0x4001)) && (((type) & ((psa_key_type_t) 0x7000)) == ((psa_key_type_t) 0x7000))) {
        if (bits > 4096u) {
            return ((psa_status_t)-134);
        }
        if (bits < 1024) {
            return ((psa_status_t)-134);
        }



        if (bits % 8 != 0) {
            return ((psa_status_t)-134);
        }
    } else



    if (((((type) & ~((psa_key_type_t) 0x3000)) & ~((psa_key_type_t) 0x00ff)) == ((psa_key_type_t) 0x4100)) && (((type) & ((psa_key_type_t) 0x7000)) == ((psa_key_type_t) 0x7000))) {

        return ((psa_status_t)0);
    } else



    if (((((type) & ~((psa_key_type_t) 0x3000)) & ~((psa_key_type_t) 0x00ff)) == ((psa_key_type_t) 0x4200)) && (((type) & ((psa_key_type_t) 0x7000)) == ((psa_key_type_t) 0x7000))) {
        if (psa_is_dh_key_size_valid(bits) == 0) {
            return ((psa_status_t)-134);
        }
    } else

    {
        return ((psa_status_t)-134);
    }

    return ((psa_status_t)0);
}

psa_status_t psa_generate_key_internal(
    const psa_key_attributes_t *attributes,
    const psa_custom_key_parameters_t *custom,
    const uint8_t *custom_data,
    size_t custom_data_length,
    uint8_t *key_buffer, size_t key_buffer_size, size_t *key_buffer_length)
{
    psa_status_t status = ((psa_status_t)-151);
    psa_key_type_t type = attributes->type;


    (void) custom;
    (void) custom_data;
    (void) custom_data_length;

    if (key_type_is_raw_bytes(type)) {
        status = psa_generate_random_internal(key_buffer, key_buffer_size);
        if (status != ((psa_status_t)0)) {
            return status;
        }


        if (type == ((psa_key_type_t) 0x2301)) {
            psa_des_set_key_parity(key_buffer, key_buffer_size);
        }

    } else


    if (type == ((psa_key_type_t) 0x7001)) {
        return mbedtls_psa_rsa_generate_key(attributes,
                                            custom_data, custom_data_length,
                                            key_buffer,
                                            key_buffer_size,
                                            key_buffer_length);
    } else



    if (((((type) & ~((psa_key_type_t) 0x3000)) & ~((psa_key_type_t) 0x00ff)) == ((psa_key_type_t) 0x4100)) && (((type) & ((psa_key_type_t) 0x7000)) == ((psa_key_type_t) 0x7000))) {
        return mbedtls_psa_ecp_generate_key(attributes,
                                            key_buffer,
                                            key_buffer_size,
                                            key_buffer_length);
    } else



    if (((((type) & ~((psa_key_type_t) 0x3000)) & ~((psa_key_type_t) 0x00ff)) == ((psa_key_type_t) 0x4200)) && (((type) & ((psa_key_type_t) 0x7000)) == ((psa_key_type_t) 0x7000))) {
        return mbedtls_psa_ffdh_generate_key(attributes,
                                             key_buffer,
                                             key_buffer_size,
                                             key_buffer_length);
    } else

    {
        (void) key_buffer_length;
        return ((psa_status_t)-134);
    }

    return ((psa_status_t)0);
}

psa_status_t psa_generate_key_custom(const psa_key_attributes_t *attributes,
                                     const psa_custom_key_parameters_t *custom,
                                     const uint8_t *custom_data,
                                     size_t custom_data_length,
                                     mbedtls_svc_key_id_t *key)
{
    psa_status_t status;
    psa_key_slot_t *slot = 
# 8212 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
                          ((void *)0)
# 8212 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
                              ;
    psa_se_drv_table_entry_t *driver = 
# 8213 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
                                      ((void *)0)
# 8213 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
                                          ;
    size_t key_buffer_size;

    *key = ((psa_key_id_t) 0);



    if (psa_get_key_bits(attributes) == 0) {
        return ((psa_status_t)-135);
    }


    if ((((attributes->type) & ((psa_key_type_t) 0x7000)) == ((psa_key_type_t) 0x4000))) {
        return ((psa_status_t)-135);
    }


    if (attributes->type == ((psa_key_type_t) 0x7001)) {
        if (custom->flags != 0) {
            return ((psa_status_t)-135);
        }
    } else

    if (!psa_custom_key_parameters_are_default(custom, custom_data_length)) {
        return ((psa_status_t)-135);
    }

    status = psa_start_key_creation(PSA_KEY_CREATION_GENERATE, attributes,
                                    &slot, &driver);
    if (status != ((psa_status_t)0)) {
        goto exit;
    }





    if (slot->key.bytes == 0) {
        if (((psa_key_location_t) ((attributes->lifetime) >> 8)) ==
            ((psa_key_location_t) 0x000000)) {
            status = psa_validate_key_type_and_size_for_key_generation(
                attributes->type, attributes->bits);
            if (status != ((psa_status_t)0)) {
                goto exit;
            }

            key_buffer_size = ((((attributes->type) & ((psa_key_type_t) 0x7000)) == ((psa_key_type_t) 0x1000) || ((attributes->type) & ((psa_key_type_t) 0x7000)) == ((psa_key_type_t) 0x2000)) ? (((attributes->bits) + 7u) / 8u) : ((((attributes->type) & ~((psa_key_type_t) 0x3000)) & ~((psa_key_type_t) 0x00ff)) == ((psa_key_type_t) 0x4200)) ? (((attributes->bits) + 7u) / 8u) : (attributes->type) == ((psa_key_type_t) 0x7001) ? (9u * (((attributes->bits) / 2u + 1u) / 8u + 5u) + 14u) : (attributes->type) == ((psa_key_type_t) 0x4001) ? (((attributes->bits) / 8u + 5u) + 11u) : (attributes->type) == ((psa_key_type_t) 0x7002) ? (((attributes->bits) / 8u + 5u) * 3u + 75u) : (attributes->type) == ((psa_key_type_t) 0x4002) ? (((attributes->bits) / 8u + 5u) * 3u + 59u) : (((attributes->type) & ~((psa_key_type_t) 0x00ff)) == ((psa_key_type_t) 0x7100)) ? ((((attributes->bits) + 7u) / 8u)) : (((attributes->type) & ~((psa_key_type_t) 0x00ff)) == ((psa_key_type_t) 0x4100)) ? (2u * (((attributes->bits) + 7u) / 8u) + 1u) : 0u)

                                 ;
        } else {
            status = psa_driver_wrapper_get_key_buffer_size(
                attributes, &key_buffer_size);
            if (status != ((psa_status_t)0)) {
                goto exit;
            }
        }

        status = psa_allocate_buffer_to_slot(slot, key_buffer_size);
        if (status != ((psa_status_t)0)) {
            goto exit;
        }
    }

    status = psa_driver_wrapper_generate_key(attributes,
                                             custom,
                                             custom_data, custom_data_length,
                                             slot->key.data, slot->key.bytes,
                                             &slot->key.bytes);
    if (status != ((psa_status_t)0)) {
        psa_remove_key_data_from_memory(slot);
    }

exit:
    if (status == ((psa_status_t)0)) {
        status = psa_finish_key_creation(slot, driver, key);
    }
    if (status != ((psa_status_t)0)) {
        psa_fail_key_creation(slot, driver);
    }

    return status;
}

psa_status_t psa_generate_key_ext(const psa_key_attributes_t *attributes,
                                  const psa_key_production_parameters_t *params,
                                  size_t params_data_length,
                                  mbedtls_svc_key_id_t *key)
{
    return psa_generate_key_custom(
        attributes,
        (const psa_custom_key_parameters_t *) params,
        params->data, params_data_length,
        key);
}

psa_status_t psa_generate_key(const psa_key_attributes_t *attributes,
                              mbedtls_svc_key_id_t *key)
{
    return psa_generate_key_custom(attributes,
                                   &default_custom_production,
                                   
# 8313 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
                                  ((void *)0)
# 8313 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
                                      , 0,
                                   key);
}
# 8324 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
psa_status_t mbedtls_psa_crypto_configure_entropy_sources(
    void (* entropy_init)(mbedtls_entropy_context *ctx),
    void (* entropy_free)(mbedtls_entropy_context *ctx))
{
    psa_status_t status = ((psa_status_t)-151);





    if (global_data.rng_state != 0) {
        status = ((psa_status_t)-137);
    } else {
        global_data.rng.entropy_init = entropy_init;
        global_data.rng.entropy_free = entropy_free;
        status = ((psa_status_t)0);
    }





    return status;
}


void mbedtls_psa_crypto_free(void)
{






    if (global_data.initialized & 0x04) {
        global_data.initialized &= ~0x04;
    }

    if (global_data.initialized & 0x02) {
        psa_wipe_all_key_slots();
        global_data.initialized &= ~0x02;
    }
# 8375 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
    if (global_data.rng_state != 0) {
        mbedtls_psa_random_free(&global_data.rng);
    }
    global_data.rng_state = 0;
    mbedtls_platform_zeroize(&global_data.rng, sizeof(global_data.rng));
# 8390 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
    if (global_data.initialized & 0x01) {
        psa_driver_wrapper_free();
        global_data.initialized &= ~0x01;
    }





}
# 8426 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
static psa_status_t mbedtls_psa_crypto_init_subsystem(mbedtls_psa_crypto_subsystem subsystem)
{
    psa_status_t status = ((psa_status_t)0);
    uint8_t driver_wrappers_initialized = 0;

    switch (subsystem) {
        case PSA_CRYPTO_SUBSYSTEM_DRIVER_WRAPPERS:





            if (!(global_data.initialized & 0x01)) {

                status = psa_driver_wrapper_init();


                global_data.initialized |= 0x01;


            }





            break;

        case PSA_CRYPTO_SUBSYSTEM_KEY_SLOTS:





            if (!(global_data.initialized & 0x02)) {
                status = psa_initialize_key_slots();


                global_data.initialized |= 0x02;

            }





            break;

        case PSA_CRYPTO_SUBSYSTEM_RNG:





            driver_wrappers_initialized =
                (global_data.initialized & 0x01);
# 8496 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
            if (global_data.rng_state == 0 && driver_wrappers_initialized) {
                mbedtls_psa_random_init(&global_data.rng);
                global_data.rng_state = 1;

                status = mbedtls_psa_random_seed(&global_data.rng);
                if (status == ((psa_status_t)0)) {
                    global_data.rng_state = 2;
                }
            }






            break;

        case PSA_CRYPTO_SUBSYSTEM_TRANSACTION:





            if (!(global_data.initialized & 0x04)) {
# 8534 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
                global_data.initialized |= 0x04;
                status = ((psa_status_t)0);

            }






            break;

        default:
            status = ((psa_status_t)-151);
    }






    return status;
}

psa_status_t psa_crypto_init(void)
{
    psa_status_t status;



    if (psa_get_initialized()) {
        return ((psa_status_t)0);
    }

    status = mbedtls_psa_crypto_init_subsystem(PSA_CRYPTO_SUBSYSTEM_DRIVER_WRAPPERS);
    if (status != ((psa_status_t)0)) {
        goto exit;
    }

    status = mbedtls_psa_crypto_init_subsystem(PSA_CRYPTO_SUBSYSTEM_KEY_SLOTS);
    if (status != ((psa_status_t)0)) {
        goto exit;
    }

    status = mbedtls_psa_crypto_init_subsystem(PSA_CRYPTO_SUBSYSTEM_RNG);
    if (status != ((psa_status_t)0)) {
        goto exit;
    }

    status = mbedtls_psa_crypto_init_subsystem(PSA_CRYPTO_SUBSYSTEM_TRANSACTION);

exit:

    if (status != ((psa_status_t)0)) {
        mbedtls_psa_crypto_free();
    }

    return status;
}
# 8601 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
psa_status_t psa_crypto_driver_pake_get_password_len(
    const psa_crypto_driver_pake_inputs_t *inputs,
    size_t *password_len)
{
    if (inputs->password_len == 0) {
        return ((psa_status_t)-137);
    }

    *password_len = inputs->password_len;

    return ((psa_status_t)0);
}

psa_status_t psa_crypto_driver_pake_get_password(
    const psa_crypto_driver_pake_inputs_t *inputs,
    uint8_t *buffer, size_t buffer_size, size_t *buffer_length)
{
    if (inputs->password_len == 0) {
        return ((psa_status_t)-137);
    }

    if (buffer_size < inputs->password_len) {
        return ((psa_status_t)-138);
    }

    memcpy(buffer, inputs->password, inputs->password_len);
    *buffer_length = inputs->password_len;

    return ((psa_status_t)0);
}

psa_status_t psa_crypto_driver_pake_get_user_len(
    const psa_crypto_driver_pake_inputs_t *inputs,
    size_t *user_len)
{
    if (inputs->user_len == 0) {
        return ((psa_status_t)-137);
    }

    *user_len = inputs->user_len;

    return ((psa_status_t)0);
}

psa_status_t psa_crypto_driver_pake_get_user(
    const psa_crypto_driver_pake_inputs_t *inputs,
    uint8_t *user_id, size_t user_id_size, size_t *user_id_len)
{
    if (inputs->user_len == 0) {
        return ((psa_status_t)-137);
    }

    if (user_id_size < inputs->user_len) {
        return ((psa_status_t)-138);
    }

    memcpy(user_id, inputs->user, inputs->user_len);
    *user_id_len = inputs->user_len;

    return ((psa_status_t)0);
}

psa_status_t psa_crypto_driver_pake_get_peer_len(
    const psa_crypto_driver_pake_inputs_t *inputs,
    size_t *peer_len)
{
    if (inputs->peer_len == 0) {
        return ((psa_status_t)-137);
    }

    *peer_len = inputs->peer_len;

    return ((psa_status_t)0);
}

psa_status_t psa_crypto_driver_pake_get_peer(
    const psa_crypto_driver_pake_inputs_t *inputs,
    uint8_t *peer_id, size_t peer_id_size, size_t *peer_id_length)
{
    if (inputs->peer_len == 0) {
        return ((psa_status_t)-137);
    }

    if (peer_id_size < inputs->peer_len) {
        return ((psa_status_t)-138);
    }

    memcpy(peer_id, inputs->peer, inputs->peer_len);
    *peer_id_length = inputs->peer_len;

    return ((psa_status_t)0);
}

psa_status_t psa_crypto_driver_pake_get_cipher_suite(
    const psa_crypto_driver_pake_inputs_t *inputs,
    psa_pake_cipher_suite_t *cipher_suite)
{
    if (inputs->cipher_suite.algorithm == ((psa_algorithm_t)0)) {
        return ((psa_status_t)-137);
    }

    *cipher_suite = inputs->cipher_suite;

    return ((psa_status_t)0);
}

psa_status_t psa_pake_setup(
    psa_pake_operation_t *operation,
    const psa_pake_cipher_suite_t *cipher_suite)
{
    psa_status_t status = ((psa_status_t)-151);

    if (operation->stage != 0) {
        status = ((psa_status_t)-137);
        goto exit;
    }

    if ((((cipher_suite->algorithm) & ((psa_algorithm_t) 0x7f000000)) == ((psa_algorithm_t) 0x0a000000)) == 0 ||
        (((cipher_suite->hash) & ((psa_algorithm_t) 0x7f000000)) == ((psa_algorithm_t) 0x02000000)) == 0) {
        status = ((psa_status_t)-135);
        goto exit;
    }





    memset(&operation->data, 0, sizeof(operation->data));

    operation->alg = cipher_suite->algorithm;
    operation->primitive = ((cipher_suite->bits & 0xFFFF) != cipher_suite->bits) ? 0 : ((psa_pake_primitive_t) (((cipher_suite->type) << 24 | (cipher_suite->family) << 16) | (cipher_suite->bits)))
                                                                                       ;
    operation->data.inputs.cipher_suite = *cipher_suite;


    if (operation->alg == ((psa_algorithm_t) 0x0a000100)) {
        psa_jpake_computation_stage_t *computation_stage =
            &operation->computation_stage.jpake;

        memset(computation_stage, 0, sizeof(*computation_stage));
        computation_stage->step = ((psa_pake_step_t) 0x01);
    } else

    {
        status = ((psa_status_t)-134);
        goto exit;
    }

    operation->stage = 1;

    return ((psa_status_t)0);
exit:
    psa_pake_abort(operation);
    return status;
}

psa_status_t psa_pake_set_password_key(
    psa_pake_operation_t *operation,
    mbedtls_svc_key_id_t password)
{
    psa_status_t status = ((psa_status_t)-151);
    psa_status_t unlock_status = ((psa_status_t)-151);
    psa_key_slot_t *slot = 
# 8763 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
                          ((void *)0)
# 8763 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
                              ;
    psa_key_type_t type;

    if (operation->stage != 1) {
        status = ((psa_status_t)-137);
        goto exit;
    }

    status = psa_get_and_lock_key_slot_with_policy(password, &slot,
                                                   ((psa_key_usage_t) 0x00004000),
                                                   operation->alg);
    if (status != ((psa_status_t)0)) {
        goto exit;
    }

    type = psa_get_key_type(&slot->attr);

    if (type != ((psa_key_type_t) 0x1203) &&
        type != ((psa_key_type_t) 0x1205)) {
        status = ((psa_status_t)-135);
        goto exit;
    }

    operation->data.inputs.password = calloc(1, slot->key.bytes);
    if (operation->data.inputs.password == 
# 8787 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
                                          ((void *)0)
# 8787 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
                                              ) {
        status = ((psa_status_t)-141);
        goto exit;
    }

    memcpy(operation->data.inputs.password, slot->key.data, slot->key.bytes);
    operation->data.inputs.password_len = slot->key.bytes;
    operation->data.inputs.attributes = slot->attr;

exit:
    if (status != ((psa_status_t)0)) {
        psa_pake_abort(operation);
    }
    unlock_status = psa_unregister_read_under_mutex(slot);
    return (status == ((psa_status_t)0)) ? unlock_status : status;
}

psa_status_t psa_pake_set_user(
    psa_pake_operation_t *operation,
    const uint8_t *user_id_external,
    size_t user_id_len)
{
    psa_status_t status = ((psa_status_t)-151);
    psa_crypto_local_input_t LOCAL_INPUT_COPY_OF_user_id_external = ((psa_crypto_local_input_t) { 
# 8810 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 8810 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   , 0 }); const uint8_t *user_id = 
# 8810 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 8810 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   ;;

    if (operation->stage != 1) {
        status = ((psa_status_t)-137);
        goto exit;
    }

    if (user_id_len == 0) {
        status = ((psa_status_t)-135);
        goto exit;
    }

    if (operation->data.inputs.user_len != 0) {
        status = ((psa_status_t)-137);
        goto exit;
    }

    operation->data.inputs.user = calloc(1, user_id_len);
    if (operation->data.inputs.user == 
# 8828 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
                                      ((void *)0)
# 8828 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
                                          ) {
        status = ((psa_status_t)-141);
        goto exit;
    }

    status = psa_crypto_local_input_alloc(user_id_external, user_id_len, &LOCAL_INPUT_COPY_OF_user_id_external); if (status != ((psa_status_t)0)) { goto exit; } user_id = LOCAL_INPUT_COPY_OF_user_id_external.buffer;;

    memcpy(operation->data.inputs.user, user_id, user_id_len);
    operation->data.inputs.user_len = user_id_len;

    status = ((psa_status_t)0);

exit:
    user_id = 
# 8841 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 8841 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   ; psa_crypto_local_input_free(&LOCAL_INPUT_COPY_OF_user_id_external);;
    if (status != ((psa_status_t)0)) {
        psa_pake_abort(operation);
    }
    return status;
}

psa_status_t psa_pake_set_peer(
    psa_pake_operation_t *operation,
    const uint8_t *peer_id_external,
    size_t peer_id_len)
{
    psa_status_t status = ((psa_status_t)-151);
    psa_crypto_local_input_t LOCAL_INPUT_COPY_OF_peer_id_external = ((psa_crypto_local_input_t) { 
# 8854 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 8854 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   , 0 }); const uint8_t *peer_id = 
# 8854 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 8854 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   ;;

    if (operation->stage != 1) {
        status = ((psa_status_t)-137);
        goto exit;
    }

    if (peer_id_len == 0) {
        status = ((psa_status_t)-135);
        goto exit;
    }

    if (operation->data.inputs.peer_len != 0) {
        status = ((psa_status_t)-137);
        goto exit;
    }

    operation->data.inputs.peer = calloc(1, peer_id_len);
    if (operation->data.inputs.peer == 
# 8872 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
                                      ((void *)0)
# 8872 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
                                          ) {
        status = ((psa_status_t)-141);
        goto exit;
    }

    status = psa_crypto_local_input_alloc(peer_id_external, peer_id_len, &LOCAL_INPUT_COPY_OF_peer_id_external); if (status != ((psa_status_t)0)) { goto exit; } peer_id = LOCAL_INPUT_COPY_OF_peer_id_external.buffer;;

    memcpy(operation->data.inputs.peer, peer_id, peer_id_len);
    operation->data.inputs.peer_len = peer_id_len;

    status = ((psa_status_t)0);

exit:
    peer_id = 
# 8885 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 8885 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   ; psa_crypto_local_input_free(&LOCAL_INPUT_COPY_OF_peer_id_external);;
    if (status != ((psa_status_t)0)) {
        psa_pake_abort(operation);
    }
    return status;
}

psa_status_t psa_pake_set_role(
    psa_pake_operation_t *operation,
    psa_pake_role_t role)
{
    psa_status_t status = ((psa_status_t)-151);

    if (operation->stage != 1) {
        status = ((psa_status_t)-137);
        goto exit;
    }

    switch (operation->alg) {

        case ((psa_algorithm_t) 0x0a000100):
            if (role == ((psa_pake_role_t) 0x00)) {
                return ((psa_status_t)0);
            }
            status = ((psa_status_t)-135);
            break;

        default:
            (void) role;
            status = ((psa_status_t)-134);
            goto exit;
    }
exit:
    psa_pake_abort(operation);
    return status;
}



static psa_crypto_driver_pake_step_t convert_jpake_computation_stage_to_driver_step(
    psa_jpake_computation_stage_t *stage)
{
    psa_crypto_driver_pake_step_t key_share_step;
    if (stage->round == PSA_JPAKE_FIRST) {
        int is_x1;

        if (stage->io_mode == PSA_JPAKE_OUTPUT) {
            is_x1 = (stage->outputs < 1);
        } else {
            is_x1 = (stage->inputs < 1);
        }

        key_share_step = is_x1 ?
                         PSA_JPAKE_X1_STEP_KEY_SHARE :
                         PSA_JPAKE_X2_STEP_KEY_SHARE;
    } else if (stage->round == PSA_JPAKE_SECOND) {
        key_share_step = (stage->io_mode == PSA_JPAKE_OUTPUT) ?
                         PSA_JPAKE_X2S_STEP_KEY_SHARE :
                         PSA_JPAKE_X4S_STEP_KEY_SHARE;
    } else {
        return PSA_JPAKE_STEP_INVALID;
    }
    return (psa_crypto_driver_pake_step_t) (key_share_step + stage->step - ((psa_pake_step_t) 0x01));
}


static psa_status_t psa_pake_complete_inputs(
    psa_pake_operation_t *operation)
{
    psa_status_t status = ((psa_status_t)-151);


    psa_crypto_driver_pake_inputs_t inputs = operation->data.inputs;

    if (inputs.password_len == 0) {
        return ((psa_status_t)-137);
    }

    if (operation->alg == ((psa_algorithm_t) 0x0a000100)) {
        if (inputs.user_len == 0 || inputs.peer_len == 0) {
            return ((psa_status_t)-137);
        }
    }


    mbedtls_platform_zeroize(&operation->data, sizeof(operation->data));

    status = psa_driver_wrapper_pake_setup(operation, &inputs);


    mbedtls_zeroize_and_free(inputs.password, inputs.password_len);


    free(inputs.user);
    free(inputs.peer);

    if (status == ((psa_status_t)0)) {

        if (operation->alg == ((psa_algorithm_t) 0x0a000100)) {
            operation->stage = 2;
        } else

        {
            status = ((psa_status_t)-134);
        }
    }
    return status;
}


static psa_status_t psa_jpake_prologue(
    psa_pake_operation_t *operation,
    psa_pake_step_t step,
    psa_jpake_io_mode_t io_mode)
{
    if (step != ((psa_pake_step_t) 0x01) &&
        step != ((psa_pake_step_t) 0x02) &&
        step != ((psa_pake_step_t) 0x03)) {
        return ((psa_status_t)-135);
    }

    psa_jpake_computation_stage_t *computation_stage =
        &operation->computation_stage.jpake;

    if (computation_stage->round != PSA_JPAKE_FIRST &&
        computation_stage->round != PSA_JPAKE_SECOND) {
        return ((psa_status_t)-137);
    }


    if (step != computation_stage->step) {
        return ((psa_status_t)-137);
    }

    if (step == ((psa_pake_step_t) 0x01) &&
        computation_stage->inputs == 0 &&
        computation_stage->outputs == 0) {


        computation_stage->io_mode = io_mode;
    } else if (computation_stage->io_mode != io_mode) {


        return ((psa_status_t)-137);
    }

    return ((psa_status_t)0);
}

static psa_status_t psa_jpake_epilogue(
    psa_pake_operation_t *operation,
    psa_jpake_io_mode_t io_mode)
{
    psa_jpake_computation_stage_t *stage =
        &operation->computation_stage.jpake;

    if (stage->step == ((psa_pake_step_t) 0x03)) {

        if (io_mode == PSA_JPAKE_INPUT) {
            stage->inputs++;
            if (stage->inputs == ((stage->round) == PSA_JPAKE_FINISHED ? 0 : ((stage->round) == PSA_JPAKE_FIRST ? 2 : 1))) {
                stage->io_mode = PSA_JPAKE_OUTPUT;
            }
        }
        if (io_mode == PSA_JPAKE_OUTPUT) {
            stage->outputs++;
            if (stage->outputs == ((stage->round) == PSA_JPAKE_FINISHED ? 0 : ((stage->round) == PSA_JPAKE_FIRST ? 2 : 1))) {
                stage->io_mode = PSA_JPAKE_INPUT;
            }
        }
        if (stage->inputs == ((stage->round) == PSA_JPAKE_FINISHED ? 0 : ((stage->round) == PSA_JPAKE_FIRST ? 2 : 1)) &&
            stage->outputs == ((stage->round) == PSA_JPAKE_FINISHED ? 0 : ((stage->round) == PSA_JPAKE_FIRST ? 2 : 1))) {

            stage->inputs = 0;
            stage->outputs = 0;
            stage->round++;
        }
        stage->step = ((psa_pake_step_t) 0x01);
    } else {
        stage->step++;
    }
    return ((psa_status_t)0);
}



psa_status_t psa_pake_output(
    psa_pake_operation_t *operation,
    psa_pake_step_t step,
    uint8_t *output_external,
    size_t output_size,
    size_t *output_length)
{
    psa_status_t status = ((psa_status_t)-151);
    psa_crypto_driver_pake_step_t driver_step = PSA_JPAKE_STEP_INVALID;
    psa_crypto_local_output_t LOCAL_OUTPUT_COPY_OF_output_external = ((psa_crypto_local_output_t) { 
# 9080 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 9080 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   , 
# 9080 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 9080 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   , 0 }); uint8_t *output = 
# 9080 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 9080 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   ;;
    *output_length = 0;

    if (operation->stage == 1) {
        status = psa_pake_complete_inputs(operation);
        if (status != ((psa_status_t)0)) {
            goto exit;
        }
    }

    if (operation->stage != 2) {
        status = ((psa_status_t)-137);
        goto exit;
    }

    if (output_size == 0) {
        status = ((psa_status_t)-135);
        goto exit;
    }

    switch (operation->alg) {

        case ((psa_algorithm_t) 0x0a000100):
            status = psa_jpake_prologue(operation, step, PSA_JPAKE_OUTPUT);
            if (status != ((psa_status_t)0)) {
                goto exit;
            }
            driver_step = convert_jpake_computation_stage_to_driver_step(
                &operation->computation_stage.jpake);
            break;

        default:
            (void) step;
            status = ((psa_status_t)-134);
            goto exit;
    }

    status = psa_crypto_local_output_alloc(output_external, output_size, &LOCAL_OUTPUT_COPY_OF_output_external); if (status != ((psa_status_t)0)) { goto exit; } output = LOCAL_OUTPUT_COPY_OF_output_external.buffer;;

    status = psa_driver_wrapper_pake_output(operation, driver_step,
                                            output, output_size, output_length);

    if (status != ((psa_status_t)0)) {
        goto exit;
    }

    switch (operation->alg) {

        case ((psa_algorithm_t) 0x0a000100):
            status = psa_jpake_epilogue(operation, PSA_JPAKE_OUTPUT);
            if (status != ((psa_status_t)0)) {
                goto exit;
            }
            break;

        default:
            status = ((psa_status_t)-134);
            goto exit;
    }

exit:
    output = 
# 9141 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 9141 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   ; do { psa_status_t local_output_status; local_output_status = psa_crypto_local_output_free(&LOCAL_OUTPUT_COPY_OF_output_external); if (local_output_status != ((psa_status_t)0)) { status = local_output_status; } } while (0);
    if (status != ((psa_status_t)0)) {
        psa_pake_abort(operation);
    }
    return status;
}

psa_status_t psa_pake_input(
    psa_pake_operation_t *operation,
    psa_pake_step_t step,
    const uint8_t *input_external,
    size_t input_length)
{
    psa_status_t status = ((psa_status_t)-151);
    psa_crypto_driver_pake_step_t driver_step = PSA_JPAKE_STEP_INVALID;
    const size_t max_input_length = (size_t) (operation->alg == ((psa_algorithm_t) 0x0a000100) && operation->primitive == ((256 & 0xFFFF) != 256) ? 0 : ((psa_pake_primitive_t) (((((psa_pake_primitive_type_t) 0x01)) << 24 | (((psa_ecc_family_t) 0x12)) << 16) | (256))) ? ( step == ((psa_pake_step_t) 0x01) ? 65 : step == ((psa_pake_step_t) 0x02) ? 65 : 32 ) : 0)

                                                                      ;
    psa_crypto_local_input_t LOCAL_INPUT_COPY_OF_input_external = ((psa_crypto_local_input_t) { 
# 9159 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 9159 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   , 0 }); const uint8_t *input = 
# 9159 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 9159 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   ;;

    if (operation->stage == 1) {
        status = psa_pake_complete_inputs(operation);
        if (status != ((psa_status_t)0)) {
            goto exit;
        }
    }

    if (operation->stage != 2) {
        status = ((psa_status_t)-137);
        goto exit;
    }

    if (input_length == 0 || input_length > max_input_length) {
        status = ((psa_status_t)-135);
        goto exit;
    }

    switch (operation->alg) {

        case ((psa_algorithm_t) 0x0a000100):
            status = psa_jpake_prologue(operation, step, PSA_JPAKE_INPUT);
            if (status != ((psa_status_t)0)) {
                goto exit;
            }
            driver_step = convert_jpake_computation_stage_to_driver_step(
                &operation->computation_stage.jpake);
            break;

        default:
            (void) step;
            status = ((psa_status_t)-134);
            goto exit;
    }

    status = psa_crypto_local_input_alloc(input_external, input_length, &LOCAL_INPUT_COPY_OF_input_external); if (status != ((psa_status_t)0)) { goto exit; } input = LOCAL_INPUT_COPY_OF_input_external.buffer;;
    status = psa_driver_wrapper_pake_input(operation, driver_step,
                                           input, input_length);

    if (status != ((psa_status_t)0)) {
        goto exit;
    }

    switch (operation->alg) {

        case ((psa_algorithm_t) 0x0a000100):
            status = psa_jpake_epilogue(operation, PSA_JPAKE_INPUT);
            if (status != ((psa_status_t)0)) {
                goto exit;
            }
            break;

        default:
            status = ((psa_status_t)-134);
            goto exit;
    }

exit:
    input = 
# 9218 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
   ((void *)0)
# 9218 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
   ; psa_crypto_local_input_free(&LOCAL_INPUT_COPY_OF_input_external);;
    if (status != ((psa_status_t)0)) {
        psa_pake_abort(operation);
    }
    return status;
}

psa_status_t psa_pake_get_implicit_key(
    psa_pake_operation_t *operation,
    psa_key_derivation_operation_t *output)
{
    psa_status_t status = ((psa_status_t)-151);
    psa_status_t abort_status = ((psa_status_t)-151);
    uint8_t shared_key[((3 + 1 + 65 + 1 + 65 + 1 + 32) * 2)];
    size_t shared_key_len = 0;

    if (operation->stage != 2) {
        status = ((psa_status_t)-137);
        goto exit;
    }


    if (operation->alg == ((psa_algorithm_t) 0x0a000100)) {
        psa_jpake_computation_stage_t *computation_stage =
            &operation->computation_stage.jpake;
        if (computation_stage->round != PSA_JPAKE_FINISHED) {
            status = ((psa_status_t)-137);
            goto exit;
        }
    } else

    {
        status = ((psa_status_t)-134);
        goto exit;
    }

    status = psa_driver_wrapper_pake_get_implicit_key(operation,
                                                      shared_key,
                                                      sizeof(shared_key),
                                                      &shared_key_len);

    if (status != ((psa_status_t)0)) {
        goto exit;
    }

    status = psa_key_derivation_input_bytes(output,
                                            ((psa_key_derivation_step_t) 0x0101),
                                            shared_key,
                                            shared_key_len);

    mbedtls_platform_zeroize(shared_key, sizeof(shared_key));
exit:
    abort_status = psa_pake_abort(operation);
    return status == ((psa_status_t)0) ? abort_status : status;
}

psa_status_t psa_pake_abort(
    psa_pake_operation_t *operation)
{
    psa_status_t status = ((psa_status_t)0);

    if (operation->stage == 2) {
        status = psa_driver_wrapper_pake_abort(operation);
    }

    if (operation->stage == 1) {
        if (operation->data.inputs.password != 
# 9284 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
                                              ((void *)0)
# 9284 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
                                                  ) {
            mbedtls_zeroize_and_free(operation->data.inputs.password,
                                     operation->data.inputs.password_len);
        }
        if (operation->data.inputs.user != 
# 9288 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
                                          ((void *)0)
# 9288 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
                                              ) {
            free(operation->data.inputs.user);
        }
        if (operation->data.inputs.peer != 
# 9291 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
                                          ((void *)0)
# 9291 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
                                              ) {
            free(operation->data.inputs.peer);
        }
    }
    memset(operation, 0, sizeof(psa_pake_operation_t));

    return status;
}
# 9324 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
static
psa_status_t psa_crypto_copy_input(const uint8_t *input, size_t input_len,
                                   uint8_t *input_copy, size_t input_copy_len)
{
    if (input_len > input_copy_len) {
        return ((psa_status_t)-151);
    }







    if (input_len > 0) {
        memcpy(input_copy, input, input_len);
    }







    return ((psa_status_t)0);
}
# 9363 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
static
psa_status_t psa_crypto_copy_output(const uint8_t *output_copy, size_t output_copy_len,
                                    uint8_t *output, size_t output_len)
{
    if (output_len < output_copy_len) {
        return ((psa_status_t)-138);
    }







    if (output_copy_len > 0) {
        memcpy(output, output_copy, output_copy_len);
    }







    return ((psa_status_t)0);
}

psa_status_t psa_crypto_local_input_alloc(const uint8_t *input, size_t input_len,
                                          psa_crypto_local_input_t *local_input)
{
    psa_status_t status;

    *local_input = ((psa_crypto_local_input_t) { 
# 9395 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
                  ((void *)0)
# 9395 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
                  , 0 });

    if (input_len == 0) {
        return ((psa_status_t)0);
    }

    local_input->buffer = calloc(input_len, 1);
    if (local_input->buffer == 
# 9402 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
                              ((void *)0)
# 9402 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
                                  ) {


        return ((psa_status_t)-141);
    }


    local_input->length = input_len;

    status = psa_crypto_copy_input(input, input_len,
                                   local_input->buffer, local_input->length);
    if (status != ((psa_status_t)0)) {
        goto error;
    }

    return ((psa_status_t)0);

error:
    mbedtls_zeroize_and_free(local_input->buffer, local_input->length);
    local_input->buffer = 
# 9421 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
                         ((void *)0)
# 9421 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
                             ;
    local_input->length = 0;
    return status;
}

void psa_crypto_local_input_free(psa_crypto_local_input_t *local_input)
{
    mbedtls_zeroize_and_free(local_input->buffer, local_input->length);
    local_input->buffer = 
# 9429 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
                         ((void *)0)
# 9429 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
                             ;
    local_input->length = 0;
}

psa_status_t psa_crypto_local_output_alloc(uint8_t *output, size_t output_len,
                                           psa_crypto_local_output_t *local_output)
{
    *local_output = ((psa_crypto_local_output_t) { 
# 9436 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
                   ((void *)0)
# 9436 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
                   , 
# 9436 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
                   ((void *)0)
# 9436 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
                   , 0 });

    if (output_len == 0) {
        return ((psa_status_t)0);
    }
    local_output->buffer = calloc(output_len, 1);
    if (local_output->buffer == 
# 9442 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
                               ((void *)0)
# 9442 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
                                   ) {


        return ((psa_status_t)-141);
    }
    local_output->length = output_len;
    local_output->original = output;

    return ((psa_status_t)0);
}

psa_status_t psa_crypto_local_output_free(psa_crypto_local_output_t *local_output)
{
    psa_status_t status;

    if (local_output->buffer == 
# 9457 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
                               ((void *)0)
# 9457 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
                                   ) {
        local_output->length = 0;
        return ((psa_status_t)0);
    }
    if (local_output->original == 
# 9461 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
                                 ((void *)0)
# 9461 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
                                     ) {

        return ((psa_status_t)-151);
    }

    status = psa_crypto_copy_output(local_output->buffer, local_output->length,
                                    local_output->original, local_output->length);
    if (status != ((psa_status_t)0)) {
        return status;
    }

    mbedtls_zeroize_and_free(local_output->buffer, local_output->length);
    local_output->buffer = 
# 9473 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c" 3 4
                          ((void *)0)
# 9473 "/home/chandu/sdk/bl602_iot_sdk/components/security/mbedtls-bl602/library/psa_crypto.c"
                              ;
    local_output->length = 0;

    return ((psa_status_t)0);
}
